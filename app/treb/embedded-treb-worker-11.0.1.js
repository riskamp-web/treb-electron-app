/*! v11.0.1. Copyright 2018-2021 Structured Data, LLC. All rights reserved. CC BY-ND: https://treb.app/license */
!function(){var t={4370:function(t,e,r){r(8783),r(1038);var n=r(857);t.exports=n.Array.from},1045:function(t,e,r){r(7145),r(2472),r(9743),r(5109),r(8255),r(5125),r(9135),r(4197),r(6495),r(6443),t.exports=r(7854)},6443:function(t,e,r){r(8145),r(5206),r(2990),r(8927),r(3105),r(5035),r(4345),r(7174),r(2846),r(4731),r(7209),r(8867),r(7789),r(3739),r(9368),r(4483),r(2056),r(3462),r(678),r(7462),r(3824),r(5021),r(2974),r(5016),r(6319),r(1539)},3099:function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},6077:function(t,e,r){var n=r(111);t.exports=function(t){if(!n(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},1223:function(t,e,r){var n=r(5112),i=r(30),a=r(3070),o=n("unscopables"),s=Array.prototype;null==s[o]&&a.f(s,o,{configurable:!0,value:i(null)}),t.exports=function(t){s[o][t]=!0}},5787:function(t){t.exports=function(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t}},9670:function(t,e,r){var n=r(111);t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},4019:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,r){"use strict";var n,i=r(4019),a=r(9781),o=r(7854),s=r(111),l=r(6656),u=r(648),c=r(8880),h=r(1320),f=r(3070).f,d=r(9518),p=r(7674),m=r(5112),v=r(9711),y=o.Int8Array,_=y&&y.prototype,g=o.Uint8ClampedArray,b=g&&g.prototype,x=y&&d(y),w=_&&d(_),M=Object.prototype,C=M.isPrototypeOf,A=m("toStringTag"),S=v("TYPED_ARRAY_TAG"),R=i&&!!p&&"Opera"!==u(o.opera),k=!1,T={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},P={BigInt64Array:8,BigUint64Array:8},N=function(t){if(!s(t))return!1;var e=u(t);return l(T,e)||l(P,e)};for(n in T)o[n]||(R=!1);if((!R||"function"!=typeof x||x===Function.prototype)&&(x=function(){throw TypeError("Incorrect invocation")},R))for(n in T)o[n]&&p(o[n],x);if((!R||!w||w===M)&&(w=x.prototype,R))for(n in T)o[n]&&p(o[n].prototype,w);if(R&&d(b)!==w&&p(b,w),a&&!l(w,A))for(n in k=!0,f(w,A,{get:function(){return s(this)?this[S]:void 0}}),T)o[n]&&c(o[n],S,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:R,TYPED_ARRAY_TAG:k&&S,aTypedArray:function(t){if(N(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(p){if(C.call(x,t))return t}else for(var e in T)if(l(T,n)){var r=o[e];if(r&&(t===r||C.call(r,t)))return t}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r){if(a){if(r)for(var n in T){var i=o[n];if(i&&l(i.prototype,t))try{delete i.prototype[t]}catch(t){}}w[t]&&!r||h(w,t,r?e:R&&_[t]||e)}},exportTypedArrayStaticMethod:function(t,e,r){var n,i;if(a){if(p){if(r)for(n in T)if((i=o[n])&&l(i,t))try{delete i[t]}catch(t){}if(x[t]&&!r)return;try{return h(x,t,r?e:R&&x[t]||e)}catch(t){}}for(n in T)!(i=o[n])||i[t]&&!r||h(i,t,e)}},isView:function(t){if(!s(t))return!1;var e=u(t);return"DataView"===e||l(T,e)||l(P,e)},isTypedArray:N,TypedArray:x,TypedArrayPrototype:w}},3331:function(t,e,r){"use strict";var n=r(7854),i=r(9781),a=r(4019),o=r(8880),s=r(2248),l=r(7293),u=r(5787),c=r(9958),h=r(7466),f=r(7067),d=r(1179),p=r(9518),m=r(7674),v=r(8006).f,y=r(3070).f,_=r(1285),g=r(8003),b=r(9909),x=b.get,w=b.set,M="ArrayBuffer",C="DataView",A="Wrong index",S=n.ArrayBuffer,R=S,k=n.DataView,T=k&&k.prototype,P=Object.prototype,N=n.RangeError,E=d.pack,D=d.unpack,O=function(t){return[255&t]},F=function(t){return[255&t,t>>8&255]},I=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},L=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},U=function(t){return E(t,23,4)},j=function(t){return E(t,52,8)},V=function(t,e){y(t.prototype,e,{get:function(){return x(this)[e]}})},G=function(t,e,r,n){var i=f(r),a=x(t);if(i+e>a.byteLength)throw N(A);var o=x(a.buffer).bytes,s=i+a.byteOffset,l=o.slice(s,s+e);return n?l:l.reverse()},z=function(t,e,r,n,i,a){var o=f(r),s=x(t);if(o+e>s.byteLength)throw N(A);for(var l=x(s.buffer).bytes,u=o+s.byteOffset,c=n(+i),h=0;h<e;h++)l[u+h]=c[a?h:e-h-1]};if(a){if(!l((function(){S(1)}))||!l((function(){new S(-1)}))||l((function(){return new S,new S(1.5),new S(NaN),S.name!=M}))){for(var B,q=(R=function(t){return u(this,R),new S(f(t))}).prototype=S.prototype,J=v(S),H=0;J.length>H;)(B=J[H++])in R||o(R,B,S[B]);q.constructor=R}m&&p(T)!==P&&m(T,P);var W=new k(new R(2)),Z=T.setInt8;W.setInt8(0,2147483648),W.setInt8(1,2147483649),!W.getInt8(0)&&W.getInt8(1)||s(T,{setInt8:function(t,e){Z.call(this,t,e<<24>>24)},setUint8:function(t,e){Z.call(this,t,e<<24>>24)}},{unsafe:!0})}else R=function(t){u(this,R,M);var e=f(t);w(this,{bytes:_.call(new Array(e),0),byteLength:e}),i||(this.byteLength=e)},k=function(t,e,r){u(this,k,C),u(t,R,C);var n=x(t).byteLength,a=c(e);if(a<0||a>n)throw N("Wrong offset");if(a+(r=void 0===r?n-a:h(r))>n)throw N("Wrong length");w(this,{buffer:t,byteLength:r,byteOffset:a}),i||(this.buffer=t,this.byteLength=r,this.byteOffset=a)},i&&(V(R,"byteLength"),V(k,"buffer"),V(k,"byteLength"),V(k,"byteOffset")),s(k.prototype,{getInt8:function(t){return G(this,1,t)[0]<<24>>24},getUint8:function(t){return G(this,1,t)[0]},getInt16:function(t){var e=G(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=G(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return L(G(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return L(G(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return D(G(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return D(G(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){z(this,1,t,O,e)},setUint8:function(t,e){z(this,1,t,O,e)},setInt16:function(t,e){z(this,2,t,F,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){z(this,2,t,F,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){z(this,4,t,I,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){z(this,4,t,I,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){z(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){z(this,8,t,j,e,arguments.length>2?arguments[2]:void 0)}});g(R,M),g(k,C),t.exports={ArrayBuffer:R,DataView:k}},1048:function(t,e,r){"use strict";var n=r(7908),i=r(1400),a=r(7466),o=Math.min;t.exports=[].copyWithin||function(t,e){var r=n(this),s=a(r.length),l=i(t,s),u=i(e,s),c=arguments.length>2?arguments[2]:void 0,h=o((void 0===c?s:i(c,s))-u,s-l),f=1;for(u<l&&l<u+h&&(f=-1,u+=h-1,l+=h-1);h-- >0;)u in r?r[l]=r[u]:delete r[l],l+=f,u+=f;return r}},1285:function(t,e,r){"use strict";var n=r(7908),i=r(1400),a=r(7466);t.exports=function(t){for(var e=n(this),r=a(e.length),o=arguments.length,s=i(o>1?arguments[1]:void 0,r),l=o>2?arguments[2]:void 0,u=void 0===l?r:i(l,r);u>s;)e[s++]=t;return e}},8457:function(t,e,r){"use strict";var n=r(9974),i=r(7908),a=r(3411),o=r(7659),s=r(7466),l=r(6135),u=r(1246);t.exports=function(t){var e,r,c,h,f,d,p=i(t),m="function"==typeof this?this:Array,v=arguments.length,y=v>1?arguments[1]:void 0,_=void 0!==y,g=u(p),b=0;if(_&&(y=n(y,v>2?arguments[2]:void 0,2)),null==g||m==Array&&o(g))for(r=new m(e=s(p.length));e>b;b++)d=_?y(p[b],b):p[b],l(r,b,d);else for(f=(h=g.call(p)).next,r=new m;!(c=f.call(h)).done;b++)d=_?a(h,y,[c.value,b],!0):c.value,l(r,b,d);return r.length=b,r}},1318:function(t,e,r){var n=r(5656),i=r(7466),a=r(1400),o=function(t){return function(e,r,o){var s,l=n(e),u=i(l.length),c=a(o,u);if(t&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===r)return t||c||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},2092:function(t,e,r){var n=r(9974),i=r(8361),a=r(7908),o=r(7466),s=r(5417),l=[].push,u=function(t){var e=1==t,r=2==t,u=3==t,c=4==t,h=6==t,f=7==t,d=5==t||h;return function(p,m,v,y){for(var _,g,b=a(p),x=i(b),w=n(m,v,3),M=o(x.length),C=0,A=y||s,S=e?A(p,M):r||f?A(p,0):void 0;M>C;C++)if((d||C in x)&&(g=w(_=x[C],C,b),t))if(e)S[C]=g;else if(g)switch(t){case 3:return!0;case 5:return _;case 6:return C;case 2:l.call(S,_)}else switch(t){case 4:return!1;case 7:l.call(S,_)}return h?-1:u||c?c:S}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterOut:u(7)}},6583:function(t,e,r){"use strict";var n=r(5656),i=r(9958),a=r(7466),o=r(9341),s=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,c=o("lastIndexOf"),h=u||!c;t.exports=h?function(t){if(u)return l.apply(this,arguments)||0;var e=n(this),r=a(e.length),o=r-1;for(arguments.length>1&&(o=s(o,i(arguments[1]))),o<0&&(o=r+o);o>=0;o--)if(o in e&&e[o]===t)return o||0;return-1}:l},9341:function(t,e,r){"use strict";var n=r(7293);t.exports=function(t,e){var r=[][t];return!!r&&n((function(){r.call(null,e||function(){throw 1},1)}))}},3671:function(t,e,r){var n=r(3099),i=r(7908),a=r(8361),o=r(7466),s=function(t){return function(e,r,s,l){n(r);var u=i(e),c=a(u),h=o(u.length),f=t?h-1:0,d=t?-1:1;if(s<2)for(;;){if(f in c){l=c[f],f+=d;break}if(f+=d,t?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;t?f>=0:h>f;f+=d)f in c&&(l=r(l,c[f],f,u));return l}};t.exports={left:s(!1),right:s(!0)}},5417:function(t,e,r){var n=r(111),i=r(3157),a=r(5112)("species");t.exports=function(t,e){var r;return i(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!i(r.prototype)?n(r)&&null===(r=r[a])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===e?0:e)}},3411:function(t,e,r){var n=r(9670),i=r(9212);t.exports=function(t,e,r,a){try{return a?e(n(r)[0],r[1]):e(r)}catch(e){throw i(t),e}}},7072:function(t,e,r){var n=r(5112)("iterator"),i=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){i=!0}};o[n]=function(){return this},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var a={};a[n]=function(){return{next:function(){return{done:r=!0}}}},t(a)}catch(t){}return r}},4326:function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},648:function(t,e,r){var n=r(1694),i=r(4326),a=r(5112)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=n?i:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),a))?r:o?i(e):"Object"==(n=i(e))&&"function"==typeof e.callee?"Arguments":n}},9920:function(t,e,r){var n=r(6656),i=r(3887),a=r(1236),o=r(3070);t.exports=function(t,e){for(var r=i(e),s=o.f,l=a.f,u=0;u<r.length;u++){var c=r[u];n(t,c)||s(t,c,l(e,c))}}},8544:function(t,e,r){var n=r(7293);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},4994:function(t,e,r){"use strict";var n=r(3383).IteratorPrototype,i=r(30),a=r(9114),o=r(8003),s=r(7497),l=function(){return this};t.exports=function(t,e,r){var u=e+" Iterator";return t.prototype=i(n,{next:a(1,r)}),o(t,u,!1,!0),s[u]=l,t}},8880:function(t,e,r){var n=r(9781),i=r(3070),a=r(9114);t.exports=n?function(t,e,r){return i.f(t,e,a(1,r))}:function(t,e,r){return t[e]=r,t}},9114:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6135:function(t,e,r){"use strict";var n=r(7593),i=r(3070),a=r(9114);t.exports=function(t,e,r){var o=n(e);o in t?i.f(t,o,a(0,r)):t[o]=r}},654:function(t,e,r){"use strict";var n=r(2109),i=r(4994),a=r(9518),o=r(7674),s=r(8003),l=r(8880),u=r(1320),c=r(5112),h=r(1913),f=r(7497),d=r(3383),p=d.IteratorPrototype,m=d.BUGGY_SAFARI_ITERATORS,v=c("iterator"),y="keys",_="values",g="entries",b=function(){return this};t.exports=function(t,e,r,c,d,x,w){i(r,e,c);var M,C,A,S=function(t){if(t===d&&N)return N;if(!m&&t in T)return T[t];switch(t){case y:case _:case g:return function(){return new r(this,t)}}return function(){return new r(this)}},R=e+" Iterator",k=!1,T=t.prototype,P=T[v]||T["@@iterator"]||d&&T[d],N=!m&&P||S(d),E="Array"==e&&T.entries||P;if(E&&(M=a(E.call(new t)),p!==Object.prototype&&M.next&&(h||a(M)===p||(o?o(M,p):"function"!=typeof M[v]&&l(M,v,b)),s(M,R,!0,!0),h&&(f[R]=b))),d==_&&P&&P.name!==_&&(k=!0,N=function(){return P.call(this)}),h&&!w||T[v]===N||l(T,v,N),f[e]=N,d)if(C={values:S(_),keys:x?N:S(y),entries:S(g)},w)for(A in C)(m||k||!(A in T))&&u(T,A,C[A]);else n({target:e,proto:!0,forced:m||k},C);return C}},9781:function(t,e,r){var n=r(7293);t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(t,e,r){var n=r(7854),i=r(111),a=n.document,o=i(a)&&i(a.createElement);t.exports=function(t){return o?a.createElement(t):{}}},8113:function(t,e,r){var n=r(5005);t.exports=n("navigator","userAgent")||""},7392:function(t,e,r){var n,i,a=r(7854),o=r(8113),s=a.process,l=s&&s.versions,u=l&&l.v8;u?i=(n=u.split("."))[0]<4?1:n[0]+n[1]:o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(i=n[1]),t.exports=i&&+i},748:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(t,e,r){var n=r(7854),i=r(1236).f,a=r(8880),o=r(1320),s=r(3505),l=r(9920),u=r(4705);t.exports=function(t,e){var r,c,h,f,d,p=t.target,m=t.global,v=t.stat;if(r=m?n:v?n[p]||s(p,{}):(n[p]||{}).prototype)for(c in e){if(f=e[c],h=t.noTargetGet?(d=i(r,c))&&d.value:r[c],!u(m?c:p+(v?".":"#")+c,t.forced)&&void 0!==h){if(typeof f==typeof h)continue;l(f,h)}(t.sham||h&&h.sham)&&a(f,"sham",!0),o(r,c,f,t)}}},7293:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},9974:function(t,e,r){var n=r(3099);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},5005:function(t,e,r){var n=r(857),i=r(7854),a=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?a(n[t])||a(i[t]):n[t]&&n[t][e]||i[t]&&i[t][e]}},1246:function(t,e,r){var n=r(648),i=r(7497),a=r(5112)("iterator");t.exports=function(t){if(null!=t)return t[a]||t["@@iterator"]||i[n(t)]}},7854:function(t,e,r){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},6656:function(t,e,r){var n=r(7908),i={}.hasOwnProperty;t.exports=function(t,e){return i.call(n(t),e)}},3501:function(t){t.exports={}},490:function(t,e,r){var n=r(5005);t.exports=n("document","documentElement")},4664:function(t,e,r){var n=r(9781),i=r(7293),a=r(317);t.exports=!n&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},1179:function(t){var e=Math.abs,r=Math.pow,n=Math.floor,i=Math.log,a=Math.LN2;t.exports={pack:function(t,o,s){var l,u,c,h=new Array(s),f=8*s-o-1,d=(1<<f)-1,p=d>>1,m=23===o?r(2,-24)-r(2,-77):0,v=t<0||0===t&&1/t<0?1:0,y=0;for((t=e(t))!=t||t===1/0?(u=t!=t?1:0,l=d):(l=n(i(t)/a),t*(c=r(2,-l))<1&&(l--,c*=2),(t+=l+p>=1?m/c:m*r(2,1-p))*c>=2&&(l++,c/=2),l+p>=d?(u=0,l=d):l+p>=1?(u=(t*c-1)*r(2,o),l+=p):(u=t*r(2,p-1)*r(2,o),l=0));o>=8;h[y++]=255&u,u/=256,o-=8);for(l=l<<o|u,f+=o;f>0;h[y++]=255&l,l/=256,f-=8);return h[--y]|=128*v,h},unpack:function(t,e){var n,i=t.length,a=8*i-e-1,o=(1<<a)-1,s=o>>1,l=a-7,u=i-1,c=t[u--],h=127&c;for(c>>=7;l>0;h=256*h+t[u],u--,l-=8);for(n=h&(1<<-l)-1,h>>=-l,l+=e;l>0;n=256*n+t[u],u--,l-=8);if(0===h)h=1-s;else{if(h===o)return n?NaN:c?-1/0:1/0;n+=r(2,e),h-=s}return(c?-1:1)*n*r(2,h-e)}}},8361:function(t,e,r){var n=r(7293),i=r(4326),a="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?a.call(t,""):Object(t)}:Object},9587:function(t,e,r){var n=r(111),i=r(7674);t.exports=function(t,e,r){var a,o;return i&&"function"==typeof(a=e.constructor)&&a!==r&&n(o=a.prototype)&&o!==r.prototype&&i(t,o),t}},2788:function(t,e,r){var n=r(5465),i=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(t){return i.call(t)}),t.exports=n.inspectSource},9909:function(t,e,r){var n,i,a,o=r(8536),s=r(7854),l=r(111),u=r(8880),c=r(6656),h=r(5465),f=r(6200),d=r(3501),p="Object already initialized",m=s.WeakMap;if(o||h.state){var v=h.state||(h.state=new m),y=v.get,_=v.has,g=v.set;n=function(t,e){if(_.call(v,t))throw new TypeError(p);return e.facade=t,g.call(v,t,e),e},i=function(t){return y.call(v,t)||{}},a=function(t){return _.call(v,t)}}else{var b=f("state");d[b]=!0,n=function(t,e){if(c(t,b))throw new TypeError(p);return e.facade=t,u(t,b,e),e},i=function(t){return c(t,b)?t[b]:{}},a=function(t){return c(t,b)}}t.exports={set:n,get:i,has:a,enforce:function(t){return a(t)?i(t):n(t,{})},getterFor:function(t){return function(e){var r;if(!l(e)||(r=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}}},7659:function(t,e,r){var n=r(5112),i=r(7497),a=n("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[a]===t)}},3157:function(t,e,r){var n=r(4326);t.exports=Array.isArray||function(t){return"Array"==n(t)}},4705:function(t,e,r){var n=r(7293),i=/#|\.prototype\./,a=function(t,e){var r=s[o(t)];return r==u||r!=l&&("function"==typeof e?n(e):!!e)},o=a.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=a.data={},l=a.NATIVE="N",u=a.POLYFILL="P";t.exports=a},111:function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},1913:function(t){t.exports=!1},9212:function(t,e,r){var n=r(9670);t.exports=function(t){var e=t.return;if(void 0!==e)return n(e.call(t)).value}},3383:function(t,e,r){"use strict";var n,i,a,o=r(7293),s=r(9518),l=r(8880),u=r(6656),c=r(5112),h=r(1913),f=c("iterator"),d=!1;[].keys&&("next"in(a=[].keys())?(i=s(s(a)))!==Object.prototype&&(n=i):d=!0);var p=null==n||o((function(){var t={};return n[f].call(t)!==t}));p&&(n={}),h&&!p||u(n,f)||l(n,f,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:d}},7497:function(t){t.exports={}},133:function(t,e,r){var n=r(7392),i=r(7293);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())||!Symbol.sham&&n&&n<41}))},8536:function(t,e,r){var n=r(7854),i=r(2788),a=n.WeakMap;t.exports="function"==typeof a&&/native code/.test(i(a))},30:function(t,e,r){var n,i=r(9670),a=r(6048),o=r(748),s=r(3501),l=r(490),u=r(317),c=r(6200)("IE_PROTO"),h=function(){},f=function(t){return"<script>"+t+"<\/script>"},d=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;d=n?function(t){t.write(f("")),t.close();var e=t.parentWindow.Object;return t=null,e}(n):((e=u("iframe")).style.display="none",l.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(f("document.F=Object")),t.close(),t.F);for(var r=o.length;r--;)delete d.prototype[o[r]];return d()};s[c]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(h.prototype=i(t),r=new h,h.prototype=null,r[c]=t):r=d(),void 0===e?r:a(r,e)}},6048:function(t,e,r){var n=r(9781),i=r(3070),a=r(9670),o=r(1956);t.exports=n?Object.defineProperties:function(t,e){a(t);for(var r,n=o(e),s=n.length,l=0;s>l;)i.f(t,r=n[l++],e[r]);return t}},3070:function(t,e,r){var n=r(9781),i=r(4664),a=r(9670),o=r(7593),s=Object.defineProperty;e.f=n?s:function(t,e,r){if(a(t),e=o(e,!0),a(r),i)try{return s(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},1236:function(t,e,r){var n=r(9781),i=r(5296),a=r(9114),o=r(5656),s=r(7593),l=r(6656),u=r(4664),c=Object.getOwnPropertyDescriptor;e.f=n?c:function(t,e){if(t=o(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(l(t,e))return a(!i.f.call(t,e),t[e])}},8006:function(t,e,r){var n=r(6324),i=r(748).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},5181:function(t,e){e.f=Object.getOwnPropertySymbols},9518:function(t,e,r){var n=r(6656),i=r(7908),a=r(6200),o=r(8544),s=a("IE_PROTO"),l=Object.prototype;t.exports=o?Object.getPrototypeOf:function(t){return t=i(t),n(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?l:null}},6324:function(t,e,r){var n=r(6656),i=r(5656),a=r(1318).indexOf,o=r(3501);t.exports=function(t,e){var r,s=i(t),l=0,u=[];for(r in s)!n(o,r)&&n(s,r)&&u.push(r);for(;e.length>l;)n(s,r=e[l++])&&(~a(u,r)||u.push(r));return u}},1956:function(t,e,r){var n=r(6324),i=r(748);t.exports=Object.keys||function(t){return n(t,i)}},5296:function(t,e){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);e.f=i?function(t){var e=n(this,t);return!!e&&e.enumerable}:r},7674:function(t,e,r){var n=r(9670),i=r(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(t){}return function(r,a){return n(r),i(a),e?t.call(r,a):r.__proto__=a,r}}():void 0)},288:function(t,e,r){"use strict";var n=r(1694),i=r(648);t.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},3887:function(t,e,r){var n=r(5005),i=r(8006),a=r(5181),o=r(9670);t.exports=n("Reflect","ownKeys")||function(t){var e=i.f(o(t)),r=a.f;return r?e.concat(r(t)):e}},857:function(t,e,r){var n=r(7854);t.exports=n},2248:function(t,e,r){var n=r(1320);t.exports=function(t,e,r){for(var i in e)n(t,i,e[i],r);return t}},1320:function(t,e,r){var n=r(7854),i=r(8880),a=r(6656),o=r(3505),s=r(2788),l=r(9909),u=l.get,c=l.enforce,h=String(String).split("String");(t.exports=function(t,e,r,s){var l,u=!!s&&!!s.unsafe,f=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof r&&("string"!=typeof e||a(r,"name")||i(r,"name",e),(l=c(r)).source||(l.source=h.join("string"==typeof e?e:""))),t!==n?(u?!d&&t[e]&&(f=!0):delete t[e],f?t[e]=r:i(t,e,r)):f?t[e]=r:o(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},4488:function(t){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},3505:function(t,e,r){var n=r(7854),i=r(8880);t.exports=function(t,e){try{i(n,t,e)}catch(r){n[t]=e}return e}},6340:function(t,e,r){"use strict";var n=r(5005),i=r(3070),a=r(5112),o=r(9781),s=a("species");t.exports=function(t){var e=n(t),r=i.f;o&&e&&!e[s]&&r(e,s,{configurable:!0,get:function(){return this}})}},8003:function(t,e,r){var n=r(3070).f,i=r(6656),a=r(5112)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,a)&&n(t,a,{configurable:!0,value:e})}},6200:function(t,e,r){var n=r(2309),i=r(9711),a=n("keys");t.exports=function(t){return a[t]||(a[t]=i(t))}},5465:function(t,e,r){var n=r(7854),i=r(3505),a="__core-js_shared__",o=n[a]||i(a,{});t.exports=o},2309:function(t,e,r){var n=r(1913),i=r(5465);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.13.0",mode:n?"pure":"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})},6707:function(t,e,r){var n=r(9670),i=r(3099),a=r(5112)("species");t.exports=function(t,e){var r,o=n(t).constructor;return void 0===o||null==(r=n(o)[a])?e:i(r)}},8710:function(t,e,r){var n=r(9958),i=r(4488),a=function(t){return function(e,r){var a,o,s=String(i(e)),l=n(r),u=s.length;return l<0||l>=u?t?"":void 0:(a=s.charCodeAt(l))<55296||a>56319||l+1===u||(o=s.charCodeAt(l+1))<56320||o>57343?t?s.charAt(l):a:t?s.slice(l,l+2):o-56320+(a-55296<<10)+65536}};t.exports={codeAt:a(!1),charAt:a(!0)}},1400:function(t,e,r){var n=r(9958),i=Math.max,a=Math.min;t.exports=function(t,e){var r=n(t);return r<0?i(r+e,0):a(r,e)}},7067:function(t,e,r){var n=r(9958),i=r(7466);t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=i(e);if(e!==r)throw RangeError("Wrong length or index");return r}},5656:function(t,e,r){var n=r(8361),i=r(4488);t.exports=function(t){return n(i(t))}},9958:function(t){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},7466:function(t,e,r){var n=r(9958),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},7908:function(t,e,r){var n=r(4488);t.exports=function(t){return Object(n(t))}},4590:function(t,e,r){var n=r(3002);t.exports=function(t,e){var r=n(t);if(r%e)throw RangeError("Wrong offset");return r}},3002:function(t,e,r){var n=r(9958);t.exports=function(t){var e=n(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}},7593:function(t,e,r){var n=r(111);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},1694:function(t,e,r){var n={};n[r(5112)("toStringTag")]="z",t.exports="[object z]"===String(n)},9843:function(t,e,r){"use strict";var n=r(2109),i=r(7854),a=r(9781),o=r(3832),s=r(260),l=r(3331),u=r(5787),c=r(9114),h=r(8880),f=r(7466),d=r(7067),p=r(4590),m=r(7593),v=r(6656),y=r(648),_=r(111),g=r(30),b=r(7674),x=r(8006).f,w=r(7321),M=r(2092).forEach,C=r(6340),A=r(3070),S=r(1236),R=r(9909),k=r(9587),T=R.get,P=R.set,N=A.f,E=S.f,D=Math.round,O=i.RangeError,F=l.ArrayBuffer,I=l.DataView,L=s.NATIVE_ARRAY_BUFFER_VIEWS,U=s.TYPED_ARRAY_TAG,j=s.TypedArray,V=s.TypedArrayPrototype,G=s.aTypedArrayConstructor,z=s.isTypedArray,B="BYTES_PER_ELEMENT",q="Wrong length",J=function(t,e){for(var r=0,n=e.length,i=new(G(t))(n);n>r;)i[r]=e[r++];return i},H=function(t,e){N(t,e,{get:function(){return T(this)[e]}})},W=function(t){var e;return t instanceof F||"ArrayBuffer"==(e=y(t))||"SharedArrayBuffer"==e},Z=function(t,e){return z(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},$=function(t,e){return Z(t,e=m(e,!0))?c(2,t[e]):E(t,e)},Y=function(t,e,r){return!(Z(t,e=m(e,!0))&&_(r)&&v(r,"value"))||v(r,"get")||v(r,"set")||r.configurable||v(r,"writable")&&!r.writable||v(r,"enumerable")&&!r.enumerable?N(t,e,r):(t[e]=r.value,t)};a?(L||(S.f=$,A.f=Y,H(V,"buffer"),H(V,"byteOffset"),H(V,"byteLength"),H(V,"length")),n({target:"Object",stat:!0,forced:!L},{getOwnPropertyDescriptor:$,defineProperty:Y}),t.exports=function(t,e,r){var a=t.match(/\d+$/)[0]/8,s=t+(r?"Clamped":"")+"Array",l="get"+t,c="set"+t,m=i[s],v=m,y=v&&v.prototype,A={},S=function(t,e){N(t,e,{get:function(){return function(t,e){var r=T(t);return r.view[l](e*a+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,n){var i=T(t);r&&(n=(n=D(n))<0?0:n>255?255:255&n),i.view[c](e*a+i.byteOffset,n,!0)}(this,e,t)},enumerable:!0})};L?o&&(v=e((function(t,e,r,n){return u(t,v,s),k(_(e)?W(e)?void 0!==n?new m(e,p(r,a),n):void 0!==r?new m(e,p(r,a)):new m(e):z(e)?J(v,e):w.call(v,e):new m(d(e)),t,v)})),b&&b(v,j),M(x(m),(function(t){t in v||h(v,t,m[t])})),v.prototype=y):(v=e((function(t,e,r,n){u(t,v,s);var i,o,l,c=0,h=0;if(_(e)){if(!W(e))return z(e)?J(v,e):w.call(v,e);i=e,h=p(r,a);var m=e.byteLength;if(void 0===n){if(m%a)throw O(q);if((o=m-h)<0)throw O(q)}else if((o=f(n)*a)+h>m)throw O(q);l=o/a}else l=d(e),i=new F(o=l*a);for(P(t,{buffer:i,byteOffset:h,byteLength:o,length:l,view:new I(i)});c<l;)S(t,c++)})),b&&b(v,j),y=v.prototype=g(V)),y.constructor!==v&&h(y,"constructor",v),U&&h(y,U,s),A[s]=v,n({global:!0,forced:v!=m,sham:!L},A),B in v||h(v,B,a),B in y||h(y,B,a),C(s)}):t.exports=function(){}},3832:function(t,e,r){var n=r(7854),i=r(7293),a=r(7072),o=r(260).NATIVE_ARRAY_BUFFER_VIEWS,s=n.ArrayBuffer,l=n.Int8Array;t.exports=!o||!i((function(){l(1)}))||!i((function(){new l(-1)}))||!a((function(t){new l,new l(null),new l(1.5),new l(t)}),!0)||i((function(){return 1!==new l(new s(2),1,void 0).length}))},3074:function(t,e,r){var n=r(260).aTypedArrayConstructor,i=r(6707);t.exports=function(t,e){for(var r=i(t,t.constructor),a=0,o=e.length,s=new(n(r))(o);o>a;)s[a]=e[a++];return s}},7321:function(t,e,r){var n=r(7908),i=r(7466),a=r(1246),o=r(7659),s=r(9974),l=r(260).aTypedArrayConstructor;t.exports=function(t){var e,r,u,c,h,f,d=n(t),p=arguments.length,m=p>1?arguments[1]:void 0,v=void 0!==m,y=a(d);if(null!=y&&!o(y))for(f=(h=y.call(d)).next,d=[];!(c=f.call(h)).done;)d.push(c.value);for(v&&p>2&&(m=s(m,arguments[2],2)),r=i(d.length),u=new(l(this))(r),e=0;r>e;e++)u[e]=v?m(d[e],e):d[e];return u}},9711:function(t){var e=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+r).toString(36)}},3307:function(t,e,r){var n=r(133);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5112:function(t,e,r){var n=r(7854),i=r(2309),a=r(6656),o=r(9711),s=r(133),l=r(3307),u=i("wks"),c=n.Symbol,h=l?c:c&&c.withoutSetter||o;t.exports=function(t){return a(u,t)&&(s||"string"==typeof u[t])||(s&&a(c,t)?u[t]=c[t]:u[t]=h("Symbol."+t)),u[t]}},1038:function(t,e,r){var n=r(2109),i=r(8457);n({target:"Array",stat:!0,forced:!r(7072)((function(t){Array.from(t)}))},{from:i})},6992:function(t,e,r){"use strict";var n=r(5656),i=r(1223),a=r(7497),o=r(9909),s=r(654),l="Array Iterator",u=o.set,c=o.getterFor(l);t.exports=s(Array,"Array",(function(t,e){u(this,{type:l,target:n(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},1539:function(t,e,r){var n=r(1694),i=r(1320),a=r(288);n||i(Object.prototype,"toString",a,{unsafe:!0})},8783:function(t,e,r){"use strict";var n=r(8710).charAt,i=r(9909),a=r(654),o="String Iterator",s=i.set,l=i.getterFor(o);a(String,"String",(function(t){s(this,{type:o,string:String(t),index:0})}),(function(){var t,e=l(this),r=e.string,i=e.index;return i>=r.length?{value:void 0,done:!0}:(t=n(r,i),e.index+=t.length,{value:t,done:!1})}))},2990:function(t,e,r){"use strict";var n=r(260),i=r(1048),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("copyWithin",(function(t,e){return i.call(a(this),t,e,arguments.length>2?arguments[2]:void 0)}))},8927:function(t,e,r){"use strict";var n=r(260),i=r(2092).every,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("every",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},3105:function(t,e,r){"use strict";var n=r(260),i=r(1285),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("fill",(function(t){return i.apply(a(this),arguments)}))},5035:function(t,e,r){"use strict";var n=r(260),i=r(2092).filter,a=r(3074),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("filter",(function(t){var e=i(o(this),t,arguments.length>1?arguments[1]:void 0);return a(this,e)}))},7174:function(t,e,r){"use strict";var n=r(260),i=r(2092).findIndex,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("findIndex",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},4345:function(t,e,r){"use strict";var n=r(260),i=r(2092).find,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("find",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},4197:function(t,e,r){r(9843)("Float32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},6495:function(t,e,r){r(9843)("Float64",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},2846:function(t,e,r){"use strict";var n=r(260),i=r(2092).forEach,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("forEach",(function(t){i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},8145:function(t,e,r){"use strict";var n=r(3832);(0,r(260).exportTypedArrayStaticMethod)("from",r(7321),n)},4731:function(t,e,r){"use strict";var n=r(260),i=r(1318).includes,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("includes",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},7209:function(t,e,r){"use strict";var n=r(260),i=r(1318).indexOf,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("indexOf",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},5109:function(t,e,r){r(9843)("Int16",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},5125:function(t,e,r){r(9843)("Int32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},7145:function(t,e,r){r(9843)("Int8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},6319:function(t,e,r){"use strict";var n=r(7854),i=r(260),a=r(6992),o=r(5112)("iterator"),s=n.Uint8Array,l=a.values,u=a.keys,c=a.entries,h=i.aTypedArray,f=i.exportTypedArrayMethod,d=s&&s.prototype[o],p=!!d&&("values"==d.name||null==d.name),m=function(){return l.call(h(this))};f("entries",(function(){return c.call(h(this))})),f("keys",(function(){return u.call(h(this))})),f("values",m,!p),f(o,m,!p)},8867:function(t,e,r){"use strict";var n=r(260),i=n.aTypedArray,a=n.exportTypedArrayMethod,o=[].join;a("join",(function(t){return o.apply(i(this),arguments)}))},7789:function(t,e,r){"use strict";var n=r(260),i=r(6583),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("lastIndexOf",(function(t){return i.apply(a(this),arguments)}))},3739:function(t,e,r){"use strict";var n=r(260),i=r(2092).map,a=r(6707),o=n.aTypedArray,s=n.aTypedArrayConstructor;(0,n.exportTypedArrayMethod)("map",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(s(a(t,t.constructor)))(e)}))}))},5206:function(t,e,r){"use strict";var n=r(260),i=r(3832),a=n.aTypedArrayConstructor;(0,n.exportTypedArrayStaticMethod)("of",(function(){for(var t=0,e=arguments.length,r=new(a(this))(e);e>t;)r[t]=arguments[t++];return r}),i)},4483:function(t,e,r){"use strict";var n=r(260),i=r(3671).right,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduceRight",(function(t){return i(a(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},9368:function(t,e,r){"use strict";var n=r(260),i=r(3671).left,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduce",(function(t){return i(a(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2056:function(t,e,r){"use strict";var n=r(260),i=n.aTypedArray,a=n.exportTypedArrayMethod,o=Math.floor;a("reverse",(function(){for(var t,e=this,r=i(e).length,n=o(r/2),a=0;a<n;)t=e[a],e[a++]=e[--r],e[r]=t;return e}))},3462:function(t,e,r){"use strict";var n=r(260),i=r(7466),a=r(4590),o=r(7908),s=r(7293),l=n.aTypedArray;(0,n.exportTypedArrayMethod)("set",(function(t){l(this);var e=a(arguments.length>1?arguments[1]:void 0,1),r=this.length,n=o(t),s=i(n.length),u=0;if(s+e>r)throw RangeError("Wrong length");for(;u<s;)this[e+u]=n[u++]}),s((function(){new Int8Array(1).set({})})))},678:function(t,e,r){"use strict";var n=r(260),i=r(6707),a=r(7293),o=n.aTypedArray,s=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod,u=[].slice;l("slice",(function(t,e){for(var r=u.call(o(this),t,e),n=i(this,this.constructor),a=0,l=r.length,c=new(s(n))(l);l>a;)c[a]=r[a++];return c}),a((function(){new Int8Array(1).slice()})))},7462:function(t,e,r){"use strict";var n=r(260),i=r(2092).some,a=n.aTypedArray;(0,n.exportTypedArrayMethod)("some",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},3824:function(t,e,r){"use strict";var n=r(260),i=n.aTypedArray,a=n.exportTypedArrayMethod,o=[].sort;a("sort",(function(t){return o.call(i(this),t)}))},5021:function(t,e,r){"use strict";var n=r(260),i=r(7466),a=r(1400),o=r(6707),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("subarray",(function(t,e){var r=s(this),n=r.length,l=a(t,n);return new(o(r,r.constructor))(r.buffer,r.byteOffset+l*r.BYTES_PER_ELEMENT,i((void 0===e?n:a(e,n))-l))}))},2974:function(t,e,r){"use strict";var n=r(7854),i=r(260),a=r(7293),o=n.Int8Array,s=i.aTypedArray,l=i.exportTypedArrayMethod,u=[].toLocaleString,c=[].slice,h=!!o&&a((function(){u.call(new o(1))}));l("toLocaleString",(function(){return u.apply(h?c.call(s(this)):s(this),arguments)}),a((function(){return[1,2].toLocaleString()!=new o([1,2]).toLocaleString()}))||!a((function(){o.prototype.toLocaleString.call([1,2])})))},5016:function(t,e,r){"use strict";var n=r(260).exportTypedArrayMethod,i=r(7293),a=r(7854).Uint8Array,o=a&&a.prototype||{},s=[].toString,l=[].join;i((function(){s.call({})}))&&(s=function(){return l.call(this)});var u=o.toString!=s;n("toString",s,u)},8255:function(t,e,r){r(9843)("Uint16",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},9135:function(t,e,r){r(9843)("Uint32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},2472:function(t,e,r){r(9843)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},9743:function(t,e,r){r(9843)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0)},4691:function(t,e){!function(t){"use strict";var e=new(function(){function t(t){void 0===t&&(t=0),this.m_w=0,this.m_z=0,this.Seed(t)}return t.prototype.Seed=function(t){void 0===t&&(t=0),t?(this.m_w=Math.round(2863311530&t)||1,this.m_z=Math.round(1431655765&t)||1):(this.m_w=Math.round(1e5*Math.random()),this.m_z=Math.round((new Date).getTime()))},t.prototype.Next=function(){return this.m_z=36969*(65535&this.m_z)+(this.m_z>>16)&4294967295,this.m_w=18e3*(65535&this.m_w)+(this.m_w>>16)&4294967295,.5+((this.m_z<<16)+this.m_w&4294967295)/4294967296},t.prototype.GetState=function(){return[this.m_w,this.m_z]},t}()),r=function(){function t(){}return t.Sort=function(t,e){this.QuickSort(t,e,0,t.length)},t.Partition=function(t,e,r,n){for(var i=t[n-1],a=r,o=r;o<n-1;o+=1)t[o]<=i&&(this.Swap(t,e,o,a),a+=1);return this.Swap(t,e,a,n-1),a},t.Swap=function(t,e,r,n){var i=t[r];t[r]=t[n],t[n]=i,i=e[r],e[r]=e[n],e[n]=i},t.QuickSort=function(t,e,r,n){if(r<n){var i=this.Partition(t,e,r,n);this.QuickSort(t,e,r,i),this.QuickSort(t,e,i+1,n)}},t}(),n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(){function t(){}return t.Sort=function(t){return this.QuickSort(t,0,t.length-1),t},t.Swap=function(t,e,r){var n=t[e];t[e]=t[r],t[r]=n},t.Partition=function(t,e,r){for(var n=t[Math.floor((r+e)/2)];e<=r;){for(;t[e]<n;)e++;for(;t[r]>n;)r--;e<=r&&(this.Swap(t,e,r),e++,r--)}return e},t.QuickSort=function(t,e,r){var n;return t.length>1&&(e<(n=this.Partition(t,e,r))-1&&this.QuickSort(t,e,n-1),n<r&&this.QuickSort(t,n,r)),t},t}(),a=function(){function t(){}return t.Correlation=function(t,e){for(var r=0,n=0,i=0,a=0,o=0,s=0,l=0;l<t.length;l++)n+=t[l]*e[l],i+=t[l],a+=e[l],o+=t[l]*t[l],s+=e[l]*e[l];return(r=t.length*n-i*a)&&(r/=Math.sqrt((t.length*o-i*i)*(t.length*s-a*a))),r},t.TickRange=function(t,e,r){var n=t/(e-1),i=Math.ceil(this.Log10(n)-1),a=Math.pow(10,i);return Math.ceil(n/a)*a},t.Log10=function(t){return Math.log(t)/Math.LN10},t.Log2=function(t){return Math.log(t)/Math.LN2},t.Percentiles=function(t,e){for(var r=i.Sort(t.slice(0)),n=r.length,a=new Array(101),o=0;o<100;o++)a[o]=r[Math.round(n*o/100)];return a[100]=r[n-1],a},t.Percentile=function(t,e){var r=i.Sort(t.slice(0)),n=r.length;return r[Math.max(0,Math.min(n-1,Math.round(n*e)))]},t.Interval=function(t){var e=0;if(!t.data||!t.data.length)return 0;if(void 0===t.min){if(void 0===t.max)return 1;for(var r=0,n=t.data;r<n.length;r++)(l=n[r])<=t.max&&e++}else if(void 0===t.max)for(var i=0,a=t.data;i<a.length;i++)(l=a[i])>=t.min&&e++;else for(var o=0,s=t.data;o<s.length;o++){var l;(l=s[o])>=t.min&&l<=t.max&&e++}return e/t.data.length},t.R2=function(t,e){for(var r=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0,c=0;c<t.length;c++)a+=(n=e[c])*(i=t[c]),o+=n,s+=i,l+=n*n,u+=i*i;return(r=t.length*a-o*s)&&(r/=Math.sqrt((t.length*l-o*o)*(t.length*u-s*s))),r*r},t.ToSD=function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return t;var r=Math.pow(10,Math.floor(this.Log10(t))+1-e);return Math.round(t/r)*r},t.Statistics=function(t){for(var e=this.Range(t),r=t.length,a=0,o=0,s=0,l=0,u=i.Sort(t.slice(0)),c=u[Math.round(r/2)],h=0;h<r;h++)a+=t[h];var f=a/=r;for(h=0;h<r;h++){var d=t[h]-a;o+=d*d,l+=d*d*d,s+=d*d*d*d}var p=r,m=o/r,v=Math.sqrt(o/r),y=l/((r-1)*Math.pow(v,3)),_=s/((r-1)*Math.pow(v,4)),g=Math.sqrt(o/r)/Math.sqrt(r),b={};for(h=5;h<100;h+=5)b[h]=u[Math.round(r*h/100)];b[0]=u[0],b[100]=u[r-1];var x=this.Interval({data:t,max:0});return n(n({},e),{median:c,mean:f,N:p,variance:m,stdev:v,skewness:y,kurtosis:_,stderr:g,percentiles:b,zero:x})},t.Truncate=function(t,e,r){var n=i.Sort(t.slice(0));return n.slice(Math.round(n.length*e/100),Math.round(n.length*r/100))},t.Histogram=function(t,e){void 0===e&&(e="sturges");for(var r=!0,n=0;r&&n<t.length;n++)r=r&&t[n]===Math.round(t[n]);var i=this.Range(t);if("string"==typeof e||!e)if("fd"===e){var a=this.FD(t);e=0===a||0===i.range?1:Math.round(i.range/a+1)}else e=this.Sturges(t);var o=[],s=[];if(r&&e>i.range){for(e=i.range+1,n=0;n<e;n++)o[n]=0,s[n]=i.min+n;for(var l=0,u=t;l<u.length;l++)o[(v=u[l])-i.min]++}else{var c=this.TickRange(i.range,e),h=this.FirstBin(i.max,i.min,e,c),f=Math.ceil(this.Log10(c)-1);for(n=0;n<e;n++)o[n]=0,s[n]=(h+n*c).toFixed(Math.max(0,-f));for(var d=h-c,p=0,m=t;p<m.length;p++){var v=m[p];o[Math.floor((v-d)/c)]++}}return{bins:o,labels:s}},t.Sturges=function(t){return Math.ceil(this.Log2(t.length)+1)},t.IQR=function(t){var e=this.Quantiles(t,[.25,.75]);return e[1]-e[0]},t.Quantiles=function(t,e){void 0===e&&(e=[0,.25,.5,.75,1]);var r=i.Sort(t.slice(0));return e.map((function(t){return r[Math.floor((r.length-1)*t)]}))},t.FD=function(t){return 2*this.IQR(t)*Math.pow(t.length,-1/3)},t.FirstBin=function(t,e,r,n){var i=(Math.floor(e/n)+1)*n,a=Math.floor((i+(r-1)*n-t)/n);return a>=2?i-a/2*n:i},t.Range=function(t){for(var e=t.length,r=e>0?t[0]:0,n=e>0?t[0]:0,i=1;i<e;i++)t[i]>n&&(n=t[i]),t[i]<r&&(r=t[i]);return{min:r,max:n,range:n-r}},t.EPSILON_DOUBLE=2220446049250313e-31,t.QUIET_NAN=Number.NaN,t.s_undefined="undefined",t.s_object="object",t.s_number="number",t}(),o=function(){function t(){this.rows=0,this.columns=0,this.data=[]}return t.Zero=function(e,r){return void 0===r&&(r=e),(new t).Reset(e,r)},t.Identity=function(t){for(var e=this.Zero(t,t),r=0;r<t;r++)e.data[r][r]=1;return e},t.Clone=function(e){var r=new t;r.rows=e.rows,r.columns=e.columns;for(var n=0,i=e.data;n<i.length;n++){var a=i[n];r.data.push(new Float64Array(a))}return r},t.FromArray=function(t,e){void 0===e&&(e=!1);var r=t[0].length,n=t.length;if(e){for(var i=this.Zero(r,n),a=0;a<n;a++)for(var o=0;o<r;o++)i.data[a][o]=t[a][o];return i}for(i=this.Zero(n,r),a=0;a<n;a++)for(o=0;o<r;o++)i.data[o][a]=t[a][o]||0;return i},t.prototype.Reset=function(t,e){this.data=new Array(e);for(var r=0;r<e;r++)this.data[r]=new Float64Array(t);return this.rows=t,this.columns=e,this},t.prototype.CopyTo=function(t){t.rows=this.rows,t.columns=this.columns,t.data=new Array(this.columns);for(var e=0,r=this.data;e<r.length;e++){var n=r[e];t.data.push(new Float64Array(n))}return t},t.prototype.GetColumn=function(t){return this.data[t]},t.prototype.SetColumn=function(t,e){this.data[t]=new Float64Array(e)},t.prototype.Transpose=function(){for(var e=t.Zero(this.columns,this.rows),r=0;r<this.columns;r++)for(var n=0;n<this.rows;n++)e.data[r][n]=this.data[n][r];return e},t.prototype.Symmetrize=function(e){void 0===e&&(e=!1);var r=this.Transpose(),n=t.Clone(this);if(e)for(a=1;a<this.columns;a++)for(i=0;i<a;i++)n.data[i][a]=r.data[i][a];else for(var i=1;i<this.rows;i++)for(var a=0;a<i;a++)n.data[i][a]=r.data[i][a];return n},t.prototype.Cholesky=function(e){if(void 0===e&&(e=!1),this.rows!==this.columns)throw new Error("matrix not square");for(var r=this.rows,n=t.Zero(r),i=0;i<r;i++){for(var a=0,o=0;o<i;o++){for(var s=0,l=0;l<o;l++)s+=n.data[o][l]*n.data[i][l];if(n.data[i][o]=s=(this.data[i][o]-s)/n.data[o][o],a+=s*s,this.data[o][i]!==this.data[i][o])throw new Error("matrix not symmetrical")}if((a=this.data[i][i]-a)<=0)throw new Error("matrix not pos-def ("+a+")");for(n.data[i][i]=a>0?Math.sqrt(a):0,o=i+1;o<r;o++)n.data[i][o]=0}return e?n.Transpose():n},t.prototype.Multiply=function(e){for(var r=0,n=0,i=t.Zero(this.rows,e.columns),a=0;a<this.rows;a++)for(var o=0;o<e.columns;o++){for(n=r=0;r<this.columns;r++)n+=this.data[r][a]*e.data[o][r];i.data[o][a]=n}return i},t.prototype.Inverse=function(){if(this.rows!==this.columns)throw new Error("invalid matrix");for(var e=t.Clone(this),r=0,n=e.rows,i=1;i<n;i++)e.data[i][0]/=e.data[0][0];for(i=1;i<n;i++){for(var a=i;a<n;a++){r=0;for(var o=0;o<i;o++)r+=e.data[o][a]*e.data[i][o];e.data[i][a]-=r}if(i!==n-1)for(a=i+1;a<n;a++){for(r=0,o=0;o<i;o++)r+=e.data[o][i]*e.data[a][o];e.data[a][i]=(e.data[a][i]-r)/e.data[i][i]}}for(i=0;i<n;i++)for(a=i;a<n;a++){var s=1;if(i!==a)for(s=0,o=i;o<a;o++)s-=e.data[o][a]*e.data[i][o];e.data[i][a]=s/e.data[a][a]}for(i=0;i<n;i++)for(a=i;a<n;a++)if(i!==a){for(r=0,o=i;o<a;o++)r+=e.data[a][o]*(i===o?1:e.data[o][i]);e.data[a][i]=-r}for(i=0;i<n;i++)for(a=0;a<n;a++){for(r=0,o=i>a?i:a;o<n;o++)r+=(a===o?1:e.data[o][a])*e.data[i][o];e.data[i][a]=r}return e},t.prototype.SortColumns=function(e){void 0===e&&(e=!1);for(var r=t.Clone(this),n=e?function(t,e){return e-t}:function(t,e){return t-e},i=0,a=r.data;i<a.length;i++)a[i].sort(n);return r},t.prototype.Rank=function(e){void 0===e&&(e=!1);for(var n=t.Clone(this),i=new Int32Array(this.rows),a=0;a<this.rows;a++)i[a]=a;for(var o=0;o<this.columns;o++){var s=new Int32Array(i);for(r.Sort(n.data[o],s),e&&s.reverse(),a=0;a<this.rows;a++)n.data[o][s[a]]=a}return n},t.prototype.Rank2=function(e,n){void 0===e&&(e=!1);for(var i=t.Zero(this.rows,this.columns),a=new Int32Array(this.rows),o=0;o<this.rows;o++)a[o]=o;for(var s=0;s<this.columns;s++){var l=new Int32Array(a);for(r.Sort(this.data[s],l),e&&l.reverse(),o=0;o<this.rows;o++)i.data[s][l[o]]=n.data[s][o]}return i},t.prototype.Correl=function(){for(var e=t.Zero(this.columns,this.columns),r=0;r<this.columns;r++){e.data[r][r]=1;for(var n=0;n<r;n++)e.data[n][r]=a.Correlation(this.data[r],this.data[n])}return e.Symmetrize()},t.prototype.IsSymmetric=function(){if(this.rows!==this.columns)return!1;for(var t=0;t<this.columns;t++)for(var e=0;e<this.rows;e++)if(this.data[t][e]!==this.data[e][t])return!1;return!0},t.prototype.toString=function(t){var e="";t=t||2;for(var r=0;r<this.rows;r++){for(var n=0;n<this.columns;n++){var i=this.data[n][r];i>=0&&(e+=" "),e+=i.toFixed(t),e+=" "}e+="\n"}return e},t}();Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length,r=0;r<e;r++){if(arguments[r]===1/0||arguments[r]===-1/0)return 1/0;t+=arguments[r]*arguments[r]}return Math.sqrt(t)});var s=function(){function t(){}return t.Guid=function(){for(var t="",e=0;e<8;e++)t+=Math.round(256*Math.random()).toString(16);return t},t.Log10=function(t){return Math.log(t)/Math.LN10},t.ToSD=function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return t;var r=t<0?-1:1;t*=r;var n=Math.pow(10,Math.floor(this.Log10(t))+1-e);return Math.round(t/n)*n*r},t.ToSDCeil=function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return t;var r=t<0?-1:1;t*=r;var n=Math.pow(10,Math.floor(this.Log10(t))+1-e);return Math.ceil(t/n)*n*r},t.SuggestDecimals=function(t){if("number"!=typeof t){for(var e=t[0],r=t[0],n=0,i=t;n<i.length;n++){var a=i[n];e=Math.min(e,a),r=Math.max(r,a)}t=r-e}var o=Math.ceil(this.Log10(t));return console.log(o),o<=0?1-o:1},t.YearFraction=function(t){var e=new Date(t.getTime());return e.setMonth(11,31),(e.getTime()-t.getTime())/this.MILLIS_YEAR},t.DEFAULT_NUMBER_FORMAT="(0,0.00)",t.DEFAULT_PCT_FORMAT="0.00",t.DEFAULT_CURRENCY_FORMAT="(0,0)",t.MILLIS_YEAR=315576e5,t}(),l=function(){function t(t){this.order=0,this.realvalues=[],this.ivalues=[],this.vectors=[];var e=t.length;this.order=e,this.vectors=[];for(var r=!0,n=0;r&&n<e;n++){if(t[n].length!==e)throw new Error("not square");for(var i=0;i<e;i++)t[n][i]!==t[i][n]&&(r=!1)}if(r){for(n=0;n<e;n++)Array.isArray(t[n])?this.vectors.push(t[n].slice(0)):this.vectors.push(Array.from(t[n]));this.tred2(),this.tql2()}else{var a=[],o=[];for(n=0;n<e;n++){for(Array.isArray(t[n])?a.push(t[n].slice(0)):a.push(Array.from(t[n])),this.vectors.push([]),i=0;i<e;i++)this.vectors[n][i]=0;o.push(0)}this.orthes(a,o),this.hqr2(a,o)}}return t.prototype.GetDiagonal=function(){for(var t=[],e=0;e<this.order;e++){t.push([]);for(var r=0;r<this.order;r++)t[e][r]=0;t[e][e]=this.realvalues[e],this.ivalues[e]>0?t[e][e+1]=this.ivalues[e]:this.ivalues[e]<0&&(t[e][e-1]=this.ivalues[e])}return t},t.prototype.tred2=function(){for(var t=0,e=0,r=0,n=0,i=0,a=this.order,o=this.vectors,s=this.realvalues,l=this.ivalues,u=0;u<a;u++)s[u]=o[a-1][u];for(var c=a-1;c>0;c--){r=0,n=0;for(var h=0;h<c;h++)r+=Math.abs(s[h]);if(0===r)for(l[c]=s[c-1],u=0;u<c;u++)s[u]=o[c-1][u],o[c][u]=0,o[u][c]=0;else{for(h=0;h<c;h++)s[h]/=r,n+=s[h]*s[h];for(t=s[c-1],e=Math.sqrt(n),t>0&&(e=-e),l[c]=r*e,n-=t*e,s[c-1]=t-e,u=0;u<c;u++)l[u]=0;for(u=0;u<c;u++){t=s[u],o[u][c]=t;var f=l[u]+o[u][u]*t;for(h=u+1;h<=c-1;h++)f+=o[h][u]*s[h],l[h]+=o[h][u]*t;l[u]=f}for(t=0,u=0;u<c;u++)l[u]/=n,t+=l[u]*s[u];for(i=t/(n+n),u=0;u<c;u++)l[u]-=i*s[u];for(u=0;u<c;u++){for(t=s[u],e=l[u],h=u;h<=c-1;h++)o[h][u]-=t*l[h]+e*s[h];s[u]=o[c-1][u],o[c][u]=0}}s[c]=n}for(c=0;c<a-1;c++){if(o[a-1][c]=o[c][c],o[c][c]=1,0!==(n=s[c+1])){for(h=0;h<=c;h++)s[h]=o[h][c+1]/n;for(u=0;u<=c;u++){for(e=0,h=0;h<=c;h++)e+=o[h][c+1]*o[h][u];for(h=0;h<=c;h++)o[h][u]-=e*s[h]}}for(h=0;h<=c;h++)o[h][c+1]=0}for(u=0;u<a;u++)s[u]=o[a-1][u],o[a-1][u]=0;o[a-1][a-1]=1,l[0]=0},t.prototype.tql2=function(){var t,e,r,n,i,a,o,s,l,u,c,h,f,d,p,m,v,y,_,g=this.order,b=this.vectors,x=this.realvalues,w=this.ivalues;for(t=1;t<g;t++)w[t-1]=w[t];for(w[g-1]=0,o=0,s=0,l=Math.pow(2,-52),e=0;e<g;e++){for(s=Math.max(s,Math.abs(x[e])+Math.abs(w[e])),a=e;a<g&&!(Math.abs(w[a])<=l*s);)a++;if(a>e)do{for(u=x[e],n=(x[e+1]-u)/(2*w[e]),c=Math.hypot(n,1),n<0&&(c=-c),x[e]=w[e]/(n+c),x[e+1]=w[e]*(n+c),h=x[e+1],f=u-x[e],t=e+2;t<g;t++)x[t]-=f;for(o+=f,n=x[a],p=d=1,m=d,v=w[e+1],y=0,_=0,t=a-1;t>=e;t--)for(m=p,p=d,_=y,u=d*w[t],f=d*n,c=Math.hypot(n,w[t]),w[t+1]=y*c,y=w[t]/c,n=(d=n/c)*x[t]-y*u,x[t+1]=f+y*(d*u+y*x[t]),r=0;r<g;r++)f=b[r][t+1],b[r][t+1]=y*b[r][t]+d*f,b[r][t]=d*b[r][t]-y*f;n=-y*_*m*v*w[e]/h,w[e]=y*n,x[e]=d*n}while(Math.abs(w[e])>l*s);x[e]=x[e]+o,w[e]=0}for(t=0;t<g-1;t++){for(r=t,n=x[t],i=t+1;i<g;i++)x[i]<n&&(r=i,n=x[i]);if(r!==t)for(x[r]=x[t],x[t]=n,i=0;i<g;i++)n=b[i][t],b[i][t]=b[i][r],b[i][r]=n}},t.prototype.orthes=function(t,e){var r,n,i,a,o,s,l,u=this.order,c=this.vectors,h=(this.realvalues,this.ivalues,u-1);for(s=1;s<=h-1;s++){for(l=0,a=s;a<=h;a++)l+=Math.abs(t[a][s-1]);if(0!==l){for(i=0,a=h;a>=s;a--)e[a]=t[a][s-1]/l,i+=e[a]*e[a];for(n=Math.sqrt(i),e[s]>0&&(n=-n),i-=e[s]*n,e[s]=e[s]-n,o=s;o<u;o++){for(r=0,a=h;a>=s;a--)r+=e[a]*t[a][o];for(r/=i,a=s;a<=h;a++)t[a][o]-=r*e[a]}for(a=0;a<=h;a++){for(r=0,o=h;o>=s;o--)r+=e[o]*t[a][o];for(r/=i,o=s;o<=h;o++)t[a][o]-=r*e[o]}e[s]=l*e[s],t[s][s-1]=l*n}}for(a=0;a<u;a++)for(o=0;o<u;o++)c[a][o]=a===o?1:0;for(s=h-1;s>=1;s--)if(0!==t[s][s-1]){for(a=s+1;a<=h;a++)e[a]=t[a][s-1];for(o=s;o<=h;o++){for(n=0,a=s;a<=h;a++)n+=e[a]*c[a][o];for(n=n/e[s]/t[s][s-1],a=s;a<=h;a++)c[a][o]+=n*e[a]}}},t.prototype.cdiv=function(t,e,r,n){var i=0,a=0;return Math.abs(r)>Math.abs(n)?{r:(t+(i=n/r)*e)/(a=r+i*n),i:(e-i*t)/a}:{r:((i=r/n)*t+e)/(a=n+i*r),i:(i*e-t)/a}},t.prototype.hqr2=function(t,e){var r,n,i,a,o,s,l,u,c,h,f,d=this.order,p=this.vectors,m=this.realvalues,v=this.ivalues,y=d,_=y-1,g=y-1,b=Math.pow(2,-52),x=0,w=0,M=0,C=0,A=0,S=0,R=0;for(s=0;s<y;s++)for((s<0||s>g)&&(m[s]=t[s][s],v[s]=0),l=Math.max(s-1,0);l<y;l++)R+=Math.abs(t[s][l]);for(c=0;_>=0;){for(h=_;h>0&&(0===(A=Math.abs(t[h-1][h-1])+Math.abs(t[h][h]))&&(A=R),!(Math.abs(t[h][h-1])<b*A));)h--;if(h===_)t[_][_]=t[_][_]+x,m[_]=t[_][_],v[_]=0,_--,c=0;else if(h===_-1){if(n=t[_][_-1]*t[_-1][_],M=(w=(t[_-1][_-1]-t[_][_])/2)*w+n,S=Math.sqrt(Math.abs(M)),t[_][_]=t[_][_]+x,t[_-1][_-1]=t[_-1][_-1]+x,i=t[_][_],M>=0){for(S=w>=0?w+S:w-S,m[_-1]=i+S,m[_]=m[_-1],0!==S&&(m[_]=i-n/S),v[_-1]=0,v[_]=0,w=(i=t[_][_-1])/(A=Math.abs(i)+Math.abs(S)),M=S/A,w/=C=Math.sqrt(w*w+M*M),M/=C,l=_-1;l<y;l++)S=t[_-1][l],t[_-1][l]=M*S+w*t[_][l],t[_][l]=M*t[_][l]-w*S;for(s=0;s<=_;s++)S=t[s][_-1],t[s][_-1]=M*S+w*t[s][_],t[s][_]=M*t[s][_]-w*S;for(s=0;s<=g;s++)S=p[s][_-1],p[s][_-1]=M*S+w*p[s][_],p[s][_]=M*p[s][_]-w*S}else m[_-1]=i+w,m[_]=i+w,v[_-1]=S,v[_]=-S;_-=2,c=0}else{if(i=t[_][_],a=0,n=0,h<_&&(a=t[_-1][_-1],n=t[_][_-1]*t[_-1][_]),10===c){for(x+=i,s=0;s<=_;s++)t[s][s]-=i;i=a=.75*(A=Math.abs(t[_][_-1])+Math.abs(t[_-1][_-2])),n=-.4375*A*A}if(30===c&&(A=(A=(a-i)/2)*A+n)>0){for(A=Math.sqrt(A),a<i&&(A=-A),A=i-n/((a-i)/2+A),s=0;s<=_;s++)t[s][s]-=A;x+=A,i=a=n=.964}for(c+=1,f=_-2;f>=h&&(w=((C=i-(S=t[f][f]))*(A=a-S)-n)/t[f+1][f]+t[f][f+1],M=t[f+1][f+1]-S-C-A,C=t[f+2][f+1],w/=A=Math.abs(w)+Math.abs(M)+Math.abs(C),M/=A,C/=A,f!==h)&&!(Math.abs(t[f][f-1])*(Math.abs(M)+Math.abs(C))<b*(Math.abs(w)*(Math.abs(t[f-1][f-1])+Math.abs(S)+Math.abs(t[f+1][f+1]))));)f--;for(s=f+2;s<=_;s++)t[s][s-2]=0,s>f+2&&(t[s][s-3]=0);for(u=f;u<=_-1;u++){var k=u!==_-1;if(u!==f&&(w=t[u][u-1],M=t[u+1][u-1],C=k?t[u+2][u-1]:0,0!==(i=Math.abs(w)+Math.abs(M)+Math.abs(C))&&(w/=i,M/=i,C/=i)),0===i)break;if(A=Math.sqrt(w*w+M*M+C*C),w<0&&(A=-A),0!==A){for(u!==f?t[u][u-1]=-A*i:h!==f&&(t[u][u-1]=-t[u][u-1]),i=(w+=A)/A,a=M/A,S=C/A,M/=w,C/=w,l=u;l<y;l++)w=t[u][l]+M*t[u+1][l],k&&(w+=C*t[u+2][l],t[u+2][l]=t[u+2][l]-w*S),t[u][l]=t[u][l]-w*i,t[u+1][l]=t[u+1][l]-w*a;for(s=0;s<=Math.min(_,u+3);s++)w=i*t[s][u]+a*t[s][u+1],k&&(w+=S*t[s][u+2],t[s][u+2]=t[s][u+2]-w*C),t[s][u]=t[s][u]-w,t[s][u+1]=t[s][u+1]-w*M;for(s=0;s<=g;s++)w=i*p[s][u]+a*p[s][u+1],k&&(w+=S*p[s][u+2],p[s][u+2]=p[s][u+2]-w*C),p[s][u]=p[s][u]-w,p[s][u+1]=p[s][u+1]-w*M}}}}if(0!==R){for(_=y-1;_>=0;_--)if(w=m[_],0===(M=v[_]))for(h=_,t[_][_]=1,s=_-1;s>=0;s--){for(n=t[s][s]-w,C=0,l=h;l<=_;l++)C+=t[s][l]*t[l][_];if(v[s]<0)S=n,A=C;else if(h=s,0===v[s]?t[s][_]=0!==n?-C/n:-C/(b*R):(i=t[s][s+1],a=t[s+1][s],r=(i*A-S*C)/(M=(m[s]-w)*(m[s]-w)+v[s]*v[s]),t[s][_]=r,Math.abs(i)>Math.abs(S)?t[s+1][_]=(-C-n*r)/i:t[s+1][_]=(-A-a*r)/S),b*(r=Math.abs(t[s][_]))*r>1)for(l=s;l<=_;l++)t[l][_]=t[l][_]/r}else if(M<0)for(h=_-1,Math.abs(t[_][_-1])>Math.abs(t[_-1][_])?(t[_-1][_-1]=M/t[_][_-1],t[_-1][_]=-(t[_][_]-w)/t[_][_-1]):(o=this.cdiv(0,-t[_-1][_],t[_-1][_-1]-w,M),t[_-1][_-1]=o.r,t[_-1][_]=o.i),t[_][_-1]=0,t[_][_]=1,s=_-2;s>=0;s--){var T=void 0,P=void 0,N=void 0,E=void 0;for(T=0,P=0,l=h;l<=_;l++)T+=t[s][l]*t[l][_-1],P+=t[s][l]*t[l][_];if(n=t[s][s]-w,v[s]<0)S=n,C=T,A=P;else if(h=s,0===v[s]?(o=this.cdiv(-T,-P,n,M),t[s][_-1]=o.r,t[s][_]=o.i):(i=t[s][s+1],a=t[s+1][s],N=(m[s]-w)*(m[s]-w)+v[s]*v[s]-M*M,E=2*(m[s]-w)*M,0===N&&0===E&&(N=b*R*(Math.abs(n)+Math.abs(M)+Math.abs(i)+Math.abs(a)+Math.abs(S))),o=this.cdiv(i*C-S*T+M*P,i*A-S*P-M*T,N,E),t[s][_-1]=o.r,t[s][_]=o.i,Math.abs(i)>Math.abs(S)+Math.abs(M)?(t[s+1][_-1]=(-T-n*t[s][_-1]+M*t[s][_])/i,t[s+1][_]=(-P-n*t[s][_]-M*t[s][_-1])/i):(o=this.cdiv(-C-a*t[s][_-1],-A-a*t[s][_],S,M),t[s+1][_-1]=o.r,t[s+1][_]=o.i)),b*(r=Math.max(Math.abs(t[s][_-1]),Math.abs(t[s][_])))*r>1)for(l=s;l<=_;l++)t[l][_-1]=t[l][_-1]/r,t[l][_]=t[l][_]/r}for(s=0;s<y;s++)if(s<0||s>g)for(l=s;l<y;l++)p[s][l]=t[s][l];for(l=y-1;l>=0;l--)for(s=0;s<=g;s++){for(S=0,u=0;u<=Math.min(l,g);u++)S+=p[s][u]*t[u][l];p[s][l]=S}}},t}(),u=Math.pow(2,-52),c=function(){function t(){this.rows=0,this.columns=0,this._data=[]}return t.FromArray=function(t){for(var e=t[0].length,r=t.length,n=this.Zero(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)n._data[i][a]=t[i][a]||0;return n},t.Zero=function(e,r){return void 0===r&&(r=e),(new t).Reset(e,r)},t.Identity=function(t){for(var e=this.Zero(t),r=0;r<t;r++)e._data[r][r]=1;return e},t.Clone=function(t){for(var e=this.Zero(t.rows,t.columns),r=0;r<t.rows;r++)e._data[r]=new Float64Array(t._data[r]);return e},t.prototype.Reset=function(t,e){void 0===e&&(e=t),this._data=new Array(t);for(var r=0;r<t;r++)this._data[r]=new Float64Array(e);return this.rows=t,this.columns=e,this},t.prototype.CopyTo=function(t){t.rows=this.rows,t.columns=this.columns,t._data=[];for(var e=0;e<this.rows;e++)t._data[e]=new Float64Array(this._data[e]);return t},t.prototype.Row=function(t,e){return void 0!==e&&(this._data[t]=new Float64Array(e)),Array.from(this._data[t])},t.prototype.Column=function(t,e){if(void 0!==e)for(var r=0;r<this.rows;r++)this._data[r][t]=arguments[1][r];var n=new Array(this.rows);for(r=0;r<this.rows;r++)n[r]=this._data[r][t];return n},t.prototype.Transpose=function(){for(var e=t.Zero(this.columns,this.rows),r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)e._data[n][r]=this._data[r][n];return e},t.prototype.ToArray=function(t){void 0===t&&(t=!1);var e=[];if(t)for(var r=0;r<this.columns;r++)e.push(this.Column(r));else for(var n=0;n<this.rows;n++)e.push(this.Row(n));return e},t.prototype.EigenSystem=function(){return new l(this._data)},t.prototype.IsPosDef=function(){return new l(this._data).realvalues.every((function(t){return t>0}))},t.prototype.MakePosDef=function(e){void 0===e&&(e=u);var r,n,i=new l(this._data),a=i.realvalues.length,o=t.Zero(a),s=t.Zero(a),c=0,h=t.Zero(a);for(i.vectors.forEach((function(t,e){return h.Row(e,t)})),r=0;r<a;r++){for(n=0;n<a;n++)o._data[r][n]=e;i.realvalues[r]>e&&(o._data[r][r]=i.realvalues[r])}for(r=0;r<a;r++){for(c=0,n=0;n<a;n++)s._data[r][n]=0,c+=i.vectors[r][n]*i.vectors[r][n]*o._data[n][n];s._data[r][r]=Math.sqrt(1/c)}for(r=0;r<a;r++)o._data[r][r]=Math.sqrt(o._data[r][r]);for(var f=s.Multiply(h.Multiply(o)),d=f.Multiply(f.Transpose()).Symmetrize(),p=0;p<d.rows;p++)d._data[p][p]=1;return d},t.prototype.Symmetrize=function(e){void 0===e&&(e=!1);var r,n,i=this.Transpose(),a=t.Clone(this);if(e)for(r=1;r<this.rows;r++)for(n=0;n<r;n++)a._data[r][n]=i._data[r][n];else for(n=1;n<this.columns;n++)for(r=0;r<n;r++)a._data[r][n]=i._data[r][n];return a},t.prototype.Cholesky=function(e){if(void 0===e&&(e=!1),this.rows!==this.columns)throw new Error("matrix not square");var r,n,i,a,o,s=this.rows,l=t.Zero(s);for(a=0;a<s;a++){for(n=0,o=0;o<a;o++){for(r=0,i=0;i<o;i++)r+=l._data[i][o]*l._data[i][a];if(l._data[o][a]=r=(this._data[o][a]-r)/l._data[o][o],n+=r*r,this._data[o][a]!=this._data[a][o])throw new Error("matrix not symmetrical")}if((n=this._data[a][a]-n)<=0)throw new Error("matrix not pos-def");for(l._data[a][a]=n>0?Math.sqrt(n):0,o=a+1;o<s;o++)l._data[o][a]=0}return e?l.Transpose():l},t.prototype.Multiply=function(e){var r,n,i,a,o=t.Zero(this.rows,e.columns);for(r=0;r<this.rows;r++)for(n=0;n<e.columns;n++){for(a=i=0;i<this.columns;i++)a+=this._data[r][i]*e._data[i][n];o._data[r][n]=a}return o},t.prototype.Inverse=function(){if(this.rows!==this.columns)throw new Error("invalid matrix");var e,r,n,i,a=t.Clone(this),o=a.rows;for(r=1;r<o;r++)a._data[0][r]/=a._data[0][0];for(r=1;r<o;r++){for(n=r;n<o;n++){for(e=0,i=0;i<r;i++)e+=a._data[n][i]*a._data[i][r];a._data[n][r]-=e}if(r!=o-1)for(n=r+1;n<o;n++){for(e=0,i=0;i<r;i++)e+=a._data[r][i]*a._data[i][n];a._data[r][n]=(a._data[r][n]-e)/a._data[r][r]}}for(r=0;r<o;r++)for(n=r;n<o;n++){var s=1;if(r!=n)for(s=0,i=r;i<n;i++)s-=a._data[n][i]*a._data[i][r];a._data[n][r]=s/a._data[n][n]}for(r=0;r<o;r++)for(n=r;n<o;n++)if(r!=n){for(e=0,i=r;i<n;i++)e+=a._data[i][n]*(r==i?1:a._data[r][i]);a._data[r][n]=-e}for(r=0;r<o;r++)for(n=0;n<o;n++){for(e=0,i=r>n?r:n;i<o;i++)e+=(n==i?1:a._data[n][i])*a._data[i][r];a._data[n][r]=e}return a},t.prototype.SortColumns=function(e){void 0===e&&(e=!1);for(var r=t.Clone(this),n=e?function(t,e){return e-t}:function(t,e){return t-e},i=0;i<this.columns;i++)r.Column(i,this.Column(i).sort(n));return r},t.prototype.Rank=function(e){void 0===e&&(e=!1);for(var n,i=t.Clone(this),a=new Array(this.rows),o=new Array(this.rows),s=0;s<this.columns;s++){for(n=0;n<this.rows;n++)o[n]=n,a[n]=this._data[n][s];for(r.Sort(a,o),e&&o.reverse(),n=0;n<this.rows;n++)i._data[o[n]][s]=n}return i},t.prototype.Correl=function(){for(var e=new Array(this.columns),r=0;r<this.columns;r++)e[r]=this.Column(r);for(var n=t.Zero(this.columns),i=0;i<this.columns;i++){n._data[i][i]=1;for(var o=0;o<i;o++)n._data[i][o]=a.Correlation(e[i],e[o])}return n.Symmetrize()},t.prototype.IsSymmetric=function(){if(this.rows!=this.columns)return!1;for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)if(this._data[t][e]!==this._data[e][t])return!1;return!0},t}();Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length,r=0;r<e;r++){if(arguments[r]===1/0||arguments[r]===-1/0)return 1/0;t+=arguments[r]*arguments[r]}return Math.sqrt(t)});for(var h=function(){function t(){}return t.Normal=function(t,e){var r=this;void 0===e&&(e={});var i=n({mean:0,sd:1,lhs:!1,ordered:!1},e);return(i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered)).map((function(t){return r.InverseNormal2(t)*i.sd+i.mean}))},t.ReverseInverseNormal2=function(t,e){var r=this;void 0===e&&(e=40);for(var n=[0,Math.min(1,Math.max(0,.5+.125*t)),1],i=n.map((function(t){return r.InverseNormal2(t)})),a=0;a<e;a++){if(Math.abs(i[1]-t)<=1e-6)return n[1];i[1]<t?(n=[n[1],(n[1]+n[2])/2,n[2]],i=[i[1],this.InverseNormal2(n[1]),i[2]]):(n=[n[0],(n[0]+n[1])/2,n[1]],i=[i[0],this.InverseNormal2(n[1]),i[1]])}return n[1]},t.TruncatedNormal=function(t,e){var r=this;void 0===e&&(e={});var i=n({mean:0,sd:1,lhs:!1,ordered:!1},e),a=i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered),o=0,s=1;"number"==typeof i.min&&(o=this.ReverseInverseNormal2((i.min-i.mean)/i.sd,i.max_iterations)),"number"==typeof i.max&&(s=this.ReverseInverseNormal2((i.max-i.mean)/i.sd,i.max_iterations));var l=s-o;return(a=a.map((function(t){return t*l+o}))).map((function(t){return r.InverseNormal2(t)*i.sd+i.mean}))},t.LogNormal=function(t,e){void 0===e&&(e={});for(var r=n({mean:1,sd:1,lhs:!1,ordered:!1},e),i=r.lhs?this.LHSFieldDouble(t,r.ordered):this.UniformField(t,r.ordered),a=0;a<i.length;a++)i[a]=Math.exp(this.InverseNormal2(i[a])*r.sd+r.mean);return i},t.LogNormalReturn=function(t,e){void 0===e&&(e={});var r=n({mean:1,sd:1,lhs:!1,ordered:!1},e),i=r.lhs?this.LHSFieldDouble(t,r.ordered):this.UniformField(t,r.ordered);r.mean+=1;for(var a=r.mean*r.mean,o=r.sd*r.sd,s=Math.log(a/Math.sqrt(a+o)),l=Math.sqrt(Math.log((a+o)/a)),u=0;u<t;u++)i[u]=Math.exp(this.InverseNormal2(i[u])*l+s)-1;return i},t.Triangular=function(t,e){var r=this;void 0===e&&(e={});var i=n({a:0,b:1,c:.5,lhs:!1,ordered:!1,field:null},e);return(i.field||(i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered))).map((function(t){return r.InverseTriangular(t,i.a,i.b,i.c)}))},t.PERT=function(t,e){void 0===e&&(e={});var r=n({field:null,lhs:!1,a:0,b:1,c:.5,lambda:4,ordered:!1},e),i=r.field||(r.lhs?this.LHSField(t,r.ordered):this.UniformField(t,r.ordered));return this.InversePERTField(i,r.a,r.b,r.c,r.lambda)},t.Uniform=function(t,e){void 0===e&&(e={});for(var r=n({lhs:!1,min:0,max:1,ordered:!1},e),i=r.lhs?this.LHSFieldDouble(t,r.ordered):this.UniformField(t,r.ordered),a=r.max-r.min,o=0;o<i.length;o++)i[o]=i[o]*a+r.min;return i},t.Bernoulli=function(t,e){void 0===e&&(e={});var r=n({lhs:!1,p:.5},e);return this.Uniform(t,{lhs:r.lhs,min:0,max:1}).map((function(t){return t<=r.p}))},t.Beta=function(t,e){var r=this;void 0===e&&(e={});var i=n({lhs:!1,a:0,b:1,ordered:!1},e);return(i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered)).map((function(t){return r.InverseBeta(t,i.a,i.b)}))},t.Discretize=function(t,e){var r=t.slice(0);e=e||Math.round;for(var n=0;n<r.length;n++)r[n]=e(r[n]);return r},t.Constant=function(t,e){for(var r=new Array(t),n=0;n<t;n++)r[n]=e;return r},t.Fixed=function(t,e){void 0===e&&(e={}),e=n({value:0},e);for(var r=new Array(t),i=0;i<t;i++)r[i]=e.value;return r},t.Conditional=function(t,e,r,n,i,a){void 0===i&&(i=0);for(var o=a||this.Bernoulli(t,{lhs:!0,p:e}),s=r(Math.ceil(t*e),n),l=new Array(t),u=0,c=0;u<t;u++)l[u]=o[u]?s[c++]:i;return l},t.Correlate=function(t,e,r){void 0===r&&(r=!1);var n,i=e.length,a=e[0].length,o=c.Zero(a,i);for(n=0;n<i;n++)o.Column(n,this.VDWField(a));var s=o.Multiply(t.Cholesky(!0).Multiply(o.Correl().Cholesky(!0).Inverse()).Transpose()).Rank();return r?e.map((function(t,e){var r=new Array(t.length),i=s.Column(e);for(n=0;n<i.length;n++)r[n]=t[i[n]];return r})):e.map((function(t,e){var r=t.slice(0).sort((function(t,e){return t-e})),i=new Array(t.length),a=s.Column(e);for(n=0;n<a.length;n++)i[n]=r[a[n]];return i}))},t.CorrelateCDM=function(t,e,r){void 0===r&&(r=!1);var n,i=e.length,a=e[0].length,s=o.Zero(a,i);for(n=0;n<i;n++)s.SetColumn(n,this.VDWField(a));var l=new o;if(l.rows=a,l.columns=i,l.data=e.map((function(t){return new Float64Array(t)})),!r)throw new Error("E_NOTIMPL: correlateCDM !ordered");return s.Multiply(t.Cholesky(!0).Multiply(s.Correl().Cholesky(!0).Inverse()).Transpose()).Rank2(!1,l).data},t.P80Pert=function(t,e,r,n){var i=this.PERTParameters(t,e,r,n),a=(i.max-i.min)/(this.InverseBeta(.9,i.v,i.w)-this.InverseBeta(.1,i.v,i.w)),o=i.min-this.InverseBeta(.1,i.v,i.w)*a,s=i.max+(1-this.InverseBeta(.9,i.v,i.w))*a;return{a:o/i.scale,b:s/i.scale,c:r}},t.P80Triangular=function(t,e,r){var n,i=(r-t)/(e-t),a=i<.5;a&&(i=1-i);var o=2.1266864*i-.1596122-2.1742909*i*i+1.1087738*i*i*i;a&&(o=1-o);var s=(e-t)/(.6890868-.4434898*i+.35757*i*i);return{a:n=r-o*s,b:n+s,c:r}},t.BetaDensity=function(t,e,r){if("number"!=typeof t){for(var n=new Array(t.length),i=0;i<t.length;i++)t[i]<=0||t[i]>=1?n[i]=0:n[i]=Math.exp((e-1)*Math.log(t[i])+(r-1)*Math.log(1-t[i])-this.LnGamma(e)-this.LnGamma(r)+this.LnGamma(e+r));return n}return t<=0||t>=1?0:Math.exp((e-1)*Math.log(t)+(r-1)*Math.log(1-t)-this.LnGamma(e)-this.LnGamma(r)+this.LnGamma(e+r))},t.PERTDensity=function(t,e,r,n,i){void 0===i&&(i=4);var a,o,s=(e+r+i*n)/(i+2);return o=(a=n===s?i/2+1:(s-e)*(2*n-e-r)/((n-s)*(r-e)))*(r-s)/(s-e),this.BetaDensity(t,a,o)},t.NormalDensity=function(t){if("number"!=typeof t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=.398942280401433*Math.exp(-t[r]*t[r]/2);return e}return.398942280401433*Math.exp(-t*t/2)},t.Shuffle=function(t){var r,n,i;for(n=t.length-1;n>=0;n--)r=Math.floor(e.Next()*(n+1)),i=t[n],t[n]=t[r],t[r]=i;return t},t.VDWField=function(t){if(this.vdw_cache.length!==t){this.vdw_cache=new Float64Array(t);for(var e=0;e<t;e++)this.vdw_cache[e]=this.InverseNormal2((e+1)/(t+1))}var r=new Float64Array(this.vdw_cache);return this.Shuffle(r)},t.LHSFieldDouble=function(t,r){void 0===r&&(r=!1);for(var n=1/t,i=new Float64Array(t),a=0;a<t;a++)i[a]=e.Next()*n+a*n;return r||this.Shuffle(i),i},t.LHSField=function(t,r){void 0===r&&(r=!1);for(var n=1/t,i=new Array(t),a=0;a<t;a++)i[a]=e.Next()*n+a*n;return r||this.Shuffle(i),i},t.UniformField=function(t,r){void 0===r&&(r=!1);for(var n=new Array(t),i=0;i<t;i++)n[i]=e.Next();return r&&n.sort((function(t,e){return t-e})),n},t.InverseTriangular=function(t,e,r,n){return e===r?e:t<=(n-e)/(r-e)?e+Math.sqrt((r-e)*(n-e)*t):r-Math.sqrt((r-e)*(r-n)*(1-t))},t.InverseNormal=function(t){return.5===t?0:(e=t<1&&t>.5?1-t:t,n=(r=Math.sqrt(Math.log(1/Math.pow(e,2))))-(2.515517+.802853*r+.010328*Math.pow(r,2))/(1+1.432788*r+.189269*Math.pow(r,2)+.001308*Math.pow(r,3)),t>.5?n:-n);var e,r,n},t.InverseNormal2=function(t){var e,r,n=t-.5;return Math.abs(n)<=.425?n*(((((((2509.0809287301227*(r=.180625-n*n)+33430.57558358813)*r+67265.7709270087)*r+45921.95393154987)*r+13731.69376550946)*r+1971.5909503065513)*r+133.14166789178438)*r+3.3871328727963665)/(((((((5226.495278852854*r+28729.085735721943)*r+39307.89580009271)*r+21213.794301586597)*r+5394.196021424751)*r+687.1870074920579)*r+42.31333070160091)*r+1):(r=n<0?t:1-t)<=0?0:(e=(r=Math.sqrt(-Math.log(r)))<=5?(((((((.0007745450142783414*(r-=1.6)+.022723844989269184)*r+.2417807251774506)*r+1.2704582524523684)*r+3.6478483247632045)*r+5.769497221460691)*r+4.630337846156546)*r+1.4234371107496835)/(((((((1.0507500716444169e-9*r+.0005475938084995345)*r+.015198666563616457)*r+.14810397642748008)*r+.6897673349851)*r+1.6763848301838038)*r+2.053191626637759)*r+1):(((((((2.0103343992922881e-7*(r-=5)+27115555687434876e-21)*r+.0012426609473880784)*r+.026532189526576124)*r+.29656057182850487)*r+1.7848265399172913)*r+5.463784911164114)*r+6.657904643501103)/(((((((20442631033899397e-31*r+1.421511758316446e-7)*r+18463183175100548e-21)*r+.0007868691311456133)*r+.014875361290850615)*r+.1369298809227358)*r+.599832206555888)*r+1),n<0?-e:e)},t.Log1p=function(t){var e=1+t;return Math.log(e)-(e-1-t)/e},t.BetaContFrac=function(e,r,n,i){var a,o=2*Number.MIN_VALUE,s=0,l=1,u=1-(e+r)*n/(e+1);for(Math.abs(u)<o&&(u=t.QUIET_NAN),a=u=1/u;s<512;){var c,h=s+1,f=h*(r-h)*n/((e-1+2*h)*(e+2*h));if(u=1+f*u,l=1+f/l,Math.abs(u)<o&&(u=t.QUIET_NAN),Math.abs(l)<o&&(l=t.QUIET_NAN),a*=(u=1/u)*l,u=1+(f=-(e+h)*(e+r+h)*n/((e+2*h)*(e+2*h+1)))*u,l=1+f/l,Math.abs(u)<o&&(u=t.QUIET_NAN),Math.abs(l)<o&&(l=t.QUIET_NAN),a*=c=(u=1/u)*l,Math.abs(c-1)<2*t.EPSILON_DOUBLE)break;if(a*Math.abs(c-1)<i)break;++s}return s>=512?t.QUIET_NAN:a},t.BetaCDF=function(e,r,n){if(e<=0)return 0;if(e>=1)return 1;if(0===e)return 0;if(1===e)return 1;var i,a=-(this.LnGamma(r)+this.LnGamma(n)-this.LnGamma(r+n))+r*Math.log(e)+n*this.Log1p(-e),o=Math.exp(a);return e<(r+1)/(r+n+2)?(i=Math.abs(0/(1*o/r))*t.EPSILON_DOUBLE,o*this.BetaContFrac(r,n,e,i)/r*1+0):(i=Math.abs(1/(1*o/n))*t.EPSILON_DOUBLE,1*(1-o*this.BetaContFrac(n,r,1-e,i)/n)+0)},t.LnGamma=function(t){var e=t-1,r=e+5.5;r-=(e+.5)*Math.log(r);var n=1;return n+=76.18009173/(e+=1),n+=-86.50532033/(e+=1),n+=24.01409822/(e+=1),n+=-1.231739516/(e+=1),n+=.00120858003/(e+=1),n+=-536382e-11/(e+=1),-r+Math.log(2.50662827465*n)},t.BetaPDF=function(t,e,r){return t<0||t>1?0:Math.exp(this.LnGamma(e+r)-this.LnGamma(e)-this.LnGamma(r))*Math.pow(t,e-1)*Math.pow(1-t,r-1)},t.InverseBeta=function(t,e,r){var n,i,a,o,s,l,u,c,h=0;if(t<0||t>1||e<0||r<0)return 0;if(0===t)return 0;if(1===t)return 1;if(t>.5){var f=1-t;return f>.5?this.InverseBeta(1-f,e,r):1-this.InverseBeta(f,r,e)}if(i=e/(e+r),t<.1){var d=(Math.log(e)+this.LnGamma(e)+this.LnGamma(r)-this.LnGamma(e+r)+Math.log(t))/e;d<=0?(n=Math.exp(d),n*=Math.pow(1-n,-(r-1)/e)):n=i,n>i&&(n=i)}else n=i;do{if(o=t-this.BetaCDF(n,e,r),s=this.BetaPDF(n,e,r),0===o||h++>64)return n;c=-((e-1)/n-(r-1)/(1-n))*(a=o/Math.max(2*Math.abs(o/n),s))*a/2,l=u=a,Math.abs(c)<Math.abs(u)?l+=c:l*=2*Math.abs(u/c),n+l>0&&n+l<1?n+=l:n=Math.sqrt(n)*Math.sqrt(i)}while(Math.abs(u)>1e-10*n);return n},t.InversePERTField=function(t,e,r,n,i){var a=this;if(r<=e)return t.map((function(){return e}));try{var o=this.PERTParameters(e,r,n,i);return t.map((function(t){return(a.InverseBeta(t,o.v,o.w)*(o.max-o.min)+o.min)/o.scale}))}catch(n){return e===r?t.map((function(t){return e})):t.map((function(t){return 0}))}},t.PERTParameters=function(t,e,r,n){if(void 0===n&&(n=4),t>=e||n<0||r<t||r>e)throw new Error("Invalid parameters");for(var i,a,o=1;Math.abs(t)<1&&Math.abs(e)<1;)o*=10,t*=10,e*=10,r*=10;return i=(t+e+n*r)/(n+2),{v:a=(0===r?Math.abs(i-r):Math.abs((i-r)/r))<=1e-12?n/2+1:(i-t)*(2*r-t-e)/((r-i)*(e-t)),w:a*(e-i)/(i-t),min:t,max:e,scale:o}},t.InversePERT=function(t,e,r,n,i){void 0===i&&(i=4);var a=this.PERTParameters(e,r,n,i);return(this.InverseBeta(t,a.v,a.w)*(a.max-a.min)+a.min)/a.scale},t.EPSILON_DOUBLE=2220446049250313e-31,t.QUIET_NAN=Number.NaN,t.M_LN_SQRT_2PI=.9189385332046728,t.M_1_SQRT_2PI=.3989422804014327,t.vdw_cache=new Float64Array(0),t}(),f=new Array(256),d=0;d<256;++d)f[d]=(d+256).toString(16).substr(1);var p=function(){function t(){this.buffer=[],this.buffer=[];for(var t=0;t<16;t++)this.buffer[t]=Math.floor(256*e.Next())}return t.prototype.toString=function(){var t=0;return f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]},t}();t.CDMatrix=o,t.Eigensystem=l,t.MC=h,t.Matrix=c,t.QSort=i,t.QSort2=r,t.Random=e,t.Stats=a,t.UUID=p,t.Util=s,Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,a=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function s(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t}Object.create,Object.create;var l,u=function(){function t(t,e,r){void 0===e&&(e=t),void 0===r&&(r=!1),this.end_=this.PatchNull(e),this.start_=this.PatchNull(t),r&&this.Normalize()}return t.FromColumn=function(e){return new t({row:1/0,column:e})},t.FromRow=function(e){return new t({row:e,column:1/0})},t.ColumnToLabel=function(t){for(var e=String.fromCharCode(65+t%26);t>25;)t=Math.floor(t/26)-1,e=String.fromCharCode(65+t%26)+e;return e},t.CellAddressToLabel=function(t,e){return void 0===e&&(e=!1),(e?(t.sheet_id||0)+"!":"")+(t.absolute_column?"$":"")+this.ColumnToLabel(t.column)+(t.absolute_row?"$":"")+(t.row+1)},t.Join=function(e){for(var r,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=new t(e.start,e.end);try{for(var l=a(i),u=l.next();!u.done;u=l.next()){var c=u.value;c&&(s.ConsumeAddress(c.start),s.ConsumeAddress(c.end))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return s},t.Bleed=function(e,r){return void 0===r&&(r=1),new t({row:Math.max(0,e.start.row-r),column:Math.max(0,e.start.column-r)},{row:e.end.row+r,column:e.end.column+r})},Object.defineProperty(t.prototype,"start",{get:function(){return n({},this.start_)},set:function(t){this.start_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return n({},this.end_)},set:function(t){this.end_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.start_.row===1/0||this.end_.row===1/0?1/0:this.end_.row-this.start_.row+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.start_.column===1/0||this.end_.column===1/0?1/0:this.end_.column-this.start_.column+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.rows*this.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_sheet",{get:function(){return this.entire_row&&this.entire_column},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_column",{get:function(){return this.start_.row===1/0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_row",{get:function(){return this.start_.column===1/0},enumerable:!1,configurable:!0}),t.prototype.PatchNull=function(t){var e=n({},t);return null===e.row&&(e.row=1/0),null===e.column&&(e.column=1/0),e},t.prototype.SetSheetID=function(t){this.start_.sheet_id=t},t.prototype.Normalize=function(){var t=n({},this.start_),e=n({},this.end_);t.row===1/0||e.row===1/0?t.row=e.row=1/0:t.row>e.row&&(t.row=this.end_.row,t.absolute_row=this.end_.absolute_row,e.row=this.start_.row,e.absolute_row=this.start_.absolute_row),t.column===1/0||e.column===1/0?t.column=e.column=1/0:t.column>e.column&&(t.column=this.end_.column,t.absolute_column=this.end_.absolute_column,e.column=this.start_.column,e.absolute_column=this.start_.absolute_column),this.start_=t,this.end_=e},t.prototype.TopLeft=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.start.column),this.entire_column||(t.row=this.start.row),t},t.prototype.BottomRight=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.end.column),this.entire_column||(t.row=this.end.row),t},t.prototype.ContainsRow=function(t){return this.entire_column||t>=this.start_.row&&t<=this.end_.row},t.prototype.ContainsColumn=function(t){return this.entire_row||t>=this.start_.column&&t<=this.end_.column},t.prototype.Contains=function(t){return(this.entire_column||t.row>=this.start_.row&&t.row<=this.end_.row)&&(this.entire_row||t.column>=this.start_.column&&t.column<=this.end_.column)},t.prototype.ContainsArea=function(t){return this.start.column<=t.start.column&&this.end.column>=t.end.column&&this.start.row<=t.start.row&&this.end.row>=t.end.row},t.prototype.Intersects=function(t){return!(t.start.column>this.end.column||this.start.column>t.end.column||t.start.row>this.end.row||this.start.row>t.end.row)},t.prototype.Equals=function(t){return t.start_.row===this.start_.row&&t.start_.column===this.start_.column&&t.end_.row===this.end_.row&&t.end_.column===this.end_.column},t.prototype.Clone=function(){return new t(this.start,this.end)},t.prototype.Array=function(){if(this.entire_column||this.entire_row)throw new Error("can't convert infinite area to array");for(var t=new Array(this.rows*this.columns),e=this.start_.sheet_id,r=0,n=this.start_.row;n<=this.end_.row;n++)for(var i=this.start_.column;i<=this.end_.column;i++)t[r++]={row:n,column:i,sheet_id:e};return t},Object.defineProperty(t.prototype,"left",{get:function(){var e=new t(this.start_,this.end_);return e.end_.column=e.start_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){var e=new t(this.start_,this.end_);return e.start_.column=e.end_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){var e=new t(this.start_,this.end_);return e.end_.row=e.start_.row,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){var e=new t(this.start_,this.end_);return e.start_.row=e.end_.row,e},enumerable:!1,configurable:!0}),t.prototype.Shift=function(t,e){return this.start_.row+=t,this.start_.column+=e,this.end_.row+=t,this.end_.column+=e,this},t.prototype.ConsumeAddress=function(t){this.entire_row||(t.column<this.start_.column&&(this.start_.column=t.column),t.column>this.end_.column&&(this.end_.column=t.column)),this.entire_column||(t.row<this.start_.row&&(this.start_.row=t.row),t.row>this.end_.row&&(this.end_.row=t.row))},t.prototype.ConsumeArea=function(t){this.ConsumeAddress(t.start),this.ConsumeAddress(t.end)},t.prototype.Resize=function(t,e){return this.end_.row=this.start_.row+t-1,this.end_.column=this.start_.column+e-1,this},t.prototype.Iterate=function(t){if(this.entire_column||this.entire_row)console.warn("don't iterate infinite area");else for(var e=this.start_.column;e<=this.end_.column;e++)for(var r=this.start_.row;r<=this.end_.row;r++)t({column:e,row:r,sheet_id:this.start_.sheet_id})},Object.defineProperty(t.prototype,"spreadsheet_label",{get:function(){var e;return this.entire_sheet?"":this.entire_column?(e=t.ColumnToLabel(this.start_.column),e+=":"+t.ColumnToLabel(this.end_.column)):this.entire_row?(e=String(this.start_.row+1),e+=":"+(this.end_.row+1)):(e=t.CellAddressToLabel(this.start_),this.columns>1||this.rows>1?e+":"+t.CellAddressToLabel(this.end_):e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{start:n({},this.start_),end:n({},this.end_)}},t}(),c=function(t){return"object"==typeof t&&!!t&&"number"==typeof t.real&&"number"==typeof t.imaginary};!function(t){t[t[void 0]=0]="undefined",t[t.formula=1]="formula",t[t.string=2]="string",t[t.number=3]="number",t[t.boolean=4]="boolean",t[t.object=5]="object",t[t.error=6]="error",t[t.complex=7]="complex"}(l||(l={}));var h,f=function(t){switch(typeof t){case"undefined":return l.undefined;case"number":return l.number;case"boolean":return l.boolean;case"object":return null===t?l.undefined:c(t)?l.complex:l.object;case"string":return"="===t[0]?l.formula:l.string;default:return l.error}};!function(t){t[t.List=0]="List",t[t.Date=1]="Date",t[t.Range=2]="Range",t[t.Number=3]="Number",t[t.Boolean=4]="Boolean"}(h||(h={}));var d=function(){function t(t,e){this.type=l.undefined,this.render_dirty=!0,void 0!==t&&this.Set(t,e)}return t.StringToColumn=function(t){var e=0;t=t.toUpperCase();for(var r=0;r<t.length;r++)e*=26,e+=t.charCodeAt(r)-64;return e-1},t.prototype.ValueIsNumber=function(){return this.type===l.number},t.prototype.ValueIsFormula=function(){return this.type===l.formula},t.prototype.ValueIsBoolean=function(){return this.type===l.boolean},t.prototype.ValueIsComplex=function(){return this.type===l.complex},t.prototype.FlushStyle=function(){this.formatted=this.rendered_type=this.style=void 0,this.render_dirty=!0},t.prototype.FlushArray=function(){this.area=void 0},t.prototype.FlushCache=function(){this.calculated=this.calculated_type=this.formatted=this.rendered_type=this.render_function=this.click_function=void 0,this.render_dirty=!0},t.prototype.Reset=function(){this.type=l.undefined,this.value=this.note=this.hyperlink=this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.area=this.renderer_data=this.render_function=this.click_function=void 0,this.render_dirty=!0},t.prototype.Set=function(t,e){void 0===e&&(e=f(t)),this.value=t,this.type=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.render_function=this.click_function=this.area=void 0,this.render_dirty=!0},t.prototype.SetCalculatedValue=function(t,e){void 0===e&&(e=f(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},t.prototype.SetCalculatedValueOrError=function(t,e){void 0===e&&("object"==typeof t&&t.error?(e=l.error,t=t.error):e=f(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},t.prototype.GetValue=function(){return this.calculated_type?this.calculated:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value},t.prototype.GetValue4=function(){return this.calculated_type?{type:this.calculated_type,value:this.calculated}:this.type===l.formula?{type:l.number,value:0}:{type:this.type,value:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value}},t.prototype.SetNote=function(t){this.note=t,this.render_dirty=!0},t.prototype.SetCalculationError=function(t){void 0===t&&(t="ERR"),this.SetCalculatedValue(t,l.error)},t.prototype.SetArray=function(t){this.type=l.undefined,this.value=this.formatted=this.rendered_type=this.style=this.hyperlink=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},t.prototype.SetArrayHead=function(t,e){this.type=f(e),this.value=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},t}(),p=function(t){return t.type===l.formula},m=function(){return{type:l.undefined,value:void 0}},v=function(t,e){return void 0===e&&(e=f(t)),{value:t,type:e}},y=function(t){return t.imaginary?{type:l.complex,value:t}:{type:l.number,value:t.real}},_=function(t){return!!t[0]&&function(t){return!t.cells}(t[0])},g=function(t){return!!t[0]&&void 0!==t[0].row},b=function(){function t(){this.data=[],this.rows_=0,this.columns_=0}return Object.defineProperty(t.prototype,"rows",{get:function(){return this.rows_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.columns_},enumerable:!1,configurable:!0}),t.prototype.EnsureRow=function(t){this.rows_=Math.max(t+1,this.rows_)},t.prototype.EnsureColumn=function(t){this.columns_=Math.max(t+1,this.columns_)},t.prototype.InsertColumns=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.data=this.data.map((function(r){if(r.length>=t){var n=r.slice(0,t),i=t+e;return r.slice(t).forEach((function(t){return n[i++]=t})),n}return r})),this.columns_+=e},t.prototype.DeleteColumns=function(t,e){void 0===e&&(e=1),this.data.forEach((function(r){return r.splice(t,e)})),this.columns_-=e},t.prototype.DeleteRows=function(t,e){void 0===e&&(e=1),this.data.splice(t,e),this.rows_-=e},t.prototype.InsertRows=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);for(var r=[t,0,[]],n=1;n<e;n++)r.push([]);Array.prototype.splice.apply(this.data,r),this.rows_+=e},t.prototype.GetCell=function(t,e){var r=t.row,n=t.column;if(!this.data[r]){if(!e)return;this.data[r]=[],this.rows_=Math.max(this.rows_,r+1)}return this.data[r][n]||e&&(this.data[r][n]=new d,this.columns_=Math.max(this.columns_,n+1)),this.data[r][n]},t.prototype.EnsureCell=function(t){var e=t.row,r=t.column,n=this.data[e];n||(this.data[e]=n=[],this.rows_=Math.max(this.rows_,e+1));var i=n[r];return i||(i=n[r]=new d,this.columns_=Math.max(this.columns_,r+1)),i},t.prototype.FromArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=!1),this.data=[];var r=0,n=0;if(e){n=t.length;for(var i=0;i<n;i++){var a=t[i];r=Math.max(r,a.length);for(var o=0;o<a.length;o++)this.data[o]||(this.data[o]=[]),this.data[o][i]=new d(a[o])}}else for(r=t.length,o=0;o<r;o++){var s=[];for(a=t[o],n=Math.max(n,a.length),i=0;i<a.length;i++)s[i]=new d(a[i]);this.data[o]=s}this.rows_=r,this.columns_=n},t.prototype.FromJSON=function(t,e){var r,i,o,s,l,c,h,f,p,m;if(void 0===t&&(t=[]),this.data=[],!_(t)){var v=[];if(g(t))try{for(var y=a(t),b=y.next();!b.done;b=y.next()){var x=b.value;try{for(var w=(o=void 0,a(x.cells)),M=w.next();!M.done;M=w.next()){var C=M.value;v.push(n(n({},C),{row:x.row}))}}catch(t){o={error:t}}finally{try{M&&!M.done&&(s=w.return)&&s.call(w)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{b&&!b.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}else try{for(var A=a(t),S=A.next();!S.done;S=A.next()){x=S.value;try{for(var R=(h=void 0,a(x.cells)),k=R.next();!k.done;k=R.next())C=k.value,v.push(n(n({},C),{column:x.column}))}catch(t){h={error:t}}finally{try{k&&!k.done&&(f=R.return)&&f.call(R)}finally{if(h)throw h.error}}}}catch(t){l={error:t}}finally{try{S&&!S.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}t=v}try{for(var T=a(t),P=T.next();!P.done;P=T.next()){var N=P.value;if(this.data[N.row]||(this.data[N.row]=[]),C=new d(N.value),void 0!==N.calculated&&C.SetCalculatedValue(N.calculated,N.calculated_type),e&&void 0!==N.style_ref&&(C.style=e[N.style_ref]),void 0!==N.note&&(C.note=N.note),void 0!==N.hyperlink&&(C.hyperlink=N.hyperlink),this.data[N.row][N.column]&&this.data[N.row][N.column].area&&(C.area=this.data[N.row][N.column].area),this.data[N.row][N.column]=C,N.area)for(var E=new u(N.area.start,N.area.end),D=E.start.row;D<=E.end.row;D++)for(var O=E.start.column;O<=E.end.column;O++)this.data[D]||(this.data[D]=[]),this.data[D][O]||(this.data[D][O]=new d),this.data[D][O].area=E;if(N.merge_area){var F=new u(N.merge_area.start,N.merge_area.end);for(D=F.start.row;D<=F.end.row;D++)for(O=F.start.column;O<=F.end.column;O++)this.data[D]||(this.data[D]=[]),this.data[D][O]||(this.data[D][O]=new d),this.data[D][O].merge_area=F}N.validation&&(C.validation=N.validation)}}catch(t){p={error:t}}finally{try{P&&!P.done&&(m=T.return)&&m.call(T)}finally{if(p)throw p.error}}this.rows_=this.data.length,this.columns_=this.data.reduce((function(t,e){return Math.max(t,e.length)}),0)},t.prototype.toJSON=function(t){var e,r,n,o,s,u,c,h;void 0===t&&(t={});var f,d=0,p=0,m=this.data.length-1;t.subset&&(d=t.subset.start.column,p=t.subset.start.row,m=t.subset.end.row);for(var v=[],y=-1,_=-1,g={},b={},x=p;x<=m;x++)if(this.data[x]){var w=this.data[x];f=w.length-1,t.subset&&(f=t.subset.end.column);for(var M=d;M<=f;M++){var C=w[M],A=C&&C.merge_area&&C.merge_area.start.row===x&&C.merge_area.start.column===M,S=C&&C.area&&C.area.start.row===x&&C.area.start.column===M,R=!C||C.type===l.string&&!C.value;if(C&&(!R||t.preserve_empty_strings)&&(A||C.type||C.calculated_type&&t.expand_arrays||C.calculated_type&&t.calculated_value||C.validation||t.decorated_cells&&C.style&&(C.style.fill||C.style.border_bottom||C.style.border_top||C.style.border_left||C.style.border_right))){var k={row:x,column:M,value:C.value};C.note&&(k.note=C.note),C.hyperlink&&(k.hyperlink=C.hyperlink),t.preserve_type&&(k.type=C.type),t.sheet_id&&(k.sheet_id=t.sheet_id),t.calculated_value&&void 0!==C.calculated&&(k.calculated=C.calculated,(t.preserve_type||C.calculated_type===l.error)&&(k.calculated_type=C.calculated_type)),C.area&&S&&(k.area=C.area.toJSON()),C.merge_area&&(k.merge_area=C.merge_area.toJSON()),C.validation&&(k.validation=C.validation),t.cell_style_refs&&t.cell_style_refs[M]&&t.cell_style_refs[M][x]&&(k.style_ref=t.cell_style_refs[M][x],t.cell_style_refs[M][x]=0),g[x]=x,b[M]=M,y=Math.max(x,y),_=Math.max(M,_),v.push(k)}}}if(t.nested){var T=Object.keys(g),P=Object.keys(b);if(T.length<=P.length&&T.length){var N={},E=[];try{for(var D=a(v),O=D.next();!O.done;O=D.next()){x=(G=O.value).row;var F=i(G,["row"]);N[G.row]||(N[G.row]=[]),N[G.row].push(F)}}catch(t){e={error:t}}finally{try{O&&!O.done&&(r=D.return)&&r.call(D)}finally{if(e)throw e.error}}try{for(var I=a(T),L=I.next();!L.done;L=I.next()){var U=L.value;x=Number(U),E.push({row:x,cells:N[x]})}}catch(t){n={error:t}}finally{try{L&&!L.done&&(o=I.return)&&o.call(I)}finally{if(n)throw n.error}}return{data:E,rows:y,columns:_+1}}if(P.length){N={},E=[];try{for(var j=a(v),V=j.next();!V.done;V=j.next()){var G;M=(G=V.value).column,F=i(G,["column"]),N[G.column]||(N[G.column]=[]),N[G.column].push(F)}}catch(t){s={error:t}}finally{try{V&&!V.done&&(u=j.return)&&u.call(j)}finally{if(s)throw s.error}}try{for(var z=a(P),B=z.next();!B.done;B=z.next())U=B.value,M=Number(U),E.push({column:M,cells:N[M]})}catch(t){c={error:t}}finally{try{B&&!B.done&&(h=z.return)&&h.call(z)}finally{if(c)throw c.error}}return{data:E,rows:y,columns:_+1}}}return{data:v,rows:y+1,columns:_+1}},t.prototype.GetAll=function(t){return void 0===t&&(t=!1),this.GetRange({row:0,column:0},{row:this.rows_-1,column:this.columns_-1},t)},t.prototype.Normalize2=function(t,e){return t.column===1/0&&(t=n(n({},t),{column:0})),t.row===1/0&&(t=n(n({},t),{row:0})),e.column===1/0&&(e=n(n({},e),{column:this.columns_-1})),e.row===1/0&&(e=n(n({},e),{row:this.rows_-1})),{from:t,to:e}},t.prototype.Normalize1=function(t){return t.column===1/0&&(t=n(n({},t),{column:0})),t.row===1/0&&(t=n(n({},t),{row:0})),t},t.prototype.RawValue=function(t,e){var r,n,i;if(void 0===e&&(e=t),t=(r=this.Normalize2(t,e)).from,e=r.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].value:void 0;var o=[],s=this.data.slice(t.row,e.row+1),l=t.column,u=e.column+1;try{for(var c=a(s),h=c.next();!h.done;h=c.next()){for(var f=h.value,d=[],p=l,m=0;p<u;p++,m++){var v=f[p];d.push(v?v.value:void 0)}o.push(d)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return o},t.prototype.GetRange=function(t,e,r){var n;if(void 0===r&&(r=!1),e?(t=(n=this.Normalize2(t,e)).from,e=n.to):t=this.Normalize1(t),!e||t===e||t.column===e.column&&t.row===e.row)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue():void 0;var i=[];if(r)for(var a=t.column;a<=e.column;a++){for(var o=[],s=t.row;s<=e.row;s++)this.data[s]&&this.data[s][a]?o.push(this.data[s][a].GetValue()):o.push(void 0);i.push(o)}else for(s=t.row;s<=e.row;s++){var l=[];for(a=t.column;a<=e.column;a++)this.data[s]&&this.data[s][a]?l.push(this.data[s][a].GetValue()):l.push(void 0);i.push(l)}return i},t.prototype.GetRange4=function(t,e,r){var n;if(void 0===e&&(e=t),void 0===r&&(r=!1),t=(n=this.Normalize2(t,e)).from,e=n.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue4():{value:void 0,type:l.undefined};var i=[];if(r)for(var a=t.column;a<=e.column;a++){for(var o=[],s=t.row;s<=e.row;s++)this.data[s]&&this.data[s][a]?o.push(this.data[s][a].GetValue4()):o.push(m());i.push(o)}else for(s=t.row;s<=e.row;s++){var u=[];for(a=t.column;a<=e.column;a++)this.data[s]&&this.data[s][a]?u.push(this.data[s][a].GetValue4()):u.push(m());i.push(u)}return i},t.prototype.Apply=function(t,e,r){var n;if(void 0===r&&(r=!1),"object"==typeof(n=t)&&void 0!==n.row&&void 0!==n.column&&(t=new u(t)),t.entire_column||t.entire_row)throw new Error("don't iterate infinite cells");var i=t.start,a=t.end;if(r)for(var o=i.row;o<=a.row;o++){this.data[o]||(this.data[o]=[]);for(var s=this.data[o],l=i.column;l<=a.column;l++)s[l]||(s[l]=new d),e(s[l],l,o)}else for(o=i.row;o<=a.row;o++)if(this.data[o])for(s=this.data[o],l=i.column;l<=a.column;l++)s[l]&&e(s[l],l,o)},t.prototype.SetArea=function(t,e){if(ArrayBuffer.isView(e))throw new Error("ABIV");if(Array.isArray(e))for(var r=t.start.row,n=0;r<=t.end.row;r++,n++){this.data[r]||(this.data[r]=[]);var i=this.data[r];if(e[n])for(var a=t.start.column,o=0;a<=t.end.column;a++,o++)i[a]||(i[a]=new d),i[a].Set(e[n][o])}else{var s=f(e);for(r=t.start.row;r<=t.end.row;r++)for(this.data[r]||(this.data[r]=[]),i=this.data[r],a=t.start.column;a<=t.end.column;a++)i[a]||(i[a]=new d),i[a].Set(e,s)}this.rows_=Math.max(this.rows_,t.end.row+1),this.columns_=Math.max(this.columns_,t.end.column+1)},t.prototype.IterateAll=function(t){var e,r,n,i;try{for(var o=a(this.data),s=o.next();!s.done;s=o.next()){var l=s.value;if(l)try{for(var u=(n=void 0,a(l)),c=u.next();!c.done;c=u.next()){var h=c.value;h&&t(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},t.prototype.FlushCellStyles=function(){var t,e,r,n;try{for(var i=a(this.data),o=i.next();!o.done;o=i.next()){var s=o.value;if(s)try{for(var l=(r=void 0,a(s)),u=l.next();!u.done;u=l.next()){var c=u.value;c&&c.FlushStyle()}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.FlushCachedValues=function(){var t,e,r,n;try{for(var i=a(this.data),o=i.next();!o.done;o=i.next()){var s=o.value;if(s)try{for(var l=(r=void 0,a(s)),u=l.next();!u.done;u=l.next()){var c=u.value;c&&c.FlushCache()}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t}(),x=function(){function t(){}return t.UpdateLocale=function(t){var e;if(t)this.locale=t;else if("undefined"!=typeof self){var r=null===(e=null===self||void 0===self?void 0:self.document)||void 0===e?void 0:e.location;if(r&&r.search&&/locale=([^?&]+?)(?:\?|$|&)/.test(r.search)){var n=r.search.match(/locale=(.*?)(?:\?|$|&)/);n&&(this.locale=n[1]),console.info("override locale",this.locale)}else"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]?this.locale=navigator.languages[0]:this.locale=navigator.language)}var i=new Intl.NumberFormat(this.locale,{minimumFractionDigits:1}).format(3.3).replace(/\d/g,"");this.decimal_separator=","===i?",":".",","===this.decimal_separator&&(this.argument_separator=";",this.grouping_separator=" ");var a=new Date(2e3,0,2,12,0,0,0);this.UpdateDateComponent(0,0,a),a=new Date(2e3,1,7,12,0,0,0),this.UpdateDateComponent(1,1,a),a=new Date(2e3,2,7,12,0,0,0),this.UpdateDateComponent(2,2,a),a=new Date(2e3,3,5,12,0,0,0),this.UpdateDateComponent(3,3,a),a=new Date(2e3,4,4,12,0,0,0),this.UpdateDateComponent(4,4,a),a=new Date(2e3,5,2,12,0,0,0),this.UpdateDateComponent(5,5,a),a=new Date(2e3,6,1,12,0,0,0),this.UpdateDateComponent(6,6,a),a=new Date(2e3,7,1,12,0,0,0),this.UpdateDateComponent(7,-1,a),a=new Date(2e3,8,1,12,0,0,0),this.UpdateDateComponent(8,-1,a),a=new Date(2e3,9,1,12,0,0,0),this.UpdateDateComponent(9,-1,a),a=new Date(2e3,10,1,12,0,0,0),this.UpdateDateComponent(10,-1,a),a=new Date(2e3,11,1,12,0,0,0),this.UpdateDateComponent(11,-1,a)},t.UpdateDateComponent=function(t,e,r){e>=0&&(this.date_components.short_days[e]=r.toLocaleString(this.locale,{weekday:"short"}),this.date_components.long_days[e]=r.toLocaleString(this.locale,{weekday:"long"})),t>=0&&(this.date_components.short_months[t]=r.toLocaleString(this.locale,{month:"short"}),this.date_components.long_months[t]=r.toLocaleString(this.locale,{month:"long"}))},t.locale="en-us",t.decimal_separator=".",t.argument_separator=",",t.grouping_separator=",",t.date_components={short_days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long_days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short_months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long_months:["January","February","March","April","May","June","July","August","September","October","November","December"]},t}();x.UpdateLocale();var w,M,C=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.left=t,this.top=e,this.width=r,this.height=n}return Object.defineProperty(t.prototype,"right",{get:function(){return this.left+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:!1,configurable:!0}),t.Create=function(e){return new t(e.left||0,e.top||0,e.width||0,e.height||0)},t.IsRectangle=function(t){var e,r,n,i;return"object"==typeof t&&"number"==typeof(null===(e=t)||void 0===e?void 0:e.left)&&"number"==typeof(null===(r=t)||void 0===r?void 0:r.top)&&"number"==typeof(null===(n=t)||void 0===n?void 0:n.width)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.height)},t.prototype.Shift=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left+e,this.top+r,this.width,this.height)},t.prototype.Scale=function(e,r){return void 0===e&&(e=1),void 0===r&&(r=e),new t(this.left*e,this.top*r,this.width*e,this.height*r)},t.prototype.Expand=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left,this.top,this.width+e,this.height+r)},t.prototype.Combine=function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right)-Math.min(this.left,e.left),Math.max(this.bottom,e.bottom)-Math.min(this.top,e.top))},t.prototype.CheckEdges=function(t,e,r){void 0===r&&(r=16);var n=0;return t-this.left<r&&(n|=1),this.right-t<r&&(n|=2),e-this.top<r&&(n|=4),this.bottom-e<r&&(n|=8),n},t.prototype.Contains=function(t,e,r){return void 0===r&&(r=0),t>=this.left-r&&t<=this.left+this.width+r&&e>=this.top-r&&e<=this.top+this.height+r},t.prototype.ContextFill=function(t){t.fillRect(this.left,this.top,this.width,this.height)},t.prototype.ContextStroke=function(t){t.strokeRect(this.left,this.top,this.width,this.height)},t.prototype.Clamp=function(t,e){return{x:t=Math.min(Math.max(t,this.left),this.right),y:e=Math.min(Math.max(e,this.top),this.bottom)}},t.prototype.ApplyStyle=function(t){t.style.top=this.top+"px",t.style.left=this.left+"px",t.style.width=this.width+"px",t.style.height=this.height+"px"},t.prototype.toJSON=function(){return{top:this.top,left:this.left,width:this.width,height:this.height}},t}();!function(t){var e,r,i=JSON.stringify({});!function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(e=t.HorizontalAlign||(t.HorizontalAlign={})),function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Middle=3]="Middle"}(r=t.VerticalAlign||(t.VerticalAlign={})),t.DefaultProperties={horizontal_align:e.None,vertical_align:r.None,number_format:"General",nan:"NaN",font_size_value:10,font_size_unit:"pt",font_face:"calibri",font_bold:!1,font_italic:!1,font_underline:!1,font_strike:!1,text:{theme:1},border_top:0,border_left:0,border_right:0,border_bottom:0},t.Merge=function(t,e,r){void 0===r&&(r=!0);var i=n(r?n({},t):{},e);return JSON.parse(JSON.stringify(i))},t.Composite=function(t){return JSON.parse(JSON.stringify(t.reduce((function(t,e){return n(n({},t),e)}),{})))},t.Empty=function(t){return JSON.stringify(t)===i},t.ValidColor=function(t){return!(!t||t.none||!t.text&&!t.theme&&0!==t.theme)},t.Font=function(t,e){void 0===e&&(e=1);var r=[];return t.font_weight?r.push(t.font_weight.toString()):t.font_bold&&r.push("bold"),t.font_italic&&r.push("italic"),r.push(((t.font_size_value||0)*e).toFixed(2)+(t.font_size_unit||"pt")),r.push(t.font_face||""),r.join(" ")}}(w||(w={})),function(t){t[t.default=0]="default",t[t.hidden=1]="hidden",t[t.padded=2]="padded",t[t.date_component=3]="date_component",t[t.date_component_minutes=4]="date_component_minutes",t[t.literal=5]="literal",t[t.formatting=6]="formatting"}(M||(M={})),new(function(){function t(){}return t.prototype.Darken=function(t,e,r,n,i){void 0===i&&(i=!1);var a=this.RGBToHSL(t,e,r),o=a.h,s=a.s,l=a.l;return l-=i?l*n/100:n/100,l=Math.max(0,Math.min(1,l)),this.HSLToRGB(o,s,l)},t.prototype.Lighten=function(t,e,r,n,i){void 0===i&&(i=!1);var a=this.RGBToHSL(t,e,r),o=a.h,s=a.s,l=a.l;return l+=i?l*n/100:n/100,l=Math.max(0,Math.min(1,l)),this.HSLToRGB(o,s,l)},t.prototype.RGBToHSL=function(t,e,r){t/=255,e/=255,r/=255;var n=Math.max(t,e,r),i=Math.min(t,e,r),a=0,o=0,s=(n+i)/2;if(n===i)a=o=0;else{var l=n-i;switch(o=s>.5?l/(2-n-i):l/(n+i),n){case t:a=(e-r)/l+(e<r?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4}a/=6}return{h:360*a,s:o,l:s}},t.prototype.HSLToRGB=function(t,e,r){var n,i,a;if(0===e)n=i=a=r;else{t/=360;var o=r<.5?r*(1+e):r+e-r*e,s=2*r-o;n=this.HueToRGB(s,o,t+1/3),i=this.HueToRGB(s,o,t),a=this.HueToRGB(s,o,t-1/3)}return{r:Math.round(255*n),g:Math.round(255*i),b:Math.round(255*a)}},t.prototype.HueToRGB=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},t}());var A,S=function(){this.date_format=!1,this.string_format=!1,this.fraction_format=!1,this.twelve_hour=!1,this.fraction_denominator=0,this.fraction_integer=!0,this.fraction_align=0,this.fraction_denominator_digits=0,this.integer_min_digits=0,this.decimal_min_digits=0,this.decimal_max_digits=0,this.grouping=!1,this.has_number_format=!1,this.prefix=[{text:""}],this.suffix=[{text:""}],this.scaling=0,this.percent=!1,this.exponential=!1,this.has_asterisk=!1};!function(t){t[t.Integer=0]="Integer",t[t.Decimal=1]="Decimal"}(A||(A={}));var R,k=function(){function t(){}return t.Parse=function(t){if(this.pattern=t,this.characters=t.split("").map((function(t){return t.charCodeAt(0)})),this.char_index=0,this.current_section=new S,this.sections=[this.current_section],this.ParseDatePattern())return this.sections;for(this.char_index=0,this.current_section=new S,this.sections=[this.current_section];this.char_index<this.characters.length;)this.ConsumeChar();return this.sections},t.ConsumeString=function(){var t="";for(this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index+1<this.characters.length&&(t+=this.pattern[++this.char_index]);break;case 34:return this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated string")},t.ConsumeFormatting=function(){var t="";for(++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:throw new Error("invalid escape character in formatting block");case 93:return this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated format")},t.ScanFractionFormat=function(){var t=this.pattern.substr(this.char_index).match(/^([#?]+ +){0,1}([#?]+)\/([#?0-9]+)(?:$|[^#?0-9])/);if(!t)return!1;var e=(t[1]||"").length+t[2].length+t[3].length+1;this.current_section.fraction_format=!0,this.current_section.fraction_integer=!!t[1];var r=Number(t[3]);return isNaN(r)||(this.current_section.fraction_denominator=r),this.current_section.decimal_max_digits=this.current_section.fraction_denominator_digits=t[3].length,this.char_index+=e,this.current_section.has_number_format=!0,!0},t.ConsumeNumberFormat=function(){var t=A.Integer;for(this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case this.group_separator:for(var e=!1,r=this.char_index+1;!e&&r<this.characters.length;r++){var n=this.characters[r];if(n===this.decimal_mark||35===n||48===n)e=!0;else if(44!==n)break}if(e){if(t===A.Decimal)throw new Error("invalid grouping in decimal part");this.current_section.grouping=!0}else this.current_section.scaling=1e3*(this.current_section.scaling||1);break;case this.decimal_mark:if(t===A.Decimal)throw new Error("too many decimal marks");t=A.Decimal;break;case 35:t===A.Decimal?this.current_section.decimal_max_digits++:this.current_section.integer_min_digits&&this.current_section.integer_min_digits++;break;case 48:t===A.Decimal?(this.current_section.decimal_max_digits++,this.current_section.decimal_min_digits=this.current_section.decimal_max_digits):this.current_section.integer_min_digits++;break;default:return}},t.AppendCharAsText=function(t){void 0===t&&(t=!0),this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=this.pattern[this.char_index]:this.current_section.prefix[this.current_section.prefix.length-1].text+=this.pattern[this.char_index],t&&this.char_index++},t.AppendString=function(t){this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=t:this.current_section.prefix[this.current_section.prefix.length-1].text+=t},t.AppendTextPart=function(t){this.current_section.has_number_format?(this.current_section.suffix.push(t),this.current_section.suffix.push({text:""})):(this.current_section.prefix.push(t),this.current_section.prefix.push({text:""}))},t.ConsumeChar=function(){var t=this.characters[this.char_index];if(63!==t&&35!==t||this.current_section.has_number_format||this.current_section.string_format||!this.ScanFractionFormat())switch(t){case 59:this.char_index++,this.current_section=new S,3===this.sections.length&&(this.current_section.string_format=!0),this.sections.push(this.current_section);break;case 64:this.char_index++,this.AppendTextPart({text:"@",flag:M.literal}),this.current_section.string_format=!0;break;case 48:case 35:case 46:case 44:this.current_section.has_number_format||this.current_section.string_format?this.AppendCharAsText():(this.ConsumeNumberFormat(),this.current_section.has_number_format=!0);break;case 91:this.AppendTextPart({text:this.ConsumeFormatting(),flag:M.formatting});break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:M.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:M.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:M.padded}),this.current_section.has_asterisk=!0}break;case 101:case 69:this.current_section.percent||this.current_section.exponential||this.current_section.string_format?this.AppendCharAsText():(this.current_section.exponential=!0,this.char_index++);break;case 37:this.current_section.exponential||this.current_section.string_format||(this.current_section.percent=!0),this.AppendCharAsText();break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.ParseDatePattern=function(){var t,e,r,n,i=this;for(this.date_pattern=!0;this.date_pattern&&this.char_index<this.pattern.length;)this.DatePatternConsumeChar();if(this.date_pattern){this.date_pattern=!1;try{for(var o=a(this.sections),s=o.next();!s.done;s=o.next()){var l=s.value;try{for(var u=(r=void 0,a(l.prefix)),c=u.next();!c.done;c=u.next()){var h=c.value;h.flag&&h.flag&(M.date_component|M.date_component_minutes)&&(this.date_pattern=!0)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}return this.date_pattern&&(this.sections[0].date_format=!0,this.sections[0].prefix.forEach((function(t,e){if(t.flag===M.date_component&&("mm"===t.text||"m"===t.text)){if(e)for(var r=e-1;r;r--)if((n=i.sections[0].prefix[r]).flag===M.date_component){/h/i.test(n.text)&&(t.flag=M.date_component_minutes,t.text=t.text.toLowerCase());break}if(e<i.sections[0].prefix.length-1)for(r=e+1;r<i.sections[0].prefix.length;r++){var n;if((n=i.sections[0].prefix[r]).flag===M.date_component){/s/i.test(n.text)&&(t.flag=M.date_component_minutes,t.text=t.text.toLowerCase());break}}}}))),this.date_pattern},t.ConsumeDatePart=function(){for(var t=this.pattern[this.char_index++],e=t.toLowerCase(),r={text:t,flag:M.date_component};this.pattern[this.char_index]&&this.pattern[this.char_index].toLowerCase()===e;)r.text+=this.pattern[this.char_index++];if("s"===e&&"."===this.pattern[this.char_index])for(r.text+=this.pattern[this.char_index++];"0"===this.pattern[this.char_index];)r.text+=this.pattern[this.char_index++];return r},t.ConsumeAMPM=function(){var t=this.pattern.substr(this.char_index,5);return"am/pm"===t||"AM/PM"===t?(this.char_index+=5,this.sections[0].twelve_hour=!0,{text:t,flag:M.date_component}):"a/p"===(t=this.pattern.substr(this.char_index,3))||"A/P"===t?(this.char_index+=3,this.sections[0].twelve_hour=!0,{text:t,flag:M.date_component}):void 0},t.DatePatternConsumeChar=function(){switch(this.characters[this.char_index]){case 59:this.char_index=this.characters.length;break;case 48:case 35:case 101:case 69:case 37:case 64:this.date_pattern=!1;break;case 72:case 104:case 77:case 109:case 83:case 115:case 68:case 100:case 89:case 121:this.AppendTextPart(this.ConsumeDatePart());break;case 65:case 97:var t=this.ConsumeAMPM();t?this.AppendTextPart(t):this.AppendCharAsText();break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:M.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:M.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:M.padded}),this.current_section.has_asterisk=!0}break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.date_pattern=!1,t.pattern="",t.char_index=0,t.characters=[],t.sections=[],t.current_section=new S,t.preserve_formatting_characters=!1,t.decimal_mark=46,t.group_separator=44,t}(),T=function(t){return t>=60&&t--,new Date(864e5*t-22090752e5)},P=function(t,e){if(void 0===e&&(e=!0),e){var r=new Date(t),n=new Date;n.setUTCMilliseconds(r.getUTCMilliseconds()),n.setUTCSeconds(r.getUTCSeconds()),n.setUTCMinutes(r.getUTCMinutes()),n.setUTCHours(r.getHours()),n.setUTCDate(r.getDate()),n.setUTCMonth(r.getMonth()),n.setUTCFullYear(r.getFullYear()),t=n.getTime()}return(t=(t+22090752e5)/864e5)>=60&&t++,t},N=function(){function t(t){var e,r;if(this._pattern="",this.decimal_zero_regexp=[],this.cloned=[],this.magic_decimal=!1,this._pattern=t,this.sections=k.Parse(t),this.sections.length||(this.sections=[]),this.sections[0]||(this.sections[0]=new S),this.sections[1]||(this.sections[1]=n({},this.sections[0]),this.sections[1].prefix=JSON.parse(JSON.stringify(this.sections[1].prefix)),this.sections[1].suffix=JSON.parse(JSON.stringify(this.sections[1].suffix)),this.sections[1].prefix.push({text:"-"}),this.cloned[1]=!0),this.sections[2]||(this.sections[2]=n({},this.sections[0]),this.cloned[2]=!0),!this.sections[3])try{for(var i=a(this.sections[0].prefix),o=i.next();!o.done;o=i.next())if(o.value.flag===M.literal){this.sections[3]=n({},this.sections[0]),this.sections[3].string_format=!0,this.cloned[3]=!0;break}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.decimal_zero_regexp=this.sections.map((function(t){if(t.decimal_max_digits>t.decimal_min_digits)return new RegExp("0{1,"+(t.decimal_max_digits-t.decimal_min_digits)+"}(?:$|e)")}))}return t.FormatPartsAsText=function(t,e){void 0===e&&(e=0);var r=-1,n=t.map((function(t,e){switch(t.flag){case M.padded:return r=e,t.text;case M.hidden:return t.text.replace(/./g," ");case M.formatting:return"";default:return t.text}}));if(r>=0&&e){for(var i=n.reduce((function(t,e,n){return n===r?t:t+e.length}),0),a="",o=0;o<e-i;o++)a+=n[r];n[r]=a}return n.join("")},Object.defineProperty(t.prototype,"pattern",{get:function(){return this._pattern},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"date_format",{get:function(){return this.sections[0]&&this.sections[0].date_format},enumerable:!1,configurable:!0}),t.prototype.IncreaseDecimal=function(){this.sections.forEach((function(t){t.decimal_min_digits++,t.decimal_max_digits=t.decimal_min_digits}))},t.prototype.DecreaseDecimal=function(){this.sections.forEach((function(t){t.decimal_min_digits=Math.max(0,t.decimal_min_digits-1),t.decimal_max_digits=t.decimal_min_digits}))},t.prototype.AddGrouping=function(){this.sections.forEach((function(t){t.grouping=!0}))},t.prototype.RemoveGrouping=function(){this.sections.forEach((function(t){t.grouping=!1}))},t.prototype.ToggleGrouping=function(){var t=!this.sections[0].grouping;this.sections.forEach((function(e){e.grouping=t}))},t.prototype.toString=function(){var t=this;return this.sections[0].date_format?this._pattern:this.sections.filter((function(e,r){return!t.cloned[r]})).map((function(t){var e="",r=0;if(t.fraction_format){t.fraction_integer&&(e+="? ");for(var n="",i=0;i<t.fraction_denominator_digits;i++)n+="#";e+=n,e+="/",t.fraction_denominator?e+=t.fraction_denominator:e+=n}else if(t.has_number_format){for(r=0;r<t.integer_min_digits;r++)e+="0";if(t.grouping&&(e.length<4&&(e=("####"+e).slice(-4)),e=e.replace(/[\d#]{1,3}(?=([\d#]{3})+(?![\d#]))/g,"$&,")),t.decimal_max_digits||t.decimal_min_digits){for(e+=".",r=0;r<t.decimal_min_digits;r++)e+="0";for(;r<t.decimal_max_digits;r++)e+="#"}if(t.scaling){var a=Math.log10(t.scaling)/3;for(r=0;r<a;r++)e+=","}t.exponential&&(e+="e")}return t.prefix.map((function(t){return t.flag===M.hidden?"0"===t.text?"?":"_"+t.text:t.flag===M.padded?"*"+t.text:t.flag===M.formatting?"["+t.text+"]":t.text})).join("")+e+t.suffix.map((function(t){return t.flag===M.hidden?"0"===t.text?"?":"_"+t.text:t.flag===M.padded?"*"+t.text:t.text})).join("")})).join(";")},t.prototype.FormatComplex=function(e){var r=!!e.imaginary;r&&(r=this.FormatParts(e.imaginary).some((function(t){return/[1-9]/.test(t.text)})));var n=!!e.real;n&&(n=this.FormatParts(e.real).some((function(t){return/[1-9]/.test(t.text)})));var i=[];return n||!n&&!r?(i.push.apply(i,s([],o(this.FormatParts(e.real)))),r&&(Math.abs(e.imaginary),i.push({text:e.imaginary<0?" "+t.minus_character+" ":" + "}),i.push.apply(i,s(s([],o(this.FormatParts(Math.abs(e.imaginary)))),[{text:t.imaginary_character}])))):r&&i.push.apply(i,s(s([],o(this.FormatParts(e.imaginary))),[{text:t.imaginary_character}])),i},t.prototype.FormatParts=function(t){var e,r;if("number"!=typeof t&&!this.sections[3])return[{text:t.toString()}];var i=this.BaseFormat(t),l=i.parts,u=i.section,c=[];if(u.date_format||u.string_format)try{for(var h=a(l),f=h.next();!f.done;f=h.next()){var d=f.value;"string"==typeof d?c.push({text:d}):c.push(d)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}else this.magic_decimal&&""===l[1]&&l.splice(1,1),c=s(s(s([],o(u.prefix.map((function(t){return n({},t)})))),[{text:u.has_number_format?l.join(x.decimal_separator):""}]),o(u.suffix.map((function(t){return n({},t)}))));for(var p=1;p<c.length;p++)c[p].flag===c[p-1].flag&&(c[p].text=c[p-1].text+c[p].text,c[p-1].text="");return c.filter((function(t){return t.text}))},t.prototype.Format=function(e,r){return void 0===r&&(r=0),t.FormatPartsAsText(this.FormatParts(e),r)},t.prototype.ZeroPad=function(t,e){for(;t.length<e;)t="0"+t;return t},t.prototype.DateFormat=function(t){var e=this,r=T(t),i=this.sections[0],a=r.getUTCHours();return i.twelve_hour&&(a>12&&(a-=12),0===a&&(a=12)),{parts:i.prefix.map((function(t){if(t.flag===M.date_component_minutes)return"mm"===t.text?{text:e.ZeroPad(r.getUTCMinutes().toString(),2)}:{text:e.ZeroPad(r.getUTCMinutes().toString(),1)};if(t.flag===M.date_component){switch(t.text.toLowerCase()){case"am/pm":case"a/p":var i=t.text.split("/");return{text:r.getUTCHours()>12?i[1]:i[0]};case"mmmmm":return{text:x.date_components.long_months[r.getUTCMonth()][0]};case"mmmm":return"MMMM"===t.text?{text:x.date_components.long_months[r.getUTCMonth()].toUpperCase()}:{text:x.date_components.long_months[r.getUTCMonth()]};case"mmm":return"MMM"===t.text?{text:x.date_components.short_months[r.getUTCMonth()].toUpperCase()}:{text:x.date_components.short_months[r.getUTCMonth()]};case"mm":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),2)};case"m":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),1)};case"ddddd":case"dddd":return"DDDDD"===t.text||"DDDD"===t.text?{text:x.date_components.long_days[r.getUTCDay()].toUpperCase()}:{text:x.date_components.long_days[r.getUTCDay()]};case"ddd":return"DDD"===t.text?{text:x.date_components.short_days[r.getUTCDay()].toUpperCase()}:{text:x.date_components.short_days[r.getUTCDay()]};case"dd":return{text:e.ZeroPad(r.getUTCDate().toString(),2)};case"d":return{text:e.ZeroPad(r.getUTCDate().toString(),1)};case"yyyy":case"yyy":return{text:r.getUTCFullYear().toString()};case"yy":case"y":return{text:e.ZeroPad((r.getUTCFullYear()%100).toString(),2)};case"hh":return{text:e.ZeroPad(a.toString(),2)};case"h":return{text:e.ZeroPad(a.toString(),1)};case"ss":return{text:e.ZeroPad(r.getUTCSeconds().toString(),2)};case"s":return{text:e.ZeroPad(r.getUTCSeconds().toString(),1)}}var o=t.text.match(/^(s+)\.(0+)$/);if(o)return{text:e.ZeroPad(r.getUTCSeconds().toString(),o[1].length)+x.decimal_separator+(r.getUTCMilliseconds()/1e3).toFixed(o[2].length).substr(2)}}return n({},t)})),section:i}},t.prototype.StringFormat=function(t,e){var r,i,o=[];try{for(var s=a(e.prefix),l=s.next();!l.done;l=s.next()){var u=l.value;u.flag===M.literal?o.push({text:t}):o.push(n({},u))}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return{parts:o,section:e}},t.prototype.Round2=function(t,e){var r=Math.pow(10,e);return Math.round(r*t)/r},t.prototype.FormatFraction=function(e,r){r.percent&&(e*=100);var n={denominator:1,numerator:Math.round(e),error:Math.abs(Math.round(e)-e)};if(r.fraction_denominator)n.denominator=r.fraction_denominator,n.numerator=Math.round(e*n.denominator);else if(n.error)for(var i=t.fraction_limits[r.fraction_denominator_digits-1]||t.fraction_limits[0],a=2;a<=i;a++){var o=Math.round(e*a),s=Math.abs(o/a-e);if(s<n.error&&(n={numerator:o,denominator:a,error:s},!s))break}var l=[];if(r.fraction_integer){var u=Math.floor(n.numerator/n.denominator);n.numerator%=n.denominator,!u&&n.numerator||(l.push(u.toString()),n.numerator&&l.push(" "))}else n.numerator||l.push("0");return n.numerator&&(l.push(n.numerator.toString()),l.push("/"),l.push(n.denominator.toString())),l.join("")},t.prototype.BaseFormat=function(e){if(this.sections[0].date_format)return this.DateFormat(Number(e));if("number"!=typeof e)return this.StringFormat(e.toString(),this.sections[3]);var r=this.sections[0],n=this.decimal_zero_regexp[0];e<0&&(r=this.sections[1]);var i=r.percent?r.decimal_max_digits+2:r.decimal_max_digits,a=Math.pow(10,-i)/2,o=Math.abs(e);if(o<a&&(r=this.sections[2],n=this.decimal_zero_regexp[2]),r.scaling&&(o/=r.scaling)<a&&(r=this.sections[2],n=this.decimal_zero_regexp[2]),r.string_format)return this.StringFormat(e.toString(),r);var s="";if(r.fraction_format)return{parts:[this.FormatFraction(o,r)],section:r};r.exponential?s=o.toExponential(r.decimal_max_digits):(r.percent&&(o*=100),s=this.Round2(o,r.decimal_max_digits).toFixed(r.decimal_max_digits)),n&&(s=s.replace(n,""));for(var l=s.split(".");l[0].length<r.integer_min_digits;)l[0]=("0000000000000000"+l[0]).slice(-r.integer_min_digits);return 0===r.integer_min_digits&&"0"===l[0]&&(l[0]=""),r.grouping&&(l[0]=l[0].replace(t.grouping_regexp,"$&"+x.grouping_separator)),{parts:l,section:r}},t.grouping_regexp=/\d{1,3}(?=(\d{3})+(?!\d))/g,t.fraction_limits=[9,99,999,9999],t.imaginary_character="ð",t.minus_character="-",t}(),E=function(){function t(){}return t.Get=function(t,e){if(void 0===e&&(e=!1),e&&"General"===t)return this.complex_general;var r=this.symbolc_name_map[t.toLowerCase()],n=this.cache[r||t];return n||(n=new N(t),this.cache[t]=n),n},t.Equals=function(t,e){if(t===e)return!0;var r=this.Get(t),n=this.Get(e);return r.pattern===n.pattern},t.Translate=function(t){var e=this.symbolc_name_map[t.toLowerCase()];return e?this.cache[e].toString():t},t.SymbolicName=function(t){var e,r;try{for(var n=a(Object.keys(this.base_formats)),i=n.next();!i.done;i=n.next()){var o=i.value;if(t===this.base_formats[o])return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return null},t.InitCache=function(){var t,e,r,n;try{for(var i=a(Object.keys(this.base_formats)),o=i.next();!o.done;o=i.next()){var s=o.value;this.cache[s]=new N(this.base_formats[s]),this.symbolc_name_map[s.toLowerCase()]=s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.cache.General.magic_decimal=!0,this.complex_general=new N("0.###"),this.complex_general.magic_decimal=!0;try{for(var l=a(Object.keys(this.aliases)),u=l.next();!u.done;u=l.next())s=u.value,this.cache[s]=this.cache[this.aliases[s]],this.symbolc_name_map[s.toLowerCase()]=s}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}},t.cache={},t.symbolc_name_map={},t.base_formats={Accounting:"_(#,##0.00_);(#,##0.00);-???",Number:"0.00",Integer:"0",Percent:"0.00%",General:"0.######",Fraction:"# ?/?",Dollar:"$* _(#,##0.00_);$* (#,##0.00);$* -???",Exponential:"0.000e","Short Date":"mm/dd/yy","Long Date":"dddd, mmm d yyyy",Timestamp:"mm-dd-yy hh:mm:ss"},t.aliases={Scientific:"Exponential",Percentage:"Percent",Currency:"Dollar"},t}();E.InitCache(),function(t){t[t.None=0]="None",t[t.Nan=1]="Nan",t[t.Exponential=2]="Exponential",t[t.Percent=4]="Percent",t[t.Currency=8]="Currency",t[t.Grouping=16]="Grouping",t[t.Parens=32]="Parens",t[t.Date=64]="Date",t[t.Time=128]="Time"}(R||(R={}));var D=(new Date).getUTCFullYear();new(function(){function t(){}return t.prototype.TestDate=function(t){var e,r,n,i,s,l,u=Date.parse(t);if(isNaN(u))return!1;var c=new Date(u),h=t.replace(/[\d\-\\/,.\s]+/g," ").toLocaleLowerCase().split(/\s+/).map((function(t){return t.trim()})).filter((function(t){return!!t}));if(!h.length)return u;if(!this.compare_month){this.compare_month={};for(var f=0;f<12;f++)this.compare_month[x.date_components.long_months[f].toLocaleLowerCase().replace(/\./,"")]=f,this.compare_month[x.date_components.short_months[f].toLocaleLowerCase().replace(/\./,"")]=f}if(!this.compare_day)for(this.compare_day={},f=0;f<7;f++)this.compare_day[x.date_components.long_days[f].toLocaleLowerCase().replace(/\./,"")]=f,this.compare_day[x.date_components.short_days[f].toLocaleLowerCase().replace(/\./,"")]=f;var d=!1,p=!1;try{for(var m=a(h),v=m.next();!v.done;v=m.next()){var y=v.value,_=!1;try{for(var g=(n=void 0,a(Object.entries(this.compare_month))),b=g.next();!b.done;b=g.next()){var w=o(b.value,2),M=w[0],C=w[1];if(y===M){if(d)return!1;if(c.getUTCMonth()!==C)return!1;_=!0,d=!0}}}catch(t){n={error:t}}finally{try{b&&!b.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}if(!_)try{for(var A=(s=void 0,a(Object.entries(this.compare_day))),S=A.next();!S.done;S=A.next()){var R=o(S.value,2),k=R[0];if(C=R[1],y===k){if(p)return!1;if(c.getUTCDay()!==C)return!1;_=!0,p=!0}}}catch(t){s={error:t}}finally{try{S&&!S.done&&(l=A.return)&&l.call(A)}finally{if(s)throw s.error}}if(!_)return!1}}catch(t){e={error:t}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return!(p&&!d)&&u},t.prototype.TryParse=function(t){void 0===t&&(t="");var e=R.None;if("'"===t[0])return{value:t,type:l.string};if(""===t)return{value:t,type:l.string};if("NaN"===t)return{value:NaN,type:l.number,hints:R.Nan};var r=t.trim(),n=r.match(/^[$](.*?)$/);n&&(r=n[1],e|=R.Currency);var i=r.match(/^\((.*?)\)$/);i&&(r=i[1],e|=R.Parens);var a=r.match(/^(.*?)%\s*$/);a&&(r=a[1],e|=R.Percent),"."===x.decimal_separator?/,/.test(r)&&(r=r.replace(/,/g,""),e|=R.Grouping):r=(r=(r=r.replace(/(\d)\s+/g,"$1")).replace(/\./g,"")).replace(/,/,".");var o=Number(r);if(null===o||isNaN(o)){var s=t.toLowerCase();if("false"===s)return{value:!1,type:l.boolean};if("true"===s)return{value:!0,type:l.boolean};var u=this.TestDate(t);if(!1!==u&&!isNaN(u)){var c=new Date(u),h=c.getUTCFullYear();if(h>=D-200&&h<=D+200)return e=R.Date,(c.getHours()||c.getMinutes()||c.getSeconds())&&(e|=R.Time),{value:P(u),type:l.number,hints:e}}return{value:t,type:l.string}}if(i&&(o=-o),a){var f=o<0?-1:1,d=(f*o).toString().split(".");d[0]=("00"+d[0]).replace(/(\d\d)$/,".$1"),o=Number(d.join(""))*f}return/e/.test(t)&&(e|=R.Exponential),{value:o,type:l.number,hints:e}},t}());var O,F,I=1e3,L=(function(){function t(t,e){void 0===t&&(t=!1),void 0===e&&(e="undefined"),this.verbose=t,this.log_id=e,this.queue=[],this.dispatched=!1,this.subscribers=[],this.pass_through=[]}t.prototype.Publish=function(t){var e,r=this;this.verbose&&console.info("es publish ("+this.log_id+")",t),this.pass_through.forEach((function(e){return e.Publish(t)})),Array.isArray(t)?(e=this.queue).push.apply(e,s([],o(t))):this.queue.push(t),this.dispatched||(this.dispatched=!0,Promise.resolve().then((function(){var t,e,n,i,o=r.queue.slice(0);r.dispatched=!1,r.queue=[];try{for(var s=a(o),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(n=void 0,a(r.subscribers)),h=c.next();!h.done;h=c.next())h.value.subscriber(u)}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}})))},t.prototype.Subscribe=function(t){var e=I++;return this.subscribers.push({subscriber:t,token:e}),e},t.prototype.Cancel=function(t){this.subscribers=this.subscribers.filter((function(e){return e.token!==t}))},t.prototype.CancelAll=function(){this.subscribers=[],this.pass_through=[]},t.prototype.PassThrough=function(t){this.pass_through.push(t)}}(),function(){function t(e,r,n,i){void 0===i&&(i=e),t.Create({container:e,node:r,resize_callback:n,layout_reference:i})}t.Create=function(e){var r,n,i=document.createElement("div");if(i.classList.add("treb-embed-resize-handle"),(e.layout_reference||e.container).appendChild(i),!t.resize_mask){var a=document.querySelector(".treb-embed-mouse-mask");a||((a=document.createElement("div")).classList.add("treb-embed-mouse-mask"),document.body.appendChild(a)),t.resize_mask=a}if(!t.resize_rect){var o=document.querySelector(".treb-embed-resize-rect");o||((o=document.createElement("div")).classList.add("treb-embed-resize-rect"),t.resize_mask.appendChild(o)),t.resize_rect=o}var s={width:0,height:0},l={x:0,y:0},u={x:0,y:0},c=function(){if(t.resize_mask.removeEventListener("mousemove",n),t.resize_mask.removeEventListener("mouseup",r),t.resize_mask.style.display="none",u.x||u.y){var i=e.container.getBoundingClientRect(),a=i.width+u.x,o=i.height+u.y;e.container.style.width=a+"px",e.container.style.height=o+"px",e.resize_callback&&e.resize_callback()}};n=function(e){e.buttons?(u.x!==e.clientX-l.x&&(u.x=e.clientX-l.x,t.resize_rect.style.width=s.width+u.x+4+"px"),u.y!==e.clientY-l.y&&(u.y=e.clientY-l.y,t.resize_rect.style.height=s.height+u.y+4+"px")):c()},r=function(){c()},i.addEventListener("mousedown",(function(i){i.stopPropagation(),i.preventDefault();var a=e.node.getBoundingClientRect();s={width:a.width,height:a.height},t.resize_rect&&(t.resize_rect.style.top=a.top-2+"px",t.resize_rect.style.left=a.left-2+"px",t.resize_rect.style.width=a.width+4+"px",t.resize_rect.style.height=a.height+4+"px"),l={x:i.clientX,y:i.clientY},u={x:0,y:0},t.resize_mask.style.display="block",t.resize_mask.addEventListener("mousemove",n),t.resize_mask.addEventListener("mouseup",r)}))}}(),function(){function t(){}return t.MeasureColorARGB=function(t){for(var e=this.MeasureColor(t),r="FF",n=0;n<3;n++){var i=e[n].toString(16);0===i.length?r+="00":1===i.length?r+="0"+i:r+=i}return r.toUpperCase()},t.MeasureColor=function(t){var e=this.color_cache[t];if(e)return e;this.color_measurement_canvas||(this.color_measurement_canvas=document.createElement("canvas"),this.color_measurement_canvas.width=1,this.color_measurement_canvas.height=1);var r=this.color_measurement_canvas.getContext("2d");return r?(r.fillStyle="#fff",r.fillRect(0,0,1,1),r.fillStyle=t,r.fillRect(0,0,1,1),e=r.getImageData(0,0,1,1).data,this.color_cache[t]=e,e):new Uint8ClampedArray(3)},t.EnsureMeasurementNode=function(){if(!this.text_measurement_node){var t=document.querySelector(".treb-chart-measurement-node");t?this.text_measurement_node=t:(this.text_measurement_node=document.createElement("div"),this.text_measurement_node.classList.add("treb-chart-measurement-node"),this.text_measurement_node.style.margin="0px",this.text_measurement_node.style.padding="0px",this.text_measurement_node.style.whiteSpace="nowrap",this.text_measurement_node.style.position="fixed",this.text_measurement_node.style.border="0px",this.text_measurement_node.style.border="1px solid red",this.text_measurement_node.style.boxSizing="content-box",this.text_measurement_node.style.top=this.text_measurement_node.style.left="-1000px",document.body.appendChild(this.text_measurement_node))}},t.FontLoaded=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=400);var n=(e?"italic":"")+" "+r+" 20pt "+t,i=this.MeasureText(n+", sans-serif","check font"),a=this.MeasureText(n+", serif","check font"),o=this.MeasureText(n+", monospace","check font");return i.width===a.width&&a.width===o.width},t.MeasureText=function(t,e,r){void 0===r&&(r=0),this.EnsureMeasurementNode(),this.text_measurement_node.style.font=t,/\n/.test(e)?(e=e.replace(/\n/g,"<BR/>"),this.text_measurement_node.innerHTML=e):this.text_measurement_node.textContent=e,this.text_measurement_node.style.lineHeight="1em",this.text_measurement_node.style.transform=r?"rotate("+r+"deg)":"";var n=this.text_measurement_node.getBoundingClientRect();return{width:n.width,height:n.height}},t.color_cache={},t}()),U=function(t,e,r,n){var i,o;if(void 0===r&&(r=6.5),void 0===n&&(n=!1),e===t)e++,t&&t--;else{var s=Math.round(1e5*e)/1e5;Math.abs(s-e)/(e-t)<1e-5&&(e=s)}var l=e-t,u=Math.log(l)/Math.log(10),c=Math.floor(Math.abs(u))*(u<0?-1:1)-1,h=-1,f=0;try{for(var d=a([.1,.25,.5,1,2.5,5,10,25,50,100]),p=d.next();!p.done;p=d.next()){var m=p.value*Math.pow(10,c),v=Math.floor(t/m)*m,y=(Math.ceil(e/m)*m-v)/m,_=Math.abs(y-r);(h<0||_<f)&&(!n||y<=r)&&(f=_,h=m)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}return t=Math.floor(t/h)*h,e=Math.ceil(e/h)*h,{scale:c,step:h,count:r=Math.round((e-t)/h),min:t,max:e}},j=100,V=function(){function t(t){var e,r;void 0===t&&(t={}),this.key_=j++,this.data={},this.type="",this.temp={},this.inflated=!1,this.resizable=!0,this.movable=!0,this.removable=!0,this.selectable=!0,this.move_with_cells=!0,this.resize_with_cells=!0,this.formula="";try{for(var n=a(Object.keys(this)),i=n.next();!i.done;i=n.next()){var o=i.value;"layout"!==o&&t[o]&&(this[o]=t[o])}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}t.layout&&(this.layout=JSON.parse(JSON.stringify(t.layout))),t.rect&&(this.rect=C.Create(t.rect))}return Object.defineProperty(t.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var t={};return this.data&&(t.data=this.data),this.formula&&(t.formula=this.formula),this.type&&(t.type=this.type),this.resizable||(t.resizable=this.resizable),this.movable||(t.movable=this.movable),this.removable||(t.removable=this.removable),this.selectable||(t.selectable=this.selectable),this.move_with_cells||(t.move_with_cells=this.move_with_cells),this.resize_with_cells||(t.resize_with_cells=this.resize_with_cells),this.layout&&(t.layout=this.layout),this.extent&&(t.extent=this.extent),t},t}(),G=function(){function t(e){this.annotations=[],this.freeze={rows:0,columns:0},this.visible=!0,this.default_column_width=100,this.default_row_height=25,this.cells=new b,this.selection={target:{row:0,column:0},area:new u({row:0,column:0}),empty:!0},this.scroll_offset={x:0,y:0},this.name=t.default_sheet_name,this.row_height_=[],this.column_width_=[],this.row_headers=[],this.column_headers=[],this.row_header_width=100,this.column_header_height=25,this.style_map=[],this.style_json_map=[],this.sheet_style={},this.row_styles={},this.column_styles={},this.row_pattern=[],this.cell_style=[],this.default_style_properties=e,this.default_column_width=100,this.row_header_width=60,this.UpdateDefaultRowHeight(),this.id_=t.base_id++}return t.Reset=function(){this.base_id=100},t.Blank=function(e,r,n,i){void 0===n&&(n=30),void 0===i&&(i=20);var a=new t(e);return r&&(a.name=r),n=Math.max(n,1),i=Math.max(i,1),a.cells.EnsureCell({row:n-1,column:i-1}),a},t.FromJSON=function(e,r,i){var o,s,l,u,c,h,f,d,p,m,v,y,b,x,w,M,C,A,S,R,k;k="string"==typeof e?JSON.parse(e):e;var T=function(t,e){Object.keys(e).forEach((function(r){var n=Number(r)||0;t[n]=e[r]}))};i||(i=new t(r)),k.default_column_width&&(i.default_column_width=k.default_column_width),k.default_row_height&&(i.default_row_height=k.default_row_height),k.id&&(i.id=k.id),k.name&&(i.name=k.name);var P=function(t){var e=t;e.text_color&&("none"!==e.text_color&&(e.text={text:e.text_color}),e.text_color=void 0),e.background&&("none"!==e.background&&(e.fill={text:e.background}),e.background=void 0),e.border_top_color&&("none"!==e.border_top_color&&(e.border_top_fill={text:e.border_top_color}),e.border_top_color=void 0),e.border_left_color&&("none"!==e.border_left_color&&(e.border_left_fill={text:e.border_left_color}),e.border_left_color=void 0),e.border_bottom_color&&("none"!==e.border_bottom_color&&(e.border_bottom_fill={text:e.border_bottom_color}),e.border_bottom_color=void 0),e.border_right_color&&("none"!==e.border_right_color&&(e.border_right_fill={text:e.border_right_color}),e.border_right_color=void 0)},N=k.cell_style_refs;try{for(var E=a(N),D=E.next();!D.done;D=E.next())P(K=D.value)}catch(t){o={error:t}}finally{try{D&&!D.done&&(s=E.return)&&s.call(E)}finally{if(o)throw o.error}}if(i.cell_style=[],N&&(k.cell_styles||[]).forEach((function(t){"number"==typeof t.ref&&(t.style=JSON.parse(JSON.stringify(N[t.ref])))})),i.cells.FromJSON(k.data),k.rows&&i.cells.EnsureRow(k.rows-1),k.columns&&i.cells.EnsureColumn(k.columns-1),k.data)if(_(k.data))try{for(var O=a(k.data),F=O.next();!F.done;F=O.next())(K=F.value).style_ref&&(i.cell_style[K.column]||(i.cell_style[K.column]=[]),i.cell_style[K.column][K.row]=JSON.parse(JSON.stringify(N[K.style_ref])))}catch(t){l={error:t}}finally{try{F&&!F.done&&(u=O.return)&&u.call(O)}finally{if(l)throw l.error}}else if(g(k.data))try{for(var I=a(k.data),L=I.next();!L.done;L=I.next()){var U=(J=L.value).row;try{for(var j=(f=void 0,a(J.cells)),G=j.next();!G.done;G=j.next()){var z=(K=G.value).column;K.style_ref&&(i.cell_style[z]||(i.cell_style[z]=[]),i.cell_style[z][U]=JSON.parse(JSON.stringify(N[K.style_ref])))}}catch(t){f={error:t}}finally{try{G&&!G.done&&(d=j.return)&&d.call(j)}finally{if(f)throw f.error}}}}catch(t){c={error:t}}finally{try{L&&!L.done&&(h=I.return)&&h.call(I)}finally{if(c)throw c.error}}else try{for(var B=a(k.data),q=B.next();!q.done;q=B.next()){var J;z=(J=q.value).column;try{for(var H=(v=void 0,a(J.cells)),W=H.next();!W.done;W=H.next())U=(K=W.value).row,K.style_ref&&(i.cell_style[z]||(i.cell_style[z]=[]),i.cell_style[z][U]=JSON.parse(JSON.stringify(N[K.style_ref])))}catch(t){v={error:t}}finally{try{W&&!W.done&&(y=H.return)&&y.call(H)}finally{if(v)throw v.error}}}}catch(t){p={error:t}}finally{try{q&&!q.done&&(m=B.return)&&m.call(B)}finally{if(p)throw p.error}}i.freeze.rows=0,i.freeze.columns=0,k.freeze&&(i.freeze.rows=k.freeze.rows||0,i.freeze.columns=k.freeze.columns||0),i.scroll_offset=k.scroll?n({},k.scroll):{x:0,y:0};try{for(var Z=a(k.cell_styles||[]),$=Z.next();!$.done;$=Z.next()){var Y=$.value;Y.style&&(i.cell_style[Y.column]||(i.cell_style[Y.column]=[]),i.cell_style[Y.column][Y.row]=Y.style)}}catch(t){b={error:t}}finally{try{$&&!$.done&&(x=Z.return)&&x.call(Z)}finally{if(b)throw b.error}}i.sheet_style=k.sheet_style||{},i.row_styles=k.row_style,i.column_styles=k.column_style,i.row_pattern=k.row_pattern||[],P(i.sheet_style||{});try{for(var Q=a(i.row_pattern),X=Q.next();!X.done;X=Q.next()){var K;P(K=X.value)}}catch(t){w={error:t}}finally{try{X&&!X.done&&(M=Q.return)&&M.call(Q)}finally{if(w)throw w.error}}try{for(var tt=a(Object.keys(i.column_styles)),et=tt.next();!et.done;et=tt.next()){var rt=et.value;P(i.column_styles[rt])}}catch(t){C={error:t}}finally{try{et&&!et.done&&(A=tt.return)&&A.call(tt)}finally{if(C)throw C.error}}try{for(var nt=a(Object.keys(i.row_styles)),it=nt.next();!it.done;it=nt.next())rt=it.value,P(i.row_styles[rt])}catch(t){S={error:t}}finally{try{it&&!it.done&&(R=nt.return)&&R.call(nt)}finally{if(S)throw S.error}}return i.row_height_=[],T(i.row_height_,k.row_height||{}),i.row_height_.length&&i.cells.EnsureRow(i.row_height_.length-1),i.column_width_=[],T(i.column_width_,k.column_width||{}),i.column_width_.length&&i.cells.EnsureColumn(i.column_width_.length-1),i.annotations=(k.annotations||[]).map((function(t){return new V(t)})),k.selection&&(i.selection=JSON.parse(JSON.stringify(k.selection))),i.visible=!0,void 0!==k.visible&&(i.visible=!!k.visible),i},Object.defineProperty(t.prototype,"header_offset",{get:function(){return{x:this.row_header_width,y:this.column_header_height}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.cells.rows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.cells.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.id_},set:function(e){this.id_=e,this.id>=t.base_id&&(t.base_id=this.id+1)},enumerable:!1,configurable:!0}),t.prototype.MergeCells=function(t){t=t.Clone(),this.cells.Apply(t,(function(e,r,n){e.merge_area=t,e.render_dirty=!0,r===t.start.column&&n===t.start.row||e.Reset()}),!0)},t.prototype.UnmergeCells=function(t){var e=!0;this.cells.Apply(t,(function(r){e=e&&!!r.merge_area&&t.Equals(r.merge_area)}),!1),e?this.cells.Apply(t,(function(t){t.merge_area=void 0,t.render_dirty=!0}),!1):console.warn("area mismatch")},t.prototype.StyleFontSize=function(t,e){void 0===e&&(e={});var r=t.font_size_value||0,n=0;switch(t.font_size_unit){case"px":r*=.75;break;case"em":n=t.font_size_value||1;break;case"%":n=(t.font_size_value||100)/100}return n&&(r=n*(e.font_size_value||10),"px"===e.font_size_unit&&(r*=.75)),r||10},t.prototype.UpdateDefaultRowHeight=function(){var t=w.Composite([this.default_style_properties,this.sheet_style]);if("undefined"!=typeof window){var e=L.MeasureText(w.Font(t),"M"),r=Math.round(1.4*e.height);this.default_row_height<r&&(this.default_row_height=r)}},t.prototype.SetRowHeaders=function(t){this.row_headers=t.map((function(t){return void 0===t?"":t.toString()})),this.row_headers&&this.cells.EnsureRow(this.row_headers.length-1)},t.prototype.SetColumnHeaders=function(t){this.column_headers=t.map((function(t){return void 0===t?"":t.toString()})),t&&this.cells.EnsureColumn(t.length-1)},t.prototype.RowHeader=function(t){return this.row_headers?this.row_headers.length>t?this.row_headers[t]:"":t+1},t.prototype.ColumnHeader=function(t){var e="";if(this.column_headers)return this.column_headers.length>t?this.column_headers[t]:"";for(;;){var r=t%26;if(e=String.fromCharCode(65+r)+e,!(t=Math.floor(t/26)))break;t--}return e},t.prototype.GetRowHeight=function(t){var e=this.row_height_[t];return void 0===e?this.default_row_height:e},t.prototype.SetRowHeight=function(t,e){return this.row_height_[t]=e,this.cells.EnsureRow(t),e},t.prototype.GetColumnWidth=function(t){var e=this.column_width_[t];return void 0===e?this.default_column_width:e},t.prototype.SetColumnWidth=function(t,e){return this.column_width_[t]=e,this.cells.EnsureColumn(t),e},t.prototype.Delta=function(t,e){var r,n,i={},l=s(s([],o(Object.keys(t))),o(Object.keys(e)));try{for(var u=a(l),c=u.next();!c.done;c=u.next()){var h=c.value,f=t[h],d=e[h];"object"==typeof f&&"object"==typeof d?JSON.stringify(f)!==JSON.stringify(d)&&(i[h]=d):f!==d&&(i[h]=d)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return i},t.prototype.UpdateCellStyle=function(t,e,r){void 0===r&&(r=!0);var n=t.row,i=t.column;this.cell_style[i]||(this.cell_style[i]=[]);var a=this.CompositeStyleForCell(t,!1,!1),o=w.Composite([this.default_style_properties,a,w.Merge(this.cell_style[i][n]||{},e,r)]),s=this.Delta(a,o);this.cell_style[i][n]=s,this.CellData(t).FlushStyle()},t.prototype.Invalidate=function(t){this.cells.Apply(this.RealArea(t),(function(t){return t.render_dirty=!0}))},t.prototype.UpdateAreaStyle=function(t,e,r){var n=this;if(void 0===e&&(e={}),void 0===r&&(r=!0),t)if(t.entire_sheet)this.UpdateSheetStyle(e,r);else if(t.entire_column)for(var i=t.start.column;i<=t.end.column;i++)this.UpdateColumnStyle(i,e,r);else if(t.entire_row)for(var a=t.start.row;a<=t.end.row;a++)this.UpdateRowStyle(a,e,r);else t.Array().forEach((function(t){return n.UpdateCellStyle(t,e,r)}))},t.prototype.HasCellStyle=function(t){return!!(this.cell_style[t.column]&&this.cell_style[t.column][t.row]||this.row_styles[t.row]||this.column_styles[t.column]||this.row_pattern.length)},t.prototype.NextVisibleColumn=function(t){for(++t;0===this.column_width_[t];t++);return t},t.prototype.PreviousVisibleColumn=function(t){for(--t;t>=0&&0===this.column_width_[t];t--);return t},t.prototype.NextVisibleRow=function(t){for(++t;0===this.row_height_[t];t++);return t},t.prototype.PreviousVisibleRow=function(t){for(--t;t>=0&&0===this.row_height_[t];t--);return t},t.prototype.SurroundingStyle=function(t){for(var e=[{},{},{},{},{},{},{},{},{},{}],r=t.column+1,n=t.column-1,i=t.row+1,a=t.row-1;0===this.column_width_[r];r++);for(;0===this.row_height_[i];i++);for(;n>=0&&0===this.column_width_[n];n--);for(;a>=0&&0===this.row_height_[a];a--);return n>=0&&a>=0&&(e[7]=this.CellStyleData({row:a,column:n})||{}),n>=0&&(e[4]=this.CellStyleData({row:t.row,column:n})||{},e[1]=this.CellStyleData({row:i,column:n})||{}),a>=0&&(e[8]=this.CellStyleData({row:a,column:t.column})||{},e[9]=this.CellStyleData({row:a,column:r})||{}),e[6]=this.CellStyleData({row:t.row,column:r})||{},e[2]=this.CellStyleData({row:i,column:t.column})||{},e[3]=this.CellStyleData({row:i,column:r})||{},e},t.prototype.CellStyleData=function(t){var e=this.cells.GetCell(t);if(e){if(!e.style){var r=this.GetStyleIndex(this.CompositeStyleForCell(t));e.style=this.style_map[r]}return e.style}},t.prototype.GetCopyStyle=function(t){return this.CompositeStyleForCell(t,!0,!1)},t.prototype.CellData=function(t){var e,r,n=this.cells.EnsureCell(t);if(n.rendered_type)return n;if(n.calculated_type?(r=n.calculated,e=n.calculated_type):(r=n.value,e=n.type),!n.style){var i=this.GetStyleIndex(this.CompositeStyleForCell(t));n.style=this.style_map[i]}if(e&&null!=r)if(e===l.number)isNaN(r)?n.formatted=void 0===n.style.nan?"NaN":n.style.nan:n.formatted=this.FormatNumber(r,n.style.number_format),n.rendered_type=l.number;else if(e===l.error)n.formatted="#"+(r||"ERR?"),n.rendered_type=l.error;else if(e===l.boolean)n.formatted=r.toString().toUpperCase(),n.rendered_type=l.boolean;else if(e===l.formula&&void 0===n.calculated)n.formatted="",n.rendered_type=l.string;else if(e===l.complex){var a=r;if(isNaN(a.real)||isNaN(a.imaginary))n.formatted=void 0===n.style.nan?"NaN":n.style.nan;else{var o=E.Get(n.style.number_format||"",!0);n.formatted=o.FormatComplex(a)}n.rendered_type=l.complex}else n.formatted=this.FormatNumber(r,n.style.number_format),n.rendered_type=l.string;else n.formatted="",n.rendered_type=l.string;return n},t.prototype.FormatNumber=function(t,e){void 0===e&&(e="");var r=E.Get(e).FormatParts(t);return r.length?1!==r.length||r[0].flag?r:r[0].text||"":""},t.prototype.SetHeaderSize=function(t,e){void 0===t&&(t=60),void 0===e&&(e=this.default_row_height),this.row_header_width=t,this.column_header_height=e},t.prototype.AutoSizeRow=function(t,e){void 0===e&&(e={});for(var r=this.default_row_height,n=0;n<this.cells.columns;n++){var i=this.CellData({row:t,column:n}),a=i.style,o=i.formatted||"";if("string"!=typeof o&&(o=o.map((function(t){return t.text})).join("")),a&&o&&o.length){var s=o.split(/\n/),l=this.StyleFontSize(a,e);r=Math.max(r,((l||10)+9)*s.length)}}this.SetRowHeight(t,r)},t.prototype.AutoSizeColumn=function(e,r){void 0===r&&(r=!0),t.measurement_canvas||(t.measurement_canvas=document.createElement("canvas"));var n=t.measurement_canvas.getContext("2d");if(n){var i=12;r||(i=this.GetColumnWidth(e));for(var a=0;a<this.cells.rows;a++){var o=this.CellData({row:a,column:e}),s=o.formatted||"";"string"!=typeof s&&(s=s.map((function(t){return t.text})).join("")),s&&s.length&&(n.font=w.Font(o.style||{}),i=Math.max(i,Math.ceil(n.measureText(s).width)+8))}this.SetColumnWidth(e,i)}},t.prototype.GetStyle=function(t){return this.style_map[t]},t.prototype.InsertRows=function(t,e){var r,n,i,o,s=this;if(void 0===t&&(t=0),void 0===e&&(e=1),t)for(var l=0;l<this.cells.columns;l++){var c=this.cells.GetCell({row:t-1,column:l},!1);if(c&&c.area){var h=this.cells.GetCell({row:t,column:l},!1);if(h&&h.area&&h.area.Equals(c.area))return!1}}e<0?this.cells.DeleteRows(t,-e):this.cells.InsertRows(t,e);for(var f={},d={},p=t;p<this.cells.rows;p++)for(l=0;l<this.cells.columns;l++){var m=this.cells.GetCell({row:p,column:l},!1);m&&(m.area&&!d[m.area.spreadsheet_label]&&(d[m.area.spreadsheet_label]=m.area),m.merge_area&&!f[m.merge_area.spreadsheet_label]&&(f[m.merge_area.spreadsheet_label]=m.merge_area))}var v=function(t){var r=d[t],n=new u({row:r.start.row+e,column:r.start.column},{row:r.end.row+e,column:r.end.column});n.Iterate((function(t){s.cells.GetCell(t,!0).area=n}))};try{for(var y=a(Object.keys(d)),_=y.next();!_.done;_=y.next())v(_.value)}catch(t){r={error:t}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}var g=function(r){var n=f[r],i={row:n.start.row,column:n.start.column};n.start.row>=t&&(i.row+=e);var a=new u(i,{row:n.end.row+e,column:n.end.column});a.Iterate((function(t){s.cells.GetCell(t,!0).merge_area=a}))};try{for(var b=a(Object.keys(f)),x=b.next();!x.done;x=b.next())g(x.value)}catch(t){i={error:t}}finally{try{x&&!x.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}var w=Object.keys(this.row_styles),M={};w.forEach((function(r){var n=Number(r);n<t?M[n]=s.row_styles[n]:e<0&&n<t-e||(M[n+e]=s.row_styles[n])})),this.row_styles=M;var C=[];if(e<0)C=[t,-e];else{C=[t,0];for(var A=0;A<e;A++)C.push(void 0)}return this.cell_style.forEach((function(e){e&&e.length>=t&&e.splice.apply(e,C)})),this.row_height_.splice.apply(this.row_height_,C),this.FlushCellStyles(),!0},t.prototype.InsertColumns=function(t,e){var r,n,i,o,s=this;if(void 0===t&&(t=0),void 0===e&&(e=1),t)for(var l=0;l<this.cells.rows;l++){var c=this.cells.GetCell({row:l,column:t-1},!1);if(c&&c.area){var h=this.cells.GetCell({row:l,column:t},!1);if(h&&h.area&&h.area.Equals(c.area))return!1}}e<0?this.cells.DeleteColumns(t,-e):this.cells.InsertColumns(t,e);for(var f={},d={},p=t;p<this.cells.columns;p++)for(l=0;l<this.cells.rows;l++){var m=this.cells.GetCell({row:l,column:p},!1);m&&(m.area&&!d[m.area.spreadsheet_label]&&(d[m.area.spreadsheet_label]=m.area),m.merge_area&&!f[m.merge_area.spreadsheet_label]&&(f[m.merge_area.spreadsheet_label]=m.merge_area))}var v=function(t){var r=d[t],n=new u({row:r.start.row,column:r.start.column+e},{row:r.end.row,column:r.end.column+e});n.Iterate((function(t){s.cells.GetCell(t,!0).area=n}))};try{for(var y=a(Object.keys(d)),_=y.next();!_.done;_=y.next())v(_.value)}catch(t){r={error:t}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}var g=function(r){var n=f[r],i={row:n.start.row,column:n.start.column};n.start.column>=t&&(i.column+=e);var a=new u(i,{row:n.end.row,column:n.end.column+e});a.Iterate((function(t){s.cells.GetCell(t,!0).merge_area=a}))};try{for(var b=a(Object.keys(f)),x=b.next();!x.done;x=b.next())g(x.value)}catch(t){i={error:t}}finally{try{x&&!x.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}var w=Object.keys(this.column_styles),M={};w.forEach((function(r){var n=Number(r);n<t?M[n]=s.column_styles[n]:e<0&&n<t-e||(M[n+e]=s.column_styles[n])})),this.column_styles=M;var C=[];if(e<0)C=[t,-e];else{C=[t,0];for(var A=0;A<e;A++)C.push(void 0)}return this.cell_style.splice.apply(this.cell_style,C),this.column_width_.splice.apply(this.column_width_,C),this.FlushCellStyles(),!0},t.prototype.ClearArea=function(t){t=this.RealArea(t),this.cells.Apply(t,(function(t){return t.Reset()}))},t.prototype.SetAreaValues2=function(t,e){t=this.RealArea(t),this.cells.SetArea(t,e)},t.prototype.SetArrayValue=function(t,e){t=this.RealArea(t),this.cells.Apply(t,(function(e){return e.SetArray(t)}),!0),this.cells.GetCell(t.start,!0).SetArrayHead(t,e)},t.prototype.SetCellValue=function(t,e){this.cells.GetCell(t,!0).Set(e)},t.prototype.RealArea=function(t,e){void 0===e&&(e=!1);var r=t.start,n=t.end;return t.entire_row&&(r.column=0,r.absolute_column=!1,n.column=this.cells.columns-1,n.absolute_column=!1),t.entire_column&&(r.row=0,r.absolute_row=!1,n.row=this.cells.rows-1,n.absolute_row=!1),e&&(n.row>=this.rows&&(n.row=this.rows-1,n.absolute_row=!1),n.column>=this.columns&&(n.column=this.columns-1,n.absolute_column=!1)),new u(r,n)},t.prototype.FormattedCellValue=function(t){var e=this.CellData(t);if(e)return"string"==typeof e.formatted?e.formatted:e.formatted?e.formatted.map((function(t){switch(t.flag){case 1:case 2:return" ";default:return t.text}})).join(""):e.value},t.prototype.GetFormattedRange=function(t,e){if(void 0===e&&(e=t),t.row===e.row&&t.column===e.column)return this.FormattedCellValue(t);for(var r=[],n=t.row;n<=e.row;n++){for(var i=[],a=t.column;a<=e.column;a++)i.push(this.FormattedCellValue({row:n,column:a}));r.push(i)}return r},t.prototype.NumberFormatsAndColors=function(t,e){var r,n,i,o,s,l,u=function(r){var n,i,a,o,s,l;r.number_format&&(e[r.number_format]=1),(null===(n=r.text)||void 0===n?void 0:n.text)&&"none"!==r.text.text&&(t[r.text.text]=1),(null===(i=r.fill)||void 0===i?void 0:i.text)&&(t[r.fill.text]=1),(null===(a=r.border_top_fill)||void 0===a?void 0:a.text)&&(t[r.border_top_fill.text]=1),(null===(o=r.border_left_fill)||void 0===o?void 0:o.text)&&(t[r.border_left_fill.text]=1),(null===(s=r.border_right_fill)||void 0===s?void 0:s.text)&&(t[r.border_right_fill.text]=1),(null===(l=r.border_bottom_fill)||void 0===l?void 0:l.text)&&(t[r.border_bottom_fill.text]=1)};for(var c in u(this.sheet_style),this.row_styles)u(this.row_styles[c]);for(var c in this.column_styles)u(this.column_styles[c]);try{for(var h=a(this.row_pattern),f=h.next();!f.done;f=h.next())u(_=f.value)}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}try{for(var d=a(this.cell_style),p=d.next();!p.done;p=d.next()){var m=p.value;if(m)try{for(var v=(s=void 0,a(m)),y=v.next();!y.done;y=v.next()){var _;(_=y.value)&&u(_)}}catch(t){s={error:t}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}},t.prototype.toJSON=function(t){var e,r,i,o,s,l,u,c,h,f,d;void 0===t&&(t={});for(var p=function(t,e){for(var r={},n=0;n<t.length;n++)void 0!==t[n]&&t[n]!==e&&(r[n]=t[n]);if(Object.keys(r).length)return r},m=[{}],v={},y=[],_=JSON.stringify({}),g=0;g<this.cell_style.length;g++)if(X=this.cell_style[g]){y[g]=[];for(var b=0;b<X.length;b++)if(X[b]){var x=JSON.stringify(X[b]);if(x!==_){var M=v[x];"number"!=typeof M&&(v[x]=M=m.length,m.push(X[b])),y[g][b]=M}}}m=JSON.parse(JSON.stringify(m));var C=JSON.parse(JSON.stringify(this.sheet_style)),A=JSON.parse(JSON.stringify(this.row_styles)),S=JSON.parse(JSON.stringify(this.column_styles)),R=JSON.parse(JSON.stringify(this.row_pattern)),k=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var r=n(n({},e),t);return r.text?(r.text=L.MeasureColorARGB(r.text),r):"number"==typeof r.theme?r:void 0};if(t.export_colors){var T=[];try{for(var P=a([A,S,m,[C],R]),N=P.next();!N.done;N=P.next()){var E=N.value;if(Array.isArray(E))try{for(var D=(i=void 0,a(E)),O=D.next();!O.done;O=D.next()){var F=O.value;T.push(F)}}catch(t){i={error:t}}finally{try{O&&!O.done&&(o=D.return)&&o.call(D)}finally{if(i)throw i.error}}else try{for(var I=(s=void 0,a(Object.keys(E))),U=I.next();!U.done;U=I.next()){var j=U.value;T.push(E[j])}}catch(t){s={error:t}}finally{try{U&&!U.done&&(l=I.return)&&l.call(I)}finally{if(s)throw s.error}}}}catch(t){e={error:t}}finally{try{N&&!N.done&&(r=P.return)&&r.call(P)}finally{if(e)throw e.error}}try{for(var V=a(T),G=V.next();!G.done;G=V.next()){var z=G.value;z.border_top_fill=k(z.border_top_fill,w.DefaultProperties.border_top_fill),z.border_left_fill=k(z.border_left_fill,w.DefaultProperties.border_top_fill),z.border_right_fill=k(z.border_right_fill,w.DefaultProperties.border_top_fill),z.border_bottom_fill=k(z.border_bottom_fill,w.DefaultProperties.border_top_fill),(null===(d=z.fill)||void 0===d?void 0:d.text)&&(z.fill.text=L.MeasureColorARGB(z.fill.text)),z.text&&z.text.text&&"none"!==z.text.text&&(z.text.text=L.MeasureColorARGB(z.text.text))}}catch(t){u={error:t}}finally{try{G&&!G.done&&(c=V.return)&&c.call(V)}finally{if(u)throw u.error}}}var B={calculated_value:!!t.rendered_values,preserve_type:!!t.preserve_type,expand_arrays:!!t.expand_arrays,decorated_cells:!!t.decorated_cells,nested:!0,cell_style_refs:y},q=this.cells.toJSON(B),J=q.data,H=q.rows,W=q.columns;t.shrink?(H+=2,W+=1):(H=this.rows,W=this.columns);try{for(var Z=a(this.annotations),$=Z.next();!$.done;$=Z.next()){var Y=$.value;Y.extent||this.CalculateAnnotationExtent(Y),Y.extent&&(H=Math.max(H,Y.extent.row+1),W=Math.max(W,Y.extent.column+1))}}catch(t){h={error:t}}finally{try{$&&!$.done&&(f=Z.return)&&f.call(Z)}finally{if(h)throw h.error}}var Q=[];for(g=0;g<y.length;g++){var X;if(X=y[g])for(b=0;b<X.length;b++)X[b]&&Q.push({row:b,column:g,ref:X[b]})}var K={id:this.id,name:this.name,data:J,sheet_style:C,rows:H,columns:W,cell_styles:Q,cell_style_refs:m,row_style:A,column_style:S,row_pattern:R.length?R:void 0,default_row_height:this.default_row_height,default_column_width:this.default_column_width,row_height:p(this.row_height_,this.default_row_height),column_width:p(this.column_width_,this.default_column_width),selection:JSON.parse(JSON.stringify(this.selection)),annotations:JSON.parse(JSON.stringify(this.annotations))};return this.visible||(K.visible=this.visible),(this.scroll_offset.x||this.scroll_offset.y)&&(K.scroll=this.scroll_offset),(this.freeze.rows||this.freeze.columns)&&(K.freeze=this.freeze),K},t.prototype.FlushCellStyles=function(){this.style_map=[],this.style_json_map=[],this.cells.FlushCellStyles()},t.prototype.ImportData=function(t){var e,r,n,i,o=t.styles,s=t.sheet_style;s&&this.UpdateAreaStyle(new u({row:1/0,column:1/0},{row:1/0,column:1/0}),o[s]);var l=t.column_styles;if(l)for(var c=0;c<l.length;c++)l[c]&&this.UpdateAreaStyle(new u({row:1/0,column:c},{row:1/0,column:c}),o[l[c]]);this.cells.FromJSON(t.cells),t.name&&(this.name=t.name||"");var h=this.cell_style;try{for(var f=a(t.cells),d=f.next();!d.done;d=f.next()){var p=d.value;p.style_ref&&(h[p.column]||(h[p.column]=[]),h[p.column][p.row]=o[p.style_ref])}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}for(c=0;c<t.column_widths.length;c++)void 0!==t.column_widths[c]&&this.SetColumnWidth(c,t.column_widths[c]);for(c=0;c<t.row_heights.length;c++)void 0!==t.row_heights[c]&&this.SetRowHeight(c,t.row_heights[c]);try{for(var m=a(t.annotations||[]),v=m.next();!v.done;v=m.next()){var y=v.value;this.annotations.push(new V(y))}}catch(t){n={error:t}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}t.hidden&&(this.visible=!1)},t.prototype.CalculateAnnotationExtent=function(t){var e,r;if(t.layout)t.extent=n({},t.layout.br.address);else{t.extent={row:0,column:0};var i=null===(e=t.rect)||void 0===e?void 0:e.right;if(i&&this.default_column_width)for(var a=0;i>=0&&a<1e3;a++)if((i-=this.GetColumnWidth(a))<0){t.extent.column=a;break}var o=null===(r=t.rect)||void 0===r?void 0:r.bottom;if(o&&this.default_row_height)for(a=0;o>=0&&a<1e3;a++)if((o-=this.GetRowHeight(a))<0){t.extent.row=a;break}}},t.prototype.UpdateSheetStyle=function(t,e){var r,n,i,o,s,l,u,c,h=this;void 0===e&&(e=!0),this.sheet_style=w.Merge(this.sheet_style,t,e);var f=Object.keys(t);try{for(var d=a(this.cell_style),p=d.next();!p.done;p=d.next()){var m=p.value;if(m){var v=function(t){t&&f.forEach((function(e){return delete t[e]}))};try{for(var y=(i=void 0,a(m)),_=y.next();!_.done;_=y.next())v(_.value)}catch(t){i={error:t}}finally{try{_&&!_.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}}}}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}var g=function(t){f.forEach((function(e){return delete h.row_styles[t][e]}))};try{for(var b=a(Object.keys(this.row_styles)),x=b.next();!x.done;x=b.next())g(x.value)}catch(t){s={error:t}}finally{try{x&&!x.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}var M=function(t){f.forEach((function(e){return delete h.column_styles[t][e]}))};try{for(var C=a(Object.keys(this.column_styles)),A=C.next();!A.done;A=C.next())M(A.value)}catch(t){u={error:t}}finally{try{A&&!A.done&&(c=C.return)&&c.call(C)}finally{if(u)throw u.error}}this.FlushCellStyles()},t.prototype.UpdateRowStyle=function(t,e,r){var n,i,o,s;void 0===r&&(r=!0),this.row_styles[t]=w.Merge(this.row_styles[t]||{},e,r);var l=Object.keys(e),c=function(e){e&&e[t]&&l.forEach((function(r){return delete e[t][r]}))};try{for(var h=a(this.cell_style),f=h.next();!f.done;f=h.next())c(f.value)}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}for(var d=0;d<this.cells.columns;d++)if(this.column_styles[d]){var p=this.column_styles[d],m=this.cell_style[d]&&this.cell_style[d][t]||{};try{for(var v=(o=void 0,a(l)),y=v.next();!y.done;y=v.next()){var _=y.value;void 0!==p[_]&&(m[_]=e[_])}}catch(t){o={error:t}}finally{try{y&&!y.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}Object.keys(m).length&&(this.cell_style[d]||(this.cell_style[d]=[]),this.cell_style[d][t]=JSON.parse(JSON.stringify(m)))}this.cells.Apply(this.RealArea(u.FromRow(t)),(function(t){return t.FlushStyle()}))},t.prototype.FlattenStyles=function(){this.CompositeStyleForCell},t.prototype.UpdateColumnStyle=function(t,e,r){var n,i;void 0===r&&(r=!0),this.column_styles[t]=w.Merge(this.column_styles[t]||{},e,r);var o=Object.keys(e);if(this.cell_style[t]){var s=function(t){t&&o.forEach((function(e){return delete t[e]}))};try{for(var l=a(this.cell_style[t]),c=l.next();!c.done;c=l.next())s(c.value)}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}this.cells.Apply(this.RealArea(u.FromColumn(t)),(function(t){return t.FlushStyle()}))},t.prototype.CompositeStyleForCell=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!0);var n=t.row,i=t.column,a=[this.default_style_properties,this.sheet_style];return r&&this.row_pattern.length&&a.push(this.row_pattern[n%this.row_pattern.length]),this.row_styles[n]&&a.push(this.row_styles[n]),this.column_styles[i]&&a.push(this.column_styles[i]),e&&this.cell_style[i]&&this.cell_style[i][n]&&a.push(this.cell_style[i][n]),w.Composite(a)},t.prototype.GetStyleIndex=function(t){for(var e=JSON.stringify(t),r=0;r<this.style_json_map.length;r++)if(e===this.style_json_map[r])return r;var n=this.style_map.length;return this.style_map.push(JSON.parse(e)),this.style_json_map.push(e),n},t.base_id=100,t.default_sheet_name="Sheet1",t}(),z=function(){function t(){this.forward={},this.backward=[]}return t.prototype.Count=function(){return this.backward.length},t.prototype.Serialize=function(){return JSON.parse(JSON.stringify(this.Map()))},t.prototype.Deserialize=function(t){var e,r;if(this.Reset(),t){try{for(var n=a(Object.keys(t)),i=n.next();!i.done;i=n.next()){var o=i.value;this.SetName(o,new u(t[o].start,t[o].end),!1)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.RebuildList()}},t.prototype.MatchSelection=function(t,e){var r,n,i;if(!t.start.sheet_id)throw new Error("match selection without sheet id");try{for(var o=a(this.List()),s=o.next();!s.done;s=o.next()){var l=s.value;if(l.range.start.sheet_id===t.start.sheet_id&&(l.range.Equals(t)&&(i=l.name),null==e?void 0:e.Equals(l.range)))return l.name}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},t.prototype.SetName=function(t,e,r){void 0===r&&(r=!0);var n=this.ValidateNamed(t);return n?e.entire_column||e.entire_row?(console.warn("invalid range"),!1):(this.forward[n]=e,r&&this.RebuildList(),!0):(console.warn("invalid name"),!1)},t.prototype.SetNames=function(t){var e,r;try{for(var n=a(Object.keys(t)),i=n.next();!i.done;i=n.next()){var o=i.value,s=t[o];this.SetName(o,new u(s.start,s.end),!1)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.RebuildList()},t.prototype.ClearName=function(t,e){void 0===e&&(e=!0),delete this.forward[t],e&&this.RebuildList()},t.prototype.Reset=function(){this.forward={},this.backward=[]},t.prototype.Get=function(t){return this.forward[t.toUpperCase()]},t.prototype.Map=function(){return this.forward},t.prototype.List=function(){return this.backward},t.prototype.ValidateNamed=function(t){return!!(t=t.trim()).length&&!/^[A-Za-z]{1,3}\d+$/.test(t)&&!/[^A-Za-z\d_.]/.test(t)&&!/^[^A-Za-z_]/.test(t)&&t.toUpperCase()},t.prototype.PatchNamedRanges=function(t,e,r,n){var i,o,s=this.List().slice(0);try{for(var l=a(s),c=l.next();!c.done;c=l.next()){var h=c.value,f=h.name,d=h.range;if(e&&t<=d.end.column)if(e>0)t<=d.start.column?d.Shift(0,e):t>d.start.column&&t<=d.end.column?d.ConsumeAddress({row:d.end.row,column:d.end.column+e}):console.warn("PNR X case 1",t,e,JSON.stringify(d));else if(e<0)if(t-e<=d.start.column)d.Shift(0,e);else if(t<=d.start.column&&t-e>d.end.column)this.ClearName(f,!1);else if(t<=d.start.column){var p=t-e-1;this.SetName(f,new u({row:d.start.row,column:p+1+e},{row:d.end.row,column:d.end.column+e}),!1)}else t<=d.end.column?(p=t-e-1)>=d.end.column?this.SetName(f,new u({row:d.start.row,column:d.start.column},{row:d.end.row,column:t-1}),!1):this.SetName(f,new u({row:d.start.row,column:d.start.column},{row:d.end.row,column:d.start.column+d.columns+e-1}),!1):console.warn("PNR X case 2",t,e,JSON.stringify(d));if(n&&r<=d.end.row)if(n>0)r<=d.start.row?d.Shift(n,0):r>d.start.row&&r<=d.end.row?d.ConsumeAddress({row:d.end.row+n,column:d.end.column}):console.warn("PNR X case 3",r,n,JSON.stringify(d));else if(n<0)if(r-n<=d.start.row)d.Shift(n,0);else if(r<=d.start.row&&r-n>d.end.row)this.ClearName(f,!1);else if(r<=d.start.row){var m=r-n-1;this.SetName(f,new u({column:d.start.column,row:m+1+n},{column:d.end.column,row:d.end.row+n}),!1)}else r<=d.end.row?(m=r-n-1)>=d.end.row?this.SetName(f,new u({column:d.start.column,row:d.start.row},{column:d.end.column,row:r-1}),!1):this.SetName(f,new u({column:d.start.column,row:d.start.row},{column:d.end.column,row:d.start.row+d.rows+n-1}),!1):console.warn("PNR X case 4",r,n,JSON.stringify(d))}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}this.RebuildList()},t.prototype.RebuildList=function(){var t,e;this.backward=[];try{for(var r=a(Object.keys(this.forward)),n=r.next();!n.done;n=r.next()){var i=n.value;this.backward.push({name:i,range:this.forward[i]})}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t}();!function(t){t.Comma=",",t.Semicolon=";"}(O||(O={})),function(t){t.Period=".",t.Comma=","}(F||(F={}));var B,q,J,H=/[\s-+=<>!()]/,W=48,Z={"==":6,"!=":6,"<>":6,"=":6,"<":7,">":7,"<=":7,">=":7,"+":9,"-":9,"&":9,"*":10,"/":10,"^":11,":":13},$=Object.keys(Z).sort((function(t,e){return e.length-t.length})),Y={"-":100,"+":100},Q=function(){function t(){this.argument_separator=O.Comma,this.decimal_mark=F.Period,this.argument_separator_char=44,this.decimal_mark_char=46,this.imaginary_char=105,this.imaginary_number="i",this.id_counter=0,this.expression="",this.data=[],this.index=0,this.length=0,this.valid=!0,this.dependencies={addresses:{},ranges:{}},this.address_refcount={},this.full_reference_list=[]}return t.prototype.Walk=function(t,e){var r=this;switch(t.type){case"address":case"missing":case"literal":case"complex":case"identifier":case"operator":return void e(t);case"range":return void(e(t)&&(this.Walk(t.start,e),this.Walk(t.end,e)));case"binary":return void(e(t)&&(this.Walk(t.left,e),this.Walk(t.right,e)));case"unary":return void(e(t)&&this.Walk(t.operand,e));case"group":return void(e(t)&&t.elements.forEach((function(t){return r.Walk(t,e)})));case"call":e(t)&&t.args.forEach((function(t){return r.Walk(t,e)}))}},t.prototype.Transpose=function(t){for(var e=t.length,r=[],n=0,i=0;i<e;i++)Array.isArray(t[i])&&(n=Math.max(n,t[i].length));for(i=0;i<n;i++){r[i]=[];for(var a=0;a<e;a++)r[i][a]=t[a][i]}return r},t.prototype.Render=function(t,e,r,n,i,a){var o=this;void 0===e&&(e={rows:0,columns:0}),void 0===r&&(r="(missing)");var s=this.argument_separator+" ";i===O.Comma?s=", ":i===O.Semicolon&&(s="; "),this.imaginary_number;var l=n===F.Comma?",":".",u=this.decimal_mark===F.Comma?/,/:/\./;switch(t.type){case"address":return this.AddressLabel(t,e);case"range":return this.AddressLabel(t.start,e)+":"+this.AddressLabel(t.end,e);case"missing":return r;case"array":return"{"+this.Transpose(t.values).map((function(t){return t.map((function(t){return"string"==typeof t?'"'+t+'"':t})).join(", ")})).join("; ")+"}";case"binary":return this.Render(t.left,e,r,n,i)+" "+t.operator+" "+this.Render(t.right,e,r,n,i);case"unary":return t.operator+this.Render(t.operand,e,r,n,i);case"complex":if(t.real){var c=Math.abs(t.imaginary);return(t.real||0)+(t.imaginary<0?" - ":" + ")+(1===c?"":c)+"i"}return-1===t.imaginary?"-i":1===t.imaginary?"i":t.imaginary+"i";case"literal":if("string"==typeof t.value)return'"'+t.value.replace(/"/g,'""')+'"';if(n&&"number"==typeof t.value){if(t.text){var h=t.text;return n===F.Comma&&this.decimal_mark===F.Period&&(h=h.replace(/,/g,"")),h.replace(u,l)}return t.value.toString().replace(/\./,l)}return t.text?t.text:t.value.toString();case"identifier":return t.name;case"operator":return"["+t.operator+"]";case"group":return t.explicit?"("+t.elements.map((function(t){return o.Render(t,e,r,n,i)})).join(s)+")":t.elements.map((function(t){return o.Render(t,e,r,n,i)})).join(s);case"call":return t.name+"("+t.args.map((function(t){return o.Render(t,e,r,n,i)})).join(s)+")"}return"??"},t.prototype.Parse=function(t){var e,r;switch("="===(t=t.trim())[0]&&(t=t.substr(1).trim()),this.expression=t,this.data=[],this.length=t.length,this.index=0,this.valid=!0,this.error_position=void 0,this.error=void 0,this.dependencies.addresses={},this.dependencies.ranges={},this.address_refcount={},this.full_reference_list=[],this.id_counter=0,this.argument_separator){case O.Semicolon:this.argument_separator_char=59;break;default:this.argument_separator_char=44}switch(this.decimal_mark){case F.Comma:this.decimal_mark_char=44;break;default:this.decimal_mark_char=46}for(var n=0;n<this.length;n++)this.data[n]=t.charCodeAt(n);var i=this.ParseGeneric(),o={};try{for(var s=a(Object.keys(this.dependencies.addresses)),l=s.next();!l.done;l=s.next()){var u=l.value;this.address_refcount[u]&&(o[u]=this.dependencies.addresses[u])}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return this.dependencies.addresses=o,{expression:i||void 0,valid:this.valid,error:this.error,error_position:this.error_position,dependencies:this.dependencies,separator:this.argument_separator,decimal_mark:this.decimal_mark,full_reference_list:this.full_reference_list.slice(0)}},t.prototype.ColumnLabel=function(t){if(t===1/0)return"";for(var e=String.fromCharCode(65+t%26);t>25;)t=Math.floor(t/26)-1,e=String.fromCharCode(65+t%26)+e;return e},t.prototype.AddressLabel=function(t,e){var r=t.column;t.absolute_column||t.column===1/0||(r+=e.columns);var n=t.row;if(t.absolute_row||t.row===1/0||(n+=e.rows),n<0||r<0||n===1/0&&r===1/0)return"#REF";var i="";return t.sheet&&(i=(H.test(t.sheet)?"'"+t.sheet+"'":t.sheet)+"!"),n===1/0?i+(t.absolute_column?"$":"")+this.ColumnLabel(r):r===1/0?i+(t.absolute_row?"$":"")+(n+1):i+(t.absolute_column?"$":"")+this.ColumnLabel(r)+(t.absolute_row?"$":"")+(n+1)},t.prototype.ParseGeneric=function(t){var e=this;void 0===t&&(t=[0]);for(var r=[],n=function(){var e=i.ParseNext(0===r.length);if("number"==typeof e){if(t.some((function(t){return e===t})))return"break";if(40===e){i.index++;var n=i.ParseGeneric([41]);i.index++,n&&r.push({type:"group",id:i.id_counter++,elements:[n],explicit:!0})}else{var a=i.ConsumeOperator();a?r.push(a):(i.error="unexpected character [1]: "+String.fromCharCode(e)+", "+e,i.valid=!1,i.index++)}}else r.push(e)},i=this;this.index<this.length&&"break"!==n(););return r.length&&(r=(r=this.BinaryToRange2(r)).map((function(t){return"identifier"===t.type&&t.name===e.imaginary_number?{type:"complex",real:0,imaginary:1,position:t.position,text:t.name,id:e.id_counter++}:t}))),0===r.length?null:1===r.length?r[0]:this.BinaryToComplex(this.ArrangeUnits(r))},t.prototype.UnitToAddress=function(t){if("literal"===t.type){if("number"==typeof t.value&&t.value>0&&!/\./.test(t.text||""))return{type:"address",position:t.position,label:t.value.toString(),row:t.value-1,id:this.id_counter++,column:1/0}}else{var e=void 0,r=t.name,n=r.split("!");if(n.length>1&&(e=n.slice(0,n.length-1).join("!"),r=r.substr(e.length+1),"'"===e[0])){if(!(e.length>1&&"'"===e[e.length-1]))return;e=e.substr(1,e.length-2)}var i="$"===r[0];r=(i?r.substr(1):r).toUpperCase();var a=Number(r);if(isNaN(a)){if(/[A-Z]{1,3}/.test(r)){for(var o=-1,s=0;s<r.length;s++)o=26*(1+o)+(r[s].charCodeAt(0)-65);return{type:"address",position:t.position,absolute_column:i,label:t.name,column:o,id:this.id_counter++,row:1/0,sheet:e}}}else if(a>0&&a!==1/0&&!/\./.test(r))return{type:"address",position:t.position,absolute_row:i,label:t.name,row:a-1,id:this.id_counter++,column:1/0,sheet:e}}},t.prototype.BinaryToRange2=function(t){for(var e,r=[],i=function(i){var o=t[i],s=t[i+1],l=t[i+2],u=void 0,c="",h=void 0;if(o&&s&&l&&"operator"===s.type&&":"===s.operator)if("address"===o.type&&"address"===l.type){var f=o.position+o.label.length,d=l.position;c=(u={type:"range",id:a.id_counter++,position:o.position,start:o,end:l,label:o.label+a.expression.substring(f,d)+l.label}).start.label+":"+u.end.label,a.address_refcount[u.start.label]--,a.address_refcount[u.end.label]--;var p=[o.position,l.position];a.full_reference_list=a.full_reference_list.filter((function(t){return t.position!==p[0]&&t.position!==p[1]}))}else if(!("literal"!==o.type&&"identifier"!==o.type||"literal"!==l.type&&"identifier"!==l.type)){var m=a.UnitToAddress(o);if(!m&&"literal"===o.type&&"number"==typeof o.value&&o.value<0){var v=n(n({},o),{text:(o.text||"").replace(/^-/,""),position:o.position+1,value:-o.value});(m=a.UnitToAddress(v))&&(h={type:"operator",operator:"-",position:o.position,id:a.id_counter++})}var y=a.UnitToAddress(l);m&&y&&(m.column===1/0&&y.column===1/0||m.row===1/0&&y.row===1/0)&&(c=m.label+":"+y.label,u={type:"range",id:a.id_counter++,position:m.position,start:m,end:y,label:c})}u?(h&&r.push(h),r.push(u),a.dependencies.ranges[c]=u,a.full_reference_list.push(u),i+=2):r.push(o),e=i},a=this,o=0;o<t.length;o++)i(o),o=e;return r},t.prototype.BinaryToComplex=function(t){var e;if("binary"===t.type){if(!("+"!==t.operator&&"-"!==t.operator||"literal"!==t.left.type||"number"!=typeof t.left.value||"complex"!==t.right.type||t.right.composited)){var r;r=this.expression.substring(t.left.position,t.right.position+((null===(e=t.right.text)||void 0===e?void 0:e.length)||0));var i=t.right.imaginary;return"-"===t.operator&&(i=-i),{type:"complex",position:t.left.position,text:r,id:this.id_counter++,imaginary:i,real:t.left.value,composited:!0}}t.left=this.BinaryToComplex(t.left),t.right=this.BinaryToComplex(t.right)}else if("unary"===t.type&&("-"===t.operator||"+"===t.operator)&&"complex"===t.operand.type&&t.operand.text===this.imaginary_number)return n(n({},t.operand),{position:t.position,text:this.expression.substring(t.position,t.operand.position+(t.operand.text||"").length),imaginary:t.operand.imaginary*("-"===t.operator?-1:1)});return t},t.prototype.BinaryToRangeX=function(t){if("binary"===t.type){if(":"===t.operator){var e=void 0,r="";if("address"===t.left.type&&"address"===t.right.type){var n=t.left.position+t.left.label.length,i=t.right.position;r=(e={type:"range",id:this.id_counter++,position:t.left.position,start:t.left,end:t.right,label:t.left.label+this.expression.substring(n,i)+t.right.label}).start.label+":"+e.end.label,this.address_refcount[e.start.label]--,this.address_refcount[e.end.label]--;var a=[t.left.position,t.right.position];this.full_reference_list=this.full_reference_list.filter((function(t){return t.position!==a[0]&&t.position!==a[1]}))}else if(!("literal"!==t.left.type&&"identifier"!==t.left.type||"literal"!==t.right.type&&"identifier"!==t.right.type)){var o=this.UnitToAddress(t.left),s=this.UnitToAddress(t.right);o&&s&&(o.column===1/0&&s.column===1/0||o.row===1/0&&s.row===1/0)&&(r=o.label+":"+s.label,e={type:"range",id:this.id_counter++,position:t.left.position,start:o,end:s,label:r})}if(e)return this.dependencies.ranges[r]=e,this.full_reference_list.push(e),e;this.error="unexpected character: :",this.valid=!1}t.left=this.BinaryToRangeX(t.left),t.right=this.BinaryToRangeX(t.right)}return t},t.prototype.ArrangeUnits=function(t){if(0===t.length)return{type:"missing",id:this.id_counter++};if(1===t.length)return t[0];for(var e=[],r=0;r<t.length;r++){var n=t[r];if("operator"===n.type){if(0!==e.length&&"operator"!==e[e.length-1].type){e.push(n);continue}if(!Y[n.operator])return this.error="unexpected character [2]: "+n.operator,this.error_position=n.position,this.valid=!1,{type:"group",id:this.id_counter++,elements:t,explicit:!1};var i=this.BinaryToComplex(this.ArrangeUnits(t.slice(r+1)));if(!this.valid)return{type:"group",id:this.id_counter++,elements:t,explicit:!1};"binary"===i.type?(i.left={type:"unary",id:this.id_counter++,operator:n.operator,operand:i.left,position:n.position},n=i):n={type:"unary",id:this.id_counter++,operator:n.operator,operand:i,position:n.position},r=t.length}if(e.length<2)e.push(n);else{if("operator"!==e[e.length-1].type)return this.error="multiple expressions",this.error_position=n.position,this.valid=!1,{type:"group",id:this.id_counter++,elements:t,explicit:!1};var a=e[e.length-2],o=e[e.length-1],s=o.operator,l={type:"binary",id:this.id_counter++,left:a,operator:s,position:o.position,right:n};"binary"===a.type&&Z[s]>Z[a.operator]&&(l.left=a.left,l.operator=a.operator,l.position=a.position,l.right={type:"binary",id:this.id_counter++,left:a.right,right:n,operator:s,position:o.position}),e.splice(-2,2,l)}}return e[0]},t.prototype.ParseNext=function(t){void 0===t&&(t=!0),this.ConsumeWhiteSpace();var e=this.data[this.index];if(34===e)return{type:"literal",id:this.id_counter++,position:this.index,value:this.ConsumeString()};if(e>=W&&e<=57||e===this.decimal_mark_char)return this.ConsumeNumber();if(123===e)return this.ConsumeArray();if(!t||45!==e&&43!==e){if(e>=65&&e<=90||e>=97&&e<=122||95===e||39===e||36===e||e>=192&&e<=312)return this.ConsumeToken(e)}else{var r=this.data[this.index+1];if(r>=W&&r<=57||r===this.decimal_mark_char)return this.ConsumeNumber()}return e},t.prototype.ConsumeArray=function(){var t={type:"array",id:this.id_counter++,values:[],position:this.index};this.index++;for(var e=0,r=0;this.index<this.length;){var n=this.ParseNext(),i=this.index;if("number"==typeof n)switch(this.index++,n){case 59:r++,e=0;break;case 44:e++;break;case 125:return t;default:this.valid&&(this.error="invalid character in array literal",this.error_position=i,this.valid=!1)}else switch(n.type){case"literal":t.values[e]||(t.values[e]=[]),t.values[e][r]=n.value;break;default:this.valid&&(this.error="invalid value in array literal",this.error_position=i,this.valid=!1)}}return t},t.prototype.ConsumeOperator=function(){var t,e;try{for(var r=a($),n=r.next();!n.done;n=r.next()){var i=n.value;if(this.expression.substr(this.index,i.length)===i){var o=this.index;return this.index+=i.length,{type:"operator",id:this.id_counter++,operator:i,position:o}}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return null},t.prototype.ConsumeArguments=function(){this.index++;for(var t=0,e=[];this.index<this.length;){var r=this.ParseGeneric([this.argument_separator_char,41]);null!==r&&e.push(r);var n=this.data[this.index];if(n===this.argument_separator_char){this.index++,t++;for(var i=e.length;i<t;i++)e.push({type:"missing",id:this.id_counter++})}else if(41===n)return this.index++,e}return e},t.prototype.ConsumeToken=function(t){var e=[t],r=this.index,n=39===t;for(++this.index;this.index<this.length;this.index++){var i=this.data[this.index];if(!(i>=65&&i<=90||i>=97&&i<=122||i>=192&&i<=312||95===i||36===i||46===i||33===i||n||i>=W&&i<=57))break;e.push(i),39===i&&(n=!1)}var a=e.map((function(t){return String.fromCharCode(t)})).join("");if(n)return this.error="unbalanced single quote",this.error_position=r,this.valid=!1,{type:"identifier",id:this.id_counter++,name:a,position:r};if("true"===a.toLowerCase())return{type:"literal",id:this.id_counter++,value:!0,position:r};if("false"===a.toLowerCase())return{type:"literal",id:this.id_counter++,value:!1,position:r};if(this.ConsumeWhiteSpace(),40===this.data[this.index]){var o=this.ConsumeArguments();return{type:"call",id:this.id_counter++,name:a,args:o,position:r}}var s=this.ConsumeAddress(a,r);if(s)return s;var l={type:"identifier",id:this.id_counter++,name:a,position:r};return this.full_reference_list.push(l),l},t.prototype.ConsumeAddress=function(t,e){var r,n=e,i=t.length,a=t.split("!");a.length>1&&(e+=(r=a.slice(0,a.length-1).join("!")).length+1);var o=this.ConsumeAddressColumn(e);if(!o)return null;e=o.position;var s=this.ConsumeAddressRow(e);if(!s)return null;e=s.position;var l=r?r+t.substr(r.length,e-n).toUpperCase():t.substr(0,e-n).toUpperCase();r&&"'"===r[0]&&(r=r.substr(1,r.length-2));var u={type:"address",id:this.id_counter++,label:l,row:s.row,column:o.column,absolute_row:s.absolute,absolute_column:o.absolute,position:n,sheet:r};return i!==e-n?null:(this.dependencies.addresses[u.label]=u,this.address_refcount[u.label]=(this.address_refcount[u.label]||0)+1,this.full_reference_list.push(u),u)},t.prototype.ConsumeAddressRow=function(t){var e=36===this.data[t];e&&t++;for(var r=t,n=0;;t++){var i=this.data[t];if(!(i>=W&&i<=57))break;n*=10,n+=i-W}return r!==t&&{absolute:e,row:n-1,position:t}},t.prototype.ConsumeAddressColumn=function(t){var e=-1,r=0,n=36===this.data[t];for(n&&t++;;t++,r++){if(r>=4)return!1;var i=this.data[t];if(i>=65&&i<=90)e=26*(1+e)+(i-65);else{if(!(i>=97&&i<=122))break;e=26*(1+e)+(i-97)}}return!(e<0)&&{absolute:n,column:e,position:t}},t.prototype.ConsumeNumber=function(){for(var t=this.index,e=0,r=!1,n=!1,i=0,a=0,o=0,s="integer",l=0,u=!1,c=this.index;this.index<this.length;this.index++,l++){var h=this.data[this.index];if(h===this.decimal_mark_char){if("integer"!==s)break;s="fraction"}else{if(37===h){i/=100,o/=100,this.index++;break}if(43===h||45===h){if(0!==l)break;45===h&&(n=!0)}else if(69===h||101===h){if("integer"!==s&&"fraction"!==s)break;s="exponent",this.index<this.length-1&&(43===this.data[this.index+1]?this.index++:45===this.data[this.index+1]&&(this.index++,r=!0))}else if(h===this.imaginary_char){if("integer"===s||"fraction"===s){this.index++,u=!0;break}}else{if(!(h>=W&&h<=57))break;switch(s){case"integer":i=10*i+(h-W);break;case"fraction":o=10*o+(h-W),a++;break;case"exponent":e=10*e+(h-W)}}}}var f=i+o/Math.pow(10,a);return"exponent"===s&&(f*=Math.pow(10,(r?-1:1)*e)),u?{type:"complex",id:this.id_counter++,position:t,imaginary:n?-f:f,real:0,text:this.expression.substring(c,this.index)||""}:{type:"literal",id:this.id_counter++,position:t,value:n?-f:f,text:this.expression.substring(c,this.index)||""}},t.prototype.ConsumeString=function(){this.index++;for(var t=[];this.index<this.length;this.index++){var e=this.data[this.index];if(34===e&&(this.index++,this.index>=this.length||34!==this.data[this.index]))break;t.push(e)}return t.map((function(t){return String.fromCharCode(t)})).join("")},t.prototype.ConsumeWhiteSpace=function(){for(;this.index<this.length;){var t=this.data[this.index];if(32!==t&&9!==t&&10!==t&&13!==t&&160!==t)return;this.index++}},t}();!function(t){t[t.default=0]="default",t[t.quoted=1]="quoted"}(B||(B={})),(J=q||(q={}))[J.white=0]="white",J[J.gray=1]="gray",J[J.black=2]="black";var X,K=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.dirty=!1,e}return e(r,t),r}(function(){function t(){this.type=t.type,this.color=q.white,this.edges_in=[],this.edges_out=[]}return Object.defineProperty(t.prototype,"has_inbound_edges",{get:function(){return this.edges_in.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"has_outbound_edges",{get:function(){return this.edges_out.length>0},enumerable:!1,configurable:!0}),t.prototype.Reset=function(){var t,e,r,n;try{for(var i=a(this.edges_out),o=i.next();!o.done;o=i.next())o.value.RemoveDependency(this)}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}try{for(var s=a(this.edges_in),l=s.next();!l.done;l=s.next())l.value.RemoveDependent(this)}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.edges_out=[],this.edges_in=[]},t.prototype.ClearDependencies=function(){var t,e;try{for(var r=a(this.edges_in),n=r.next();!n.done;n=r.next())n.value.RemoveDependent(this)}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.edges_in=[]},t.prototype.AddDependent=function(t){var e,r;if(t!==this){try{for(var n=a(this.edges_out),i=n.next();!i.done;i=n.next())if(i.value===t)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.edges_out.push(t)}},t.prototype.RemoveDependent=function(t){this.edges_out=this.edges_out.filter((function(e){return e!==t}))},t.prototype.AddDependency=function(t){var e,r;if(t!==this){try{for(var n=a(this.edges_in),i=n.next();!i.done;i=n.next())if(i.value===t)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.edges_in.push(t)}},t.prototype.RemoveDependency=function(t){this.edges_in=this.edges_in.filter((function(e){return e!==t}))},t.prototype.LinkTo=function(t){this.AddDependent(t),t.AddDependency(this)},t.prototype.DependsOn=function(t){this.AddDependency(t),t.AddDependent(this)},t.prototype.LoopCheck=function(){var t,e;this.color=q.gray;for(var r=[this];r.length;){var n=r[r.length-1],i=!0;if(n.color!==q.black)try{for(var o=(t=void 0,a(n.edges_out)),s=o.next();!s.done;s=o.next()){var l=s.value;if(l.color===q.gray)return this.color=q.white,!0;l.color===q.white&&(l.color=q.gray,r.push(l),i=!1)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}i&&(r.pop(),n.color=q.black)}return this.color=q.black,!1},t.type="vertex",t}());!function(t){t[t.None=0]="None",t[t.CalculationError=1]="CalculationError"}(X||(X={}));var tt,et=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.error=X.None,e.result=m(),e.expression={type:"missing",id:-1},e.expression_error=!1,e.short_circuit=!1,e.type=r.type,e}return e(r,t),Object.defineProperty(r.prototype,"array_head",{get:function(){return!!this.address&&!!this.reference&&!!this.reference.area&&this.reference.area.start.column===this.address.column&&this.reference.area.start.row===this.address.row},enumerable:!1,configurable:!0}),r.prototype.TakeReferenceValue=function(){this.reference&&(this.result=v(this.reference.GetValue()))},r.prototype.Calculate=function(t){var e,r,n,i,o,s;if(this.dirty)if(this.color===q.white&&this.LoopCheck()&&(this.dirty=!1,this.edges_in.length)){this.reference&&(this.array_head||this.reference.type===l.formula)&&this.reference.SetCalculationError("LOOP");try{for(var u=a(this.edges_out),c=u.next();!c.done;c=u.next())(y=c.value).Calculate(t)}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}}else{try{for(var h=a(this.edges_in),f=h.next();!f.done;f=h.next())if((y=f.value).dirty)return}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}if(this.reference){if(this.reference.type===l.formula){this.short_circuit=!1;var d=t.CalculationCallback.call(t,this);if(this.result=d.value,this.short_circuit)return;d.volatile&&t.volatile_list.push(this)}else this.result=this.reference.GetValue4();if(this.array_head)t.SpreadCallback.call(t,this,this.result);else if(this.reference.type===l.formula){var p=Array.isArray(this.result)?this.result[0][0]:this.result;this.reference.SetCalculatedValue(p.value,p.type)}}else console.info("skip dirty constant? [or dangling...]");this.dirty=!1;try{for(var m=a(this.edges_out),v=m.next();!v.done;v=m.next()){var y;(y=v.value).dirty&&t.calculation_list.push(y)}}catch(t){o={error:t}}finally{try{v&&!v.done&&(s=m.return)&&s.call(m)}finally{if(o)throw o.error}}}},r.type="spreadsheet-vertex",r}(K),rt=function(t){function r(e){var n=t.call(this)||this;return n.type=r.type,n.area=e.Clone(),r.list.push(n),n}return e(r,t),r.GetVertex=function(t){var e,n;try{for(var i=a(this.list),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.area.start.sheet_id===t.start.sheet_id&&s.area.Equals(t))return[s,!1]}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return[new r(t),!0]},r.Clear=function(){this.list=[]},r.GetContainingArrays=function(t){var e,r,n=[];try{for(var i=a(this.list),o=i.next();!o.done;o=i.next()){var s=o.value;s.area.start.sheet_id===t.sheet_id&&s.area.Contains(t)&&n.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},r.CreateImplicitEdges=function(t,e){var r,n;try{for(var i=a(this.list),o=i.next();!o.done;o=i.next()){var s=o.value;s.area.start.sheet_id===e.sheet_id&&s.area.Contains(e)&&s.DependsOn(t)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},r.prototype.RemoveDependent=function(e){var n=this;t.prototype.RemoveDependent.call(this,e),this.edges_out.length||(this.Reset(),r.list=r.list.filter((function(t){return t!==n})))},r.prototype.Calculate=function(t){var e,r,n,i,o,s;if(this.dirty)if(this.color===q.white&&this.LoopCheck()&&(this.dirty=!1,this.edges_in.length))try{for(var l=a(this.edges_out),u=l.next();!u.done;u=l.next())u.value.Calculate(t)}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}else{try{for(var c=a(this.edges_in),h=c.next();!h.done;h=c.next())if(h.value.dirty)return}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}this.dirty=!1;try{for(var f=a(this.edges_out),d=f.next();!d.done;d=f.next())d.value.Calculate(t)}catch(t){o={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}}},r.type="array-vertex",r.list=[],r}(K);!function(t){t[t.OK=0]="OK",t[t.Loop=1]="Loop",t[t.CalculationError=2]="CalculationError"}(tt||(tt={}));var nt,it=function(){function t(){this.vertices=[[]],this.volatile_list=[],this.calculation_list=[],this.cells_map={},this.leaf_vertices=[],this.dirty_list=[],this.loop_check_required=!1}return t.prototype.IsSpreadsheetVertex=function(t){return t.type===et.type},t.prototype.AttachData=function(t){var e,r;this.model=t,this.cells_map={};try{for(var n=a(t.sheets),i=n.next();!i.done;i=n.next()){var o=i.value;this.cells_map[o.id]=o.cells}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.FlushTree=function(){this.dirty_list=[],this.volatile_list=[],this.vertices=[[]],this.leaf_vertices=[],this.cells_map={},rt.Clear()},t.prototype.ResolveArrayHead=function(t){if(!t.sheet_id)throw new Error("resolve array head with no sheet id");var e=this.cells_map[t.sheet_id];if(!e)throw new Error("no cells? sheet id "+t.sheet_id);var r=e.data[t.row];if(r){var n=r[t.column];if(n&&n.area){var i={row:n.area.start.row,column:n.area.start.column,sheet_id:t.sheet_id};return console.info("array head",t,i),i}}return t},t.prototype.GetVertex=function(t,e){if(!t.sheet_id)throw new Error("getvertex with no sheet id");var r=this.cells_map[t.sheet_id];if(!r)throw new Error("no cells? sheet id "+t.sheet_id);if(!this.vertices[t.sheet_id]){if(!e)return;this.vertices[t.sheet_id]=[]}if(this.vertices[t.sheet_id][t.column]){var n=this.vertices[t.sheet_id][t.column][t.row];if(n)return n;if(!e)return}else{if(!e)return;this.vertices[t.sheet_id][t.column]=[]}var i=new et;return i.address={row:t.row,column:t.column,absolute_row:t.absolute_row,absolute_column:t.absolute_column,sheet_id:t.sheet_id},i.reference=r.EnsureCell(t),this.vertices[t.sheet_id][t.column][t.row]=i,rt.CreateImplicitEdges(i,t),i},t.prototype.RemoveVertex=function(t){if(!t.sheet_id)throw new Error("removevertex with no sheet id");var e=this.GetVertex(t,!1);e&&(e.Reset(),this.vertices[t.sheet_id][t.column][t.row]=void 0)},t.prototype.ResetVertex=function(t){var e=this.GetVertex(t,!1);e&&e.Reset()},t.prototype.ResetInbound=function(t,e,r,n){var i,o;void 0===e&&(e=!1),void 0===r&&(r=!0),void 0===n&&(n=!1);var s=this.GetVertex(t,r);if(s)s.ClearDependencies(),e&&this.SetVertexDirty(s),n&&this.RemoveVertex(t);else if(e){var l=rt.GetContainingArrays(t);try{for(var u=a(l),c=u.next();!c.done;c=u.next()){var h=c.value;this.SetVertexDirty(h)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}},t.prototype.ResetLoopState=function(){var t,e,r,n,i,o,s,l;try{for(var u=a(this.vertices),c=u.next();!c.done;c=u.next()){var h=c.value;if(h)try{for(var f=(r=void 0,a(h)),d=f.next();!d.done;d=f.next()){var p=d.value;if(p)try{for(var m=(i=void 0,a(p)),v=m.next();!v.done;v=m.next())(g=v.value)&&(g.color=g.edges_out.length?q.white:q.black)}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var y=a(this.leaf_vertices),_=y.next();!_.done;_=y.next()){var g;(g=_.value).color=q.black}}catch(t){s={error:t}}finally{try{_&&!_.done&&(l=y.return)&&l.call(y)}finally{if(s)throw s.error}}},t.prototype.LoopCheck=function(t){var e,r,n,i,o,s,l,u,c,h;if(void 0===t&&(t=!1),!this.loop_check_required&&!t)return!1;var f=[];try{for(var d=a(this.vertices),p=d.next();!p.done;p=d.next()){var m=p.value;if(m)try{for(var v=(n=void 0,a(m)),y=v.next();!y.done;y=v.next()){var _=y.value;if(_)try{for(var g=(o=void 0,a(_)),b=g.next();!b.done;b=g.next())(C=b.value)&&(C.color=C.edges_out.length?q.white:q.black,f.push(C))}catch(t){o={error:t}}finally{try{b&&!b.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{y&&!y.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}var x=[];try{for(var w=a(f),M=w.next();!M.done;M=w.next()){var C;if((C=M.value).color===q.white){for(C.color=q.gray,x.push(C);x.length;){var A=x[x.length-1],S=!0;if(A.color!==q.black)try{for(var R=(c=void 0,a(A.edges_out)),k=R.next();!k.done;k=R.next()){var T=k.value;if(T.color===q.gray)return this.loop_hint=this.RenderAddress(C.address),console.info("loop detected @",this.loop_hint),!0;T.color===q.white&&(T.color=q.gray,x.push(T),S=!1)}}catch(t){c={error:t}}finally{try{k&&!k.done&&(h=R.return)&&h.call(R)}finally{if(c)throw c.error}}S&&(x.pop(),A.color=q.black)}C.color=q.black}}}catch(t){l={error:t}}finally{try{M&&!M.done&&(u=w.return)&&u.call(w)}finally{if(l)throw l.error}}return this.loop_check_required=!1,this.loop_hint=void 0,!1},t.prototype.RenderAddress=function(t){var e,r;if(!t)return"undefined";var n="";if(t.sheet_id&&this.model)try{for(var i=a(this.model.sheets),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.sheet_id===s.id){n=s.name+"!";break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n+new u(t).spreadsheet_label},t.prototype.AddArrayEdge=function(t,e){var r,n;if(!t.start.sheet_id)throw new Error("AddArrayEdge called without sheet ID");var i=this.GetVertex(e,!0),s=o(rt.GetVertex(t),2),l=s[0],u=s[1];if(i.DependsOn(l),this.loop_check_required=!0,u){var c=this.vertices[t.start.sheet_id];if(c)if(t.entire_row){for(var h=0;h<c.length;h++)if(c[h])for(var f=t.start.row;f<=t.end.row;f++)(m=c[h][f])&&l.DependsOn(m);console.groupEnd()}else if(t.entire_column){for(h=t.start.column;h<=t.end.column;h++)if(c[h])try{for(var d=(r=void 0,a(c[h])),p=d.next();!p.done;p=d.next())(null==(m=p.value)?void 0:m.address)&&l.DependsOn(m)}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}console.groupEnd()}else for(f=t.start.row;f<=t.end.row;f++)for(h=t.start.column;h<=t.end.column;h++){var m;(m=c[h][f])&&l.DependsOn(m)}}},t.prototype.AddEdge=function(t,e){var r=this.GetVertex(t,!0);this.GetVertex(e,!0).DependsOn(r),r.reference&&r.reference.area&&!r.array_head&&this.AddEdge(n(n({},t),{row:r.reference.area.start.row,column:r.reference.area.start.column}),e),this.loop_check_required=!0},t.prototype.RemoveEdge=function(t,e){var r=this.GetVertex(t,!1),n=this.GetVertex(e,!1);r&&n&&(r.RemoveDependent(n),n.RemoveDependency(r))},t.prototype.SetAreaDirty=function(t){if(t.start.column===1/0||t.end.column===1/0||t.start.row===1/0||t.end.row===1/0)throw new Error("don't iterate over infinite area");var e=t.start.sheet_id;if(!e)throw new Error("invalid area, missing sheet id");for(var r=t.start.column;r<=t.end.column;r++)for(var n=t.start.row;n<=t.end.row;n++){var i={row:n,column:r,sheet_id:e};this.GetVertex(i,!1)&&this.SetDirty(i)}},t.prototype.SetVertexDirty=function(t){var e,r;if(!t.dirty){this.dirty_list.push(t),t.dirty=!0;try{for(var n=a(t.edges_out),i=n.next();!i.done;i=n.next()){var o=i.value;this.SetVertexDirty(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}},t.prototype.SetDirty=function(t){var e=this.GetVertex(t,!0);this.SetVertexDirty(e)},t.prototype.AddLeafVertex=function(t){var e,r;try{for(var n=a(this.leaf_vertices),i=n.next();!i.done;i=n.next())if(i.value===t)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.leaf_vertices.push(t)},t.prototype.RemoveLeafVertex=function(t){this.leaf_vertices=this.leaf_vertices.filter((function(e){return e!==t}))},t.prototype.AddLeafVertexEdge=function(t,e){var r=this.GetVertex(t,!0);return e.DependsOn(r),tt.OK},t.prototype.RemoveLeafVertexEdge=function(t,e){var r=this.GetVertex(t,!1);r&&(r.RemoveDependent(e),e.RemoveDependency(r))},t.prototype.InitializeGraph=function(){var t,e;try{for(var r=a(this.dirty_list),n=r.next();!n.done;n=r.next()){var i=n.value;this.IsSpreadsheetVertex(i)&&(i.TakeReferenceValue(),this.CheckVolatile(i)&&this.volatile_list.push(i)),i.dirty=!1}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.dirty_list=[]},t.prototype.Recalculate=function(){var t,e;try{for(var r=a(this.volatile_list),n=r.next();!n.done;n=r.next()){var i=n.value;this.SetVertexDirty(i)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.calculation_list=this.dirty_list.slice(0),this.volatile_list=[],this.dirty_list=[],this.loop_check_required&&(this.ResetLoopState(),this.loop_check_required=!1);for(var o=0;o<this.calculation_list.length;o++)this.calculation_list[o].Calculate(this);this.calculation_list=[]},t}();!function(t){t.Argument="ARG",t.Data="DATA",t.Reference="REF",t.Name="NAME",t.Expression="EXPR",t.Value="VALUE",t.Unknown="UNK",t.NotImpl="NOTIMPL",t.Div0="DIV/0",t.NA="N/A"}(nt||(nt={}));var at,ot={error:nt.NotImpl},st=function(){return{type:l.error,value:nt.Expression}},lt=function(){return{type:l.error,value:nt.Data}},ut=function(){return{type:l.error,value:nt.Div0}},ct=function(){return{type:l.error,value:nt.Argument}},ht=function(){return{type:l.error,value:nt.Value}},ft=function(){return{type:l.error,value:nt.Reference}},dt=function(){return{type:l.error,value:nt.Name}},pt=function(){return{type:l.error,value:nt.Unknown}};!function(t){t[t.value=0]="value",t[t.reference=1]="reference"}(at||(at={}));var mt,vt=function(t){return{r:Math.sqrt(t.real*t.real+t.imaginary*t.imaginary),theta:Math.atan2(t.imaginary,t.real)}},yt=function(t,e){return{real:t.real*e.real-t.imaginary*e.imaginary,imaginary:t.real*e.imaginary+t.imaginary*e.real}},_t=function(t,e){for(var r=[],n=0;n<t.m;n++){for(var i=[],a=0;a<e.n;a++){for(var o=0,s=0;s<t.n;s++)o+=t.array[n][s]*e.array[s][a];i.push(o)}r.push(i)}return{array:r,m:t.m,n:e.n}},gt=function(t){var e={real:0,imaginary:0},r=t.n;if(2==r){var i=yt(t.array[0][0],t.array[1][1]),a=yt(t.array[1][0],t.array[0][1]);return{real:i.real-a.real,imaginary:i.imaginary-a.imaginary}}for(var o=function(t){for(var e={m:t,n:t,array:[]},r=0;r<t;r++){for(var n=[],i=0;i<t;i++)n.push({real:0,imaginary:0});e.array.push(n)}return e}(t.n),s=0;s<r;s++){for(var l=0,u=1;u<r;u++){for(var c=0,h=0;h<r;h++)h!=s&&(o.array[l][c]=n({},t.array[u][h]),c++);l++}o.m=o.n=r-1;var f=Math.pow(-1,s),d=yt({real:t.array[0][s].real*f,imaginary:t.array[0][s].imaginary*f},gt(o));e.real+=d.real,e.imaginary+=d.imaginary}return e},bt=function(t){if(t.m===t.n){var e,r,n,i,a=function(t){var e=t.array.map((function(t){return t.slice(0)}));return{m:t.m,n:t.n,array:e}}(t),o=a.array,s=t.m;for(r=1;r<s;r++)o[0][r]/=o[0][0];for(r=1;r<s;r++){for(n=r;n<s;n++){for(e=0,i=0;i<r;i++)e+=o[n][i]*o[i][r];o[n][r]-=e}if(r!=s-1)for(n=r+1;n<s;n++){for(e=0,i=0;i<r;i++)e+=o[r][i]*o[i][n];o[r][n]=(o[r][n]-e)/o[r][r]}}for(r=0;r<s;r++)for(n=r;n<s;n++){var l=1;if(r!=n)for(l=0,i=r;i<n;i++)l-=o[n][i]*o[i][r];o[n][r]=l/o[n][n]}for(r=0;r<s;r++)for(n=r;n<s;n++)if(r!=n){for(e=0,i=r;i<n;i++)e+=o[i][n]*(r==i?1:o[r][i]);o[r][n]=-e}for(r=0;r<s;r++)for(n=0;n<s;n++){for(e=0,i=r>n?r:n;i<s;i++)e+=(n==i?1:o[n][i])*o[i][r];o[n][r]=e}return a}},xt=function(t){var e=t.real||0,r=t.imaginary||0;return yt({real:Math.exp(e),imaginary:0},{real:Math.cos(r),imaginary:Math.sin(r)})},wt=function(t,e){if(e.imaginary)return xt(yt(e,function(t){var e=vt(t);return{real:Math.log(e.r),imaginary:e.theta}}(t)));var r=vt(t);return function(t){var e=t.r,r=t.theta;return{real:e*Math.cos(r),imaginary:e*Math.sin(r)}}({r:Math.pow(r.r,e.real),theta:r.theta*e.real})},Mt=function(t,e){return void 0===e&&(e=0),t&&t.type===l.complex?t:{type:l.complex,value:{real:e,imaginary:0}}},Ct=function(t){return t.imaginary?{type:l.complex,value:t}:{type:l.number,value:t.real}},At=function(t,e){if(t.type===l.error)return[0,0,t];if(e.type===l.error)return[0,0,e];var r=[0,0];switch(t.type){case l.number:r[0]=t.value;break;case l.boolean:r[0]=t.value?1:0;break;case l.undefined:break;case l.complex:r[3]=t;break;default:return[0,0,ht()]}switch(e.type){case l.number:r[1]=e.value;break;case l.boolean:r[1]=e.value?1:0;break;case l.undefined:break;case l.complex:r[4]=e;break;default:return[0,0,ht()]}return(r[3]||r[4])&&(r[3]=Mt(r[3],r[0]),r[4]=Mt(r[4],r[1])),r},St=function(t,e){var r=o(At(t,e),5),n=r[0],i=r[1],a=r[2],s=r[3],u=r[4];return a||(s&&u?Ct({real:s.value.real+u.value.real,imaginary:s.value.imaginary+u.value.imaginary}):{value:n+i,type:l.number})},Rt=function(t,e){var r=o(At(t,e),5),n=r[0],i=r[1],a=r[2],s=r[3],u=r[4];return a||(s&&u?Ct({real:s.value.real-u.value.real,imaginary:s.value.imaginary-u.value.imaginary}):{value:n-i,type:l.number})},kt=function(t,e){var r=o(At(t,e),5),n=r[0],i=r[1],a=r[2],s=r[3],u=r[4];if(a)return a;if(s&&u)return Ct(wt(s.value,u.value));var c=Math.pow(n,i);return isNaN(c)?ht():{type:l.number,value:c}},Tt=function(t,e){var r=o(At(t,e),5),n=r[0],i=r[1],a=r[2],s=r[3],u=r[4];return a||(s&&u?Ct(yt(s.value,u.value)):{value:n*i,type:l.number})},Pt=function(t,e){var r=o(At(t,e),5),n=r[0],i=r[1],a=r[2],s=r[3],u=r[4];return a||(s&&u?0===u.value.real&&0===u.value.imaginary?ut():Ct(function(t,e){var r={real:e.real,imaginary:-e.imaginary},n=yt(t,r),i=yt(e,r);return{real:n.real/i.real,imaginary:n.imaginary/i.real}}(s.value,u.value)):0===i?ut():{value:n/i,type:l.number})},Nt=function(t,e){var r=o(At(t,e),3),n=r[0],i=r[1];return r[2]||(0===i?ut():{value:n%i,type:l.number})},Et=function(t,e){return t.type===l.error?t:e.type===l.error?e:{type:l.string,value:""+(t.type===l.undefined?"":t.value)+(e.type===l.undefined?"":e.value)}},Dt=function(t,e){if(t.type===l.error)return t;if(e.type===l.error)return e;if(t.type===l.undefined&&(""===e.value||0===e.value||e.type===l.complex&&0===e.value.real&&0===e.value.complex)||e.type===l.undefined&&(""===t.value||0===t.value||t.type===l.complex&&0===t.value.real&&0===t.value.complex))return{type:l.boolean,value:!0};if(t.type===l.complex||e.type===l.complex){var r=!1;return t.type===e.type?r=t.value.real==e.value.real&&t.value.imaginary==e.value.imaginary:t.type===l.number?r=e.value.real==t.value&&!e.value.imaginary:e.type===l.number&&(r=t.value.real==e.value&&!t.value.imaginary),{type:l.boolean,value:r}}return{type:l.boolean,value:t.value==e.value}},Ot=function(t,e){var r=Dt(t,e);return{type:l.boolean,value:!r.value}},Ft=function(t,e){return t.type===l.error?t:e.type===l.error?e:t.type===l.complex||e.type===l.complex?ht():{type:l.boolean,value:(t.value||0)>(e.value||0)}},It=function(t,e){return t.type===l.error?t:e.type===l.error?e:t.type===l.complex||e.type===l.complex?ht():{type:l.boolean,value:t.value>=e.value}},Lt=function(t,e){return t.type===l.error?t:e.type===l.error?e:t.type===l.complex||e.type===l.complex?ht():{type:l.boolean,value:t.value<e.value}},Ut=function(t,e){return t.type===l.error?t:e.type===l.error?e:t.type===l.complex||e.type===l.complex?ht():{type:l.boolean,value:t.value<=e.value}},jt=function(t){return!Array.isArray(t)&&t.type===l.object&&!!t.value.type},Vt=function(t){return!Array.isArray(t)&&t.type===l.object&&"metadata"===t.value.type},Gt=function(){function t(t,e){this.library=t,this.parser=e,this.context={address:{row:-1,column:-1},volatile:!1,call_index:0},this.call_index=0,this.cells_map={},this.sheet_name_map={},this.named_range_map={}}return t.prototype.SetModel=function(t){var e,r;this.cells_map={},this.sheet_name_map={};try{for(var n=a(t.sheets),i=n.next();!i.done;i=n.next()){var o=i.value;this.cells_map[o.id]=o.cells,this.sheet_name_map[o.name.toLowerCase()]=o.id}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.data_model=t,this.named_range_map=t.named_ranges.Map(),this.context.model=t},t.prototype.Calculate=function(t,e,r){return void 0===r&&(r=!1),r||(this.context.address=e,this.context.volatile=!1,this.context.call_index=0,this.call_index=0),{value:this.CalculateExpression(t),volatile:this.context.volatile}},t.prototype.CellFunction2=function(t){if(!t.sheet_id){if(!t.sheet)return function(){return ft()};t.sheet_id=this.sheet_name_map[t.sheet.toLowerCase()]}var e=this.cells_map[t.sheet_id];if(!e)return console.warn("missing cells reference @ "+t.sheet_id),function(){return ft()};var r=e.GetCell(t);return r?function(){return r.GetValue4()}:function(){return{type:l.undefined,value:void 0}}},t.prototype.CellFunction4=function(t,e){if(!t.sheet_id)throw new Error("missing sheet id in CellFunction4");return this.cells_map[t.sheet_id].GetRange4(t,e,!0)},t.prototype.GetMetadata=function(t,e){var r,i,o,s,u,c;switch(t.type){case"address":u=t;break;case"range":c=t;break;case"identifier":var h=this.named_range_map[t.name.toUpperCase()];h&&(1===h.count?u=h.start:c=h);break;case"call":var f=this.CalculateExpression(t,!0);if(!jt(f))return f;if("address"===f.value.type)u=f.value;else{if("range"!==f.value.type)return f;c=f.value}break;default:return this.CalculateExpression(t)}if(u){var d=this.data_model.active_sheet;if(u.sheet_id&&u.sheet_id!==d.id)try{for(var p=a(this.data_model.sheets),m=p.next();!m.done;m=p.next())if((b=m.value).id===u.sheet_id){d=b;break}}catch(t){r={error:t}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}var v=(A=d.CellData(u)).calculated_type?A.calculated:A.value,y=n({type:"metadata",address:n({},u),value:v,format:A.style?A.style.number_format:void 0},e(A,u));return{type:l.object,value:y}}if(c){if(c.start.row===1/0||c.start.column===1/0)return ft();if(d=this.data_model.active_sheet,c.start.sheet_id&&c.start.sheet_id!==d.id)try{for(var _=a(this.data_model.sheets),g=_.next();!g.done;g=_.next()){var b;if((b=g.value).id===c.start.sheet_id){d=b;break}}}catch(t){o={error:t}}finally{try{g&&!g.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}for(var x=[],w=c.start.column;w<=c.end.column;w++){for(var M=[],C=c.start.row;C<=c.end.row;C++){var A=d.CellData({row:C,column:w});u=n(n({},c.start),{row:C,column:w}),v=A.calculated_type?A.calculated:A.value,y=n({type:"metadata",address:u,value:v,format:A.style?A.style.number_format:void 0},e(A,u)),M.push({type:l.object,value:y})}x.push(M)}return x}return this.CalculateExpression(t)},t.prototype.RewriteMacro=function(t,e){var r,n=this;switch(t.type){case"identifier":if(r=e[t.name.toUpperCase()])return JSON.parse(JSON.stringify(r));break;case"binary":t.left=this.RewriteMacro(t.left,e),t.right=this.RewriteMacro(t.right,e);break;case"unary":t.operand=this.RewriteMacro(t.operand,e);break;case"group":t.elements=t.elements.map((function(t){return n.RewriteMacro(t,e)}));break;case"call":t.args=t.args.map((function(t){return n.RewriteMacro(t,e)}))}return t},t.prototype.CallMacro=function(t,e){var r,n=this;if(!e.expression)return function(){return st()};var i=JSON.stringify(e.expression),a={},o=(null===(r=e.argument_names)||void 0===r?void 0:r.map((function(t){return t.toUpperCase()})))||[];return function(t){for(var e=JSON.parse(i),r=0;r<o.length;r++)a[o[r]]=t.args[r]||{type:"missing"};return n.CalculateExpression(n.RewriteMacro(e,a))}},t.prototype.CallExpression=function(t,e){var r=this;void 0===e&&(e=!1);var n=this.library.Get(t.name);return n?function(i){var a=r.call_index++;r.context.volatile=r.context.volatile||!!n.volatile;var o,s="if"===t.name.toLowerCase(),u=-1,c=n.arguments||[],h=i.args.map((function(t,e){if(!o){var n=c[Math.min(e,c.length-1)]||{};if(e===u)return n.boxed?m():void 0;if(void 0===t)return s&&0===e&&(u=1),n.boxed?m():void 0;if(n.address)return n.boxed?{type:l.string,value:r.parser.Render(t).replace(/\$/g,"")}:r.parser.Render(t).replace(/\$/g,"");if(n.metadata)return r.GetMetadata(t,(function(){return{}}));var i=r.CalculateExpression(t);if(!Array.isArray(i)&&i.type===l.error)return n.allow_error?i:void(o=i);if(s&&0===e&&!Array.isArray(i)){var a=!1;if(i.type===l.string){var h=i.value.toLowerCase().trim();a="false"!==h&&"f"!==h}else a=!!i.value;u=a?2:1}return n.boxed?i:Array.isArray(i)?i.map((function(t){return t.map((function(t){return t.value}))})):i.value}}));if(o)return o;if(r.context.call_index=a,n.return_type===at.reference){var f=n.fn.apply(null,h);if(e)return f;if(jt(f)){if("address"===f.value.type)return r.CellFunction2(f.value)();if("range"===f.value.type)return r.CellFunction4(f.value.start,f.value.end)}return f}return n.fn.apply(null,h)}:function(){return dt()}},t.prototype.UnaryExpression=function(t){var e=this;switch(t.operator){case"+":return function(t){return e.CalculateExpression(t.operand)};case"-":var r=Rt,n={type:l.number,value:0};return function(t){var i=e.CalculateExpression(t.operand);return Array.isArray(i)?i.map((function(t){return t.map((function(t){return r(n,t)}))})):r(n,i)};default:return function(){return console.warn("unexpected unary operator:",t.operator),st()}}},t.prototype.RecycleArray=function(t,e,r){var n,i;if(t[0].length<r){var o=t[0].length;try{for(var s=a(t),l=s.next();!l.done;l=s.next())for(var u=l.value,c=o;c<r;c++)u[c]=u[c%o]}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}if(t.length<e)for(var h=o=t.length;h<e;h++)t[h]=t[h%o].slice(0);return t},t.prototype.ElementwiseBinaryExpression=function(t,e,r){var n=Math.max(e.length,r.length),i=Math.max(e[0].length,r[0].length);e=this.RecycleArray(e,n,i),r=this.RecycleArray(r,n,i);for(var a=[],o=0;o<n;o++){for(var s=[],l=0;l<i;l++)s[l]=t(e[o][l],r[o][l]);a.push(s)}return a},t.prototype.BinaryExpression=function(t){var e=this,r=function(t){switch(t){case"&":return Et;case"+":return St;case"-":return Rt;case"*":return Tt;case"/":return Pt;case"^":case"**":return kt;case"%":return Nt;case"=":case"==":return Dt;case"!=":case"<>":return Ot;case">":return Ft;case">=":return It;case"<":return Lt;case"<=":return Ut}}(t.operator);return r?function(t){var n=e.CalculateExpression(t.left),i=e.CalculateExpression(t.right);return Array.isArray(n)?Array.isArray(i)?e.ElementwiseBinaryExpression(r,n,i):e.ElementwiseBinaryExpression(r,n,[[i]]):Array.isArray(i)?e.ElementwiseBinaryExpression(r,[[n]],i):r(n,i)}:function(){return console.info("(unexpected binary operator: "+t.operator+")"),st()}},t.prototype.Identifier=function(t){var e=this,r=t.name,n=r.toUpperCase();switch(n){case"FALSE":case"F":return function(){return{value:!1,type:l.boolean}};case"TRUE":case"T":return function(){return{value:!0,type:l.boolean}};case"UNDEFINED":return function(){return{value:void 0,type:l.undefined}}}return function(){var t=e.named_range_map[n];return t?1===t.count?e.CellFunction4(t.start,t.start):e.CellFunction4(t.start,t.end):(console.info("** identifier",r),dt())}},t.prototype.GroupExpression=function(t){var e=this;return t.elements&&1===t.elements.length?function(t){return e.CalculateExpression(t.elements[0])}:(console.warn("Can't handle group !== 1"),function(){return st()})},t.prototype.CalculateExpression=function(t,e){var r=this;if(void 0===e&&(e=!1),t.user_data)return t.user_data(t);switch(t.type){case"call":var n=this.data_model.macro_functions[t.name.toUpperCase()];return n?(t.user_data=this.CallMacro(t,n))(t):(t.user_data=this.CallExpression(t,e))(t);case"address":return(t.user_data=this.CellFunction2(t))();case"range":return(t.user_data=function(t){return r.CellFunction4(t.start,t.end)})(t);case"binary":return(t.user_data=this.BinaryExpression(t))(t);case"unary":return(t.user_data=this.UnaryExpression(t))(t);case"identifier":return(t.user_data=this.Identifier(t))();case"missing":return(t.user_data=function(){return{value:void 0,type:l.undefined}})();case"literal":var i={value:t.value,type:f(t.value)};return(t.user_data=function(){return i})();case"group":return(t.user_data=this.GroupExpression(t))(t);case"complex":var a={value:{real:t.real,imaginary:t.imaginary},type:l.complex};return(t.user_data=function(){return a})();case"array":return(t.user_data=function(){return t.values.map((function(t){return(Array.isArray(t)?t:[t]).map((function(t){return{value:t,type:f(t)}}))}))})();default:return console.warn("Unhandled parse expr:",t),pt()}},t}(),zt=function(t){for(var e=[],r=t.length,n=t[0].length,i=0;i<n;i++){e[i]=[];for(var a=0;a<r;a++)e[i][a]=t[a][i]}return e},Bt=function(t){return Array.isArray(t)?t.reduce((function(t,e){return void 0===e?t:Array.isArray(e)?t.concat(Bt(e)):e instanceof Float32Array||e instanceof Float64Array?t.concat(Array.from(e)):t.concat([e])}),[]):[t]},qt=function(t){return function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return Array.isArray(e)?e.map((function(e){return e.map((function(e){return t.apply(void 0,s([e],o(r)))}))})):t.apply(void 0,s([e],o(r)))}},Jt=function(t){return function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return Array.isArray(e)?Array.isArray(r)?e.map((function(e,i){return e.map((function(e,a){return t.apply(void 0,s([e,r[i][a]],o(n)))}))})):e.map((function(e){return e.map((function(e){return t.apply(void 0,s([e,r],o(n)))}))})):t.apply(void 0,s([e,r],o(n)))}},Ht=function(){function t(){this.functions={}}return t.prototype.Register=function(){for(var t,e,r,n,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];try{for(var s=a(i),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(r=void 0,a(Object.keys(u))),h=c.next();!h.done;h=c.next()){var f=h.value;if(/[^a-zA-Z0-9._]/.test(f))throw new Error("invalid function name (invalid character)");if(f.length>255)throw new Error("invalid function name (too long, > 255)");if(/^[^a-zA-Z]/.test(f))throw new Error("invalid function name (start with an ascii letter)");var d=f.toLowerCase();if(this.functions[d])throw new Error("function name ("+d+") is already in use");var p=u[f];p.canonical_name=f,this.functions[d]=p}}catch(t){r={error:t}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}},t.prototype.Get=function(t){var e=t.toLowerCase();return this.functions[e]},t.prototype.List=function(){var t,e,r={};try{for(var n=a(Object.keys(this.functions)),i=n.next();!i.done;i=n.next()){var o=i.value;r[o]=this.functions[o]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},t.prototype.Alias=function(t,e){var r,i=this.Get(e);if(!i)throw new Error("referenced function "+e+" does not exist");this.Register(((r={})[t]=n({},i),r))},t}();!function(t){t[t.move=0]="move",t[t.line=1]="line"}(mt||(mt={}));var Wt,Zt,$t,Yt,Qt,Xt,Kt=function(){function t(){}return t.UnpackValues=function(t){var e=this;if(Array.isArray(t)){var r=t[0];return Array.isArray(r)||r instanceof Float64Array||r instanceof Float32Array?t.reduce((function(t,r){return t.concat(e.UnpackValues(r))}),[]):t.map((function(t){return isNaN(t)?void 0:t}))}if(t instanceof Float32Array||t instanceof Float64Array)return Array.prototype.slice.call(t);if(t&&"object"==typeof t){var n=Object.keys(t).length;if(void 0!==t[0]&&void 0!==t[(n-1).toString()]){for(var i=[],a=0;a<n;a++)i[a]=t[a.toString()];return i}}return[]},t.SparklineCommon=function(t,e){var r,n=[],i=(null===(r=e.text)||void 0===r?void 0:r.text)||this.default_color,a=[i,i];return Array.isArray(t.calculated)&&(n=this.UnpackValues(t.calculated[0]),"string"==typeof t.calculated[1]&&(a[0]=t.calculated[1]),"string"==typeof t.calculated[2]&&(a[1]=t.calculated[2])),{values:n,colors:a}},t.RenderLine=function(t,e,r,n,i){var a=this.SparklineCommon(n,i),o=a.values,s=a.colors,l=1;Array.isArray(n.calculated)&&"number"==typeof n.calculated[2]&&(l=n.calculated[2]);for(var u=0,c=0,h=-1,f=0;f<o.length;f++)"number"==typeof(_=o[f])&&(h>=0?(u=Math.min(u,_),c=Math.max(c,_)):(h=f,u=c=_));if(u!==c){var d=.9*t/(o.length-1),p=c-u,m=.8*e,v=.1*e;r.strokeStyle=s[0],r.lineWidth=l,r.lineCap="round",r.lineJoin="round",r.beginPath();var y=mt.move;for(f=h;f<o.length;f++){var _;if("number"==typeof(_=o[f])){var g=.05*t+d*f,b=e-(_-u)*m/p-v;y===mt.move?(r.moveTo(g,b),y=mt.line):r.lineTo(g,b)}else y=mt.move}r.stroke()}},t.RenderColumn=function(t,e,r,n,i){var o,s,l=this.SparklineCommon(n,i),u=l.values,c=l.colors,h=0,f=0,d=!1;try{for(var p=a(u),m=p.next();!m.done;m=p.next())"number"==typeof(S=m.value)&&(d?(h=Math.min(h,S),f=Math.max(f,S)):(d=!0,h=f=S))}catch(t){o={error:t}}finally{try{m&&!m.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}if(u.length){var v=(t-6-2)/(u.length-0),y=e-5;if(h!==f)if(h<0&&f>0){for(var _=2.5+f/(C=f-h)*y,g=0;g<u.length;g++)if("number"==typeof(S=u[g])){var b=3+g*v,x=Math.abs(S)/C*y;if(S>=0){r.fillStyle=c[0];var w=_-x;r.fillRect(b+2,w,v-2,x)}else{r.fillStyle=c[1];var M=_;r.fillRect(b+2,M,v-2,x)}}}else if(f>0){r.fillStyle=c[0];var C=f-h;for(g=0;g<u.length;g++)if("number"==typeof(S=u[g])){b=3+g*v;var A=e-2.5-(x=Math.max(1,(S-h)/C*y));r.fillRect(b+2,A,v-2,x)}}else for(r.fillStyle=c[1],C=f-h,g=0;g<u.length;g++){var S;"number"==typeof(S=u[g])&&(b=3+g*v,x=Math.max(1,Math.abs(f-S)/C*y),r.fillRect(b+2,2.5,v-2,x))}}},t.default_color="#888",t}(),te=function(t){var e=1/(1+.3275911*(t=Math.abs(t)));return 1-((((1.061405429*e-1.453152027)*e+1.421413741)*e-.284496736)*e+.254829592)*e*Math.exp(-1*t*t)},ee=function(t){if(.5===t)return 0;var e=t<1&&t>.5?1-t:t,r=Math.sqrt(Math.log(1/Math.pow(e,2))),n=r-(2.515517+.802853*r+.010328*Math.pow(r,2))/(1+1.432788*r+.189269*Math.pow(r,2)+.001308*Math.pow(r,3));return t>.5?n:-n},re={type:l.boolean,value:!0},ne={type:l.boolean,value:!1},ie={Rand:{volatile:!0,fn:function(){return{type:l.number,value:Math.random()}}},RandBetween:{arguments:[{name:"min"},{name:"max"}],volatile:!0,fn:function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),t>e){var r=t;t=e,e=r}return{type:l.number,value:Math.floor(Math.random()*(e+1-t)+t)}}},Sum:{description:"Adds arguments and ranges",arguments:[{boxed:!0,name:"values or ranges"}],fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i={real:0,imaginary:0},o=Bt(r);try{for(var s=a(o),u=s.next();!u.done;u=s.next()){var c=u.value;switch(c.type){case l.number:i.real+=c.value;break;case l.boolean:i.real+=c.value?1:0;break;case l.complex:i.real+=c.value.real,i.imaginary+=c.value.imaginary;break;case l.error:return c}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return y(i)}},Now:{description:"Returns current time",volatile:!0,fn:function(){return{type:l.number,value:P((new Date).getTime())}}},Today:{description:"Returns current day",volatile:!0,fn:function(){var t=new Date;return t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setHours(12),{type:l.number,value:P(t.getTime())}}},IfError:{description:"Returns the original value, or the alternate value if the original value contains an error",arguments:[{name:"original value",allow_error:!0,boxed:!0},{name:"alternate value"}],fn:function(t,e){return void 0===e&&(e=0),t&&t.type===l.error?{value:e,type:f(e)}:t}},IsError:{description:"Checks if another cell contains an error",arguments:[{name:"reference",allow_error:!0,boxed:!0}],fn:function(t){var e,r;if(Array.isArray(t)){var n=Bt(t);try{for(var i=a(n),o=i.next();!o.done;o=i.next())if(o.value.type===l.error)return{type:l.boolean,value:!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}else if(t)return{type:l.boolean,value:t.type===l.error};return{type:l.boolean,value:!1}}},Cell:{description:"Returns data about a cell",arguments:[{name:"type",description:"Type of data to return"},{name:"reference",description:"Cell reference",metadata:!0}],fn:function(t,e){if(!Vt(e))return ft();if(t)switch(t.toString().toLowerCase()){case"format":return e.value.format?{type:l.string,value:e.value.format}:ft();case"address":return{type:l.string,value:e.value.address.label.replace(/\$/g,"")}}return{type:l.error,value:ot.error}}},Year:{description:"Returns year from date",arguments:[{name:"date"}],fn:function(t){return v(new Date(T(t)).getUTCFullYear())}},Month:{description:"Returns month from date",arguments:[{name:"date"}],fn:function(t){return v(new Date(T(t)).getUTCMonth()+1)}},Day:{description:"Returns day of month from date",arguments:[{name:"date"}],fn:function(t){return v(new Date(T(t)).getUTCDate())}},Radians:{description:"Converts degrees to radians",arguments:[{name:"Degrees",description:"Angle in degrees"}],fn:qt((function(t){return v(t*Math.PI/180)}))},Degrees:{description:"Converts radians to degrees",arguments:[{name:"Radians",description:"Angle in radians"}],fn:qt((function(t){return v(t/Math.PI*180)}))},CountA:{description:"Counts cells that are not empty",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return v(Bt(t).reduce((function(t,e){return void 0===e?t:t+1}),0))}},Count:{description:"Counts cells that contain numbers",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return v(Bt(t).reduce((function(t,e){return"number"==typeof e?t+1:t}),0))}},Or:{fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=!1;r=Bt(r);try{for(var o=a(r),s=o.next();!s.done;s=o.next()){var l=s.value;i=i||!!l}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return v(i)}},And:{fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=!0;r=Bt(r);try{for(var o=a(r),s=o.next();!s.done;s=o.next()){var l=s.value;i=i&&!!l}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return v(i)}},Not:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?ct():1===t.length?v(!t[0]):v(!0)}},If:{arguments:[{name:"test value",boxed:!0},{name:"value if true",boxed:!0,allow_error:!0},{name:"value if false",boxed:!0,allow_error:!0}],fn:function(t,e,r){return void 0===e&&(e=re),void 0===r&&(r=ne),Array.isArray(t)?t.map((function(t,n){return t.map((function(t,i){return(p(t)?"false"!==t.value.toLowerCase()&&"f"!==t.value.toLowerCase():t.value)?Array.isArray(e)?e[n][i]:e:Array.isArray(r)?r[n][i]:r}))})):(p(t)?"false"!==t.value.toLowerCase()&&"f"!==t.value.toLowerCase():t.value)?e:r}},Fact:{description:"Returns the factorial of a number",arguments:[{name:"number"}],fn:qt((function(t){t=Math.floor(t);for(var e=1;t>1;)e*=t,t--;return{type:l.number,value:e}}))},Power:{description:"Returns base raised to the given power",arguments:[{name:"base",boxed:!0},{name:"exponent",boxed:!0}],fn:Jt((function(t,e){if(t.type===l.complex||e.type===l.complex){var r=t.type===l.complex?t.value:{real:t.value||0,imaginary:0},n=e.type===l.complex?e.value:{real:e.value||0,imaginary:0},i=wt(r,n);return y(i)}return i=Math.pow(t.value,e.value),isNaN(i)?ht():{type:l.number,value:i}}))},Mod:{fn:Jt((function(t,e){return e?v(t%e):ut()}))},Sort:{arguments:[{name:"values"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(t=Bt(t)).every((function(t){return"number"==typeof t}))?t.sort((function(t,e){return t-e})):t.sort(),[t.map((function(t){return v(t)}))]}},Transpose:{description:"Returns transpose of input matrix",arguments:[{name:"matrix",boxed:!0}],fn:function(t){return Array.isArray(t)?zt(t):t}},Max:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.max.apply(0,Bt(t).filter((function(t){return"number"==typeof t})))}}},Min:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.min.apply(0,Bt(t).filter((function(t){return"number"==typeof t})))}}},SumProduct:{description:"Returns the sum of pairwise products of two or more ranges",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.map((function(t){return Bt(t)})),n=Math.max.apply(0,r.map((function(t){return t.length}))),i=0,a=function(t){i+=r.reduce((function(e,r){return e*(r[t]||0)}),1)},o=0;o<n;o++)a(o);return{type:l.number,value:i}}},VLookup:{fn:function(t,e,r,n){if(void 0===n&&(n=!0),r=Math.max(0,r-1),n){for(var i=Math.abs(t-e[0][0]),a=e[r][0],o=1;o<e[0].length;o++){var s=Math.abs(e[0][o]-t);s<i&&(i=s,a=e[r][o])}return v(a)}for(o=1;o<e[0].length;o++)if(e[0][o]==t)return e[r][o];return{type:l.error,value:nt.NA}}},Product:{arguments:[{boxed:!0}],fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i={real:1,imaginary:0};r=Bt(r);try{for(var o=a(r),s=o.next();!s.done;s=o.next()){var u=s.value;u.type===l.complex?i=yt(i,u.value):u.type===l.number&&(i.real*=u.value,i.imaginary*=u.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return y(i)}},Log:{fn:Jt((function(t,e){return void 0===e&&(e=10),{type:l.number,value:Math.log(t)/Math.log(e)}}))},Log10:{fn:qt((function(t){return{type:l.number,value:Math.log(t)/Math.log(10)}}))},Ln:{fn:qt((function(t){return{type:l.number,value:Math.log(t)}}))},Round:{fn:Jt((function(t,e){void 0===e&&(e=0);var r=Math.pow(10,e);return{type:l.number,value:Math.round(r*t)/r}}))},RoundDown:{fn:Jt((function(t,e){void 0===e&&(e=0);var r=Math.pow(10,e),n=t>=0;return{type:l.number,value:n?Math.floor(r*t)/r:Math.ceil(r*t)/r}}))},Reverse:{arguments:[{boxed:!0}],fn:function(t){return Array.isArray(t)?1===t.length?[t[0].reverse()]:t.reverse():{type:l.string,value:t.value.toString().split("").reverse().join("")}}},Exp:{arguments:[{boxed:!0}],fn:qt((function(t){if(t.type===l.complex){var e=xt(t.value);return y(e)}return{type:l.number,value:Math.exp(t.value||0)}}))},Abs:{arguments:[{boxed:!0}],fn:qt((function(t){return t.type===l.complex?{type:l.number,value:Math.sqrt(t.value.real*t.value.real+t.value.imaginary*t.value.imaginary)}:{type:l.number,value:Math.abs(t.value||0)}}))},Simplify:{fn:Jt((function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return{type:l.number,value:t};var r=t<0?-1:1;t*=r;var n=Math.pow(10,Math.floor(Math.log10(t))+1-e);return{type:l.number,value:Math.round(t/n)*n*r}}))},Erf:{fn:function(t){return{type:l.number,value:te(t)}}},NormsInv:{description:"Inverse of the normal cumulative distribution",arguments:[{name:"probability"}],fn:function(t){return{type:l.number,value:ee(t)}}},"Norm.Inv":{description:"Inverse of the normal cumulative distribution",arguments:[{name:"probability"},{name:"mean",default:0},{name:"standard deviation",default:1}],fn:function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),{type:l.number,value:ee(t)*r+e}}},"Norm.Dist":{description:"Cumulative normal distribution",arguments:[{name:"value"},{name:"mean",default:0},{name:"standard deviation",default:1}],fn:function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1);var n=t<e?-1:1;return{type:l.number,value:.5*(1+n*te(Math.abs(t-e)/(r*Math.sqrt(2))))}}},Sqrt:{description:"Returns the square root of the argument",arguments:[{boxed:!0}],fn:qt((function(t){if(t.type===l.complex){var e=wt(t.value,{real:.5,imaginary:0});return y(e)}return t.type!==l.undefined&&t.value?(e=Math.sqrt(t.value),isNaN(e)?ht():{type:l.number,value:e}):{type:l.number,value:0}}))},HexToDec:{arguments:[{description:"hexadecimal string"}],fn:function(t){return{type:l.number,value:parseInt(t,16)}}},DecToHex:{arguments:[{description:"number"}],fn:function(t){return{type:l.string,value:t.toString(16)}}},Checkbox:{arguments:[{name:"checked"}],click:function(t){var e=t.x,r=t.y,n=t.width,i=t.height,a=t.cell,o={};if(a&&n&&i&&e&&r){var s={x:3,y:i-3-16};if(a.style){switch(a.style.vertical_align){case w.VerticalAlign.Top:s.y=3;break;case w.VerticalAlign.Middle:s.y=Math.round(i/2-8)}switch(a.style.horizontal_align){case w.HorizontalAlign.Right:s.x=Math.round(n-3-16);break;case w.HorizontalAlign.Center:s.x=Math.round(n/2-8)}}e>=s.x&&e<=s.x+16&&r>=s.y&&r<=s.y+16&&(o.value="=Checkbox("+(a.calculated?"FALSE":"TRUE")+")",o.block_selection=!0)}return o},render:function(t){var e,r,n=t.context,i=t.width,o=t.height,s=t.cell,l=t.scale||1;n.lineJoin="round",n.lineCap="round";var u=3*l,c=u,h=o-u-16*l;if(s.style){switch(s.style.vertical_align){case w.VerticalAlign.Top:h=u;break;case w.VerticalAlign.Middle:h=Math.round(o/2-8*l)}switch(s.style.horizontal_align){case w.HorizontalAlign.Right:c=Math.round(i-u-16*l);break;case w.HorizontalAlign.Center:c=Math.round(i/2-8*l)}}if(s&&s.calculated){n.lineWidth=.5,n.fillStyle=n.strokeStyle,n.beginPath(),n.moveTo(c,h),n.lineTo(c+16*l,h),n.lineTo(c+16*l,h+16*l),n.lineTo(c,h+16*l),n.closePath(),n.moveTo(c+15*l,h+4*l);try{for(var f=a([[13.59,2.58],[6,10.17],[2.41,6.59],[1,8],[6,13]]),d=f.next();!d.done;d=f.next()){var p=d.value;n.lineTo(c+p[0]*l,h+p[1]*l)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}n.closePath(),n.fill()}else n.lineWidth=Math.max(2,2*l),n.strokeRect(c,h,16*l,16*l);return{handled:!0}},fn:function(t){return{value:!!t,type:l.boolean}}},"Sparkline.Column":{arguments:[{name:"data"},{name:"color"},{name:"negative color"}],render:function(t){return Kt.RenderColumn(t.width,t.height,t.context,t.cell,t.style),{handled:!0}},fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.object,value:t}}},"Sparkline.Line":{arguments:[{name:"data"},{name:"color"},{name:"line width"}],render:function(t){return Kt.RenderLine(t.width,t.height,t.context,t.cell,t.style),{handled:!0}},fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.object,value:t}}}},ae={};try{for(var oe=a(Object.keys(ie)),se=oe.next();!se.done;se=oe.next()){var le=se.value;ae[le.toLowerCase()]=le}}catch(t){Wt={error:t}}finally{try{se&&!se.done&&(Zt=oe.return)&&Zt.call(oe)}finally{if(Wt)throw Wt.error}}var ue={};try{for(var ce=a(["pow"]),he=ce.next();!he.done;he=ce.next()){var fe=he.value;ue[fe.toLowerCase()]=fe}}catch(t){$t={error:t}}finally{try{he&&!he.done&&(Yt=ce.return)&&Yt.call(ce)}finally{if($t)throw $t.error}}var de=function(t){var e=t.toLowerCase();if(ae[e])return"continue";if(ue[e])return"continue";var r=Object.getOwnPropertyDescriptor(Math,t);if(!r)return"continue";var n=r.value,i=typeof n;switch(i){case"number":ie[t]={fn:function(){return{type:l.number,value:n}},category:["Math Functions"]};break;case"function":ie[t]={fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return v(n.apply(void 0,s([],o(t))))},category:["Math Functions"]};break;default:console.info("unexpected type:",i,t)}};try{for(var pe=a(Object.getOwnPropertyNames(Math)),me=pe.next();!me.done;me=pe.next())de(me.value)}catch(t){Qt={error:t}}finally{try{me&&!me.done&&(Xt=pe.return)&&Xt.call(pe)}finally{if(Qt)throw Qt.error}}Math.log10||(Math.log10=function(t){return Math.log(t)/Math.log(10)});var ve,ye=function(t,e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),i?-r*(t/(1-Math.pow(1+t,-e)))/(1+t)-n*(1/((1+t)*((Math.pow(1+t,e)-1)/t))):-(r*t*Math.pow(1+t,e)+n*t)/(Math.pow(1+t,e)-1)},_e=function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),i?(1+t)*-r/t*(Math.pow(1+t,e)-1)-n*Math.pow(1+t,e):-r/t*(Math.pow(1+t,e)-1)-n*Math.pow(1+t,e)},ge=function(t,e,r,n,i,a){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=0),e<1)return NaN;if(1===e&&a)return 0;var o=ye(t,r,n,i,a),s=_e(t,e-1,o,n,a)*t;return a?s/(1+t):s},be=function(t,e,r,n,i,a){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=0),ye(t,r,n,i,a)-ge(t,e,r,n,i,a)},xe={NPV:{description:"Returns the present value of a series of future cashflows",arguments:[{name:"Rate"},{name:"Cashflow"}],fn:function(t){void 0===t&&(t=0);for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0,i=Bt(e),a=0;a<i.length;a++){var o=i[a];"number"==typeof o&&(n+=Math.pow(1+t,-(a+1))*o)}return{type:l.number,value:n}}},IRR:{description:"Calculates the internal rate of return of a series of cashflows",arguments:[{name:"Cashflows"},{name:"Guess",default:.1}],fn:function(t,e){void 0===e&&(e=.1);for(var r=Bt(t).map((function(t){return"number"==typeof t?t:0})),n=[{found:!1,value:0},{found:!1,value:0}],i=0;i<50;i++){for(var a=0,o=0;o<r.length;o++)a+=Math.pow(1+e,-(o+1))*r[o];if(Math.abs(a)<=.00125)return{type:l.number,value:e};if(a>0){if(n[0].value=n[0].found?Math.max(n[0].value,e):e,n[0].found=!0,!n[1].found){e+=.1;continue}}else if(n[1].value=n[1].found?Math.min(n[1].value,e):e,n[1].found=!0,!n[0].found){e-=.1;continue}e=n[0].value+(n[1].value-n[0].value)/2}return{type:l.error,value:"NUM"}}},CUMPRINC:{description:"Returns cumulative principal paid on a loan between two periods",arguments:[{name:"Rate"},{name:"Periods"},{name:"Present Value"},{name:"Start Period"},{name:"End Period"},{name:"Type",default:0}],fn:function(t,e,r,n,i,a){void 0===a&&(a=0);for(var o=0,s=n;s<=i;s++)o+=be(t,s,e,r,0,a);return{type:l.number,value:o}}},CUMIPMT:{description:"Returns cumulative interest paid on a loan between two periods",arguments:[{name:"Rate"},{name:"Periods"},{name:"Present Value"},{name:"Start Period"},{name:"End Period"},{name:"Type",default:0}],fn:function(t,e,r,n,i,a){void 0===a&&(a=0);for(var o=0,s=n;s<=i;s++)o+=ge(t,s,e,r,0,a);return{type:l.number,value:o}}},IPMT:{description:"Returns the interest portion of a payment",arguments:[{name:"Rate"},{name:"Period"},{name:"Periods"},{name:"Present Value",default:0},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i,a){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=0),{type:l.number,value:ge(t,e,r,n,i,a)}}},PPMT:{description:"Returns the principal portion of a payment",arguments:[{name:"Rate"},{name:"Period"},{name:"Periods"},{name:"Present Value",default:0},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i,a){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=0),{type:l.number,value:be(t,e,r,n,i,a)}}},Rate:{description:"Returns the interest rate of a loan",arguments:[{name:"Periods"},{name:"Payment"},{name:"Present Value",default:0},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0);for(var a=.25,o=[-1,1],s=0;s<32;s++){var u=ye(a,t,r,n,i);if(Math.abs(u-e)<=1e-6)return{type:l.number,value:a};var c=ye(o[1],t,r,n,i);e>=u&&e<=c||e>=c&&e<=u?o[0]=a:o[1]=a,a=o[0]+(o[1]-o[0])/2}return{type:l.number,value:a}}},FV:{description:"Returns the future value of an investment",arguments:[{name:"Rate"},{name:"Periods"},{name:"Payment"},{name:"Present Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),{type:l.number,value:_e(t,e,r,n,i)}}},PV:{description:"Returns the present value of an investment",arguments:[{name:"Rate"},{name:"Periods"},{name:"Payment"},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),i?(r+=n*(1/((1+t)*((Math.pow(1+t,e)-1)/t))),{type:l.number,value:-(r+r/t*(1-Math.pow(1+t,-(e-1))))}):{type:l.number,value:-(n+r/t*(Math.pow(1+t,e)-1))/Math.pow(1+t,e)}}},NPER:{description:"Returns the number of periods of an investment",arguments:[{name:"Rate"},{name:"Payment"},{name:"Present Value"},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),i?{type:l.number,value:1+(-Math.log(1+t*(1-r/-e))+Math.log(1+n*t/(-e*(1+t))))/Math.log(1+t)}:{type:l.number,value:(Math.log(Math.pow(1-r*t/-e,-1))+Math.log(1+n*t/-e))/Math.log(1+t)}}},PMT:{description:"Returns the periodic payment of a loan",arguments:[{name:"Rate"},{name:"Periods"},{name:"Present Value"},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),{type:l.number,value:ye(t,e,r,n,i)}}}},we={Char:{arguments:[{name:"number"}],fn:function(t){return{type:l.string,value:String.fromCodePoint(t||32)}},category:["text"]},Code:{arguments:[{name:"string"}],fn:function(t){return{type:l.number,value:t.codePointAt(0)}},category:["text"]},Text:{arguments:[{name:"value"},{name:"number format"}],fn:function(t,e){return void 0===e&&(e="0.00####"),{type:l.string,value:E.Get(e).Format(t||0)}},category:["text"]},Left:{arguments:[{name:"string"},{name:"count"}],fn:function(t,e){return void 0===e&&(e=1),{type:l.string,value:t.substr(0,e)}},category:["text"]},Right:{arguments:[{name:"string"},{name:"count"}],fn:function(t,e){return void 0===e&&(e=1),{type:l.string,value:t.slice(-e)}},category:["text"]},Mid:{arguments:[{name:"string"},{name:"left"},{name:"count"}],fn:function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),{type:l.string,value:t.substr(Math.max(0,e-1),r)}},category:["text"]},Search:{description:"Find a string (needle) in another string (haystack). Case-insensitive.",arguments:[{name:"Needle"},{name:"Haystack"},{name:"Start",default:1}],fn:function(t,e,r){if(void 0===r&&(r=1),r>=1){if(!t)return{type:l.number,value:r};var n=function(t){for(var e=[],r=t.length,n="[\\^$.|?*+()",i=0;i<r;i++){var a=t[i];switch(a){case"*":e.push(".","*");break;case"?":e.push(".");break;case"~":a=t[++i]||"";default:for(var o=0;o<n.length;o++)if(a===n[o]){e.push("\\");break}e.push(a)}}return e.join("")}(t),i=new RegExp(n,"i").exec(e.substr(r-1));if(i)return{type:l.number,value:i.index+r}}return ht()}},Find:{description:"Find a string (needle) in another string (haystack). Case-sensitive.",arguments:[{name:"Needle"},{name:"Haystack"},{name:"Start",default:1}],fn:function(t,e,r){if(void 0===r&&(r=1),r>=1){if(!t)return{type:l.number,value:r};var n=new RegExp(t).exec(e.substr(r-1));if(n)return{type:l.number,value:n.index+r}}return ht()}},Concat:{description:"Pastes strings together",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Bt(t),n=r.map((function(t){var e,r=(null===(e=t)||void 0===e?void 0:e.toString())||"";return"number"==typeof t&&","===x.decimal_separator?r.replace(/\./,","):r})).join("");return{type:l.string,value:n}}}},Me={Concatenate:"Concat"},Ce={IsBlank:{description:"Returns true if the reference is blank",arguments:[{name:"Reference",metadata:!0}],fn:qt((function(t){return{type:l.boolean,value:!(null==t?void 0:t.value)||void 0===t.value.value}}))},IsNumber:{description:"Returns true if the reference is a number",arguments:[{name:"Reference",metadata:!0}],fn:qt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&"number"==typeof t.value.value}}))},IsLogical:{description:"Returns true if the reference is a logical TRUE or FALSE",arguments:[{name:"Reference",metadata:!0}],fn:qt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&"boolean"==typeof t.value.value}}))},IsText:{description:"Returns true if the reference is text",arguments:[{name:"Reference",metadata:!0}],fn:qt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&"string"==typeof t.value.value}}))}},Ae=function(t,e){void 0===e&&(e=!1);for(var r=t.length,n=0,i=0,a=0;a<r;a++)n+=t[a];for(n/=r,a=0;a<r;a++){var o=t[a]-n;i+=o*o}return e?i/(r-1):i/r},Se={StDev:{description:"Returns the standard deviation of a set of values, corresponding to a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.sqrt(Ae(Bt(t),!1))}}},"StDev.S":{description:"Returns the standard deviation of a set of values, corresponding to a sample of a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.sqrt(Ae(Bt(t),!0))}}},Var:{description:"Returns the variance of a set of values, corresponding to a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Ae(Bt(t),!1)}}},"Var.S":{description:"Returns the variance of a set of values, corresponding to a sample of a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Ae(Bt(t),!0)}}},Correl:{description:"Returns the correlation between two ranges of values",arguments:[{name:"A"},{name:"B"}],fn:function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return ht();if(!Array.isArray(t[0])||!Array.isArray(e[0]))return ht();for(var r=0,n=0,i=0,a=0,o=0,s=0,u=0,c=0;c<t.length;c++)if(t[c]&&e[c])for(var h=t[c].length,f=0;f<h;f++){var d=Number(t[c][f]),p=Number(e[c][f]);isNaN(d)||isNaN(p)||(n+=d*p,i+=d,a+=p,o+=d*d,s+=p*p,u++)}return(r=u*n-i*a)&&(r/=Math.sqrt((u*o-i*i)*(u*s-a*a))),{type:l.number,value:r}}},GeoMean:{description:"Returns the geometric mean of all numeric arguments",arguments:[{boxed:!0}],fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];r=Bt(r);var i=0,o={real:1,imaginary:0},s=!1,u=!1;try{for(var c=a(r),h=c.next();!h.done;h=c.next()){var f=h.value;f.type===l.complex?(s=!0,o=yt(o,f.value),i++):f.type===l.number&&(f.value<0&&(u=!0),i++,o.real*=f.value,o.imaginary*=f.value)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}if(s){var d=wt(o,{real:1/i,imaginary:0});return d.imaginary?{type:l.complex,value:d}:{type:l.number,value:d.real}}return u?ht():{type:l.number,value:Math.pow(o.real,1/i)}}},Average:{description:"Returns the arithmetic mean of all numeric arguments",arguments:[{boxed:!0}],fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];r=Bt(r);var i={real:0,imaginary:0},o=0;try{for(var s=a(r),u=s.next();!u.done;u=s.next()){var c=u.value;if(c.type===l.error)return c;c.type===l.number&&(i.real+=c.value,o++),c.type===l.complex&&(i.real+=c.value.real,i.imaginary+=c.value.imaginary,o++)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return i.real/=o,i.imaginary/=o,i.imaginary?{type:l.complex,value:i}:{type:l.number,value:i.real}}},Percentile:{description:"Returns the kth percentile value from the range of data",arguments:[{name:"range"},{name:"percentile"}],fn:function(t,e){var r=Bt(t).filter((function(t){return"number"==typeof t}));r.sort((function(t,e){return t-e}));var n=r.length,i=Math.pow(10,8),a=Math.round((1+(n-1)*e)*i)/i,o=Math.floor(a),s=Math.ceil(a);return{type:l.number,value:(r[o-1]+r[s-1])/2}}},Median:{description:"Returns the median value of the range of data",arguments:[{name:"range"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Bt(t).filter((function(t){return"number"==typeof t}));r.sort((function(t,e){return t-e}));var n=r.length,i=1+.5*(n-1),a=Math.floor(i),o=Math.ceil(i);return{type:l.number,value:(r[a-1]+r[o-1])/2}}}},Re={Mean:"Average","StDev.P":"StDev","Var.P":"Var"},ke={IsComplex:{description:"Returns true if the reference is a complex number",arguments:[{name:"Reference",metadata:!0}],fn:qt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&c(t.value.value)}}))},Real:{description:"Returns the real part of a complex number",arguments:[{boxed:!0}],fn:qt((function(t){return t.type===l.number?n({},t):t.type===l.complex?{type:l.number,value:t.value.real||0}:t.type===l.undefined||t.type===l.string&&""===t.value?{type:l.number,value:0}:ht()}))},Imaginary:{description:"Returns the imaginary part of a complex number (as real)",arguments:[{boxed:!0}],fn:qt((function(t){return t.type===l.complex?{type:l.number,value:t.value.imaginary||0}:t.type===l.number||t.type===l.undefined||t.type===l.string&&""===t.value?{type:l.number,value:0}:ht()}))},Conjugate:{description:"Returns the conjugate of a complex number",arguments:[{boxed:!0}],fn:qt((function(t){return t.type===l.complex?{type:l.complex,value:{real:t.value.real,imaginary:-t.value.imaginary}}:t.type!==l.number&&t.type!==l.undefined&&t.value?ht():{type:l.number,value:t.value||0}}))},Arg:{description:"Returns the principal argument of a complex number",arguments:[{boxed:!0}],fn:qt((function(t){return t.type===l.complex?{type:l.number,value:Math.atan2(t.value.imaginary,t.value.real)}:t.type===l.number||t.type===l.undefined||t.type===l.string&&""===t.value?{type:l.number,value:Math.atan2(0,t.value||0)}:ht()}))},Rectangular:{description:"Converts a complex number in polar form to rectangular form",arguments:[{name:"r"},{name:"Î¸ in radians"}],fn:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),{type:l.complex,value:{real:t*Math.cos(e),imaginary:t*Math.sin(e)}}}},Complex:{description:"Ensures that the given value will be treated as a complex number",arguments:[{boxed:!0}],fn:qt((function(t){return t.type===l.complex?t:t.type!==l.number&&t.type!==l.undefined&&t.value?ht():{type:l.complex,value:{imaginary:0,real:t.value||0}}}))},ComplexLog:{description:"Returns the principal value Log(z) of a complex number z",arguments:[{boxed:!0}],fn:qt((function(t){if(t.type===l.number){if(!t.value)return ht();t={type:l.complex,value:{real:t.value,imaginary:0}}}else if(t.type===l.undefined||t.type===l.string&&""===t.value)return ht();if(t.type===l.complex){var e=vt(t.value),r={real:Math.log(e.r),imaginary:e.theta};return r.imaginary?{type:l.complex,value:r}:{type:l.number,value:r.real}}return ht()}))}},Te=function(t){Array.isArray(t)||(t=[[t]]);var e=t.length,r=e?t[0].length:0,i=[];if(!e||!r)return{m:e,n:r,array:i};for(var a=0;a<e;a++){for(var o=[],s=0;s<r;s++){var u=t[a][s];if(u.type===l.complex)o.push(n({},u.value));else if(u.type===l.number)o.push({real:u.value,imaginary:0});else{if(u.type!==l.undefined&&""!==u.value)return{m:e,n:r,error:!0,array:[]};o.push({real:0,imaginary:0})}}i.push(o)}return{m:e,n:r,array:i}},Pe={MDeterm:{description:"Returns the determinant of a matrix",arguments:[{name:"matrix",boxed:!0}],fn:function(t){var e=Te(t);if(!e.array||!e.m||!e.n||e.m!==e.n||e.error)return ht();var r=gt(e);return r?y(r):ht()}},MInverse:{description:"Returns the inverse matrix",arguments:[{name:"matrix",boxed:!0}],fn:function(t){var e=Te(t);if(!e.array||!e.m||!e.n||e.m!==e.n||e.error)return ht();var r=gt(e);if(r&&0===r.real&&0===(null==r?void 0:r.imaginary))return ht();var n=function(t){var e=[];if(t.m===t.n){var r=function(t){for(var e={real_values:!1,imaginary_values:!1,square:t.m===t.n,unit_diagonal:!0},r={m:t.m,n:t.n,array:[]},n={m:t.m,n:t.n,array:[]},i=0;i<t.m;i++){for(var a=t.array[i],o=[],s=[],l=0;l<t.n;l++)a[l].real&&(e.real_values=!0),a[l].imaginary&&(e.imaginary_values=!0),l===i&&e.unit_diagonal&&(1===a[l].real&&0===a[l].imaginary||(e.unit_diagonal=!1)),o.push(a[l].real),s.push(a[l].imaginary);r.array.push(o),n.array.push(s)}return{real:r,imaginary:n,flags:e}}(t),n=r.real,i=r.imaginary,a=r.flags,o=bt(n);if(o){if(!a.imaginary_values){for(var s=0;s<t.m;s++){for(var l=[],u=0;u<t.n;u++)l.push({real:o.array[s][u],imaginary:0});e.push(l)}return e}var c=_t(o,i),h=function(t,e){for(var r=[],n=0;n<t.m;n++){for(var i=[],a=0;a<t.n;a++)i.push(t.array[n][a]+e.array[n][a]);r.push(i)}return{m:t.m,n:t.n,array:r}}(n,_t(i,c)),f=bt(h);if(f){var d=_t(c,f);for(s=0;s<t.m;s++){for(l=[],u=0;u<t.n;u++)l.push({real:f.array[s][u],imaginary:-d.array[s][u]});e.push(l)}return e}}}}(e);return n?n.map((function(t){return t.map((function(t){return y(t)}))})):ht()}},MMult:{description:"Returns the dot product of A and B",arguments:[{name:"A",boxed:!0},{name:"B",boxed:!0}],fn:function(t,e){var r=Te(t),n=Te(e);return!r.array||r.error||!n.array||n.error||r.m!==n.n?ht():function(t,e){for(var r=[],n=0;n<t.m;n++){for(var i=[],a=0;a<e.n;a++){for(var o={real:0,imaginary:0},s=0;s<t.n;s++)o.real+=t.array[n][s].real*e.array[s][a].real-t.array[n][s].imaginary*e.array[s][a].imaginary,o.imaginary+=t.array[n][s].real*e.array[s][a].imaginary+t.array[n][s].imaginary*e.array[s][a].real;i.push(o)}r.push(i)}return r}(n,r).map((function(t){return t.map((function(t){return y(t)}))}))}}},Ne=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.state_id=0,e.type=r.type,e.color=q.black,e.state_representation="",e}return e(r,t),r.prototype.UpdateState=function(){var t=JSON.stringify(this.edges_in.map((function(t){return t.result})));t!==this.state_representation&&(this.state_representation=t,this.state_id++)},r.prototype.Calculate=function(t){var e,r;if(this.dirty){try{for(var n=a(this.edges_in),i=n.next();!i.done;i=n.next())if(i.value.dirty)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.UpdateState(),this.dirty=!1}},r.prototype.AddDependent=function(t){throw new Error("leaf vertex cannot have dependents")},r.type="leaf-vertex",r}(et),Ee=function(t){function r(){var e,r,i,o,s=t.call(this)||this;s.library=new Ht,s.parser=new Q,s.expression_calculator=new Gt(s.library,s.parser),s.full_rebuild_required=!1,s.UpdateLocale(),s.library.Register(ie,we,Se,xe,Ce,ke,Pe);try{for(var u=a(Object.keys(Re)),c=u.next();!c.done;c=u.next()){var h=c.value;s.library.Alias(h,Re[h])}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}try{for(var f=a(Object.keys(Me)),d=f.next();!d.done;d=f.next())h=d.value,s.library.Alias(h,Me[h])}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}return s.library.Register({CountIf:{arguments:[{name:"range"},{name:"criteria"}],fn:function(t,e){var r,n,i,o,u=Bt(t);"string"!=typeof e?e="="+(e||0).toString():(e=e.trim(),/^[=<>]/.test(e)||(e="="+e));var c=s.parser.Parse("{}"+e),h=c.expression;if(c.error||!h)return st();if("binary"!==h.type)return st();if("array"!==h.left.type)return st();h.left.values=[u];var f=s.CalculateExpression(h);if(Array.isArray(f)){var d=0;try{for(var p=a(f),m=p.next();!m.done;m=p.next()){var v=m.value;try{for(var y=(i=void 0,a(v)),_=y.next();!_.done;_=y.next())_.value.value&&d++}catch(t){i={error:t}}finally{try{_&&!_.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{m&&!m.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return{type:l.number,value:d}}return f}},Offset:{arguments:[{name:"reference",description:"Base reference",metadata:!0},{name:"rows",description:"number of rows to offset"},{name:"columns",description:"number of columns to offset"}],return_type:at.reference,volatile:!0,fn:function(t,e,r,i,a){if(void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===a&&(a=1),!t)return ct();if(!Vt(t))return ft();var o=s.DynamicDependencies(t.value.address,s.expression_calculator.context.address,!0,e,r,i,a);if(!o)return ft();if(o.dirty)return s.GetVertex(s.expression_calculator.context.address,!0).short_circuit=!0,{type:l.undefined,value:void 0};if(o.area){var u=n(n({type:"address"},o.area.start),{label:"",position:0,id:0}),c=n(n({type:"address"},o.area.end),{label:"",position:0,id:0}),h=1===o.area.count?u:{type:"range",start:u,end:c,label:"",position:0,id:0};return{type:l.object,value:h}}return ht()}.bind(s)},Indirect:{arguments:[{name:"reference",description:"Cell reference (string)"}],return_type:at.reference,volatile:!0,fn:function(t){if(!t||"string"!=typeof t)return ct();var e=s.parser.Parse(t);if(e.error||!e.expression||"address"!==e.expression.type&&"range"!==e.expression.type)return ft();var r=s.DynamicDependencies(e.expression,s.expression_calculator.context.address);return r?r.dirty?(s.GetVertex(s.expression_calculator.context.address,!0).short_circuit=!0,{type:l.undefined,value:void 0}):{type:l.object,value:e.expression}:ft()}.bind(s)},Rows:{arguments:[{name:"reference",description:"Array or reference"}],volatile:!1,fn:function(t){if(!t)return ct();if(Array.isArray(t)){var e=t[0];return Array.isArray(e)?{type:l.number,value:e.length}:ht()}return{type:l.number,value:1}}},Columns:{arguments:[{name:"reference",description:"Array or reference"}],volatile:!1,fn:function(t){return t?Array.isArray(t)?{type:l.number,value:t.length}:{type:l.number,value:1}:ct()}},IsFormula:{description:"Returns true if the reference is a formula",arguments:[{name:"Reference",metadata:!0}],fn:qt((function(t){var e,r,n,i;if(null===(n=null==t?void 0:t.value)||void 0===n?void 0:n.address)try{for(var o=a((null===(i=s.model)||void 0===i?void 0:i.sheets)||[]),u=o.next();!u.done;u=o.next()){var c=u.value;if(c.id===t.value.address.sheet_id){var h=c.cells.GetCell(t.value.address,!1);return{type:l.boolean,value:(null==h?void 0:h.type)===l.formula}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return{type:l.boolean,value:!1}}))}}),s}return e(r,t),r.prototype.SpreadCallback=function(t,e){if(!t.address||!t.address.sheet_id)throw new Error("spread callback called without sheet id");var r=this.cells_map[t.address.sheet_id];if(!r)throw new Error("spread callback called without cells");if(t&&t.reference){var n=t.reference.area;if(n){var i=n.rows,a=n.columns;if(Array.isArray(e)){e=zt(e);for(var o=0;o<i;o++)if(e[o]){for(var s=0;s<a&&s<e[o].length;s++)r.data[o+n.start.row][s+n.start.column].SetCalculatedValue(e[o][s].value,e[o][s].type);for(;s<a;s++)r.data[o+n.start.row][s+n.start.column].SetCalculatedValue(void 0,l.undefined)}else for(s=0;s<a;s++)r.data[o+n.start.row][s+n.start.column].SetCalculatedValue(void 0,l.undefined)}else for(o=0;o<i;o++)for(s=0;s<a;s++)r.data[o+n.start.row][s+n.start.column].SetCalculatedValue(e.value,e.type)}}},r.prototype.CalculationCallback=function(t){if(!t.address)throw new Error("vertex missing address");return t.expression_error?{value:pt()}:this.expression_calculator.Calculate(t.expression,t.address)},r.prototype.DynamicDependencies=function(t,e,r,n,i,a,o){if(void 0===r&&(r=!1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=1),void 0===o&&(o=1),this.model){var s=this.ResolveExpressionAddress(t,e);if(s){var l=!1,c=(s=this.model.active_sheet.RealArea(s)).start.sheet_id;r&&(s=new u({column:s.start.column+i,row:s.start.row+n,sheet_id:s.start.sheet_id},{column:s.start.column+i+a-1,row:s.start.row+n+o-1,sheet_id:s.end.sheet_id}));for(var h=s.start.row;h<=s.end.row;h++)for(var f=s.start.column;f<=s.end.column;f++){var d=this.GetVertex({row:h,column:f,sheet_id:c},!1);d&&d.dirty&&(this.AddEdge({row:h,column:f,sheet_id:c},this.expression_calculator.context.address),l=!0)}return{dirty:l,area:s}}}},r.prototype.UpdateLocale=function(){","===x.decimal_separator?(this.parser.decimal_mark=F.Comma,this.parser.argument_separator=O.Semicolon):(this.parser.decimal_mark=F.Period,this.parser.argument_separator=O.Comma)},r.prototype.GetFunction=function(t){return this.library.Get(t)},r.prototype.SupportedFunctions=function(){var t,e,r=this.library.List(),n=Object.keys(r).map((function(t){var e=r[t].canonical_name;return e||(e=t.replace(/_/g,".")),{name:e,description:r[t].description,arguments:(r[t].arguments||[]).map((function(t){return{name:t.name||""}}))}}));if(this.model)try{for(var i=a(Object.keys(this.model.macro_functions)),o=i.next();!o.done;o=i.next()){var s=o.value,l=this.model.macro_functions[s];n.push({name:l.name,description:l.description,arguments:(l.argument_names||[]).map((function(t){return{name:t}}))})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},r.prototype.RegisterFunction=function(t){var e,r,i=this,o=function(e){var r,a=t[e],o=a.fn;a.fn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.apply({address:n({},i.expression_calculator.context.address)},t)},s.library.Register(((r={})[e]=a,r))},s=this;try{for(var l=a(Object.keys(t)),u=l.next();!u.done;u=l.next())o(u.value)}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},r.prototype.AttachModel=function(t){this.AttachData(t),this.expression_calculator.SetModel(t)},r.prototype.Calculate=function(t,e){if(this.AttachModel(t),e&&!e.start.sheet_id)throw new Error("CalculateInternal called with subset w/out sheet ID");this.full_rebuild_required&&(e=void 0,this.UpdateAnnotations(),this.full_rebuild_required=!1),this.RebuildGraph(e);try{this.Recalculate()}catch(t){console.error(t),console.info("calculation error trapped")}},r.prototype.Reset=function(){this.FlushTree(),this.model&&this.AttachModel(this.model),this.full_rebuild_required=!0},r.prototype.CalculateExpression=function(t,e,r){return void 0===e&&(e={row:-1,column:-1}),void 0===r&&(r=!1),this.expression_calculator.Calculate(t,e,r).value},r.prototype.RebuildClean=function(t,e){void 0===e&&(e=!1),this.full_rebuild_required=!1,this.AttachModel(t),this.RebuildGraph(),this.UpdateAnnotations(),this.InitializeGraph(),e&&this.volatile_list.length&&this.Recalculate()},r.prototype.FlattenCellList=function(t){var e,r,n={},i=[];try{for(var o=a(t),s=o.next();!s.done;s=o.next()){var l=s.value,c={column:l.column,row:l.row,sheet_id:l.sheet_id},h=u.CellAddressToLabel(c,!0);n[h]||(n[h]=h,i.push(c))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i},r.prototype.MetadataReferences=function(t){var e=[];if(!this.model)return e;var r=this.parser.Parse(t);if(r.expression&&"call"===r.expression.type){var n=this.GetFunction(r.expression.name);if(!n||!n.arguments)return e;for(var i=0;i<n.arguments.length;i++){var a=n.arguments[i];if(a&&a.metadata){var o=r.expression.args[i];if(o){var s=this.ResolveExpressionAddress(o);s&&e.push(s.start)}}}}return e},r.prototype.RemoveAnnotation=function(t){var e=t.temp.vertex;e&&(e.Reset(),this.RemoveLeafVertex(e))},r.prototype.UpdateAnnotations=function(t){var e,r;if(!t&&this.model&&(t=this.model.active_sheet.annotations),t){void 0===t||Array.isArray(t)||(t=[t]);try{for(var n=a(t),i=n.next();!i.done;i=n.next()){var o=i.value;if(o.formula){o.temp.vertex||(o.temp.vertex=new Ne);var s=o.temp.vertex;this.AddLeafVertex(s),this.UpdateLeafVertex(s,o.formula)}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}},r.prototype.ResolveSheetID=function(t,e){var r,n;if(!this.model)throw new Error("ResolveSheetID called without model");var i="address"===t.type?t:t.start;if(i.sheet_id)return!0;if(!i.sheet)return i.sheet_id=(null==e?void 0:e.sheet_id)||this.model.active_sheet.id,!0;var o=i.sheet.toLowerCase();try{for(var s=a(this.model.sheets),l=s.next();!l.done;l=s.next()){var u=l.value;if(u.name.toLowerCase()===o)return i.sheet_id=u.id,!0}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},r.prototype.ResolveExpressionAddress=function(t,e){switch(t.type){case"address":if(this.ResolveSheetID(t,e))return new u(t);break;case"range":if(this.ResolveSheetID(t,e))return new u(t.start,t.end);break;case"identifier":if(this.model){var r=this.model.named_ranges.Get(t.name.toUpperCase());if(r)return new u(r.start,r.end)}}},r.prototype.NamedRangeToAddressUnit=function(t){if(this.model){var e=t.name.toUpperCase(),r=this.model.named_ranges.Get(e);return r?1===r.count?this.ConstructAddressUnit(r.start,e,t.id,t.position):{type:"range",start:this.ConstructAddressUnit(r.start,e,t.id,t.position),end:this.ConstructAddressUnit(r.end,e,t.id,t.position),label:e,id:t.id,position:t.position}:void 0}},r.prototype.ConstructAddressUnit=function(t,e,r,n){return{type:"address",row:t.row,column:t.column,sheet_id:t.sheet_id,label:e,id:r,position:n}},r.prototype.RebuildDependencies=function(t,e,r,n,i){var o,s,l,u,c=this;if(void 0===n&&(n={addresses:{},ranges:{}}),!i&&(i={},this.model)){try{for(var h=a(this.model.sheets),f=h.next();!f.done;f=h.next()){var d=f.value;i[d.name.toLowerCase()]=d.id}}catch(t){o={error:t}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}if(!r)try{for(var p=a(this.model.sheets),m=p.next();!m.done;m=p.next())if((d=m.value).id===e){r=d.name;break}}catch(t){l={error:t}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(l)throw l.error}}}switch(t.type){case"literal":case"missing":case"operator":break;case"identifier":var v=this.NamedRangeToAddressUnit(t);v&&("address"===v.type?n.addresses[v.label]=v:n.ranges[v.label]=v);break;case"address":t.sheet_id||(t.sheet_id=t.sheet?i[t.sheet.toLowerCase()]||0:e,t.sheet||(t.sheet=r)),n.addresses[t.sheet_id+"!"+t.label]=t;break;case"range":t.start.sheet_id||(t.start.sheet_id=t.start.sheet?i[t.start.sheet.toLowerCase()]||0:e,t.start.sheet||(t.start.sheet=r)),n.ranges[t.start.sheet_id+"!"+t.start.label+":"+t.end.label]=t;break;case"unary":this.RebuildDependencies(t.operand,e,r,n,i);break;case"binary":this.RebuildDependencies(t.left,e,r,n,i),this.RebuildDependencies(t.right,e,r,n,i);break;case"group":t.elements.forEach((function(t){return c.RebuildDependencies(t,e,r,n,i)}));break;case"call":var y=t.args.slice(0),_=this.library.Get(t.name);_&&_.arguments&&_.arguments.forEach((function(t,n){t&&t.address&&(c.RebuildDependencies(y[n],e,r,void 0,i),y[n]={type:"missing",id:-1})})),y.forEach((function(t){return c.RebuildDependencies(t,e,r,n,i)}))}return n},r.prototype.UpdateLeafVertex=function(t,e){var r,n,i,o,s=this;if(!this.model)throw new Error("UpdateLeafVertex called without model");t.Reset();var l=this.parser.Parse(e);if(l.expression){var c=this.RebuildDependencies(l.expression,this.model.active_sheet.id,this.model.active_sheet.name);try{for(var h=a(Object.keys(c.ranges)),f=h.next();!f.done;f=h.next()){var d=f.value,p=c.ranges[d];new u(p.start,p.end).Iterate((function(e){s.AddLeafVertexEdge(e,t)}))}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}try{for(var m=a(Object.keys(c.addresses)),v=m.next();!v.done;v=m.next()){d=v.value;var y=c.addresses[d];this.AddLeafVertexEdge(y,t)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}}t.expression=l.expression||{type:"missing",id:-1},t.expression_error=!l.valid},r.prototype.ApplyMacroFunctionInternal=function(t,e,r){var n=this;switch(t.type){case"identifier":if(r[0]){var i=r[0][(t.name||"").toUpperCase()];if(i)return JSON.parse(JSON.stringify(i))}break;case"binary":t.left=this.ApplyMacroFunctionInternal(t.left,e,r),t.right=this.ApplyMacroFunctionInternal(t.right,e,r);break;case"unary":t.operand=this.ApplyMacroFunctionInternal(t.operand,e,r);break;case"group":t.elements=t.elements.map((function(t){return n.ApplyMacroFunctionInternal(t,e,r)}));break;case"call":if(t.args=t.args.map((function(t){return n.ApplyMacroFunctionInternal(t,e,r)})),!this.library.Get(t.name)){var a=e.macro_functions[t.name.toUpperCase()];if(a&&a.expression){var o=JSON.parse(JSON.stringify(a.expression)),s={};if(a.argument_names)for(var l=0;l<a.argument_names.length;l++)s[a.argument_names[l].toUpperCase()]=t.args[l]?t.args[l]:{type:"missing"};r.unshift(s);var u=this.ApplyMacroFunctionInternal(o,e,r);return r.shift(),u}}}return t},r.prototype.ApplyMacroFunctions=function(t){if(this.model&&Object.keys(this.model.macro_functions).length)return this.ApplyMacroFunctionInternal(t,this.model,[])},r.prototype.RebuildGraphCell=function(t,e){var r,i,o,s,c=this;if(t.area&&t.area.start.column===e.column&&t.area.start.row===e.row){var h=t.area,f=h.start,d=h.end,p=f.sheet_id||e.sheet_id;f.sheet_id||(f.sheet_id=p);for(var m=f.column;m<=d.column;m++)for(var v=f.row;v<=d.row;v++)this.ResetInbound({column:m,row:v,sheet_id:p},!0,!1);for(this.SetDirty(e),m=f.column;m<=d.column;m++)for(v=f.row;v<=d.row;v++)v===f.row&&m===f.column||this.AddEdge(f,n(n({},f),{row:v,column:m}))}if(t.type===l.formula){this.ResetInbound(e,!0);var y=this.parser.Parse(t.value);if(y.expression){if("call"===y.expression.type){var _=this.library.Get(y.expression.name);_&&(_.render||_.click)&&(t.render_function=_.render,t.click_function=_.click)}var g=this.RebuildDependencies(y.expression,e.sheet_id,"");try{for(var b=a(Object.keys(g.ranges)),x=b.next();!x.done;x=b.next()){var w=x.value,M=g.ranges[w],C=new u(M.start,M.end);C.entire_row||C.entire_column?this.AddArrayEdge(C,e):C.Iterate((function(t){return c.AddEdge(t,e)}))}}catch(t){r={error:t}}finally{try{x&&!x.done&&(i=b.return)&&i.call(b)}finally{if(r)throw r.error}}try{for(var A=a(Object.keys(g.addresses)),S=A.next();!S.done;S=A.next()){w=S.value;var R=g.addresses[w];this.AddEdge(R,e)}}catch(t){o={error:t}}finally{try{S&&!S.done&&(s=A.return)&&s.call(A)}finally{if(o)throw o.error}}}var k=this.GetVertex(e,!0);k&&(k.expression=y.expression||{type:"missing",id:-1},k.expression_error=!y.valid)}else t.value!==t.calculated?this.ResetInbound(e,!0,!1):t.type===l.undefined?this.ResetInbound(e,!0,!1,!0):console.warn("UNHANDLED CASE",t)},r.prototype.RebuildGraph=function(t){var e,r,n;if(t){if(!t.start.sheet_id)throw new Error("subset missing sheet id");for(var i=this.cells_map[t.start.sheet_id],o=t.start.row;o<=t.end.row;o++)if(f=i.data[o])for(var s=t.start.column;s<=t.end.column;s++)(p=f[s])&&this.RebuildGraphCell(p,{row:o,column:s,sheet_id:t.start.sheet_id})}else try{for(var l=a((null===(n=this.model)||void 0===n?void 0:n.sheets)||[]),u=l.next();!u.done;u=l.next()){var c=u.value,h=c.cells.data.length;for(o=0;o<h;o++){var f;if(f=c.cells.data[o]){var d=f.length;for(s=0;s<d;s++){var p;(p=f[s])&&this.RebuildGraphCell(p,{row:o,column:s,sheet_id:c.id})}}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},r.prototype.IsNativeOrTypedArray=function(t){return Array.isArray(t)||t instanceof Float64Array||t instanceof Float32Array},r.prototype.CheckVolatile=function(t){var e=this;if(!t.expression||t.expression_error)return!1;var r=!1;return this.parser.Walk(t.expression,(function(t){if("call"===t.type){var n=e.library.Get(t.name);n&&n.volatile&&(r=!0)}return!r})),r},r}(it),De=function(t){return t.length===3+t[2]?{column:t[0],row:t[1],sheet_id:0,data:t.subarray(3)}:{column:t[0],row:t[1],sheet_id:t[2],data:t.subarray(4)}},Oe=r(4691);!function(t){t[t.Null=0]="Null",t[t.Prep=1]="Prep",t[t.Simulation=2]="Simulation",t[t.Post=3]="Post"}(ve||(ve={}));var Fe=function(t){for(var e=Oe.MC.Uniform(t),r=[],n=0;n<t;n++)r[n]=n;for(n=0;n<t;n++){var i=n+Math.floor(e[n]*(t-n)),a=r[n];r[n]=r[i],r[i]=a}return r},Ie=function(){function t(){this.address={row:0,column:0},this.volatile=!1,this.iteration=0,this.iterations=0,this.call_index=0,this.lhs=!1,this.state=ve.Null,this.results=[],this.elapsed=0,this.trials=0,this.distributions=[],this.correlated_distributions={},this.functions={"Multivariate.Normal":{description:"Returns a sample from the multivariate normal distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"mean",description:"Distribution Mean",default:0},{name:"stdev",description:"Standard Deviation",default:1}],fn:this.multivariate_normal.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.LogNormal":{description:"Returns a sample from the multivariate log-normal distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"mean",description:"Mean of underlying Normal distribution",default:0},{name:"stdev",description:"Standard Deviation of underlying Normal distribution",default:1}],fn:this.multivariate_lognormal.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.Uniform":{description:"Returns a sample from the multivariate uniform distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"min",description:"Minimum Value",default:0},{name:"max",description:"Maximum Value",default:1}],fn:this.multivariate_uniform.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.Beta":{description:"Returns a sample from the multivariate beta distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"w",description:"Shape Parameter"},{name:"v",description:"Shape Parameter"}],fn:this.multivariate_beta.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.PERT":{description:"Returns a sample from the multivariate PERT distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"min",description:"Minimum Value"},{name:"mode",description:"Most-Likely Value"},{name:"max",description:"Maximum Value"},{name:"lambda",default:4}],fn:this.multivariate_pert.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.Triangular":{description:"Returns a sample from the multivariate triangular distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"min",description:"Minimum Value"},{name:"mode",description:"Most-Likely Value"},{name:"max",description:"Maximum Value"}],fn:this.multivariate_triangular.bind(this),category:["RiskAMP Random Distributions"],extension:!0},UniformRangeSample:{description:"Returns one of a set of values, with equal probability and with replacement",simulation_volatile:!0,arguments:[{name:"range",description:"Range of Values"}],fn:this.uniformrangesample.bind(this),category:["RiskAMP Random Distributions"],extension:!0},SampleValue:{description:"Returns one of a set of values, with equal probability and with replacement",simulation_volatile:!0,arguments:[{name:"range",description:"Range of Values"}],fn:this.samplevalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"SampleValue.Weighted":{description:"Returns one of a set of values, weighted by a second set of values",simulation_volatile:!0,arguments:[{name:"range",description:"Range of Values"},{name:"weights",description:"Range of Weights"}],fn:this.samplevalue_weighted.bind(this),category:["RiskAMP Random Distributions"],extension:!0},BernoulliValue:{description:"Returns true or false (boolean) based on the given probability",simulation_volatile:!0,arguments:[{name:"p",description:"Probability to return True",default:.5}],fn:this.bernoullivalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},ProbabilityValue:{description:"Returns true or false (boolean) based on the given probability",simulation_volatile:!0,arguments:[{name:"p",description:"Probability to return True",default:.5}],fn:this.probabilityvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},UniformValue:{description:"Returns a sample from the uniform distribution",simulation_volatile:!0,arguments:[{name:"min",description:"Minimum",default:0},{name:"max",description:"Maximum",default:1}],fn:this.uniformvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},BetaValue:{description:"Returns a sample from the beta distribution",simulation_volatile:!0,arguments:[{name:"w",description:"Shape Parameter"},{name:"v",description:"Shape Parameter"}],fn:this.betavalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},TruncatedNormalValue:{description:"Returns a sample from the normal distribution",simulation_volatile:!0,arguments:[{name:"mean",description:"Mean",default:0},{name:"stdev",description:"Standard Deviation",default:1},{name:"min",description:"Minimum Value"},{name:"max",description:"Maximum Value"}],fn:this.truncatednormalvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},NormalValue:{description:"Returns a sample from the normal distribution",simulation_volatile:!0,arguments:[{name:"mean",description:"Mean",default:0},{name:"stdev",description:"Standard Deviation",default:1}],fn:this.normalvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},PERTValue:{description:"Returns a sample from the beta-PERT distribution",simulation_volatile:!0,arguments:[{name:"min",description:"Minimum Value",default:0},{name:"mode",description:"Most-Likely Value",default:.5},{name:"max",description:"Maximum Value",default:1},{name:"lambda",default:4}],fn:this.pertvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},LognormalValue:{description:"Returns a sample from the log-normal distribution",simulation_volatile:!0,arguments:[{name:"mean",description:"Mean of underlying Normal distribution",default:0},{name:"stdev",description:"Standard Deviation of underlying Normal distribution",default:1}],fn:this.lognormalvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},SequentialValue:{description:"Returns one from a set of values, in order",simulation_volatile:!0,arguments:[{name:"values",description:"Data Array"},{name:"count",description:"Count",default:0}],fn:this.sequentialvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},IndexValue:{description:"Returns a monotonically increasing value",simulation_volatile:!0,arguments:[{name:"max",description:"Maximum",default:0}],fn:this.indexvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"PERTValue.P":{description:"Returns a sample from the beta-PERT distribution",simulation_volatile:!0,arguments:[{name:"p10",description:"10th-Percentile Value",default:0},{name:"mode",description:"Most-Likely Value",default:.5},{name:"p90",description:"90th-Percentile Value",default:1},{name:"lambda",default:4}],fn:this.pertvalue_p.bind(this),category:["RiskAMP Random Distributions"],extension:!0},TriangularValue:{description:"Returns a sample from the triangular distribution",simulation_volatile:!0,arguments:[{name:"min",description:"Minimum Value",default:0},{name:"mode",description:"Most Likely Value",default:.5},{name:"max",description:"Maximum Value",default:1}],fn:this.triangularvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},SimulationCorrelation:{description:"Returns the correlation between the data from two cells in the simulation",arguments:[{name:"reference cell",description:"Cell 1",collector:!0},{name:"reference cell",description:"Cell 2",collector:!0}],fn:this.simulationcorrelation.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationRSquared:{description:"Returns the r-squared value (coefficient of correlation) of the data from two cells in the simulation",arguments:[{name:"dependent",description:"Dependent Value",collector:!0},{name:"independent",description:"Indepdendent Value",collector:!0}],fn:this.simulationrsquared.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationSkewness:{description:"Returns the skewness of data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationskewness.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationKurtosis:{description:"Returns the kurtosis (peakedness) of data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationkurtosis.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationPercentile:{description:"Returns the value of a cell at a given percentile in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"percentile",description:"Percentile (as %)"}],fn:this.simulationpercentile.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationInterval:{description:"Returns the portion of results in the simulation that fall within some bounds (as a percentage)",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"min",description:"Minimum Value (optional, inclusive)"},{name:"max",description:"Maximum Value (optional, inclusive)"}],fn:this.simulationinterval.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationMean:{description:"Returns the mean (average) value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmean.bind(this),extension:!0,category:["RiskAMP Simulation Functions"]},SimulationMedian:{description:"Returns the median value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmedian.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationValue:{description:"Returns the value of this cell in the simulation at the given trial number",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"iteration",description:"Trial Number"}],fn:this.simulationvalue.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationValuesArray:{description:"Returns all values of this cell in the simulation, as an array",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationvaluesarray.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SortedSimulationIndex:{description:"Returns the iteration number of a sorted value for this cell",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"index"}],fn:this.sortedsimulationindex.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},"SimulationValuesArray.Ordered":{description:"Returns all values of this cell in the simulation, as an array, ordered by a second cell",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"order by",description:"Reference Cell for Ordering",collector:!0}],fn:this.simulationvaluesarray_ordered.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationMin:{description:"Returns the minimum value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmin.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationMax:{description:"Returns the maximum value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmax.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationStandardError:{description:"Returns the standard error of the mean from this cell in the simulation",arguments:[{name:"reference cell",collector:!0}],fn:this.simulationstandarderror.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationStandardDeviation:{description:"Returns the standard deviation of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationstandarddeviation.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationVariance:{description:"Returns the variance of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationvariance.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationTrials:{description:"Returns the number of trials from the last simulation",fn:this.simulationtrials.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationTime:{description:"Returns the elapsed time of the last simulation",fn:this.simulationtime.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},IsPosDef:{description:"Checks that a matrix is positive-definite",arguments:[{name:"matrix"}],fn:function(t){if(t.some((function(t){return t.some((function(t){return"number"!=typeof t}))})))return ht();var e=Oe.Matrix.FromArray(t);return{type:l.boolean,value:e.IsPosDef()}},extension:!0},MakePosDef:{description:"Returns a matrix that is positive-definite",arguments:[{name:"matrix"}],fn:function(t){return t.some((function(t){return t.some((function(t){return"number"!=typeof t}))}))?ht():Oe.Matrix.FromArray(t).MakePosDef().ToArray().map((function(t){return t.map((function(t){return{type:l.number,value:t}}))}))},extension:!0},Cholesky:{arguments:[{name:"matrix"},{name:"transpose",default:!1}],fn:function(t,e){return void 0===e&&(e=!1),Oe.Matrix.FromArray(t).Cholesky(e).ToArray().map((function(t){return t.map((function(t){return{type:l.number,value:t}}))}))},extension:!0},EigenValues:{description:"Returns the eigenvalues of the matrix (as column vector)",arguments:[{name:"matrix"}],fn:function(t){return t.some((function(t){return t.some((function(t){return"number"!=typeof t}))}))?ht():[Oe.Matrix.FromArray(t).EigenSystem().realvalues.map((function(t){return{type:l.number,value:t}}))]},extension:!0},EigenVectors:{description:"Returns the eigenvectors of the matrix (as matrix)",arguments:[{name:"matrix"}],fn:function(t){return t.some((function(t){return t.some((function(t){return"number"!=typeof t}))}))?ht():Oe.Matrix.FromArray(t).EigenSystem().vectors.map((function(t){return Array.from(t).map((function(t){return{type:l.number,value:t}}))}))},extension:!0},"RiskAMP.Scale":{description:"Creates a uniform scale within a given range",arguments:[{name:"min"},{name:"max"}],fn:this.Scale.bind(this),extension:!0},"RiskAMP.HistogramTable":{description:"Creates a histogram table from a source cell",arguments:[{name:"reference cell",collector:!0}],fn:this.HistogramTable.bind(this),extension:!0},"RiskAMP.Permutation":{description:"Creates a random permutation of source data",arguments:[{name:"range",boxed:!0}],fn:this.Permutation.bind(this),extension:!0,simulation_volatile:!0}}}return Object.defineProperty(t.prototype,"seed",{set:function(t){Oe.Random.Seed(t)},enumerable:!1,configurable:!0}),t.prototype.CallerArea=function(){var t,e,r,n,i=1,o=1;if(this.address.sheet_id)try{for(var s=a((null===(r=this.model)||void 0===r?void 0:r.sheets)||[]),l=s.next();!l.done;l=s.next()){var u=l.value;if(u.id===this.address.sheet_id){u.cells.data[this.address.row]&&(n=u.cells.data[this.address.row][this.address.column]);break}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return(null==n?void 0:n.area)&&(i=n.area.rows,o=n.area.columns),{rows:i,columns:o}},t.prototype.CorrelateDistributions=function(){var t,e,r=this,n=function(t){var e=i.correlated_distributions[t],n=e.addresses.map((function(t){return r.distributions[t.sheet_id||0][t.column][t.row][t.call_index]}));try{var a=Oe.MC.CorrelateCDM(e.correlation,n,!0);e.addresses.forEach((function(t,e){r.distributions[t.sheet_id||0][t.column][t.row][t.call_index]=a[e]}))}catch(t){console.warn(t)}},i=this;try{for(var o=a(Object.keys(this.correlated_distributions)),s=o.next();!s.done;s=o.next())n(s.value)}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.InitDistribution=function(){if(!this.address)throw new Error("invalid address");if(!this.address.sheet_id)throw new Error("address missing sheet ID");this.distributions[this.address.sheet_id]||(this.distributions[this.address.sheet_id]=[]);var t=this.distributions[this.address.sheet_id];t[this.address.column]||(t[this.address.column]=[]);var e=t[this.address.column];e[this.address.row]||(e[this.address.row]=[])},t.prototype.StoreCellResults=function(t){if(t||(t=this.address),t){if(!t.sheet_id)throw new Error("SCR called without sheet id");this.results[t.sheet_id]||(this.results[t.sheet_id]=[]),this.results[t.sheet_id][t.column]||(this.results[t.sheet_id][t.column]=[]);var e=this.results[t.sheet_id][t.column];return e[t.row]||(e[t.row]=[]),e[t.row]}},t.prototype.PrepMultivariate=function(t,e){if(!this.correlated_distributions[t]){var r=Oe.CDMatrix.FromArray(e);if(!r.IsSymmetric()){for(var n=1;n<e.length;n++)for(var i=0;i<n;i++)if(e[n][i]){console.warn("invalid lower-triangular matrix");break}r=r.Symmetrize(!0)}this.correlated_distributions[t]={correlation:r,addresses:[]}}this.correlated_distributions[t].addresses.push({column:this.address.column,row:this.address.row,sheet_id:this.address.sheet_id,call_index:this.call_index}),this.InitDistribution()},t.prototype.ValidateCorrelationMatrix=function(t){var e=Oe.Matrix.FromArray(t);return e.IsSymmetric()||(e=e.Symmetrize(!0)),!(t.some((function(t){return t.some((function(t){return"number"!=typeof t&&void 0!==t}))}))||!e.IsPosDef())},t.prototype.multivariate_normal=function(t,e,r,n){if(void 0===r&&(r=0),void 0===n&&(n=1),this.state===ve.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Normal(this.iterations,{mean:r,sd:n,lhs:this.lhs,ordered:!0});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:Oe.MC.Normal(1,{mean:r,sd:n})[0]}:lt()},t.prototype.multivariate_lognormal=function(t,e,r,n){if(void 0===r&&(r=0),void 0===n&&(n=1),this.state===ve.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.LogNormal(this.iterations,{mean:r,sd:n,lhs:this.lhs,ordered:!0});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:Oe.MC.LogNormal(1,{mean:r,sd:n})[0]}:lt()},t.prototype.multivariate_beta=function(t,e,r,n){if(void 0===r&&(r=1),void 0===n&&(n=2),this.state===ve.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Beta(this.iterations,{a:r,b:n,lhs:this.lhs,ordered:!0});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:Oe.MC.Beta(1,{a:r,b:n})[0]}:lt()},t.prototype.multivariate_uniform=function(t,e,r,n){if(void 0===r&&(r=0),void 0===n&&(n=1),this.state===ve.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Uniform(this.iterations,{min:r,max:n,lhs:this.lhs,ordered:!0});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:Oe.MC.Uniform(1,{min:r,max:n})[0]}:lt()},t.prototype.multivariate_pert=function(t,e,r,n,i,a){if(void 0===r&&(r=0),void 0===n&&(n=.5),void 0===i&&(i=1),void 0===a&&(a=4),this.state===ve.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.PERT(this.iterations,{a:r,b:i,c:n,lambda:a,lhs:this.lhs,ordered:!0});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:Oe.MC.PERT(1,{a:r,b:i,c:n,lambda:a})[0]}:lt()},t.prototype.multivariate_triangular=function(t,e,r,n,i){if(void 0===r&&(r=0),void 0===n&&(n=.5),void 0===i&&(i=1),this.state===ve.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Triangular(this.iterations,{a:r,b:i,c:n,lhs:this.lhs,ordered:!0});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:Oe.MC.Triangular(1,{a:r,b:i,c:n})[0]}:lt()},t.prototype.uniformvalue=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Uniform(this.iterations,{min:t,max:e,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.Uniform(1,{min:t,max:e})[0]}},t.prototype.bernoullivalue=function(t){if(void 0===t&&(t=.5),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Bernoulli(this.iterations,{p:t,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.boolean,value:Oe.MC.Bernoulli(1,{p:t})[0]}},t.prototype.probabilityvalue=function(t){return void 0===t&&(t=.5),this.bernoullivalue(t)},t.prototype.sequentialvalue=function(t,e){if(void 0===e&&(e=0),this.state===ve.Prep)this.InitDistribution();else if(this.state===ve.Simulation){var r=this.iteration;e>0&&(r=this.iteration%e);var n=t[0].length,i=Math.floor(r/n)%t.length,a=r%n;return{type:l.number,value:t[i][a]}}return{type:l.number,value:t[0][0]}},t.prototype.indexvalue=function(t){if(void 0===t&&(t=0),this.state===ve.Prep)this.InitDistribution();else if(this.state===ve.Simulation)return t>0?{type:l.number,value:this.iteration%t+1}:{type:l.number,value:this.iteration+1};return{type:l.number,value:1}},t.prototype.lognormalvalue=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.LogNormal(this.iterations,{mean:t,sd:e,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.LogNormal(1,{mean:t,sd:e})[0]}},t.prototype.truncatednormalvalue=function(t,e,r,n){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.TruncatedNormal(this.iterations,{mean:t,sd:e,lhs:this.lhs,min:r,max:n});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.TruncatedNormal(1,{mean:t,sd:e,min:r,max:n})[0]}},t.prototype.normalvalue=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Normal(this.iterations,{mean:t,sd:e,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.Normal(1,{mean:t,sd:e})[0]}},t.prototype.pertvalue=function(t,e,r,n){if(void 0===t&&(t=0),void 0===e&&(e=.5),void 0===r&&(r=1),void 0===n&&(n=4),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.PERT(this.iterations,{a:t,b:r,c:e,lambda:n,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.PERT(1,{a:t,b:r,c:e,lambda:n})[0]}},t.prototype.pertvalue_p=function(t,e,r,i){if(void 0===t&&(t=0),void 0===e&&(e=.5),void 0===r&&(r=1),void 0===i&&(i=4),this.state===ve.Prep){var a=Oe.MC.P80Pert(t,r,e,i);this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.PERT(this.iterations,n(n({},a),{lambda:i,lhs:this.lhs}))}else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};var o=Oe.MC.P80Pert(t,r,e,i);return{type:l.number,value:Oe.MC.PERT(1,n(n({},o),{lambda:i}))[0]}},t.prototype.CommonDistributionFunction=function(t,e,r){if(this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=t.apply(e,[this.iterations].concat(r));else if(this.state===ve.Simulation)return this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration];return t.apply(e,[1].concat(r))[0]},t.prototype.triangularvalue=function(t,e,r){if(void 0===t&&(t=0),void 0===e&&(e=.5),void 0===r&&(r=1),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Triangular(this.iterations,{a:t,b:r,c:e,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.Triangular(1,{a:t,b:r,c:e})[0]}},t.prototype.betavalue=function(t,e){if(void 0===t&&(t=1),void 0===e&&(e=1),this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Beta(this.iterations,{a:t,b:e,lhs:this.lhs});else if(this.state===ve.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:Oe.MC.Beta(1,{a:t,b:e})[0]}},t.prototype.samplevalue=function(t){return this.uniformrangesample(t)},t.prototype.samplevalue_weighted=function(t,e){if(this.state===ve.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Uniform(this.iterations,{min:0,max:1,lhs:this.lhs});else{var r=this.state===ve.Simulation?this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]:Oe.MC.Uniform(1,{min:0,max:1})[0];if(!t||!t.length)return{type:l.undefined,value:void 0};for(var n=r*Bt(e).reduce((function(t,e){return void 0===e?t:t+Number(e)}),0),i=0,a=0;a<t.length;a++)for(var o=0;o<t[a].length;o++)if((i+=e[a][o])>=n)return{type:l.number,value:t[a][o]}}return{type:l.number,value:t[0][0]}},t.prototype.uniformrangesample=function(t){this.state===ve.Prep&&(this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=Oe.MC.Uniform(this.iterations,{min:0,max:1,lhs:this.lhs}));var e=this.state===ve.Simulation?this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]:Oe.MC.Uniform(1,{min:0,max:1})[0];if(!t||!t.length)return{type:l.undefined,value:void 0};var r=Math.floor(t[0].length*t.length*e),n=t[r%t.length][Math.floor(r/t.length)]||"";return{value:n,type:f(n)}},t.prototype.simulationtrials=function(){return{type:l.number,value:this.trials}},t.prototype.simulationtime=function(){return{type:l.number,value:this.elapsed/1e3}},t.prototype.simulationvaluesarray=function(t){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();for(var e=[],r=0;r<t.length;r++)e[r]={type:l.number,value:t[r]};return[e]},t.prototype.simulationvaluesarray_ordered=function(t,e){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length||e&&!e.length)return lt();if(!e)return[Array.prototype.slice.call(t,0).sort((function(t,e){return t-e})).map((function(t){return{type:l.number,value:t}}))];var r=Array.from(t).map((function(t,r){return[t,e[r]]}));return r.sort((function(t,e){return t[1]-e[1]})),[r.map((function(t){return{type:l.number,value:t[0]}}))]},t.prototype.simulationrsquared=function(t,e){return this.state!==ve.Null?{type:l.number,value:0}:t&&t.length&&e&&e.length?{type:l.number,value:Oe.Stats.R2(t,e)}:lt()},t.prototype.simulationcorrelation=function(t,e){return this.state!==ve.Null?{type:l.number,value:0}:t&&t.length&&e&&e.length?{type:l.number,value:Oe.Stats.Correlation(t,e)}:lt()},t.prototype.sortedsimulationindex=function(t,e){if(void 0===e&&(e=1),this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();if(e<1||e>t.length)return ct();var r=Array.from(t).map((function(t,e){return[t,e+1]}));return r.sort((function(t,e){return t[0]-e[0]})),{type:l.number,value:r[e-1][1]}},t.prototype.simulationvalue=function(t,e){return void 0===e&&(e=1),this.state!==ve.Null?{type:l.number,value:0}:t&&t.length?e<1||e>t.length?ct():{type:l.number,value:t[e-1]}:lt()},t.prototype.simulationpercentile=function(t,e){return void 0===e&&(e=.5),this.state!==ve.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:Oe.Stats.Percentile(t,e)}:lt()},t.prototype.simulationstandarddeviation=function(t){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var e=Oe.Stats.Statistics(t);return{type:l.number,value:e.stdev}},t.prototype.simulationvariance=function(t){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var e=Oe.Stats.Statistics(t);return{type:l.number,value:e.variance}},t.prototype.simulationskewness=function(t){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var e=Oe.Stats.Statistics(t);return{type:l.number,value:e.skewness}},t.prototype.simulationkurtosis=function(t){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var e=Oe.Stats.Statistics(t);return{type:l.number,value:e.kurtosis}},t.prototype.simulationinterval=function(t,e,r){return this.state!==ve.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:Oe.Stats.Interval({data:t,min:e,max:r})}:lt()},t.prototype.simulationstandarderror=function(t){var e,r,n,i;if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var o=0,s=0;try{for(var u=a(t),c=u.next();!c.done;c=u.next())o+=c.value||0}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}var h=o/t.length;try{for(var f=a(t),d=f.next();!d.done;d=f.next()){var p=d.value-h;s+=p*p}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return{type:l.number,value:Math.sqrt(s/t.length)/Math.sqrt(t.length)}},t.prototype.simulationmin=function(t){return this.state!==ve.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:Math.min.apply(0,t)}:lt()},t.prototype.simulationmax=function(t){return this.state!==ve.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:Math.max.apply(0,t)}:lt()},t.prototype.simulationmean=function(t){var e,r;if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var n=0;try{for(var i=a(t),o=i.next();!o.done;o=i.next())n+=o.value}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return{type:l.number,value:n/t.length}},t.prototype.simulationmedian=function(t){if(this.state!==ve.Null)return{type:l.number,value:0};if(!t||!t.length)return lt();var e=t.filter((function(t){return"number"==typeof t?t:0}));return e.sort((function(t,e){return t-e})),{type:l.number,value:e[Math.round(e.length/2)]}},t.prototype.Permutation=function(t){if(!t){var e=this.CallerArea(),r=e.rows,i=e.columns;if((p=r*i)<=0)return ct();for(var a=Fe(p),o=[],s=0,u=0;u<i;u++){for(var c=[],h=0;h<r;h++)c.push({type:l.number,value:a[s++]});o.push(c)}return o}if(Array.isArray(t)){r=t.length;var f=t[0].length;if(!r||!f)return ct();var d=t.reduce((function(t,e){return e.concat(t)}),[]),p=r*f;if(d.length!==p)throw console.info("invalid?",p,t,d),new Error("invalid length");for(a=Fe(p),o=[],s=0,h=0;h<r;h++){var m=[];for(u=0;u<f;u++){var v=a[s++];m.push(n({},d[v]))}o.push(m)}return o}return n({},t)},t.prototype.Scale=function(t,e){var r=this.CallerArea(),n=r.rows,i=r.columns,a=Math.max(n,i),o=t>e?U(e,t,a-1,!0):U(t,e,a-1,!0),s=o.min,u=[[]];if(o.count<a-1&&(s=o.min-Math.floor((a-1-o.count)/2)*o.step),t>e)for(var c=0;c<a;c++){var h=s+c*o.step;u[0][a-1-c]={type:l.number,value:h}}else for(c=0;c<a;c++)h=s+c*o.step,u[0][c]={type:l.number,value:h};return n<i?zt(u):u},t.prototype.HistogramTable=function(t){var e=this.CallerArea(),r=e.rows,n=e.columns,i=Math.max(r,n),a=Math.min(r,n);if(Array.isArray(t)||t instanceof Float64Array||t instanceof Float32Array){if(t.length<=1)return{type:l.number,value:0};Array.isArray(t)||(t=Array.prototype.slice.call(t)),t.sort((function(t,e){return t-e}));var o=t[0]||0,s=t[t.length-1]||0;if(s===o)return{type:l.number,value:0};var u=[[],[]],c=U(o,s,i,!0),h=c.min,f=0;c.count<i&&(h=c.min-Math.ceil(i-c.count)/2*c.step);for(var d=0;d<i;d++){for(var p=h+(d+1)*c.step,m=0;f<t.length&&t[f]<p;f++,m++);u[1][d]={type:l.number,value:m},u[0][d]={type:l.number,value:p}}return 1===a&&(u=[u[1]]),n>r?zt(u):u}return{type:l.number,value:0}},t}(),Le=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.simulation_model=new Ie,n.context=n.simulation_model,n}return e(r,t),r.prototype.CallExpression=function(t,e){var r=this;void 0===e&&(e=!1);var n=this.library.Get(t.name);if(!n)return function(t){return dt()};var i=n.arguments||[];return this.simulation_model.state===ve.Prep&&t.args.forEach((function(t,e){var n=i[e]||{};if(t&&n.collector)if("address"===t.type)r.simulation_model.StoreCellResults(t);else if("identifier"===t.type){var a=r.named_range_map[t.name.toUpperCase()];a&&r.simulation_model.StoreCellResults(a.start)}else if("call"===t.type){var o=r.CalculateExpression(t,!0);o&&jt(o)&&("address"===o.value.type?r.simulation_model.StoreCellResults(o.value):"range"===o.value.type&&r.simulation_model.StoreCellResults(o.value.start))}})),function(a){var o=r.call_index++;r.simulation_model.volatile=r.simulation_model.volatile||!!n.volatile||!!n.simulation_volatile&&r.simulation_model.state!==ve.Null;var s,u="IF"===t.name.toUpperCase(),c=-1,h=a.args.map((function(t,e){if(!s){var n=i[Math.min(e,i.length-1)]||{};if(e===c)return n.boxed?m():void 0;if(void 0===t)return u&&0===e&&(c=1),n.boxed?m():void 0;if(n.address)return n.boxed?{type:l.string,value:r.parser.Render(t).replace(/\$/g,"")}:r.parser.Render(t).replace(/\$/g,"");if(n.metadata)return r.GetMetadata(t,(function(t,e){return{simulation_data:r.simulation_model.state===ve.Null?r.simulation_model.StoreCellResults(e):[]}}));if(n.collector&&r.simulation_model.state===ve.Null){if("address"===t.type)return r.simulation_model.StoreCellResults(t);if("range"===t.type)return r.simulation_model.StoreCellResults(t.start);if("identifier"===t.type){var a=r.named_range_map[t.name.toUpperCase()];if(a)return r.simulation_model.StoreCellResults(a.start)}else if("call"===t.type&&(o=r.CalculateExpression(t,!0))&&jt(o)){if("address"===o.value.type)return r.simulation_model.StoreCellResults(o.value);if("range"===o.value.type)return r.simulation_model.StoreCellResults(o.value.start)}return s=ft()}var o=r.CalculateExpression(t);if(!Array.isArray(o)&&o.type===l.error)return n.allow_error?o:void(s=o);if(u&&0===e&&!Array.isArray(o)){var h=!1;if(o.type===l.string){var f=o.value.toLowerCase().trim();h="false"!==f&&"f"!==f}else h=!!o.value;c=h?2:1}return n.boxed?o:Array.isArray(o)?o.map((function(t){return t.map((function(t){return t.value}))})):o.value}}));if(s)return s;if(r.context.call_index=o,n.return_type===at.reference){var f=n.fn.apply(null,h);if(e)return f;if(jt(f)){if("address"===f.value.type)return r.CellFunction2(f.value)();if("range"===f.value.type)return r.CellFunction4(f.value.start,f.value.end)}return f}return n.fn.apply(null,h)}},r}(Gt),Ue=function(t){function r(){var e=t.call(this)||this;return e.expression_calculator=e.simulation_expression_calculator=new Le(e.library,e.parser),e.library.Register(e.simulation_expression_calculator.simulation_model.functions),e}return e(r,t),r.prototype.InitSimulation=function(t,e,r,n,i){var o,s,l,u,c,h=this.simulation_expression_calculator.simulation_model;if(h.iterations=t,h.results=[],h.lhs=e,h.correlated_distributions={},"number"==typeof i&&(h.seed=i),this.Reset(),this.AttachModel(r),n&&n.length)try{for(var f=a(n),d=f.next();!d.done;d=f.next()){var p=d.value;if(!p.sheet_id)throw new Error("additional cell passed without sheet id");try{for(var m=(l=void 0,a((null===(c=this.model)||void 0===c?void 0:c.sheets)||[])),v=m.next();!v.done;v=m.next()){var y=v.value;if(y.id===p.sheet_id){y.cells.GetCell(p,!1)&&h.StoreCellResults(p);break}}}catch(t){l={error:t}}finally{try{v&&!v.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}}}catch(t){o={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}if(this.RebuildGraph(),this.LoopCheck())throw new Error("Loop (circular dependency) found in graph");return h.state=ve.Prep,h.iteration=0,this.Recalculate(),h.CorrelateDistributions(),h.state=ve.Simulation,tt.OK},r.prototype.GetResults=function(){return this.simulation_expression_calculator.simulation_model.results},r.prototype.SimulationTrial=function(t){var e=this.simulation_expression_calculator.simulation_model;e.iteration=t;try{for(var r in this.Recalculate(),e.results){var n=this.cells_map[r];for(var i in e.results[r]){var a=e.results[r][i];for(var o in a){var s=n.GetCell({row:Number(o),column:Number(i)});if(s){var l=s.GetValue();switch(typeof l){case"number":a[o][t]=l;break;case"boolean":a[o][t]=l?1:0;break;default:a[o][t]=0}}}}}return{status:tt.OK,reference:null}}catch(t){return console.info("calculation error trapped",t),{status:tt.CalculationError,reference:null}}},r.prototype.FlattenedResults=function(){var t,e,r,n=this.simulation_expression_calculator.simulation_model,i=[];for(var a in n.results)for(var o in n.results[a]){var s=n.results[a][o];for(var l in s)i.push((t={row:Number(l),column:Number(o),sheet_id:Number(a),data:s[l]},void 0,r=void 0,e=4+t.data.length,r=new Float64Array(e),r[0]=t.column,r[1]=t.row,r[2]=t.sheet_id,r[3]=t.data.length,r.set(t.data,4),r).buffer)}return i},r.prototype.FlushSimulationResults=function(){var t=this.simulation_expression_calculator.simulation_model;t.results=[],t.elapsed=0,t.trials=0},r.prototype.ShiftSimulationResults=function(t,e,r,n){},r.prototype.UpdateResults=function(t,e,r){var n,i;if(void 0===e&&(e=this.model),void 0===r&&(r=!0),!e)throw new Error("UpdateResults called without model");var o=this.simulation_expression_calculator.simulation_model;if(t){o.results=[],o.elapsed=t.elapsed,o.trials=t.trials;try{for(var s=a(t.results),l=s.next();!l.done;l=s.next()){var u=l.value,c=u instanceof ArrayBuffer?De(new Float64Array(u)):u;c.sheet_id||(c.sheet_id=e.active_sheet.id),o.results[c.sheet_id]||(o.results[c.sheet_id]=[]),o.results[c.sheet_id][c.column]||(o.results[c.sheet_id][c.column]=[]),o.results[c.sheet_id][c.column][c.row]=c.data,r&&this.SetDirty(c)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}else o.results=[],o.elapsed=0,o.trials=0},r}(Ee),je=function(){function t(t){this.base_worker=t,this.trials=0,this.lhs=!1,this.data_model={active_sheet:G.Blank({}),sheets:[G.Blank({})],named_ranges:new z,macro_functions:{}},this.screen_updates=!1,this.calculator=new Ue,this.start_time=0,this.additional_cells=[],this.iteration=0}return t.prototype.Timestamp=function(){return self.performance?performance.now():Date.now()},t.prototype.OnMessage=function(t){var e,r,n=t.data;if(n)switch(n.type){case"configure":if(n.locale&&n.locale!==x.locale&&(x.UpdateLocale(n.locale),this.calculator.UpdateLocale()),this.data_model.sheets=n.sheets.map((function(t){return G.FromJSON(t,{})})),this.data_model.active_sheet=this.data_model.sheets[0],n.additional_cells&&(this.additional_cells=n.additional_cells),this.data_model.named_ranges.Deserialize(n.named_ranges),this.data_model.macro_functions={},n.macro_functions)try{for(var i=a(n.macro_functions),o=i.next();!o.done;o=i.next()){var s=o.value;this.data_model.macro_functions[s.name.toUpperCase()]=s}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.seed=n.seed;break;case"step":this.SimulationStep();break;case"start":this.trials=n.trials||1e3,this.lhs=!!n.lhs,this.screen_updates=!!n.screen_updates,this.Start()}},t.prototype.Post=function(t,e){this.base_worker.postMessage(t,e)},t.prototype.SimulationStep=function(){if(!(this.iteration>=this.trials)){this.calculator.SimulationTrial(this.iteration);var t=Math.floor(this.iteration/this.trials*100);if(++this.iteration!==this.trials){var e=this.calculator.FlattenedResults(),r=this.Timestamp()-this.start_time;this.Post({type:"update",percent_complete:t,cells:this.data_model.active_sheet.cells.toJSON(),trial_data:{results:e,trials:this.iteration,elapsed:r}},e)}else this.Finish()}},t.prototype.Start=function(){if(!this.trials)throw new Error("invalid trial count");this.start_time=this.Timestamp();var t=this.calculator.InitSimulation(this.trials,this.lhs,this.data_model,this.additional_cells,this.seed);if(this.seed=void 0,t!==tt.OK)throw new Error("graph failed");var e=0;if(this.screen_updates)this.iteration=0,this.SimulationStep();else{for(var r=0;r<this.trials;r++){this.calculator.SimulationTrial(r);var n=Math.floor(r/this.trials*100);n!==e&&(e=n,this.Post({type:"progress",percent_complete:e}))}this.Finish()}},t.prototype.Finish=function(){this.Post({type:"progress",percent_complete:100});var t=this.calculator.FlattenedResults(),e=this.Timestamp()-this.start_time;this.Post({type:"complete",trial_data:{results:t,trials:this.trials,elapsed:e}},t)},t}(),Ve=self,Ge=new je(Ve);Ve.addEventListener("message",(function(t){return Ge.OnMessage(t)})),r(4370),r(1045)}()}();