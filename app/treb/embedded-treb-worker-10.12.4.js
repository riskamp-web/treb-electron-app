/*! v10.12.4. Copyright 2018-2021 Structured Data, LLC. All rights reserved. CC BY-ND: https://treb.app/license */
!function(){var t={4370:function(t,e,r){r(8783),r(1038);var n=r(857);t.exports=n.Array.from},1045:function(t,e,r){r(7145),r(2472),r(9743),r(5109),r(8255),r(5125),r(9135),r(4197),r(6495),r(6443),t.exports=r(7854)},6443:function(t,e,r){r(8145),r(5206),r(2990),r(8927),r(3105),r(5035),r(4345),r(7174),r(2846),r(4731),r(7209),r(8867),r(7789),r(3739),r(9368),r(4483),r(2056),r(3462),r(678),r(7462),r(3824),r(5021),r(2974),r(5016),r(6319),r(1539)},3099:function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},6077:function(t,e,r){var n=r(111);t.exports=function(t){if(!n(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},1223:function(t,e,r){var n=r(5112),i=r(30),o=r(3070),a=n("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),t.exports=function(t){s[a][t]=!0}},5787:function(t){t.exports=function(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t}},9670:function(t,e,r){var n=r(111);t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},4019:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,r){"use strict";var n,i=r(4019),o=r(9781),a=r(7854),s=r(111),l=r(6656),u=r(648),c=r(8880),h=r(1320),f=r(3070).f,d=r(9518),p=r(7674),m=r(5112),v=r(9711),y=a.Int8Array,_=y&&y.prototype,g=a.Uint8ClampedArray,w=g&&g.prototype,b=y&&d(y),x=_&&d(_),M=Object.prototype,C=M.isPrototypeOf,S=m("toStringTag"),A=v("TYPED_ARRAY_TAG"),R=i&&!!p&&"Opera"!==u(a.opera),k=!1,T={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},P={BigInt64Array:8,BigUint64Array:8},N=function(t){if(!s(t))return!1;var e=u(t);return l(T,e)||l(P,e)};for(n in T)a[n]||(R=!1);if((!R||"function"!=typeof b||b===Function.prototype)&&(b=function(){throw TypeError("Incorrect invocation")},R))for(n in T)a[n]&&p(a[n],b);if((!R||!x||x===M)&&(x=b.prototype,R))for(n in T)a[n]&&p(a[n].prototype,x);if(R&&d(w)!==x&&p(w,x),o&&!l(x,S))for(n in k=!0,f(x,S,{get:function(){return s(this)?this[A]:void 0}}),T)a[n]&&c(a[n],A,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:R,TYPED_ARRAY_TAG:k&&A,aTypedArray:function(t){if(N(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(p){if(C.call(b,t))return t}else for(var e in T)if(l(T,n)){var r=a[e];if(r&&(t===r||C.call(r,t)))return t}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r){if(o){if(r)for(var n in T){var i=a[n];if(i&&l(i.prototype,t))try{delete i.prototype[t]}catch(t){}}x[t]&&!r||h(x,t,r?e:R&&_[t]||e)}},exportTypedArrayStaticMethod:function(t,e,r){var n,i;if(o){if(p){if(r)for(n in T)if((i=a[n])&&l(i,t))try{delete i[t]}catch(t){}if(b[t]&&!r)return;try{return h(b,t,r?e:R&&b[t]||e)}catch(t){}}for(n in T)!(i=a[n])||i[t]&&!r||h(i,t,e)}},isView:function(t){if(!s(t))return!1;var e=u(t);return"DataView"===e||l(T,e)||l(P,e)},isTypedArray:N,TypedArray:b,TypedArrayPrototype:x}},3331:function(t,e,r){"use strict";var n=r(7854),i=r(9781),o=r(4019),a=r(8880),s=r(2248),l=r(7293),u=r(5787),c=r(9958),h=r(7466),f=r(7067),d=r(1179),p=r(9518),m=r(7674),v=r(8006).f,y=r(3070).f,_=r(1285),g=r(8003),w=r(9909),b=w.get,x=w.set,M="ArrayBuffer",C="DataView",S="Wrong index",A=n.ArrayBuffer,R=A,k=n.DataView,T=k&&k.prototype,P=Object.prototype,N=n.RangeError,E=d.pack,D=d.unpack,O=function(t){return[255&t]},F=function(t){return[255&t,t>>8&255]},I=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},L=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},U=function(t){return E(t,23,4)},V=function(t){return E(t,52,8)},j=function(t,e){y(t.prototype,e,{get:function(){return b(this)[e]}})},G=function(t,e,r,n){var i=f(r),o=b(t);if(i+e>o.byteLength)throw N(S);var a=b(o.buffer).bytes,s=i+o.byteOffset,l=a.slice(s,s+e);return n?l:l.reverse()},z=function(t,e,r,n,i,o){var a=f(r),s=b(t);if(a+e>s.byteLength)throw N(S);for(var l=b(s.buffer).bytes,u=a+s.byteOffset,c=n(+i),h=0;h<e;h++)l[u+h]=c[o?h:e-h-1]};if(o){if(!l((function(){A(1)}))||!l((function(){new A(-1)}))||l((function(){return new A,new A(1.5),new A(NaN),A.name!=M}))){for(var B,J=(R=function(t){return u(this,R),new A(f(t))}).prototype=A.prototype,q=v(A),H=0;q.length>H;)(B=q[H++])in R||a(R,B,A[B]);J.constructor=R}m&&p(T)!==P&&m(T,P);var W=new k(new R(2)),Z=T.setInt8;W.setInt8(0,2147483648),W.setInt8(1,2147483649),!W.getInt8(0)&&W.getInt8(1)||s(T,{setInt8:function(t,e){Z.call(this,t,e<<24>>24)},setUint8:function(t,e){Z.call(this,t,e<<24>>24)}},{unsafe:!0})}else R=function(t){u(this,R,M);var e=f(t);x(this,{bytes:_.call(new Array(e),0),byteLength:e}),i||(this.byteLength=e)},k=function(t,e,r){u(this,k,C),u(t,R,C);var n=b(t).byteLength,o=c(e);if(o<0||o>n)throw N("Wrong offset");if(o+(r=void 0===r?n-o:h(r))>n)throw N("Wrong length");x(this,{buffer:t,byteLength:r,byteOffset:o}),i||(this.buffer=t,this.byteLength=r,this.byteOffset=o)},i&&(j(R,"byteLength"),j(k,"buffer"),j(k,"byteLength"),j(k,"byteOffset")),s(k.prototype,{getInt8:function(t){return G(this,1,t)[0]<<24>>24},getUint8:function(t){return G(this,1,t)[0]},getInt16:function(t){var e=G(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=G(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return L(G(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return L(G(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return D(G(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return D(G(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){z(this,1,t,O,e)},setUint8:function(t,e){z(this,1,t,O,e)},setInt16:function(t,e){z(this,2,t,F,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){z(this,2,t,F,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){z(this,4,t,I,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){z(this,4,t,I,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){z(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){z(this,8,t,V,e,arguments.length>2?arguments[2]:void 0)}});g(R,M),g(k,C),t.exports={ArrayBuffer:R,DataView:k}},1048:function(t,e,r){"use strict";var n=r(7908),i=r(1400),o=r(7466),a=Math.min;t.exports=[].copyWithin||function(t,e){var r=n(this),s=o(r.length),l=i(t,s),u=i(e,s),c=arguments.length>2?arguments[2]:void 0,h=a((void 0===c?s:i(c,s))-u,s-l),f=1;for(u<l&&l<u+h&&(f=-1,u+=h-1,l+=h-1);h-- >0;)u in r?r[l]=r[u]:delete r[l],l+=f,u+=f;return r}},1285:function(t,e,r){"use strict";var n=r(7908),i=r(1400),o=r(7466);t.exports=function(t){for(var e=n(this),r=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),l=a>2?arguments[2]:void 0,u=void 0===l?r:i(l,r);u>s;)e[s++]=t;return e}},8457:function(t,e,r){"use strict";var n=r(9974),i=r(7908),o=r(3411),a=r(7659),s=r(7466),l=r(6135),u=r(1246);t.exports=function(t){var e,r,c,h,f,d,p=i(t),m="function"==typeof this?this:Array,v=arguments.length,y=v>1?arguments[1]:void 0,_=void 0!==y,g=u(p),w=0;if(_&&(y=n(y,v>2?arguments[2]:void 0,2)),null==g||m==Array&&a(g))for(r=new m(e=s(p.length));e>w;w++)d=_?y(p[w],w):p[w],l(r,w,d);else for(f=(h=g.call(p)).next,r=new m;!(c=f.call(h)).done;w++)d=_?o(h,y,[c.value,w],!0):c.value,l(r,w,d);return r.length=w,r}},1318:function(t,e,r){var n=r(5656),i=r(7466),o=r(1400),a=function(t){return function(e,r,a){var s,l=n(e),u=i(l.length),c=o(a,u);if(t&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===r)return t||c||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},2092:function(t,e,r){var n=r(9974),i=r(8361),o=r(7908),a=r(7466),s=r(5417),l=[].push,u=function(t){var e=1==t,r=2==t,u=3==t,c=4==t,h=6==t,f=7==t,d=5==t||h;return function(p,m,v,y){for(var _,g,w=o(p),b=i(w),x=n(m,v,3),M=a(b.length),C=0,S=y||s,A=e?S(p,M):r||f?S(p,0):void 0;M>C;C++)if((d||C in b)&&(g=x(_=b[C],C,w),t))if(e)A[C]=g;else if(g)switch(t){case 3:return!0;case 5:return _;case 6:return C;case 2:l.call(A,_)}else switch(t){case 4:return!1;case 7:l.call(A,_)}return h?-1:u||c?c:A}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterOut:u(7)}},6583:function(t,e,r){"use strict";var n=r(5656),i=r(9958),o=r(7466),a=r(9341),s=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,c=a("lastIndexOf"),h=u||!c;t.exports=h?function(t){if(u)return l.apply(this,arguments)||0;var e=n(this),r=o(e.length),a=r-1;for(arguments.length>1&&(a=s(a,i(arguments[1]))),a<0&&(a=r+a);a>=0;a--)if(a in e&&e[a]===t)return a||0;return-1}:l},9341:function(t,e,r){"use strict";var n=r(7293);t.exports=function(t,e){var r=[][t];return!!r&&n((function(){r.call(null,e||function(){throw 1},1)}))}},3671:function(t,e,r){var n=r(3099),i=r(7908),o=r(8361),a=r(7466),s=function(t){return function(e,r,s,l){n(r);var u=i(e),c=o(u),h=a(u.length),f=t?h-1:0,d=t?-1:1;if(s<2)for(;;){if(f in c){l=c[f],f+=d;break}if(f+=d,t?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;t?f>=0:h>f;f+=d)f in c&&(l=r(l,c[f],f,u));return l}};t.exports={left:s(!1),right:s(!0)}},5417:function(t,e,r){var n=r(111),i=r(3157),o=r(5112)("species");t.exports=function(t,e){var r;return i(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!i(r.prototype)?n(r)&&null===(r=r[o])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===e?0:e)}},3411:function(t,e,r){var n=r(9670),i=r(9212);t.exports=function(t,e,r,o){try{return o?e(n(r)[0],r[1]):e(r)}catch(e){throw i(t),e}}},7072:function(t,e,r){var n=r(5112)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o={};o[n]=function(){return{next:function(){return{done:r=!0}}}},t(o)}catch(t){}return r}},4326:function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},648:function(t,e,r){var n=r(1694),i=r(4326),o=r(5112)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=n?i:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?r:a?i(e):"Object"==(n=i(e))&&"function"==typeof e.callee?"Arguments":n}},9920:function(t,e,r){var n=r(6656),i=r(3887),o=r(1236),a=r(3070);t.exports=function(t,e){for(var r=i(e),s=a.f,l=o.f,u=0;u<r.length;u++){var c=r[u];n(t,c)||s(t,c,l(e,c))}}},8544:function(t,e,r){var n=r(7293);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},4994:function(t,e,r){"use strict";var n=r(3383).IteratorPrototype,i=r(30),o=r(9114),a=r(8003),s=r(7497),l=function(){return this};t.exports=function(t,e,r){var u=e+" Iterator";return t.prototype=i(n,{next:o(1,r)}),a(t,u,!1,!0),s[u]=l,t}},8880:function(t,e,r){var n=r(9781),i=r(3070),o=r(9114);t.exports=n?function(t,e,r){return i.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},9114:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6135:function(t,e,r){"use strict";var n=r(7593),i=r(3070),o=r(9114);t.exports=function(t,e,r){var a=n(e);a in t?i.f(t,a,o(0,r)):t[a]=r}},654:function(t,e,r){"use strict";var n=r(2109),i=r(4994),o=r(9518),a=r(7674),s=r(8003),l=r(8880),u=r(1320),c=r(5112),h=r(1913),f=r(7497),d=r(3383),p=d.IteratorPrototype,m=d.BUGGY_SAFARI_ITERATORS,v=c("iterator"),y="keys",_="values",g="entries",w=function(){return this};t.exports=function(t,e,r,c,d,b,x){i(r,e,c);var M,C,S,A=function(t){if(t===d&&N)return N;if(!m&&t in T)return T[t];switch(t){case y:case _:case g:return function(){return new r(this,t)}}return function(){return new r(this)}},R=e+" Iterator",k=!1,T=t.prototype,P=T[v]||T["@@iterator"]||d&&T[d],N=!m&&P||A(d),E="Array"==e&&T.entries||P;if(E&&(M=o(E.call(new t)),p!==Object.prototype&&M.next&&(h||o(M)===p||(a?a(M,p):"function"!=typeof M[v]&&l(M,v,w)),s(M,R,!0,!0),h&&(f[R]=w))),d==_&&P&&P.name!==_&&(k=!0,N=function(){return P.call(this)}),h&&!x||T[v]===N||l(T,v,N),f[e]=N,d)if(C={values:A(_),keys:b?N:A(y),entries:A(g)},x)for(S in C)(m||k||!(S in T))&&u(T,S,C[S]);else n({target:e,proto:!0,forced:m||k},C);return C}},9781:function(t,e,r){var n=r(7293);t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(t,e,r){var n=r(7854),i=r(111),o=n.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},8113:function(t,e,r){var n=r(5005);t.exports=n("navigator","userAgent")||""},7392:function(t,e,r){var n,i,o=r(7854),a=r(8113),s=o.process,l=s&&s.versions,u=l&&l.v8;u?i=(n=u.split("."))[0]<4?1:n[0]+n[1]:a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(i=n[1]),t.exports=i&&+i},748:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(t,e,r){var n=r(7854),i=r(1236).f,o=r(8880),a=r(1320),s=r(3505),l=r(9920),u=r(4705);t.exports=function(t,e){var r,c,h,f,d,p=t.target,m=t.global,v=t.stat;if(r=m?n:v?n[p]||s(p,{}):(n[p]||{}).prototype)for(c in e){if(f=e[c],h=t.noTargetGet?(d=i(r,c))&&d.value:r[c],!u(m?c:p+(v?".":"#")+c,t.forced)&&void 0!==h){if(typeof f==typeof h)continue;l(f,h)}(t.sham||h&&h.sham)&&o(f,"sham",!0),a(r,c,f,t)}}},7293:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},9974:function(t,e,r){var n=r(3099);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},5005:function(t,e,r){var n=r(857),i=r(7854),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(n[t])||o(i[t]):n[t]&&n[t][e]||i[t]&&i[t][e]}},1246:function(t,e,r){var n=r(648),i=r(7497),o=r(5112)("iterator");t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[n(t)]}},7854:function(t,e,r){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},6656:function(t,e,r){var n=r(7908),i={}.hasOwnProperty;t.exports=function(t,e){return i.call(n(t),e)}},3501:function(t){t.exports={}},490:function(t,e,r){var n=r(5005);t.exports=n("document","documentElement")},4664:function(t,e,r){var n=r(9781),i=r(7293),o=r(317);t.exports=!n&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},1179:function(t){var e=Math.abs,r=Math.pow,n=Math.floor,i=Math.log,o=Math.LN2;t.exports={pack:function(t,a,s){var l,u,c,h=new Array(s),f=8*s-a-1,d=(1<<f)-1,p=d>>1,m=23===a?r(2,-24)-r(2,-77):0,v=t<0||0===t&&1/t<0?1:0,y=0;for((t=e(t))!=t||t===1/0?(u=t!=t?1:0,l=d):(l=n(i(t)/o),t*(c=r(2,-l))<1&&(l--,c*=2),(t+=l+p>=1?m/c:m*r(2,1-p))*c>=2&&(l++,c/=2),l+p>=d?(u=0,l=d):l+p>=1?(u=(t*c-1)*r(2,a),l+=p):(u=t*r(2,p-1)*r(2,a),l=0));a>=8;h[y++]=255&u,u/=256,a-=8);for(l=l<<a|u,f+=a;f>0;h[y++]=255&l,l/=256,f-=8);return h[--y]|=128*v,h},unpack:function(t,e){var n,i=t.length,o=8*i-e-1,a=(1<<o)-1,s=a>>1,l=o-7,u=i-1,c=t[u--],h=127&c;for(c>>=7;l>0;h=256*h+t[u],u--,l-=8);for(n=h&(1<<-l)-1,h>>=-l,l+=e;l>0;n=256*n+t[u],u--,l-=8);if(0===h)h=1-s;else{if(h===a)return n?NaN:c?-1/0:1/0;n+=r(2,e),h-=s}return(c?-1:1)*n*r(2,h-e)}}},8361:function(t,e,r){var n=r(7293),i=r(4326),o="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},9587:function(t,e,r){var n=r(111),i=r(7674);t.exports=function(t,e,r){var o,a;return i&&"function"==typeof(o=e.constructor)&&o!==r&&n(a=o.prototype)&&a!==r.prototype&&i(t,a),t}},2788:function(t,e,r){var n=r(5465),i=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(t){return i.call(t)}),t.exports=n.inspectSource},9909:function(t,e,r){var n,i,o,a=r(8536),s=r(7854),l=r(111),u=r(8880),c=r(6656),h=r(5465),f=r(6200),d=r(3501),p="Object already initialized",m=s.WeakMap;if(a){var v=h.state||(h.state=new m),y=v.get,_=v.has,g=v.set;n=function(t,e){if(_.call(v,t))throw new TypeError(p);return e.facade=t,g.call(v,t,e),e},i=function(t){return y.call(v,t)||{}},o=function(t){return _.call(v,t)}}else{var w=f("state");d[w]=!0,n=function(t,e){if(c(t,w))throw new TypeError(p);return e.facade=t,u(t,w,e),e},i=function(t){return c(t,w)?t[w]:{}},o=function(t){return c(t,w)}}t.exports={set:n,get:i,has:o,enforce:function(t){return o(t)?i(t):n(t,{})},getterFor:function(t){return function(e){var r;if(!l(e)||(r=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}}},7659:function(t,e,r){var n=r(5112),i=r(7497),o=n("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},3157:function(t,e,r){var n=r(4326);t.exports=Array.isArray||function(t){return"Array"==n(t)}},4705:function(t,e,r){var n=r(7293),i=/#|\.prototype\./,o=function(t,e){var r=s[a(t)];return r==u||r!=l&&("function"==typeof e?n(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},111:function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},1913:function(t){t.exports=!1},9212:function(t,e,r){var n=r(9670);t.exports=function(t){var e=t.return;if(void 0!==e)return n(e.call(t)).value}},3383:function(t,e,r){"use strict";var n,i,o,a=r(7293),s=r(9518),l=r(8880),u=r(6656),c=r(5112),h=r(1913),f=c("iterator"),d=!1;[].keys&&("next"in(o=[].keys())?(i=s(s(o)))!==Object.prototype&&(n=i):d=!0);var p=null==n||a((function(){var t={};return n[f].call(t)!==t}));p&&(n={}),h&&!p||u(n,f)||l(n,f,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:d}},7497:function(t){t.exports={}},133:function(t,e,r){var n=r(7392),i=r(7293);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())||!Symbol.sham&&n&&n<41}))},8536:function(t,e,r){var n=r(7854),i=r(2788),o=n.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},30:function(t,e,r){var n,i=r(9670),o=r(6048),a=r(748),s=r(3501),l=r(490),u=r(317),c=r(6200)("IE_PROTO"),h=function(){},f=function(t){return"<script>"+t+"<\/script>"},d=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;d=n?function(t){t.write(f("")),t.close();var e=t.parentWindow.Object;return t=null,e}(n):((e=u("iframe")).style.display="none",l.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(f("document.F=Object")),t.close(),t.F);for(var r=a.length;r--;)delete d.prototype[a[r]];return d()};s[c]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(h.prototype=i(t),r=new h,h.prototype=null,r[c]=t):r=d(),void 0===e?r:o(r,e)}},6048:function(t,e,r){var n=r(9781),i=r(3070),o=r(9670),a=r(1956);t.exports=n?Object.defineProperties:function(t,e){o(t);for(var r,n=a(e),s=n.length,l=0;s>l;)i.f(t,r=n[l++],e[r]);return t}},3070:function(t,e,r){var n=r(9781),i=r(4664),o=r(9670),a=r(7593),s=Object.defineProperty;e.f=n?s:function(t,e,r){if(o(t),e=a(e,!0),o(r),i)try{return s(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},1236:function(t,e,r){var n=r(9781),i=r(5296),o=r(9114),a=r(5656),s=r(7593),l=r(6656),u=r(4664),c=Object.getOwnPropertyDescriptor;e.f=n?c:function(t,e){if(t=a(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(l(t,e))return o(!i.f.call(t,e),t[e])}},8006:function(t,e,r){var n=r(6324),i=r(748).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},5181:function(t,e){e.f=Object.getOwnPropertySymbols},9518:function(t,e,r){var n=r(6656),i=r(7908),o=r(6200),a=r(8544),s=o("IE_PROTO"),l=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=i(t),n(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?l:null}},6324:function(t,e,r){var n=r(6656),i=r(5656),o=r(1318).indexOf,a=r(3501);t.exports=function(t,e){var r,s=i(t),l=0,u=[];for(r in s)!n(a,r)&&n(s,r)&&u.push(r);for(;e.length>l;)n(s,r=e[l++])&&(~o(u,r)||u.push(r));return u}},1956:function(t,e,r){var n=r(6324),i=r(748);t.exports=Object.keys||function(t){return n(t,i)}},5296:function(t,e){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);e.f=i?function(t){var e=n(this,t);return!!e&&e.enumerable}:r},7674:function(t,e,r){var n=r(9670),i=r(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(t){}return function(r,o){return n(r),i(o),e?t.call(r,o):r.__proto__=o,r}}():void 0)},288:function(t,e,r){"use strict";var n=r(1694),i=r(648);t.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},3887:function(t,e,r){var n=r(5005),i=r(8006),o=r(5181),a=r(9670);t.exports=n("Reflect","ownKeys")||function(t){var e=i.f(a(t)),r=o.f;return r?e.concat(r(t)):e}},857:function(t,e,r){var n=r(7854);t.exports=n},2248:function(t,e,r){var n=r(1320);t.exports=function(t,e,r){for(var i in e)n(t,i,e[i],r);return t}},1320:function(t,e,r){var n=r(7854),i=r(8880),o=r(6656),a=r(3505),s=r(2788),l=r(9909),u=l.get,c=l.enforce,h=String(String).split("String");(t.exports=function(t,e,r,s){var l,u=!!s&&!!s.unsafe,f=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof r&&("string"!=typeof e||o(r,"name")||i(r,"name",e),(l=c(r)).source||(l.source=h.join("string"==typeof e?e:""))),t!==n?(u?!d&&t[e]&&(f=!0):delete t[e],f?t[e]=r:i(t,e,r)):f?t[e]=r:a(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},4488:function(t){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},3505:function(t,e,r){var n=r(7854),i=r(8880);t.exports=function(t,e){try{i(n,t,e)}catch(r){n[t]=e}return e}},6340:function(t,e,r){"use strict";var n=r(5005),i=r(3070),o=r(5112),a=r(9781),s=o("species");t.exports=function(t){var e=n(t),r=i.f;a&&e&&!e[s]&&r(e,s,{configurable:!0,get:function(){return this}})}},8003:function(t,e,r){var n=r(3070).f,i=r(6656),o=r(5112)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},6200:function(t,e,r){var n=r(2309),i=r(9711),o=n("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},5465:function(t,e,r){var n=r(7854),i=r(3505),o="__core-js_shared__",a=n[o]||i(o,{});t.exports=a},2309:function(t,e,r){var n=r(1913),i=r(5465);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.12.0",mode:n?"pure":"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})},6707:function(t,e,r){var n=r(9670),i=r(3099),o=r(5112)("species");t.exports=function(t,e){var r,a=n(t).constructor;return void 0===a||null==(r=n(a)[o])?e:i(r)}},8710:function(t,e,r){var n=r(9958),i=r(4488),o=function(t){return function(e,r){var o,a,s=String(i(e)),l=n(r),u=s.length;return l<0||l>=u?t?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},1400:function(t,e,r){var n=r(9958),i=Math.max,o=Math.min;t.exports=function(t,e){var r=n(t);return r<0?i(r+e,0):o(r,e)}},7067:function(t,e,r){var n=r(9958),i=r(7466);t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=i(e);if(e!==r)throw RangeError("Wrong length or index");return r}},5656:function(t,e,r){var n=r(8361),i=r(4488);t.exports=function(t){return n(i(t))}},9958:function(t){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},7466:function(t,e,r){var n=r(9958),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},7908:function(t,e,r){var n=r(4488);t.exports=function(t){return Object(n(t))}},4590:function(t,e,r){var n=r(3002);t.exports=function(t,e){var r=n(t);if(r%e)throw RangeError("Wrong offset");return r}},3002:function(t,e,r){var n=r(9958);t.exports=function(t){var e=n(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}},7593:function(t,e,r){var n=r(111);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},1694:function(t,e,r){var n={};n[r(5112)("toStringTag")]="z",t.exports="[object z]"===String(n)},9843:function(t,e,r){"use strict";var n=r(2109),i=r(7854),o=r(9781),a=r(3832),s=r(260),l=r(3331),u=r(5787),c=r(9114),h=r(8880),f=r(7466),d=r(7067),p=r(4590),m=r(7593),v=r(6656),y=r(648),_=r(111),g=r(30),w=r(7674),b=r(8006).f,x=r(7321),M=r(2092).forEach,C=r(6340),S=r(3070),A=r(1236),R=r(9909),k=r(9587),T=R.get,P=R.set,N=S.f,E=A.f,D=Math.round,O=i.RangeError,F=l.ArrayBuffer,I=l.DataView,L=s.NATIVE_ARRAY_BUFFER_VIEWS,U=s.TYPED_ARRAY_TAG,V=s.TypedArray,j=s.TypedArrayPrototype,G=s.aTypedArrayConstructor,z=s.isTypedArray,B="BYTES_PER_ELEMENT",J="Wrong length",q=function(t,e){for(var r=0,n=e.length,i=new(G(t))(n);n>r;)i[r]=e[r++];return i},H=function(t,e){N(t,e,{get:function(){return T(this)[e]}})},W=function(t){var e;return t instanceof F||"ArrayBuffer"==(e=y(t))||"SharedArrayBuffer"==e},Z=function(t,e){return z(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},$=function(t,e){return Z(t,e=m(e,!0))?c(2,t[e]):E(t,e)},Y=function(t,e,r){return!(Z(t,e=m(e,!0))&&_(r)&&v(r,"value"))||v(r,"get")||v(r,"set")||r.configurable||v(r,"writable")&&!r.writable||v(r,"enumerable")&&!r.enumerable?N(t,e,r):(t[e]=r.value,t)};o?(L||(A.f=$,S.f=Y,H(j,"buffer"),H(j,"byteOffset"),H(j,"byteLength"),H(j,"length")),n({target:"Object",stat:!0,forced:!L},{getOwnPropertyDescriptor:$,defineProperty:Y}),t.exports=function(t,e,r){var o=t.match(/\d+$/)[0]/8,s=t+(r?"Clamped":"")+"Array",l="get"+t,c="set"+t,m=i[s],v=m,y=v&&v.prototype,S={},A=function(t,e){N(t,e,{get:function(){return function(t,e){var r=T(t);return r.view[l](e*o+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,n){var i=T(t);r&&(n=(n=D(n))<0?0:n>255?255:255&n),i.view[c](e*o+i.byteOffset,n,!0)}(this,e,t)},enumerable:!0})};L?a&&(v=e((function(t,e,r,n){return u(t,v,s),k(_(e)?W(e)?void 0!==n?new m(e,p(r,o),n):void 0!==r?new m(e,p(r,o)):new m(e):z(e)?q(v,e):x.call(v,e):new m(d(e)),t,v)})),w&&w(v,V),M(b(m),(function(t){t in v||h(v,t,m[t])})),v.prototype=y):(v=e((function(t,e,r,n){u(t,v,s);var i,a,l,c=0,h=0;if(_(e)){if(!W(e))return z(e)?q(v,e):x.call(v,e);i=e,h=p(r,o);var m=e.byteLength;if(void 0===n){if(m%o)throw O(J);if((a=m-h)<0)throw O(J)}else if((a=f(n)*o)+h>m)throw O(J);l=a/o}else l=d(e),i=new F(a=l*o);for(P(t,{buffer:i,byteOffset:h,byteLength:a,length:l,view:new I(i)});c<l;)A(t,c++)})),w&&w(v,V),y=v.prototype=g(j)),y.constructor!==v&&h(y,"constructor",v),U&&h(y,U,s),S[s]=v,n({global:!0,forced:v!=m,sham:!L},S),B in v||h(v,B,o),B in y||h(y,B,o),C(s)}):t.exports=function(){}},3832:function(t,e,r){var n=r(7854),i=r(7293),o=r(7072),a=r(260).NATIVE_ARRAY_BUFFER_VIEWS,s=n.ArrayBuffer,l=n.Int8Array;t.exports=!a||!i((function(){l(1)}))||!i((function(){new l(-1)}))||!o((function(t){new l,new l(null),new l(1.5),new l(t)}),!0)||i((function(){return 1!==new l(new s(2),1,void 0).length}))},3074:function(t,e,r){var n=r(260).aTypedArrayConstructor,i=r(6707);t.exports=function(t,e){for(var r=i(t,t.constructor),o=0,a=e.length,s=new(n(r))(a);a>o;)s[o]=e[o++];return s}},7321:function(t,e,r){var n=r(7908),i=r(7466),o=r(1246),a=r(7659),s=r(9974),l=r(260).aTypedArrayConstructor;t.exports=function(t){var e,r,u,c,h,f,d=n(t),p=arguments.length,m=p>1?arguments[1]:void 0,v=void 0!==m,y=o(d);if(null!=y&&!a(y))for(f=(h=y.call(d)).next,d=[];!(c=f.call(h)).done;)d.push(c.value);for(v&&p>2&&(m=s(m,arguments[2],2)),r=i(d.length),u=new(l(this))(r),e=0;r>e;e++)u[e]=v?m(d[e],e):d[e];return u}},9711:function(t){var e=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+r).toString(36)}},3307:function(t,e,r){var n=r(133);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5112:function(t,e,r){var n=r(7854),i=r(2309),o=r(6656),a=r(9711),s=r(133),l=r(3307),u=i("wks"),c=n.Symbol,h=l?c:c&&c.withoutSetter||a;t.exports=function(t){return o(u,t)&&(s||"string"==typeof u[t])||(s&&o(c,t)?u[t]=c[t]:u[t]=h("Symbol."+t)),u[t]}},1038:function(t,e,r){var n=r(2109),i=r(8457);n({target:"Array",stat:!0,forced:!r(7072)((function(t){Array.from(t)}))},{from:i})},6992:function(t,e,r){"use strict";var n=r(5656),i=r(1223),o=r(7497),a=r(9909),s=r(654),l="Array Iterator",u=a.set,c=a.getterFor(l);t.exports=s(Array,"Array",(function(t,e){u(this,{type:l,target:n(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},1539:function(t,e,r){var n=r(1694),i=r(1320),o=r(288);n||i(Object.prototype,"toString",o,{unsafe:!0})},8783:function(t,e,r){"use strict";var n=r(8710).charAt,i=r(9909),o=r(654),a="String Iterator",s=i.set,l=i.getterFor(a);o(String,"String",(function(t){s(this,{type:a,string:String(t),index:0})}),(function(){var t,e=l(this),r=e.string,i=e.index;return i>=r.length?{value:void 0,done:!0}:(t=n(r,i),e.index+=t.length,{value:t,done:!1})}))},2990:function(t,e,r){"use strict";var n=r(260),i=r(1048),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("copyWithin",(function(t,e){return i.call(o(this),t,e,arguments.length>2?arguments[2]:void 0)}))},8927:function(t,e,r){"use strict";var n=r(260),i=r(2092).every,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("every",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},3105:function(t,e,r){"use strict";var n=r(260),i=r(1285),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("fill",(function(t){return i.apply(o(this),arguments)}))},5035:function(t,e,r){"use strict";var n=r(260),i=r(2092).filter,o=r(3074),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("filter",(function(t){var e=i(a(this),t,arguments.length>1?arguments[1]:void 0);return o(this,e)}))},7174:function(t,e,r){"use strict";var n=r(260),i=r(2092).findIndex,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("findIndex",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},4345:function(t,e,r){"use strict";var n=r(260),i=r(2092).find,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("find",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},4197:function(t,e,r){r(9843)("Float32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},6495:function(t,e,r){r(9843)("Float64",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},2846:function(t,e,r){"use strict";var n=r(260),i=r(2092).forEach,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("forEach",(function(t){i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},8145:function(t,e,r){"use strict";var n=r(3832);(0,r(260).exportTypedArrayStaticMethod)("from",r(7321),n)},4731:function(t,e,r){"use strict";var n=r(260),i=r(1318).includes,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("includes",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},7209:function(t,e,r){"use strict";var n=r(260),i=r(1318).indexOf,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("indexOf",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},5109:function(t,e,r){r(9843)("Int16",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},5125:function(t,e,r){r(9843)("Int32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},7145:function(t,e,r){r(9843)("Int8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},6319:function(t,e,r){"use strict";var n=r(7854),i=r(260),o=r(6992),a=r(5112)("iterator"),s=n.Uint8Array,l=o.values,u=o.keys,c=o.entries,h=i.aTypedArray,f=i.exportTypedArrayMethod,d=s&&s.prototype[a],p=!!d&&("values"==d.name||null==d.name),m=function(){return l.call(h(this))};f("entries",(function(){return c.call(h(this))})),f("keys",(function(){return u.call(h(this))})),f("values",m,!p),f(a,m,!p)},8867:function(t,e,r){"use strict";var n=r(260),i=n.aTypedArray,o=n.exportTypedArrayMethod,a=[].join;o("join",(function(t){return a.apply(i(this),arguments)}))},7789:function(t,e,r){"use strict";var n=r(260),i=r(6583),o=n.aTypedArray;(0,n.exportTypedArrayMethod)("lastIndexOf",(function(t){return i.apply(o(this),arguments)}))},3739:function(t,e,r){"use strict";var n=r(260),i=r(2092).map,o=r(6707),a=n.aTypedArray,s=n.aTypedArrayConstructor;(0,n.exportTypedArrayMethod)("map",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(s(o(t,t.constructor)))(e)}))}))},5206:function(t,e,r){"use strict";var n=r(260),i=r(3832),o=n.aTypedArrayConstructor;(0,n.exportTypedArrayStaticMethod)("of",(function(){for(var t=0,e=arguments.length,r=new(o(this))(e);e>t;)r[t]=arguments[t++];return r}),i)},4483:function(t,e,r){"use strict";var n=r(260),i=r(3671).right,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduceRight",(function(t){return i(o(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},9368:function(t,e,r){"use strict";var n=r(260),i=r(3671).left,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduce",(function(t){return i(o(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2056:function(t,e,r){"use strict";var n=r(260),i=n.aTypedArray,o=n.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var t,e=this,r=i(e).length,n=a(r/2),o=0;o<n;)t=e[o],e[o++]=e[--r],e[r]=t;return e}))},3462:function(t,e,r){"use strict";var n=r(260),i=r(7466),o=r(4590),a=r(7908),s=r(7293),l=n.aTypedArray;(0,n.exportTypedArrayMethod)("set",(function(t){l(this);var e=o(arguments.length>1?arguments[1]:void 0,1),r=this.length,n=a(t),s=i(n.length),u=0;if(s+e>r)throw RangeError("Wrong length");for(;u<s;)this[e+u]=n[u++]}),s((function(){new Int8Array(1).set({})})))},678:function(t,e,r){"use strict";var n=r(260),i=r(6707),o=r(7293),a=n.aTypedArray,s=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod,u=[].slice;l("slice",(function(t,e){for(var r=u.call(a(this),t,e),n=i(this,this.constructor),o=0,l=r.length,c=new(s(n))(l);l>o;)c[o]=r[o++];return c}),o((function(){new Int8Array(1).slice()})))},7462:function(t,e,r){"use strict";var n=r(260),i=r(2092).some,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("some",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},3824:function(t,e,r){"use strict";var n=r(260),i=n.aTypedArray,o=n.exportTypedArrayMethod,a=[].sort;o("sort",(function(t){return a.call(i(this),t)}))},5021:function(t,e,r){"use strict";var n=r(260),i=r(7466),o=r(1400),a=r(6707),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("subarray",(function(t,e){var r=s(this),n=r.length,l=o(t,n);return new(a(r,r.constructor))(r.buffer,r.byteOffset+l*r.BYTES_PER_ELEMENT,i((void 0===e?n:o(e,n))-l))}))},2974:function(t,e,r){"use strict";var n=r(7854),i=r(260),o=r(7293),a=n.Int8Array,s=i.aTypedArray,l=i.exportTypedArrayMethod,u=[].toLocaleString,c=[].slice,h=!!a&&o((function(){u.call(new a(1))}));l("toLocaleString",(function(){return u.apply(h?c.call(s(this)):s(this),arguments)}),o((function(){return[1,2].toLocaleString()!=new a([1,2]).toLocaleString()}))||!o((function(){a.prototype.toLocaleString.call([1,2])})))},5016:function(t,e,r){"use strict";var n=r(260).exportTypedArrayMethod,i=r(7293),o=r(7854).Uint8Array,a=o&&o.prototype||{},s=[].toString,l=[].join;i((function(){s.call({})}))&&(s=function(){return l.call(this)});var u=a.toString!=s;n("toString",s,u)},8255:function(t,e,r){r(9843)("Uint16",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},9135:function(t,e,r){r(9843)("Uint32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},2472:function(t,e,r){r(9843)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},9743:function(t,e,r){r(9843)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0)},4691:function(t,e){!function(t){"use strict";var e=new(function(){function t(t){void 0===t&&(t=0),this.m_w=0,this.m_z=0,this.Seed(t)}return t.prototype.Seed=function(t){void 0===t&&(t=0),t?(this.m_w=Math.round(2863311530&t)||1,this.m_z=Math.round(1431655765&t)||1):(this.m_w=Math.round(1e5*Math.random()),this.m_z=Math.round((new Date).getTime()))},t.prototype.Next=function(){return this.m_z=36969*(65535&this.m_z)+(this.m_z>>16)&4294967295,this.m_w=18e3*(65535&this.m_w)+(this.m_w>>16)&4294967295,.5+((this.m_z<<16)+this.m_w&4294967295)/4294967296},t.prototype.GetState=function(){return[this.m_w,this.m_z]},t}()),r=function(){function t(){}return t.Sort=function(t,e){this.QuickSort(t,e,0,t.length)},t.Partition=function(t,e,r,n){for(var i=t[n-1],o=r,a=r;a<n-1;a+=1)t[a]<=i&&(this.Swap(t,e,a,o),o+=1);return this.Swap(t,e,o,n-1),o},t.Swap=function(t,e,r,n){var i=t[r];t[r]=t[n],t[n]=i,i=e[r],e[r]=e[n],e[n]=i},t.QuickSort=function(t,e,r,n){if(r<n){var i=this.Partition(t,e,r,n);this.QuickSort(t,e,r,i),this.QuickSort(t,e,i+1,n)}},t}(),n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(){function t(){}return t.Sort=function(t){return this.QuickSort(t,0,t.length-1),t},t.Swap=function(t,e,r){var n=t[e];t[e]=t[r],t[r]=n},t.Partition=function(t,e,r){for(var n=t[Math.floor((r+e)/2)];e<=r;){for(;t[e]<n;)e++;for(;t[r]>n;)r--;e<=r&&(this.Swap(t,e,r),e++,r--)}return e},t.QuickSort=function(t,e,r){var n;return t.length>1&&(e<(n=this.Partition(t,e,r))-1&&this.QuickSort(t,e,n-1),n<r&&this.QuickSort(t,n,r)),t},t}(),o=function(){function t(){}return t.Correlation=function(t,e){for(var r=0,n=0,i=0,o=0,a=0,s=0,l=0;l<t.length;l++)n+=t[l]*e[l],i+=t[l],o+=e[l],a+=t[l]*t[l],s+=e[l]*e[l];return(r=t.length*n-i*o)&&(r/=Math.sqrt((t.length*a-i*i)*(t.length*s-o*o))),r},t.TickRange=function(t,e,r){var n=t/(e-1),i=Math.ceil(this.Log10(n)-1),o=Math.pow(10,i);return Math.ceil(n/o)*o},t.Log10=function(t){return Math.log(t)/Math.LN10},t.Log2=function(t){return Math.log(t)/Math.LN2},t.Percentiles=function(t,e){for(var r=i.Sort(t.slice(0)),n=r.length,o=new Array(101),a=0;a<100;a++)o[a]=r[Math.round(n*a/100)];return o[100]=r[n-1],o},t.Percentile=function(t,e){var r=i.Sort(t.slice(0)),n=r.length;return r[Math.max(0,Math.min(n-1,Math.round(n*e)))]},t.Interval=function(t){var e=0;if(!t.data||!t.data.length)return 0;if(void 0===t.min){if(void 0===t.max)return 1;for(var r=0,n=t.data;r<n.length;r++)(l=n[r])<=t.max&&e++}else if(void 0===t.max)for(var i=0,o=t.data;i<o.length;i++)(l=o[i])>=t.min&&e++;else for(var a=0,s=t.data;a<s.length;a++){var l;(l=s[a])>=t.min&&l<=t.max&&e++}return e/t.data.length},t.R2=function(t,e){for(var r=0,n=0,i=0,o=0,a=0,s=0,l=0,u=0,c=0;c<t.length;c++)o+=(n=e[c])*(i=t[c]),a+=n,s+=i,l+=n*n,u+=i*i;return(r=t.length*o-a*s)&&(r/=Math.sqrt((t.length*l-a*a)*(t.length*u-s*s))),r*r},t.ToSD=function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return t;var r=Math.pow(10,Math.floor(this.Log10(t))+1-e);return Math.round(t/r)*r},t.Statistics=function(t){for(var e=this.Range(t),r=t.length,o=0,a=0,s=0,l=0,u=i.Sort(t.slice(0)),c=u[Math.round(r/2)],h=0;h<r;h++)o+=t[h];var f=o/=r;for(h=0;h<r;h++){var d=t[h]-o;a+=d*d,l+=d*d*d,s+=d*d*d*d}var p=r,m=a/r,v=Math.sqrt(a/r),y=l/((r-1)*Math.pow(v,3)),_=s/((r-1)*Math.pow(v,4)),g=Math.sqrt(a/r)/Math.sqrt(r),w={};for(h=5;h<100;h+=5)w[h]=u[Math.round(r*h/100)];w[0]=u[0],w[100]=u[r-1];var b=this.Interval({data:t,max:0});return n(n({},e),{median:c,mean:f,N:p,variance:m,stdev:v,skewness:y,kurtosis:_,stderr:g,percentiles:w,zero:b})},t.Truncate=function(t,e,r){var n=i.Sort(t.slice(0));return n.slice(Math.round(n.length*e/100),Math.round(n.length*r/100))},t.Histogram=function(t,e){void 0===e&&(e="sturges");for(var r=!0,n=0;r&&n<t.length;n++)r=r&&t[n]===Math.round(t[n]);var i=this.Range(t);if("string"==typeof e||!e)if("fd"===e){var o=this.FD(t);e=0===o||0===i.range?1:Math.round(i.range/o+1)}else e=this.Sturges(t);var a=[],s=[];if(r&&e>i.range){for(e=i.range+1,n=0;n<e;n++)a[n]=0,s[n]=i.min+n;for(var l=0,u=t;l<u.length;l++)a[(v=u[l])-i.min]++}else{var c=this.TickRange(i.range,e),h=this.FirstBin(i.max,i.min,e,c),f=Math.ceil(this.Log10(c)-1);for(n=0;n<e;n++)a[n]=0,s[n]=(h+n*c).toFixed(Math.max(0,-f));for(var d=h-c,p=0,m=t;p<m.length;p++){var v=m[p];a[Math.floor((v-d)/c)]++}}return{bins:a,labels:s}},t.Sturges=function(t){return Math.ceil(this.Log2(t.length)+1)},t.IQR=function(t){var e=this.Quantiles(t,[.25,.75]);return e[1]-e[0]},t.Quantiles=function(t,e){void 0===e&&(e=[0,.25,.5,.75,1]);var r=i.Sort(t.slice(0));return e.map((function(t){return r[Math.floor((r.length-1)*t)]}))},t.FD=function(t){return 2*this.IQR(t)*Math.pow(t.length,-1/3)},t.FirstBin=function(t,e,r,n){var i=(Math.floor(e/n)+1)*n,o=Math.floor((i+(r-1)*n-t)/n);return o>=2?i-o/2*n:i},t.Range=function(t){for(var e=t.length,r=e>0?t[0]:0,n=e>0?t[0]:0,i=1;i<e;i++)t[i]>n&&(n=t[i]),t[i]<r&&(r=t[i]);return{min:r,max:n,range:n-r}},t.EPSILON_DOUBLE=2220446049250313e-31,t.QUIET_NAN=Number.NaN,t.s_undefined="undefined",t.s_object="object",t.s_number="number",t}(),a=function(){function t(){this.rows=0,this.columns=0,this.data=[]}return t.Zero=function(e,r){return void 0===r&&(r=e),(new t).Reset(e,r)},t.Identity=function(t){for(var e=this.Zero(t,t),r=0;r<t;r++)e.data[r][r]=1;return e},t.Clone=function(e){var r=new t;r.rows=e.rows,r.columns=e.columns;for(var n=0,i=e.data;n<i.length;n++){var o=i[n];r.data.push(new Float64Array(o))}return r},t.FromArray=function(t,e){void 0===e&&(e=!1);var r=t[0].length,n=t.length;if(e){for(var i=this.Zero(r,n),o=0;o<n;o++)for(var a=0;a<r;a++)i.data[o][a]=t[o][a];return i}for(i=this.Zero(n,r),o=0;o<n;o++)for(a=0;a<r;a++)i.data[a][o]=t[o][a]||0;return i},t.prototype.Reset=function(t,e){this.data=new Array(e);for(var r=0;r<e;r++)this.data[r]=new Float64Array(t);return this.rows=t,this.columns=e,this},t.prototype.CopyTo=function(t){t.rows=this.rows,t.columns=this.columns,t.data=new Array(this.columns);for(var e=0,r=this.data;e<r.length;e++){var n=r[e];t.data.push(new Float64Array(n))}return t},t.prototype.GetColumn=function(t){return this.data[t]},t.prototype.SetColumn=function(t,e){this.data[t]=new Float64Array(e)},t.prototype.Transpose=function(){for(var e=t.Zero(this.columns,this.rows),r=0;r<this.columns;r++)for(var n=0;n<this.rows;n++)e.data[r][n]=this.data[n][r];return e},t.prototype.Symmetrize=function(e){void 0===e&&(e=!1);var r=this.Transpose(),n=t.Clone(this);if(e)for(o=1;o<this.columns;o++)for(i=0;i<o;i++)n.data[i][o]=r.data[i][o];else for(var i=1;i<this.rows;i++)for(var o=0;o<i;o++)n.data[i][o]=r.data[i][o];return n},t.prototype.Cholesky=function(e){if(void 0===e&&(e=!1),this.rows!==this.columns)throw new Error("matrix not square");for(var r=this.rows,n=t.Zero(r),i=0;i<r;i++){for(var o=0,a=0;a<i;a++){for(var s=0,l=0;l<a;l++)s+=n.data[a][l]*n.data[i][l];if(n.data[i][a]=s=(this.data[i][a]-s)/n.data[a][a],o+=s*s,this.data[a][i]!==this.data[i][a])throw new Error("matrix not symmetrical")}if((o=this.data[i][i]-o)<=0)throw new Error("matrix not pos-def ("+o+")");for(n.data[i][i]=o>0?Math.sqrt(o):0,a=i+1;a<r;a++)n.data[i][a]=0}return e?n.Transpose():n},t.prototype.Multiply=function(e){for(var r=0,n=0,i=t.Zero(this.rows,e.columns),o=0;o<this.rows;o++)for(var a=0;a<e.columns;a++){for(n=r=0;r<this.columns;r++)n+=this.data[r][o]*e.data[a][r];i.data[a][o]=n}return i},t.prototype.Inverse=function(){if(this.rows!==this.columns)throw new Error("invalid matrix");for(var e=t.Clone(this),r=0,n=e.rows,i=1;i<n;i++)e.data[i][0]/=e.data[0][0];for(i=1;i<n;i++){for(var o=i;o<n;o++){r=0;for(var a=0;a<i;a++)r+=e.data[a][o]*e.data[i][a];e.data[i][o]-=r}if(i!==n-1)for(o=i+1;o<n;o++){for(r=0,a=0;a<i;a++)r+=e.data[a][i]*e.data[o][a];e.data[o][i]=(e.data[o][i]-r)/e.data[i][i]}}for(i=0;i<n;i++)for(o=i;o<n;o++){var s=1;if(i!==o)for(s=0,a=i;a<o;a++)s-=e.data[a][o]*e.data[i][a];e.data[i][o]=s/e.data[o][o]}for(i=0;i<n;i++)for(o=i;o<n;o++)if(i!==o){for(r=0,a=i;a<o;a++)r+=e.data[o][a]*(i===a?1:e.data[a][i]);e.data[o][i]=-r}for(i=0;i<n;i++)for(o=0;o<n;o++){for(r=0,a=i>o?i:o;a<n;a++)r+=(o===a?1:e.data[a][o])*e.data[i][a];e.data[i][o]=r}return e},t.prototype.SortColumns=function(e){void 0===e&&(e=!1);for(var r=t.Clone(this),n=e?function(t,e){return e-t}:function(t,e){return t-e},i=0,o=r.data;i<o.length;i++)o[i].sort(n);return r},t.prototype.Rank=function(e){void 0===e&&(e=!1);for(var n=t.Clone(this),i=new Int32Array(this.rows),o=0;o<this.rows;o++)i[o]=o;for(var a=0;a<this.columns;a++){var s=new Int32Array(i);for(r.Sort(n.data[a],s),e&&s.reverse(),o=0;o<this.rows;o++)n.data[a][s[o]]=o}return n},t.prototype.Rank2=function(e,n){void 0===e&&(e=!1);for(var i=t.Zero(this.rows,this.columns),o=new Int32Array(this.rows),a=0;a<this.rows;a++)o[a]=a;for(var s=0;s<this.columns;s++){var l=new Int32Array(o);for(r.Sort(this.data[s],l),e&&l.reverse(),a=0;a<this.rows;a++)i.data[s][l[a]]=n.data[s][a]}return i},t.prototype.Correl=function(){for(var e=t.Zero(this.columns,this.columns),r=0;r<this.columns;r++){e.data[r][r]=1;for(var n=0;n<r;n++)e.data[n][r]=o.Correlation(this.data[r],this.data[n])}return e.Symmetrize()},t.prototype.IsSymmetric=function(){if(this.rows!==this.columns)return!1;for(var t=0;t<this.columns;t++)for(var e=0;e<this.rows;e++)if(this.data[t][e]!==this.data[e][t])return!1;return!0},t.prototype.toString=function(t){var e="";t=t||2;for(var r=0;r<this.rows;r++){for(var n=0;n<this.columns;n++){var i=this.data[n][r];i>=0&&(e+=" "),e+=i.toFixed(t),e+=" "}e+="\n"}return e},t}();Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length,r=0;r<e;r++){if(arguments[r]===1/0||arguments[r]===-1/0)return 1/0;t+=arguments[r]*arguments[r]}return Math.sqrt(t)});var s=function(){function t(){}return t.Guid=function(){for(var t="",e=0;e<8;e++)t+=Math.round(256*Math.random()).toString(16);return t},t.Log10=function(t){return Math.log(t)/Math.LN10},t.ToSD=function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return t;var r=t<0?-1:1;t*=r;var n=Math.pow(10,Math.floor(this.Log10(t))+1-e);return Math.round(t/n)*n*r},t.ToSDCeil=function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return t;var r=t<0?-1:1;t*=r;var n=Math.pow(10,Math.floor(this.Log10(t))+1-e);return Math.ceil(t/n)*n*r},t.SuggestDecimals=function(t){if("number"!=typeof t){for(var e=t[0],r=t[0],n=0,i=t;n<i.length;n++){var o=i[n];e=Math.min(e,o),r=Math.max(r,o)}t=r-e}var a=Math.ceil(this.Log10(t));return console.log(a),a<=0?1-a:1},t.YearFraction=function(t){var e=new Date(t.getTime());return e.setMonth(11,31),(e.getTime()-t.getTime())/this.MILLIS_YEAR},t.DEFAULT_NUMBER_FORMAT="(0,0.00)",t.DEFAULT_PCT_FORMAT="0.00",t.DEFAULT_CURRENCY_FORMAT="(0,0)",t.MILLIS_YEAR=315576e5,t}(),l=function(){function t(t){this.order=0,this.realvalues=[],this.ivalues=[],this.vectors=[];var e=t.length;this.order=e,this.vectors=[];for(var r=!0,n=0;r&&n<e;n++){if(t[n].length!==e)throw new Error("not square");for(var i=0;i<e;i++)t[n][i]!==t[i][n]&&(r=!1)}if(r){for(n=0;n<e;n++)Array.isArray(t[n])?this.vectors.push(t[n].slice(0)):this.vectors.push(Array.from(t[n]));this.tred2(),this.tql2()}else{var o=[],a=[];for(n=0;n<e;n++){for(Array.isArray(t[n])?o.push(t[n].slice(0)):o.push(Array.from(t[n])),this.vectors.push([]),i=0;i<e;i++)this.vectors[n][i]=0;a.push(0)}this.orthes(o,a),this.hqr2(o,a)}}return t.prototype.GetDiagonal=function(){for(var t=[],e=0;e<this.order;e++){t.push([]);for(var r=0;r<this.order;r++)t[e][r]=0;t[e][e]=this.realvalues[e],this.ivalues[e]>0?t[e][e+1]=this.ivalues[e]:this.ivalues[e]<0&&(t[e][e-1]=this.ivalues[e])}return t},t.prototype.tred2=function(){for(var t=0,e=0,r=0,n=0,i=0,o=this.order,a=this.vectors,s=this.realvalues,l=this.ivalues,u=0;u<o;u++)s[u]=a[o-1][u];for(var c=o-1;c>0;c--){r=0,n=0;for(var h=0;h<c;h++)r+=Math.abs(s[h]);if(0===r)for(l[c]=s[c-1],u=0;u<c;u++)s[u]=a[c-1][u],a[c][u]=0,a[u][c]=0;else{for(h=0;h<c;h++)s[h]/=r,n+=s[h]*s[h];for(t=s[c-1],e=Math.sqrt(n),t>0&&(e=-e),l[c]=r*e,n-=t*e,s[c-1]=t-e,u=0;u<c;u++)l[u]=0;for(u=0;u<c;u++){t=s[u],a[u][c]=t;var f=l[u]+a[u][u]*t;for(h=u+1;h<=c-1;h++)f+=a[h][u]*s[h],l[h]+=a[h][u]*t;l[u]=f}for(t=0,u=0;u<c;u++)l[u]/=n,t+=l[u]*s[u];for(i=t/(n+n),u=0;u<c;u++)l[u]-=i*s[u];for(u=0;u<c;u++){for(t=s[u],e=l[u],h=u;h<=c-1;h++)a[h][u]-=t*l[h]+e*s[h];s[u]=a[c-1][u],a[c][u]=0}}s[c]=n}for(c=0;c<o-1;c++){if(a[o-1][c]=a[c][c],a[c][c]=1,0!==(n=s[c+1])){for(h=0;h<=c;h++)s[h]=a[h][c+1]/n;for(u=0;u<=c;u++){for(e=0,h=0;h<=c;h++)e+=a[h][c+1]*a[h][u];for(h=0;h<=c;h++)a[h][u]-=e*s[h]}}for(h=0;h<=c;h++)a[h][c+1]=0}for(u=0;u<o;u++)s[u]=a[o-1][u],a[o-1][u]=0;a[o-1][o-1]=1,l[0]=0},t.prototype.tql2=function(){var t,e,r,n,i,o,a,s,l,u,c,h,f,d,p,m,v,y,_,g=this.order,w=this.vectors,b=this.realvalues,x=this.ivalues;for(t=1;t<g;t++)x[t-1]=x[t];for(x[g-1]=0,a=0,s=0,l=Math.pow(2,-52),e=0;e<g;e++){for(s=Math.max(s,Math.abs(b[e])+Math.abs(x[e])),o=e;o<g&&!(Math.abs(x[o])<=l*s);)o++;if(o>e)do{for(u=b[e],n=(b[e+1]-u)/(2*x[e]),c=Math.hypot(n,1),n<0&&(c=-c),b[e]=x[e]/(n+c),b[e+1]=x[e]*(n+c),h=b[e+1],f=u-b[e],t=e+2;t<g;t++)b[t]-=f;for(a+=f,n=b[o],p=d=1,m=d,v=x[e+1],y=0,_=0,t=o-1;t>=e;t--)for(m=p,p=d,_=y,u=d*x[t],f=d*n,c=Math.hypot(n,x[t]),x[t+1]=y*c,y=x[t]/c,n=(d=n/c)*b[t]-y*u,b[t+1]=f+y*(d*u+y*b[t]),r=0;r<g;r++)f=w[r][t+1],w[r][t+1]=y*w[r][t]+d*f,w[r][t]=d*w[r][t]-y*f;n=-y*_*m*v*x[e]/h,x[e]=y*n,b[e]=d*n}while(Math.abs(x[e])>l*s);b[e]=b[e]+a,x[e]=0}for(t=0;t<g-1;t++){for(r=t,n=b[t],i=t+1;i<g;i++)b[i]<n&&(r=i,n=b[i]);if(r!==t)for(b[r]=b[t],b[t]=n,i=0;i<g;i++)n=w[i][t],w[i][t]=w[i][r],w[i][r]=n}},t.prototype.orthes=function(t,e){var r,n,i,o,a,s,l,u=this.order,c=this.vectors,h=(this.realvalues,this.ivalues,u-1);for(s=1;s<=h-1;s++){for(l=0,o=s;o<=h;o++)l+=Math.abs(t[o][s-1]);if(0!==l){for(i=0,o=h;o>=s;o--)e[o]=t[o][s-1]/l,i+=e[o]*e[o];for(n=Math.sqrt(i),e[s]>0&&(n=-n),i-=e[s]*n,e[s]=e[s]-n,a=s;a<u;a++){for(r=0,o=h;o>=s;o--)r+=e[o]*t[o][a];for(r/=i,o=s;o<=h;o++)t[o][a]-=r*e[o]}for(o=0;o<=h;o++){for(r=0,a=h;a>=s;a--)r+=e[a]*t[o][a];for(r/=i,a=s;a<=h;a++)t[o][a]-=r*e[a]}e[s]=l*e[s],t[s][s-1]=l*n}}for(o=0;o<u;o++)for(a=0;a<u;a++)c[o][a]=o===a?1:0;for(s=h-1;s>=1;s--)if(0!==t[s][s-1]){for(o=s+1;o<=h;o++)e[o]=t[o][s-1];for(a=s;a<=h;a++){for(n=0,o=s;o<=h;o++)n+=e[o]*c[o][a];for(n=n/e[s]/t[s][s-1],o=s;o<=h;o++)c[o][a]+=n*e[o]}}},t.prototype.cdiv=function(t,e,r,n){var i=0,o=0;return Math.abs(r)>Math.abs(n)?{r:(t+(i=n/r)*e)/(o=r+i*n),i:(e-i*t)/o}:{r:((i=r/n)*t+e)/(o=n+i*r),i:(i*e-t)/o}},t.prototype.hqr2=function(t,e){var r,n,i,o,a,s,l,u,c,h,f,d=this.order,p=this.vectors,m=this.realvalues,v=this.ivalues,y=d,_=y-1,g=y-1,w=Math.pow(2,-52),b=0,x=0,M=0,C=0,S=0,A=0,R=0;for(s=0;s<y;s++)for((s<0||s>g)&&(m[s]=t[s][s],v[s]=0),l=Math.max(s-1,0);l<y;l++)R+=Math.abs(t[s][l]);for(c=0;_>=0;){for(h=_;h>0&&(0===(S=Math.abs(t[h-1][h-1])+Math.abs(t[h][h]))&&(S=R),!(Math.abs(t[h][h-1])<w*S));)h--;if(h===_)t[_][_]=t[_][_]+b,m[_]=t[_][_],v[_]=0,_--,c=0;else if(h===_-1){if(n=t[_][_-1]*t[_-1][_],M=(x=(t[_-1][_-1]-t[_][_])/2)*x+n,A=Math.sqrt(Math.abs(M)),t[_][_]=t[_][_]+b,t[_-1][_-1]=t[_-1][_-1]+b,i=t[_][_],M>=0){for(A=x>=0?x+A:x-A,m[_-1]=i+A,m[_]=m[_-1],0!==A&&(m[_]=i-n/A),v[_-1]=0,v[_]=0,x=(i=t[_][_-1])/(S=Math.abs(i)+Math.abs(A)),M=A/S,x/=C=Math.sqrt(x*x+M*M),M/=C,l=_-1;l<y;l++)A=t[_-1][l],t[_-1][l]=M*A+x*t[_][l],t[_][l]=M*t[_][l]-x*A;for(s=0;s<=_;s++)A=t[s][_-1],t[s][_-1]=M*A+x*t[s][_],t[s][_]=M*t[s][_]-x*A;for(s=0;s<=g;s++)A=p[s][_-1],p[s][_-1]=M*A+x*p[s][_],p[s][_]=M*p[s][_]-x*A}else m[_-1]=i+x,m[_]=i+x,v[_-1]=A,v[_]=-A;_-=2,c=0}else{if(i=t[_][_],o=0,n=0,h<_&&(o=t[_-1][_-1],n=t[_][_-1]*t[_-1][_]),10===c){for(b+=i,s=0;s<=_;s++)t[s][s]-=i;i=o=.75*(S=Math.abs(t[_][_-1])+Math.abs(t[_-1][_-2])),n=-.4375*S*S}if(30===c&&(S=(S=(o-i)/2)*S+n)>0){for(S=Math.sqrt(S),o<i&&(S=-S),S=i-n/((o-i)/2+S),s=0;s<=_;s++)t[s][s]-=S;b+=S,i=o=n=.964}for(c+=1,f=_-2;f>=h&&(x=((C=i-(A=t[f][f]))*(S=o-A)-n)/t[f+1][f]+t[f][f+1],M=t[f+1][f+1]-A-C-S,C=t[f+2][f+1],x/=S=Math.abs(x)+Math.abs(M)+Math.abs(C),M/=S,C/=S,f!==h)&&!(Math.abs(t[f][f-1])*(Math.abs(M)+Math.abs(C))<w*(Math.abs(x)*(Math.abs(t[f-1][f-1])+Math.abs(A)+Math.abs(t[f+1][f+1]))));)f--;for(s=f+2;s<=_;s++)t[s][s-2]=0,s>f+2&&(t[s][s-3]=0);for(u=f;u<=_-1;u++){var k=u!==_-1;if(u!==f&&(x=t[u][u-1],M=t[u+1][u-1],C=k?t[u+2][u-1]:0,0!==(i=Math.abs(x)+Math.abs(M)+Math.abs(C))&&(x/=i,M/=i,C/=i)),0===i)break;if(S=Math.sqrt(x*x+M*M+C*C),x<0&&(S=-S),0!==S){for(u!==f?t[u][u-1]=-S*i:h!==f&&(t[u][u-1]=-t[u][u-1]),i=(x+=S)/S,o=M/S,A=C/S,M/=x,C/=x,l=u;l<y;l++)x=t[u][l]+M*t[u+1][l],k&&(x+=C*t[u+2][l],t[u+2][l]=t[u+2][l]-x*A),t[u][l]=t[u][l]-x*i,t[u+1][l]=t[u+1][l]-x*o;for(s=0;s<=Math.min(_,u+3);s++)x=i*t[s][u]+o*t[s][u+1],k&&(x+=A*t[s][u+2],t[s][u+2]=t[s][u+2]-x*C),t[s][u]=t[s][u]-x,t[s][u+1]=t[s][u+1]-x*M;for(s=0;s<=g;s++)x=i*p[s][u]+o*p[s][u+1],k&&(x+=A*p[s][u+2],p[s][u+2]=p[s][u+2]-x*C),p[s][u]=p[s][u]-x,p[s][u+1]=p[s][u+1]-x*M}}}}if(0!==R){for(_=y-1;_>=0;_--)if(x=m[_],0===(M=v[_]))for(h=_,t[_][_]=1,s=_-1;s>=0;s--){for(n=t[s][s]-x,C=0,l=h;l<=_;l++)C+=t[s][l]*t[l][_];if(v[s]<0)A=n,S=C;else if(h=s,0===v[s]?t[s][_]=0!==n?-C/n:-C/(w*R):(i=t[s][s+1],o=t[s+1][s],r=(i*S-A*C)/(M=(m[s]-x)*(m[s]-x)+v[s]*v[s]),t[s][_]=r,Math.abs(i)>Math.abs(A)?t[s+1][_]=(-C-n*r)/i:t[s+1][_]=(-S-o*r)/A),w*(r=Math.abs(t[s][_]))*r>1)for(l=s;l<=_;l++)t[l][_]=t[l][_]/r}else if(M<0)for(h=_-1,Math.abs(t[_][_-1])>Math.abs(t[_-1][_])?(t[_-1][_-1]=M/t[_][_-1],t[_-1][_]=-(t[_][_]-x)/t[_][_-1]):(a=this.cdiv(0,-t[_-1][_],t[_-1][_-1]-x,M),t[_-1][_-1]=a.r,t[_-1][_]=a.i),t[_][_-1]=0,t[_][_]=1,s=_-2;s>=0;s--){var T=void 0,P=void 0,N=void 0,E=void 0;for(T=0,P=0,l=h;l<=_;l++)T+=t[s][l]*t[l][_-1],P+=t[s][l]*t[l][_];if(n=t[s][s]-x,v[s]<0)A=n,C=T,S=P;else if(h=s,0===v[s]?(a=this.cdiv(-T,-P,n,M),t[s][_-1]=a.r,t[s][_]=a.i):(i=t[s][s+1],o=t[s+1][s],N=(m[s]-x)*(m[s]-x)+v[s]*v[s]-M*M,E=2*(m[s]-x)*M,0===N&&0===E&&(N=w*R*(Math.abs(n)+Math.abs(M)+Math.abs(i)+Math.abs(o)+Math.abs(A))),a=this.cdiv(i*C-A*T+M*P,i*S-A*P-M*T,N,E),t[s][_-1]=a.r,t[s][_]=a.i,Math.abs(i)>Math.abs(A)+Math.abs(M)?(t[s+1][_-1]=(-T-n*t[s][_-1]+M*t[s][_])/i,t[s+1][_]=(-P-n*t[s][_]-M*t[s][_-1])/i):(a=this.cdiv(-C-o*t[s][_-1],-S-o*t[s][_],A,M),t[s+1][_-1]=a.r,t[s+1][_]=a.i)),w*(r=Math.max(Math.abs(t[s][_-1]),Math.abs(t[s][_])))*r>1)for(l=s;l<=_;l++)t[l][_-1]=t[l][_-1]/r,t[l][_]=t[l][_]/r}for(s=0;s<y;s++)if(s<0||s>g)for(l=s;l<y;l++)p[s][l]=t[s][l];for(l=y-1;l>=0;l--)for(s=0;s<=g;s++){for(A=0,u=0;u<=Math.min(l,g);u++)A+=p[s][u]*t[u][l];p[s][l]=A}}},t}(),u=Math.pow(2,-52),c=function(){function t(){this.rows=0,this.columns=0,this._data=[]}return t.FromArray=function(t){for(var e=t[0].length,r=t.length,n=this.Zero(r,e),i=0;i<r;i++)for(var o=0;o<e;o++)n._data[i][o]=t[i][o]||0;return n},t.Zero=function(e,r){return void 0===r&&(r=e),(new t).Reset(e,r)},t.Identity=function(t){for(var e=this.Zero(t),r=0;r<t;r++)e._data[r][r]=1;return e},t.Clone=function(t){for(var e=this.Zero(t.rows,t.columns),r=0;r<t.rows;r++)e._data[r]=new Float64Array(t._data[r]);return e},t.prototype.Reset=function(t,e){void 0===e&&(e=t),this._data=new Array(t);for(var r=0;r<t;r++)this._data[r]=new Float64Array(e);return this.rows=t,this.columns=e,this},t.prototype.CopyTo=function(t){t.rows=this.rows,t.columns=this.columns,t._data=[];for(var e=0;e<this.rows;e++)t._data[e]=new Float64Array(this._data[e]);return t},t.prototype.Row=function(t,e){return void 0!==e&&(this._data[t]=new Float64Array(e)),Array.from(this._data[t])},t.prototype.Column=function(t,e){if(void 0!==e)for(var r=0;r<this.rows;r++)this._data[r][t]=arguments[1][r];var n=new Array(this.rows);for(r=0;r<this.rows;r++)n[r]=this._data[r][t];return n},t.prototype.Transpose=function(){for(var e=t.Zero(this.columns,this.rows),r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)e._data[n][r]=this._data[r][n];return e},t.prototype.ToArray=function(t){void 0===t&&(t=!1);var e=[];if(t)for(var r=0;r<this.columns;r++)e.push(this.Column(r));else for(var n=0;n<this.rows;n++)e.push(this.Row(n));return e},t.prototype.EigenSystem=function(){return new l(this._data)},t.prototype.IsPosDef=function(){return new l(this._data).realvalues.every((function(t){return t>0}))},t.prototype.MakePosDef=function(e){void 0===e&&(e=u);var r,n,i=new l(this._data),o=i.realvalues.length,a=t.Zero(o),s=t.Zero(o),c=0,h=t.Zero(o);for(i.vectors.forEach((function(t,e){return h.Row(e,t)})),r=0;r<o;r++){for(n=0;n<o;n++)a._data[r][n]=e;i.realvalues[r]>e&&(a._data[r][r]=i.realvalues[r])}for(r=0;r<o;r++){for(c=0,n=0;n<o;n++)s._data[r][n]=0,c+=i.vectors[r][n]*i.vectors[r][n]*a._data[n][n];s._data[r][r]=Math.sqrt(1/c)}for(r=0;r<o;r++)a._data[r][r]=Math.sqrt(a._data[r][r]);for(var f=s.Multiply(h.Multiply(a)),d=f.Multiply(f.Transpose()).Symmetrize(),p=0;p<d.rows;p++)d._data[p][p]=1;return d},t.prototype.Symmetrize=function(e){void 0===e&&(e=!1);var r,n,i=this.Transpose(),o=t.Clone(this);if(e)for(r=1;r<this.rows;r++)for(n=0;n<r;n++)o._data[r][n]=i._data[r][n];else for(n=1;n<this.columns;n++)for(r=0;r<n;r++)o._data[r][n]=i._data[r][n];return o},t.prototype.Cholesky=function(e){if(void 0===e&&(e=!1),this.rows!==this.columns)throw new Error("matrix not square");var r,n,i,o,a,s=this.rows,l=t.Zero(s);for(o=0;o<s;o++){for(n=0,a=0;a<o;a++){for(r=0,i=0;i<a;i++)r+=l._data[i][a]*l._data[i][o];if(l._data[a][o]=r=(this._data[a][o]-r)/l._data[a][a],n+=r*r,this._data[a][o]!=this._data[o][a])throw new Error("matrix not symmetrical")}if((n=this._data[o][o]-n)<=0)throw new Error("matrix not pos-def");for(l._data[o][o]=n>0?Math.sqrt(n):0,a=o+1;a<s;a++)l._data[a][o]=0}return e?l.Transpose():l},t.prototype.Multiply=function(e){var r,n,i,o,a=t.Zero(this.rows,e.columns);for(r=0;r<this.rows;r++)for(n=0;n<e.columns;n++){for(o=i=0;i<this.columns;i++)o+=this._data[r][i]*e._data[i][n];a._data[r][n]=o}return a},t.prototype.Inverse=function(){if(this.rows!==this.columns)throw new Error("invalid matrix");var e,r,n,i,o=t.Clone(this),a=o.rows;for(r=1;r<a;r++)o._data[0][r]/=o._data[0][0];for(r=1;r<a;r++){for(n=r;n<a;n++){for(e=0,i=0;i<r;i++)e+=o._data[n][i]*o._data[i][r];o._data[n][r]-=e}if(r!=a-1)for(n=r+1;n<a;n++){for(e=0,i=0;i<r;i++)e+=o._data[r][i]*o._data[i][n];o._data[r][n]=(o._data[r][n]-e)/o._data[r][r]}}for(r=0;r<a;r++)for(n=r;n<a;n++){var s=1;if(r!=n)for(s=0,i=r;i<n;i++)s-=o._data[n][i]*o._data[i][r];o._data[n][r]=s/o._data[n][n]}for(r=0;r<a;r++)for(n=r;n<a;n++)if(r!=n){for(e=0,i=r;i<n;i++)e+=o._data[i][n]*(r==i?1:o._data[r][i]);o._data[r][n]=-e}for(r=0;r<a;r++)for(n=0;n<a;n++){for(e=0,i=r>n?r:n;i<a;i++)e+=(n==i?1:o._data[n][i])*o._data[i][r];o._data[n][r]=e}return o},t.prototype.SortColumns=function(e){void 0===e&&(e=!1);for(var r=t.Clone(this),n=e?function(t,e){return e-t}:function(t,e){return t-e},i=0;i<this.columns;i++)r.Column(i,this.Column(i).sort(n));return r},t.prototype.Rank=function(e){void 0===e&&(e=!1);for(var n,i=t.Clone(this),o=new Array(this.rows),a=new Array(this.rows),s=0;s<this.columns;s++){for(n=0;n<this.rows;n++)a[n]=n,o[n]=this._data[n][s];for(r.Sort(o,a),e&&a.reverse(),n=0;n<this.rows;n++)i._data[a[n]][s]=n}return i},t.prototype.Correl=function(){for(var e=new Array(this.columns),r=0;r<this.columns;r++)e[r]=this.Column(r);for(var n=t.Zero(this.columns),i=0;i<this.columns;i++){n._data[i][i]=1;for(var a=0;a<i;a++)n._data[i][a]=o.Correlation(e[i],e[a])}return n.Symmetrize()},t.prototype.IsSymmetric=function(){if(this.rows!=this.columns)return!1;for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)if(this._data[t][e]!==this._data[e][t])return!1;return!0},t}();Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length,r=0;r<e;r++){if(arguments[r]===1/0||arguments[r]===-1/0)return 1/0;t+=arguments[r]*arguments[r]}return Math.sqrt(t)});for(var h=function(){function t(){}return t.Normal=function(t,e){var r=this;void 0===e&&(e={});var i=n({mean:0,sd:1,lhs:!1,ordered:!1},e);return(i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered)).map((function(t){return r.InverseNormal2(t)*i.sd+i.mean}))},t.ReverseInverseNormal2=function(t,e){var r=this;void 0===e&&(e=40);for(var n=[0,Math.min(1,Math.max(0,.5+.125*t)),1],i=n.map((function(t){return r.InverseNormal2(t)})),o=0;o<e;o++){if(Math.abs(i[1]-t)<=1e-6)return n[1];i[1]<t?(n=[n[1],(n[1]+n[2])/2,n[2]],i=[i[1],this.InverseNormal2(n[1]),i[2]]):(n=[n[0],(n[0]+n[1])/2,n[1]],i=[i[0],this.InverseNormal2(n[1]),i[1]])}return n[1]},t.TruncatedNormal=function(t,e){var r=this;void 0===e&&(e={});var i=n({mean:0,sd:1,lhs:!1,ordered:!1},e),o=i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered),a=0,s=1;"number"==typeof i.min&&(a=this.ReverseInverseNormal2((i.min-i.mean)/i.sd,i.max_iterations)),"number"==typeof i.max&&(s=this.ReverseInverseNormal2((i.max-i.mean)/i.sd,i.max_iterations));var l=s-a;return(o=o.map((function(t){return t*l+a}))).map((function(t){return r.InverseNormal2(t)*i.sd+i.mean}))},t.LogNormal=function(t,e){void 0===e&&(e={});for(var r=n({mean:1,sd:1,lhs:!1,ordered:!1},e),i=r.lhs?this.LHSFieldDouble(t,r.ordered):this.UniformField(t,r.ordered),o=0;o<i.length;o++)i[o]=Math.exp(this.InverseNormal2(i[o])*r.sd+r.mean);return i},t.LogNormalReturn=function(t,e){void 0===e&&(e={});var r=n({mean:1,sd:1,lhs:!1,ordered:!1},e),i=r.lhs?this.LHSFieldDouble(t,r.ordered):this.UniformField(t,r.ordered);r.mean+=1;for(var o=r.mean*r.mean,a=r.sd*r.sd,s=Math.log(o/Math.sqrt(o+a)),l=Math.sqrt(Math.log((o+a)/o)),u=0;u<t;u++)i[u]=Math.exp(this.InverseNormal2(i[u])*l+s)-1;return i},t.Triangular=function(t,e){var r=this;void 0===e&&(e={});var i=n({a:0,b:1,c:.5,lhs:!1,ordered:!1,field:null},e);return(i.field||(i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered))).map((function(t){return r.InverseTriangular(t,i.a,i.b,i.c)}))},t.PERT=function(t,e){void 0===e&&(e={});var r=n({field:null,lhs:!1,a:0,b:1,c:.5,lambda:4,ordered:!1},e),i=r.field||(r.lhs?this.LHSField(t,r.ordered):this.UniformField(t,r.ordered));return this.InversePERTField(i,r.a,r.b,r.c,r.lambda)},t.Uniform=function(t,e){void 0===e&&(e={});for(var r=n({lhs:!1,min:0,max:1,ordered:!1},e),i=r.lhs?this.LHSFieldDouble(t,r.ordered):this.UniformField(t,r.ordered),o=r.max-r.min,a=0;a<i.length;a++)i[a]=i[a]*o+r.min;return i},t.Bernoulli=function(t,e){void 0===e&&(e={});var r=n({lhs:!1,p:.5},e);return this.Uniform(t,{lhs:r.lhs,min:0,max:1}).map((function(t){return t<=r.p}))},t.Beta=function(t,e){var r=this;void 0===e&&(e={});var i=n({lhs:!1,a:0,b:1,ordered:!1},e);return(i.lhs?this.LHSField(t,i.ordered):this.UniformField(t,i.ordered)).map((function(t){return r.InverseBeta(t,i.a,i.b)}))},t.Discretize=function(t,e){var r=t.slice(0);e=e||Math.round;for(var n=0;n<r.length;n++)r[n]=e(r[n]);return r},t.Constant=function(t,e){for(var r=new Array(t),n=0;n<t;n++)r[n]=e;return r},t.Fixed=function(t,e){void 0===e&&(e={}),e=n({value:0},e);for(var r=new Array(t),i=0;i<t;i++)r[i]=e.value;return r},t.Conditional=function(t,e,r,n,i,o){void 0===i&&(i=0);for(var a=o||this.Bernoulli(t,{lhs:!0,p:e}),s=r(Math.ceil(t*e),n),l=new Array(t),u=0,c=0;u<t;u++)l[u]=a[u]?s[c++]:i;return l},t.Correlate=function(t,e,r){void 0===r&&(r=!1);var n,i=e.length,o=e[0].length,a=c.Zero(o,i);for(n=0;n<i;n++)a.Column(n,this.VDWField(o));var s=a.Multiply(t.Cholesky(!0).Multiply(a.Correl().Cholesky(!0).Inverse()).Transpose()).Rank();return r?e.map((function(t,e){var r=new Array(t.length),i=s.Column(e);for(n=0;n<i.length;n++)r[n]=t[i[n]];return r})):e.map((function(t,e){var r=t.slice(0).sort((function(t,e){return t-e})),i=new Array(t.length),o=s.Column(e);for(n=0;n<o.length;n++)i[n]=r[o[n]];return i}))},t.CorrelateCDM=function(t,e,r){void 0===r&&(r=!1);var n,i=e.length,o=e[0].length,s=a.Zero(o,i);for(n=0;n<i;n++)s.SetColumn(n,this.VDWField(o));var l=new a;if(l.rows=o,l.columns=i,l.data=e.map((function(t){return new Float64Array(t)})),!r)throw new Error("E_NOTIMPL: correlateCDM !ordered");return s.Multiply(t.Cholesky(!0).Multiply(s.Correl().Cholesky(!0).Inverse()).Transpose()).Rank2(!1,l).data},t.P80Pert=function(t,e,r,n){var i=this.PERTParameters(t,e,r,n),o=(i.max-i.min)/(this.InverseBeta(.9,i.v,i.w)-this.InverseBeta(.1,i.v,i.w)),a=i.min-this.InverseBeta(.1,i.v,i.w)*o,s=i.max+(1-this.InverseBeta(.9,i.v,i.w))*o;return{a:a/i.scale,b:s/i.scale,c:r}},t.P80Triangular=function(t,e,r){var n,i=(r-t)/(e-t),o=i<.5;o&&(i=1-i);var a=2.1266864*i-.1596122-2.1742909*i*i+1.1087738*i*i*i;o&&(a=1-a);var s=(e-t)/(.6890868-.4434898*i+.35757*i*i);return{a:n=r-a*s,b:n+s,c:r}},t.BetaDensity=function(t,e,r){if("number"!=typeof t){for(var n=new Array(t.length),i=0;i<t.length;i++)t[i]<=0||t[i]>=1?n[i]=0:n[i]=Math.exp((e-1)*Math.log(t[i])+(r-1)*Math.log(1-t[i])-this.LnGamma(e)-this.LnGamma(r)+this.LnGamma(e+r));return n}return t<=0||t>=1?0:Math.exp((e-1)*Math.log(t)+(r-1)*Math.log(1-t)-this.LnGamma(e)-this.LnGamma(r)+this.LnGamma(e+r))},t.PERTDensity=function(t,e,r,n,i){void 0===i&&(i=4);var o,a,s=(e+r+i*n)/(i+2);return a=(o=n===s?i/2+1:(s-e)*(2*n-e-r)/((n-s)*(r-e)))*(r-s)/(s-e),this.BetaDensity(t,o,a)},t.NormalDensity=function(t){if("number"!=typeof t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=.398942280401433*Math.exp(-t[r]*t[r]/2);return e}return.398942280401433*Math.exp(-t*t/2)},t.Shuffle=function(t){var r,n,i;for(n=t.length-1;n>=0;n--)r=Math.floor(e.Next()*(n+1)),i=t[n],t[n]=t[r],t[r]=i;return t},t.VDWField=function(t){if(this.vdw_cache.length!==t){this.vdw_cache=new Float64Array(t);for(var e=0;e<t;e++)this.vdw_cache[e]=this.InverseNormal2((e+1)/(t+1))}var r=new Float64Array(this.vdw_cache);return this.Shuffle(r)},t.LHSFieldDouble=function(t,r){void 0===r&&(r=!1);for(var n=1/t,i=new Float64Array(t),o=0;o<t;o++)i[o]=e.Next()*n+o*n;return r||this.Shuffle(i),i},t.LHSField=function(t,r){void 0===r&&(r=!1);for(var n=1/t,i=new Array(t),o=0;o<t;o++)i[o]=e.Next()*n+o*n;return r||this.Shuffle(i),i},t.UniformField=function(t,r){void 0===r&&(r=!1);for(var n=new Array(t),i=0;i<t;i++)n[i]=e.Next();return r&&n.sort((function(t,e){return t-e})),n},t.InverseTriangular=function(t,e,r,n){return e===r?e:t<=(n-e)/(r-e)?e+Math.sqrt((r-e)*(n-e)*t):r-Math.sqrt((r-e)*(r-n)*(1-t))},t.InverseNormal=function(t){return.5===t?0:(e=t<1&&t>.5?1-t:t,n=(r=Math.sqrt(Math.log(1/Math.pow(e,2))))-(2.515517+.802853*r+.010328*Math.pow(r,2))/(1+1.432788*r+.189269*Math.pow(r,2)+.001308*Math.pow(r,3)),t>.5?n:-n);var e,r,n},t.InverseNormal2=function(t){var e,r,n=t-.5;return Math.abs(n)<=.425?n*(((((((2509.0809287301227*(r=.180625-n*n)+33430.57558358813)*r+67265.7709270087)*r+45921.95393154987)*r+13731.69376550946)*r+1971.5909503065513)*r+133.14166789178438)*r+3.3871328727963665)/(((((((5226.495278852854*r+28729.085735721943)*r+39307.89580009271)*r+21213.794301586597)*r+5394.196021424751)*r+687.1870074920579)*r+42.31333070160091)*r+1):(r=n<0?t:1-t)<=0?0:(e=(r=Math.sqrt(-Math.log(r)))<=5?(((((((.0007745450142783414*(r-=1.6)+.022723844989269184)*r+.2417807251774506)*r+1.2704582524523684)*r+3.6478483247632045)*r+5.769497221460691)*r+4.630337846156546)*r+1.4234371107496835)/(((((((1.0507500716444169e-9*r+.0005475938084995345)*r+.015198666563616457)*r+.14810397642748008)*r+.6897673349851)*r+1.6763848301838038)*r+2.053191626637759)*r+1):(((((((2.0103343992922881e-7*(r-=5)+27115555687434876e-21)*r+.0012426609473880784)*r+.026532189526576124)*r+.29656057182850487)*r+1.7848265399172913)*r+5.463784911164114)*r+6.657904643501103)/(((((((20442631033899397e-31*r+1.421511758316446e-7)*r+18463183175100548e-21)*r+.0007868691311456133)*r+.014875361290850615)*r+.1369298809227358)*r+.599832206555888)*r+1),n<0?-e:e)},t.Log1p=function(t){var e=1+t;return Math.log(e)-(e-1-t)/e},t.BetaContFrac=function(e,r,n,i){var o,a=2*Number.MIN_VALUE,s=0,l=1,u=1-(e+r)*n/(e+1);for(Math.abs(u)<a&&(u=t.QUIET_NAN),o=u=1/u;s<512;){var c,h=s+1,f=h*(r-h)*n/((e-1+2*h)*(e+2*h));if(u=1+f*u,l=1+f/l,Math.abs(u)<a&&(u=t.QUIET_NAN),Math.abs(l)<a&&(l=t.QUIET_NAN),o*=(u=1/u)*l,u=1+(f=-(e+h)*(e+r+h)*n/((e+2*h)*(e+2*h+1)))*u,l=1+f/l,Math.abs(u)<a&&(u=t.QUIET_NAN),Math.abs(l)<a&&(l=t.QUIET_NAN),o*=c=(u=1/u)*l,Math.abs(c-1)<2*t.EPSILON_DOUBLE)break;if(o*Math.abs(c-1)<i)break;++s}return s>=512?t.QUIET_NAN:o},t.BetaCDF=function(e,r,n){if(e<=0)return 0;if(e>=1)return 1;if(0===e)return 0;if(1===e)return 1;var i,o=-(this.LnGamma(r)+this.LnGamma(n)-this.LnGamma(r+n))+r*Math.log(e)+n*this.Log1p(-e),a=Math.exp(o);return e<(r+1)/(r+n+2)?(i=Math.abs(0/(1*a/r))*t.EPSILON_DOUBLE,a*this.BetaContFrac(r,n,e,i)/r*1+0):(i=Math.abs(1/(1*a/n))*t.EPSILON_DOUBLE,1*(1-a*this.BetaContFrac(n,r,1-e,i)/n)+0)},t.LnGamma=function(t){var e=t-1,r=e+5.5;r-=(e+.5)*Math.log(r);var n=1;return n+=76.18009173/(e+=1),n+=-86.50532033/(e+=1),n+=24.01409822/(e+=1),n+=-1.231739516/(e+=1),n+=.00120858003/(e+=1),n+=-536382e-11/(e+=1),-r+Math.log(2.50662827465*n)},t.BetaPDF=function(t,e,r){return t<0||t>1?0:Math.exp(this.LnGamma(e+r)-this.LnGamma(e)-this.LnGamma(r))*Math.pow(t,e-1)*Math.pow(1-t,r-1)},t.InverseBeta=function(t,e,r){var n,i,o,a,s,l,u,c,h=0;if(t<0||t>1||e<0||r<0)return 0;if(0===t)return 0;if(1===t)return 1;if(t>.5){var f=1-t;return f>.5?this.InverseBeta(1-f,e,r):1-this.InverseBeta(f,r,e)}if(i=e/(e+r),t<.1){var d=(Math.log(e)+this.LnGamma(e)+this.LnGamma(r)-this.LnGamma(e+r)+Math.log(t))/e;d<=0?(n=Math.exp(d),n*=Math.pow(1-n,-(r-1)/e)):n=i,n>i&&(n=i)}else n=i;do{if(a=t-this.BetaCDF(n,e,r),s=this.BetaPDF(n,e,r),0===a||h++>64)return n;c=-((e-1)/n-(r-1)/(1-n))*(o=a/Math.max(2*Math.abs(a/n),s))*o/2,l=u=o,Math.abs(c)<Math.abs(u)?l+=c:l*=2*Math.abs(u/c),n+l>0&&n+l<1?n+=l:n=Math.sqrt(n)*Math.sqrt(i)}while(Math.abs(u)>1e-10*n);return n},t.InversePERTField=function(t,e,r,n,i){var o=this;if(r<=e)return t.map((function(){return e}));try{var a=this.PERTParameters(e,r,n,i);return t.map((function(t){return(o.InverseBeta(t,a.v,a.w)*(a.max-a.min)+a.min)/a.scale}))}catch(n){return e===r?t.map((function(t){return e})):t.map((function(t){return 0}))}},t.PERTParameters=function(t,e,r,n){if(void 0===n&&(n=4),t>=e||n<0||r<t||r>e)throw new Error("Invalid parameters");for(var i,o,a=1;Math.abs(t)<1&&Math.abs(e)<1;)a*=10,t*=10,e*=10,r*=10;return i=(t+e+n*r)/(n+2),{v:o=(0===r?Math.abs(i-r):Math.abs((i-r)/r))<=1e-12?n/2+1:(i-t)*(2*r-t-e)/((r-i)*(e-t)),w:o*(e-i)/(i-t),min:t,max:e,scale:a}},t.InversePERT=function(t,e,r,n,i){void 0===i&&(i=4);var o=this.PERTParameters(e,r,n,i);return(this.InverseBeta(t,o.v,o.w)*(o.max-o.min)+o.min)/o.scale},t.EPSILON_DOUBLE=2220446049250313e-31,t.QUIET_NAN=Number.NaN,t.M_LN_SQRT_2PI=.9189385332046728,t.M_1_SQRT_2PI=.3989422804014327,t.vdw_cache=new Float64Array(0),t}(),f=new Array(256),d=0;d<256;++d)f[d]=(d+256).toString(16).substr(1);var p=function(){function t(){this.buffer=[],this.buffer=[];for(var t=0;t<16;t++)this.buffer[t]=Math.floor(256*e.Next())}return t.prototype.toString=function(){var t=0;return f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+"-"+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]+f[this.buffer[t++]]},t}();t.CDMatrix=a,t.Eigensystem=l,t.MC=h,t.Matrix=c,t.QSort=i,t.QSort2=r,t.Random=e,t.Stats=o,t.UUID=p,t.Util=s,Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}function o(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function s(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t}Object.create,Object.create;var l,u=function(){function t(t,e,r){void 0===e&&(e=t),void 0===r&&(r=!1),this.end_=this.PatchNull(e),this.start_=this.PatchNull(t),r&&this.Normalize()}return t.FromColumn=function(e){return new t({row:1/0,column:e})},t.FromRow=function(e){return new t({row:e,column:1/0})},t.ColumnToLabel=function(t){for(var e=String.fromCharCode(65+t%26);t>25;)t=Math.floor(t/26)-1,e=String.fromCharCode(65+t%26)+e;return e},t.CellAddressToLabel=function(t,e){return void 0===e&&(e=!1),(e?(t.sheet_id||0)+"!":"")+(t.absolute_column?"$":"")+this.ColumnToLabel(t.column)+(t.absolute_row?"$":"")+(t.row+1)},t.Join=function(e){for(var r,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];var s=new t(e.start,e.end);try{for(var l=o(i),u=l.next();!u.done;u=l.next()){var c=u.value;c&&(s.ConsumeAddress(c.start),s.ConsumeAddress(c.end))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return s},t.Bleed=function(e,r){return void 0===r&&(r=1),new t({row:Math.max(0,e.start.row-r),column:Math.max(0,e.start.column-r)},{row:e.end.row+r,column:e.end.column+r})},Object.defineProperty(t.prototype,"start",{get:function(){return n({},this.start_)},set:function(t){this.start_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return n({},this.end_)},set:function(t){this.end_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.start_.row===1/0||this.end_.row===1/0?1/0:this.end_.row-this.start_.row+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.start_.column===1/0||this.end_.column===1/0?1/0:this.end_.column-this.start_.column+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.rows*this.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_sheet",{get:function(){return this.entire_row&&this.entire_column},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_column",{get:function(){return this.start_.row===1/0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_row",{get:function(){return this.start_.column===1/0},enumerable:!1,configurable:!0}),t.prototype.PatchNull=function(t){var e=n({},t);return null===e.row&&(e.row=1/0),null===e.column&&(e.column=1/0),e},t.prototype.SetSheetID=function(t){this.start_.sheet_id=t},t.prototype.Normalize=function(){var t=n({},this.start_),e=n({},this.end_);t.row===1/0||e.row===1/0?t.row=e.row=1/0:t.row>e.row&&(t.row=this.end_.row,t.absolute_row=this.end_.absolute_row,e.row=this.start_.row,e.absolute_row=this.start_.absolute_row),t.column===1/0||e.column===1/0?t.column=e.column=1/0:t.column>e.column&&(t.column=this.end_.column,t.absolute_column=this.end_.absolute_column,e.column=this.start_.column,e.absolute_column=this.start_.absolute_column),this.start_=t,this.end_=e},t.prototype.TopLeft=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.start.column),this.entire_column||(t.row=this.start.row),t},t.prototype.BottomRight=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.end.column),this.entire_column||(t.row=this.end.row),t},t.prototype.ContainsRow=function(t){return this.entire_column||t>=this.start_.row&&t<=this.end_.row},t.prototype.ContainsColumn=function(t){return this.entire_row||t>=this.start_.column&&t<=this.end_.column},t.prototype.Contains=function(t){return(this.entire_column||t.row>=this.start_.row&&t.row<=this.end_.row)&&(this.entire_row||t.column>=this.start_.column&&t.column<=this.end_.column)},t.prototype.ContainsArea=function(t){return this.start.column<=t.start.column&&this.end.column>=t.end.column&&this.start.row<=t.start.row&&this.end.row>=t.end.row},t.prototype.Intersects=function(t){return!(t.start.column>this.end.column||this.start.column>t.end.column||t.start.row>this.end.row||this.start.row>t.end.row)},t.prototype.Equals=function(t){return t.start_.row===this.start_.row&&t.start_.column===this.start_.column&&t.end_.row===this.end_.row&&t.end_.column===this.end_.column},t.prototype.Clone=function(){return new t(this.start,this.end)},t.prototype.Array=function(){if(this.entire_column||this.entire_row)throw new Error("can't convert infinite area to array");for(var t=new Array(this.rows*this.columns),e=this.start_.sheet_id,r=0,n=this.start_.row;n<=this.end_.row;n++)for(var i=this.start_.column;i<=this.end_.column;i++)t[r++]={row:n,column:i,sheet_id:e};return t},Object.defineProperty(t.prototype,"left",{get:function(){var e=new t(this.start_,this.end_);return e.end_.column=e.start_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){var e=new t(this.start_,this.end_);return e.start_.column=e.end_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){var e=new t(this.start_,this.end_);return e.end_.row=e.start_.row,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){var e=new t(this.start_,this.end_);return e.start_.row=e.end_.row,e},enumerable:!1,configurable:!0}),t.prototype.Shift=function(t,e){return this.start_.row+=t,this.start_.column+=e,this.end_.row+=t,this.end_.column+=e,this},t.prototype.ConsumeAddress=function(t){this.entire_row||(t.column<this.start_.column&&(this.start_.column=t.column),t.column>this.end_.column&&(this.end_.column=t.column)),this.entire_column||(t.row<this.start_.row&&(this.start_.row=t.row),t.row>this.end_.row&&(this.end_.row=t.row))},t.prototype.ConsumeArea=function(t){this.ConsumeAddress(t.start),this.ConsumeAddress(t.end)},t.prototype.Resize=function(t,e){return this.end_.row=this.start_.row+t-1,this.end_.column=this.start_.column+e-1,this},t.prototype.Iterate=function(t){if(this.entire_column||this.entire_row)console.warn("don't iterate infinite area");else for(var e=this.start_.column;e<=this.end_.column;e++)for(var r=this.start_.row;r<=this.end_.row;r++)t({column:e,row:r,sheet_id:this.start_.sheet_id})},Object.defineProperty(t.prototype,"spreadsheet_label",{get:function(){var e;return this.entire_sheet?"":this.entire_column?(e=t.ColumnToLabel(this.start_.column),e+=":"+t.ColumnToLabel(this.end_.column)):this.entire_row?(e=String(this.start_.row+1),e+=":"+(this.end_.row+1)):(e=t.CellAddressToLabel(this.start_),this.columns>1||this.rows>1?e+":"+t.CellAddressToLabel(this.end_):e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{start:n({},this.start_),end:n({},this.end_)}},t}();!function(t){t[t[void 0]=0]="undefined",t[t.formula=1]="formula",t[t.string=2]="string",t[t.number=3]="number",t[t.boolean=4]="boolean",t[t.object=5]="object",t[t.error=6]="error"}(l||(l={}));var c,h=function(t){switch(typeof t){case"undefined":return l.undefined;case"number":return l.number;case"boolean":return l.boolean;case"object":return null===t?l.undefined:l.object;case"string":return"="===t[0]?l.formula:l.string;default:return l.error}};!function(t){t[t.List=0]="List",t[t.Date=1]="Date",t[t.Range=2]="Range",t[t.Number=3]="Number",t[t.Boolean=4]="Boolean"}(c||(c={}));var f=function(){function t(t,e){this.type=l.undefined,this.render_dirty=!0,void 0!==t&&this.Set(t,e)}return t.StringToColumn=function(t){var e=0;t=t.toUpperCase();for(var r=0;r<t.length;r++)e*=26,e+=t.charCodeAt(r)-64;return e-1},t.prototype.ValueIsNumber=function(){return this.type===l.number},t.prototype.ValueIsFormula=function(){return this.type===l.formula},t.prototype.ValueIsBoolean=function(){return this.type===l.boolean},t.prototype.FlushStyle=function(){this.formatted=this.rendered_type=this.style=void 0,this.render_dirty=!0},t.prototype.FlushArray=function(){this.area=void 0},t.prototype.FlushCache=function(){this.calculated=this.calculated_type=this.formatted=this.rendered_type=this.render_function=this.click_function=void 0,this.render_dirty=!0},t.prototype.Reset=function(){this.type=l.undefined,this.value=this.note=this.hyperlink=this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.area=this.renderer_data=this.render_function=this.click_function=void 0,this.render_dirty=!0},t.prototype.Set=function(t,e){void 0===e&&(e=h(t)),this.value=t,this.type=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.render_function=this.click_function=this.area=void 0,this.render_dirty=!0},t.prototype.SetCalculatedValue=function(t,e){void 0===e&&(e=h(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},t.prototype.SetCalculatedValueOrError=function(t,e){void 0===e&&("object"==typeof t&&t.error?(e=l.error,t=t.error):e=h(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},t.prototype.GetValue=function(){return this.calculated_type?this.calculated:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value},t.prototype.GetValue4=function(){return this.calculated_type?{type:this.calculated_type,value:this.calculated}:this.type===l.formula?{type:l.number,value:0}:{type:this.type,value:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value}},t.prototype.SetNote=function(t){this.note=t,this.render_dirty=!0},t.prototype.SetCalculationError=function(t){void 0===t&&(t="ERR"),this.SetCalculatedValue(t,l.error)},t.prototype.SetArray=function(t){this.type=l.undefined,this.value=this.formatted=this.rendered_type=this.style=this.hyperlink=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},t.prototype.SetArrayHead=function(t,e){this.type=h(e),this.value=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},t}(),d=function(t){return t.type===l.formula},p=function(){return{type:l.undefined,value:void 0}},m=function(t,e){return void 0===e&&(e=h(t)),{value:t,type:e}},v=function(t){return!!t[0]&&function(t){return!t.cells}(t[0])},y=function(t){return!!t[0]&&void 0!==t[0].row},_=function(){function t(){this.data=[],this.rows_=0,this.columns_=0}return Object.defineProperty(t.prototype,"rows",{get:function(){return this.rows_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.columns_},enumerable:!1,configurable:!0}),t.prototype.EnsureRow=function(t){this.rows_=Math.max(t+1,this.rows_)},t.prototype.EnsureColumn=function(t){this.columns_=Math.max(t+1,this.columns_)},t.prototype.InsertColumns=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.data=this.data.map((function(r){if(r.length>=t){var n=r.slice(0,t),i=t+e;return r.slice(t).forEach((function(t){return n[i++]=t})),n}return r})),this.columns_+=e},t.prototype.DeleteColumns=function(t,e){void 0===e&&(e=1),this.data.forEach((function(r){return r.splice(t,e)})),this.columns_-=e},t.prototype.DeleteRows=function(t,e){void 0===e&&(e=1),this.data.splice(t,e),this.rows_-=e},t.prototype.InsertRows=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);for(var r=[t,0,[]],n=1;n<e;n++)r.push([]);Array.prototype.splice.apply(this.data,r),this.rows_+=e},t.prototype.GetCell=function(t,e){var r=t.row,n=t.column;if(!this.data[r]){if(!e)return;this.data[r]=[],this.rows_=Math.max(this.rows_,r+1)}return this.data[r][n]||e&&(this.data[r][n]=new f,this.columns_=Math.max(this.columns_,n+1)),this.data[r][n]},t.prototype.EnsureCell=function(t){var e=t.row,r=t.column,n=this.data[e];n||(this.data[e]=n=[],this.rows_=Math.max(this.rows_,e+1));var i=n[r];return i||(i=n[r]=new f,this.columns_=Math.max(this.columns_,r+1)),i},t.prototype.FromArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=!1),this.data=[];var r=0,n=0;if(e){n=t.length;for(var i=0;i<n;i++){var o=t[i];r=Math.max(r,o.length);for(var a=0;a<o.length;a++)this.data[a]||(this.data[a]=[]),this.data[a][i]=new f(o[a])}}else for(r=t.length,a=0;a<r;a++){var s=[];for(o=t[a],n=Math.max(n,o.length),i=0;i<o.length;i++)s[i]=new f(o[i]);this.data[a]=s}this.rows_=r,this.columns_=n},t.prototype.FromJSON=function(t){var e,r,i,a,s,l,c,h,d,p;if(void 0===t&&(t=[]),this.data=[],!v(t)){var m=[];if(y(t))try{for(var _=o(t),g=_.next();!g.done;g=_.next()){var w=g.value;try{for(var b=(i=void 0,o(w.cells)),x=b.next();!x.done;x=b.next()){var M=x.value;m.push(n(n({},M),{row:w.row}))}}catch(t){i={error:t}}finally{try{x&&!x.done&&(a=b.return)&&a.call(b)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{g&&!g.done&&(r=_.return)&&r.call(_)}finally{if(e)throw e.error}}else try{for(var C=o(t),S=C.next();!S.done;S=C.next()){w=S.value;try{for(var A=(c=void 0,o(w.cells)),R=A.next();!R.done;R=A.next())M=R.value,m.push(n(n({},M),{column:w.column}))}catch(t){c={error:t}}finally{try{R&&!R.done&&(h=A.return)&&h.call(A)}finally{if(c)throw c.error}}}}catch(t){s={error:t}}finally{try{S&&!S.done&&(l=C.return)&&l.call(C)}finally{if(s)throw s.error}}t=m}try{for(var k=o(t),T=k.next();!T.done;T=k.next()){var P=T.value;if(this.data[P.row]||(this.data[P.row]=[]),M=new f(P.value),void 0!==P.calculated&&M.SetCalculatedValue(P.calculated,P.calculated_type),void 0!==P.note&&(M.note=P.note),void 0!==P.hyperlink&&(M.hyperlink=P.hyperlink),this.data[P.row][P.column]&&this.data[P.row][P.column].area&&(M.area=this.data[P.row][P.column].area),this.data[P.row][P.column]=M,P.area)for(var N=new u(P.area.start,P.area.end),E=N.start.row;E<=N.end.row;E++)for(var D=N.start.column;D<=N.end.column;D++)this.data[E]||(this.data[E]=[]),this.data[E][D]||(this.data[E][D]=new f),this.data[E][D].area=N;if(P.merge_area){var O=new u(P.merge_area.start,P.merge_area.end);for(E=O.start.row;E<=O.end.row;E++)for(D=O.start.column;D<=O.end.column;D++)this.data[E]||(this.data[E]=[]),this.data[E][D]||(this.data[E][D]=new f),this.data[E][D].merge_area=O}P.validation&&(M.validation=P.validation)}}catch(t){d={error:t}}finally{try{T&&!T.done&&(p=k.return)&&p.call(k)}finally{if(d)throw d.error}}this.rows_=this.data.length,this.columns_=this.data.reduce((function(t,e){return Math.max(t,e.length)}),0)},t.prototype.toJSON=function(t){var e,r,n,a,s,u,c,h;void 0===t&&(t={});var f,d=0,p=0,m=this.data.length-1;t.subset&&(d=t.subset.start.column,p=t.subset.start.row,m=t.subset.end.row);for(var v=[],y=-1,_=-1,g={},w={},b=p;b<=m;b++)if(this.data[b]){var x=this.data[b];f=x.length-1,t.subset&&(f=t.subset.end.column);for(var M=d;M<=f;M++){var C=x[M],S=C&&C.merge_area&&C.merge_area.start.row===b&&C.merge_area.start.column===M,A=C&&C.area&&C.area.start.row===b&&C.area.start.column===M,R=!C||C.type===l.string&&!C.value;if(C&&(!R||t.preserve_empty_strings)&&(S||C.type||C.calculated_type&&t.expand_arrays||C.calculated_type&&t.calculated_value||C.validation||t.decorated_cells&&C.style&&(C.style.fill||C.style.border_bottom||C.style.border_top||C.style.border_left||C.style.border_right))){var k={row:b,column:M,value:C.value};C.note&&(k.note=C.note),C.hyperlink&&(k.hyperlink=C.hyperlink),t.preserve_type&&(k.type=C.type),t.sheet_id&&(k.sheet_id=t.sheet_id),t.calculated_value&&void 0!==C.calculated&&(k.calculated=C.calculated,(t.preserve_type||C.calculated_type===l.error)&&(k.calculated_type=C.calculated_type)),C.area&&A&&(k.area=C.area.toJSON()),C.merge_area&&(k.merge_area=C.merge_area.toJSON()),C.validation&&(k.validation=C.validation),t.cell_style_refs&&t.cell_style_refs[M]&&t.cell_style_refs[M][b]&&(k.style_ref=t.cell_style_refs[M][b],t.cell_style_refs[M][b]=0),g[b]=b,w[M]=M,y=Math.max(b,y),_=Math.max(M,_),v.push(k)}}}if(t.nested){var T=Object.keys(g),P=Object.keys(w);if(T.length<=P.length&&T.length){var N={},E=[];try{for(var D=o(v),O=D.next();!O.done;O=D.next()){b=(G=O.value).row;var F=i(G,["row"]);N[G.row]||(N[G.row]=[]),N[G.row].push(F)}}catch(t){e={error:t}}finally{try{O&&!O.done&&(r=D.return)&&r.call(D)}finally{if(e)throw e.error}}try{for(var I=o(T),L=I.next();!L.done;L=I.next()){var U=L.value;b=Number(U),E.push({row:b,cells:N[b]})}}catch(t){n={error:t}}finally{try{L&&!L.done&&(a=I.return)&&a.call(I)}finally{if(n)throw n.error}}return{data:E,rows:y,columns:_+1}}if(P.length){N={},E=[];try{for(var V=o(v),j=V.next();!j.done;j=V.next()){var G;M=(G=j.value).column,F=i(G,["column"]),N[G.column]||(N[G.column]=[]),N[G.column].push(F)}}catch(t){s={error:t}}finally{try{j&&!j.done&&(u=V.return)&&u.call(V)}finally{if(s)throw s.error}}try{for(var z=o(P),B=z.next();!B.done;B=z.next())U=B.value,M=Number(U),E.push({column:M,cells:N[M]})}catch(t){c={error:t}}finally{try{B&&!B.done&&(h=z.return)&&h.call(z)}finally{if(c)throw c.error}}return{data:E,rows:y,columns:_+1}}}return{data:v,rows:y+1,columns:_+1}},t.prototype.GetAll=function(t){return void 0===t&&(t=!1),this.GetRange({row:0,column:0},{row:this.rows_-1,column:this.columns_-1},t)},t.prototype.Normalize2=function(t,e){return t.column===1/0&&(t=n(n({},t),{column:0})),t.row===1/0&&(t=n(n({},t),{row:0})),e.column===1/0&&(e=n(n({},e),{column:this.columns_-1})),e.row===1/0&&(e=n(n({},e),{row:this.rows_-1})),{from:t,to:e}},t.prototype.Normalize1=function(t){return t.column===1/0&&(t=n(n({},t),{column:0})),t.row===1/0&&(t=n(n({},t),{row:0})),t},t.prototype.RawValue=function(t,e){var r,n,i;if(void 0===e&&(e=t),t=(r=this.Normalize2(t,e)).from,e=r.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].value:void 0;var a=[],s=this.data.slice(t.row,e.row+1),l=t.column,u=e.column+1;try{for(var c=o(s),h=c.next();!h.done;h=c.next()){for(var f=h.value,d=[],p=l,m=0;p<u;p++,m++){var v=f[p];d.push(v?v.value:void 0)}a.push(d)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return a},t.prototype.GetRange=function(t,e,r){var n;if(void 0===r&&(r=!1),e?(t=(n=this.Normalize2(t,e)).from,e=n.to):t=this.Normalize1(t),!e||t===e||t.column===e.column&&t.row===e.row)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue():void 0;var i=[];if(r)for(var o=t.column;o<=e.column;o++){for(var a=[],s=t.row;s<=e.row;s++)this.data[s]&&this.data[s][o]?a.push(this.data[s][o].GetValue()):a.push(void 0);i.push(a)}else for(s=t.row;s<=e.row;s++){var l=[];for(o=t.column;o<=e.column;o++)this.data[s]&&this.data[s][o]?l.push(this.data[s][o].GetValue()):l.push(void 0);i.push(l)}return i},t.prototype.GetRange4=function(t,e,r){var n;if(void 0===e&&(e=t),void 0===r&&(r=!1),t=(n=this.Normalize2(t,e)).from,e=n.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue4():{value:void 0,type:l.undefined};var i=[];if(r)for(var o=t.column;o<=e.column;o++){for(var a=[],s=t.row;s<=e.row;s++)this.data[s]&&this.data[s][o]?a.push(this.data[s][o].GetValue4()):a.push(p());i.push(a)}else for(s=t.row;s<=e.row;s++){var u=[];for(o=t.column;o<=e.column;o++)this.data[s]&&this.data[s][o]?u.push(this.data[s][o].GetValue4()):u.push(p());i.push(u)}return i},t.prototype.Apply=function(t,e,r){var n;if(void 0===r&&(r=!1),"object"==typeof(n=t)&&void 0!==n.row&&void 0!==n.column&&(t=new u(t)),t.entire_column||t.entire_row)throw new Error("don't iterate infinite cells");var i=t.start,o=t.end;if(r)for(var a=i.row;a<=o.row;a++){this.data[a]||(this.data[a]=[]);for(var s=this.data[a],l=i.column;l<=o.column;l++)s[l]||(s[l]=new f),e(s[l],l,a)}else for(a=i.row;a<=o.row;a++)if(this.data[a])for(s=this.data[a],l=i.column;l<=o.column;l++)s[l]&&e(s[l],l,a)},t.prototype.SetArea=function(t,e){if(ArrayBuffer.isView(e))throw new Error("ABIV");if(Array.isArray(e))for(var r=t.start.row,n=0;r<=t.end.row;r++,n++){this.data[r]||(this.data[r]=[]);var i=this.data[r];if(e[n])for(var o=t.start.column,a=0;o<=t.end.column;o++,a++)i[o]||(i[o]=new f),i[o].Set(e[n][a])}else{var s=h(e);for(r=t.start.row;r<=t.end.row;r++)for(this.data[r]||(this.data[r]=[]),i=this.data[r],o=t.start.column;o<=t.end.column;o++)i[o]||(i[o]=new f),i[o].Set(e,s)}this.rows_=Math.max(this.rows_,t.end.row+1),this.columns_=Math.max(this.columns_,t.end.column+1)},t.prototype.IterateAll=function(t){var e,r,n,i;try{for(var a=o(this.data),s=a.next();!s.done;s=a.next()){var l=s.value;if(l)try{for(var u=(n=void 0,o(l)),c=u.next();!c.done;c=u.next()){var h=c.value;h&&t(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}},t.prototype.FlushCellStyles=function(){var t,e,r,n;try{for(var i=o(this.data),a=i.next();!a.done;a=i.next()){var s=a.value;if(s)try{for(var l=(r=void 0,o(s)),u=l.next();!u.done;u=l.next()){var c=u.value;c&&c.FlushStyle()}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.FlushCachedValues=function(){var t,e,r,n;try{for(var i=o(this.data),a=i.next();!a.done;a=i.next()){var s=a.value;if(s)try{for(var l=(r=void 0,o(s)),u=l.next();!u.done;u=l.next()){var c=u.value;c&&c.FlushCache()}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t}(),g=function(){function t(){}return t.UpdateLocale=function(t){var e;if(t)this.locale=t;else if("undefined"!=typeof self){var r=null===(e=null===self||void 0===self?void 0:self.document)||void 0===e?void 0:e.location;if(r&&r.search&&/locale=([^?&]+?)(?:\?|$|&)/.test(r.search)){var n=r.search.match(/locale=(.*?)(?:\?|$|&)/);n&&(this.locale=n[1]),console.info("override locale",this.locale)}else"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]?this.locale=navigator.languages[0]:this.locale=navigator.language)}var i=new Intl.NumberFormat(this.locale,{minimumFractionDigits:1}).format(3.3).replace(/\d/g,"");this.decimal_separator=","===i?",":".",","===this.decimal_separator&&(this.argument_separator=";",this.grouping_separator=" ");var o=new Date(2e3,0,2,12,0,0,0);this.UpdateDateComponent(0,0,o),o=new Date(2e3,1,7,12,0,0,0),this.UpdateDateComponent(1,1,o),o=new Date(2e3,2,7,12,0,0,0),this.UpdateDateComponent(2,2,o),o=new Date(2e3,3,5,12,0,0,0),this.UpdateDateComponent(3,3,o),o=new Date(2e3,4,4,12,0,0,0),this.UpdateDateComponent(4,4,o),o=new Date(2e3,5,2,12,0,0,0),this.UpdateDateComponent(5,5,o),o=new Date(2e3,6,1,12,0,0,0),this.UpdateDateComponent(6,6,o),o=new Date(2e3,7,1,12,0,0,0),this.UpdateDateComponent(7,-1,o),o=new Date(2e3,8,1,12,0,0,0),this.UpdateDateComponent(8,-1,o),o=new Date(2e3,9,1,12,0,0,0),this.UpdateDateComponent(9,-1,o),o=new Date(2e3,10,1,12,0,0,0),this.UpdateDateComponent(10,-1,o),o=new Date(2e3,11,1,12,0,0,0),this.UpdateDateComponent(11,-1,o)},t.UpdateDateComponent=function(t,e,r){e>=0&&(this.date_components.short_days[e]=r.toLocaleString(this.locale,{weekday:"short"}),this.date_components.long_days[e]=r.toLocaleString(this.locale,{weekday:"long"})),t>=0&&(this.date_components.short_months[t]=r.toLocaleString(this.locale,{month:"short"}),this.date_components.long_months[t]=r.toLocaleString(this.locale,{month:"long"}))},t.locale="en-us",t.decimal_separator=".",t.argument_separator=",",t.grouping_separator=",",t.date_components={short_days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long_days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short_months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long_months:["January","February","March","April","May","June","July","August","September","October","November","December"]},t}();g.UpdateLocale();var w,b,x=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.left=t,this.top=e,this.width=r,this.height=n}return Object.defineProperty(t.prototype,"right",{get:function(){return this.left+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:!1,configurable:!0}),t.Create=function(e){return new t(e.left||0,e.top||0,e.width||0,e.height||0)},t.IsRectangle=function(t){var e,r,n,i;return"object"==typeof t&&"number"==typeof(null===(e=t)||void 0===e?void 0:e.left)&&"number"==typeof(null===(r=t)||void 0===r?void 0:r.top)&&"number"==typeof(null===(n=t)||void 0===n?void 0:n.width)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.height)},t.prototype.Shift=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left+e,this.top+r,this.width,this.height)},t.prototype.Scale=function(e,r){return void 0===e&&(e=1),void 0===r&&(r=e),new t(this.left*e,this.top*r,this.width*e,this.height*r)},t.prototype.Expand=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left,this.top,this.width+e,this.height+r)},t.prototype.Combine=function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right)-Math.min(this.left,e.left),Math.max(this.bottom,e.bottom)-Math.min(this.top,e.top))},t.prototype.CheckEdges=function(t,e,r){void 0===r&&(r=16);var n=0;return t-this.left<r&&(n|=1),this.right-t<r&&(n|=2),e-this.top<r&&(n|=4),this.bottom-e<r&&(n|=8),n},t.prototype.Contains=function(t,e,r){return void 0===r&&(r=0),t>=this.left-r&&t<=this.left+this.width+r&&e>=this.top-r&&e<=this.top+this.height+r},t.prototype.ContextFill=function(t){t.fillRect(this.left,this.top,this.width,this.height)},t.prototype.ContextStroke=function(t){t.strokeRect(this.left,this.top,this.width,this.height)},t.prototype.Clamp=function(t,e){return{x:t=Math.min(Math.max(t,this.left),this.right),y:e=Math.min(Math.max(e,this.top),this.bottom)}},t.prototype.ApplyStyle=function(t){t.style.top=this.top+"px",t.style.left=this.left+"px",t.style.width=this.width+"px",t.style.height=this.height+"px"},t.prototype.toJSON=function(){return{top:this.top,left:this.left,width:this.width,height:this.height}},t}();!function(t){var e,r,i=JSON.stringify({});!function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(e=t.HorizontalAlign||(t.HorizontalAlign={})),function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Middle=3]="Middle"}(r=t.VerticalAlign||(t.VerticalAlign={})),t.DefaultProperties={horizontal_align:e.None,vertical_align:r.None,number_format:"General",nan:"NaN",font_size_value:10,font_size_unit:"pt",font_face:"calibri",font_bold:!1,font_italic:!1,font_underline:!1,font_strike:!1,text:{theme:1},border_top:0,border_left:0,border_right:0,border_bottom:0},t.Merge=function(t,e,r){void 0===r&&(r=!0);var i=n(r?n({},t):{},e);return JSON.parse(JSON.stringify(i))},t.Composite=function(t){return JSON.parse(JSON.stringify(t.reduce((function(t,e){return n(n({},t),e)}),{})))},t.Empty=function(t){return JSON.stringify(t)===i},t.ValidColor=function(t){return!(!t||t.none||!t.text&&!t.theme&&0!==t.theme)},t.Font=function(t,e){void 0===e&&(e=1);var r=[];return t.font_weight?r.push(t.font_weight.toString()):t.font_bold&&r.push("bold"),t.font_italic&&r.push("italic"),r.push(((t.font_size_value||0)*e).toFixed(2)+(t.font_size_unit||"pt")),r.push(t.font_face||""),r.join(" ")}}(w||(w={})),function(t){t[t.default=0]="default",t[t.hidden=1]="hidden",t[t.padded=2]="padded",t[t.date_component=3]="date_component",t[t.date_component_minutes=4]="date_component_minutes",t[t.literal=5]="literal",t[t.formatting=6]="formatting"}(b||(b={})),new(function(){function t(){}return t.prototype.Darken=function(t,e,r,n,i){void 0===i&&(i=!1);var o=this.RGBToHSL(t,e,r),a=o.h,s=o.s,l=o.l;return l-=i?l*n/100:n/100,l=Math.max(0,Math.min(1,l)),this.HSLToRGB(a,s,l)},t.prototype.Lighten=function(t,e,r,n,i){void 0===i&&(i=!1);var o=this.RGBToHSL(t,e,r),a=o.h,s=o.s,l=o.l;return l+=i?l*n/100:n/100,l=Math.max(0,Math.min(1,l)),this.HSLToRGB(a,s,l)},t.prototype.RGBToHSL=function(t,e,r){t/=255,e/=255,r/=255;var n=Math.max(t,e,r),i=Math.min(t,e,r),o=0,a=0,s=(n+i)/2;if(n===i)o=a=0;else{var l=n-i;switch(a=s>.5?l/(2-n-i):l/(n+i),n){case t:o=(e-r)/l+(e<r?6:0);break;case e:o=(r-t)/l+2;break;case r:o=(t-e)/l+4}o/=6}return{h:360*o,s:a,l:s}},t.prototype.HSLToRGB=function(t,e,r){var n,i,o;if(0===e)n=i=o=r;else{t/=360;var a=r<.5?r*(1+e):r+e-r*e,s=2*r-a;n=this.HueToRGB(s,a,t+1/3),i=this.HueToRGB(s,a,t),o=this.HueToRGB(s,a,t-1/3)}return{r:Math.round(255*n),g:Math.round(255*i),b:Math.round(255*o)}},t.prototype.HueToRGB=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},t}());var M,C=function(){this.date_format=!1,this.string_format=!1,this.fraction_format=!1,this.twelve_hour=!1,this.fraction_denominator=0,this.fraction_integer=!0,this.fraction_align=0,this.fraction_denominator_digits=0,this.integer_min_digits=0,this.decimal_min_digits=0,this.decimal_max_digits=0,this.grouping=!1,this.has_number_format=!1,this.prefix=[{text:""}],this.suffix=[{text:""}],this.scaling=0,this.percent=!1,this.exponential=!1,this.has_asterisk=!1};!function(t){t[t.Integer=0]="Integer",t[t.Decimal=1]="Decimal"}(M||(M={}));var S,A=function(){function t(){}return t.Parse=function(t){if(this.pattern=t,this.characters=t.split("").map((function(t){return t.charCodeAt(0)})),this.char_index=0,this.current_section=new C,this.sections=[this.current_section],this.ParseDatePattern())return this.sections;for(this.char_index=0,this.current_section=new C,this.sections=[this.current_section];this.char_index<this.characters.length;)this.ConsumeChar();return this.sections},t.ConsumeString=function(){var t="";for(this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index+1<this.characters.length&&(t+=this.pattern[++this.char_index]);break;case 34:return this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated string")},t.ConsumeFormatting=function(){var t="";for(++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:throw new Error("invalid escape character in formatting block");case 93:return this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated format")},t.ScanFractionFormat=function(){var t=this.pattern.substr(this.char_index).match(/^([#?]+ +){0,1}([#?]+)\/([#?0-9]+)(?:$|[^#?0-9])/);if(!t)return!1;var e=(t[1]||"").length+t[2].length+t[3].length+1;this.current_section.fraction_format=!0,this.current_section.fraction_integer=!!t[1];var r=Number(t[3]);return isNaN(r)||(this.current_section.fraction_denominator=r),this.current_section.decimal_max_digits=this.current_section.fraction_denominator_digits=t[3].length,this.char_index+=e,this.current_section.has_number_format=!0,!0},t.ConsumeNumberFormat=function(){var t=M.Integer;for(this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case this.group_separator:for(var e=!1,r=this.char_index+1;!e&&r<this.characters.length;r++){var n=this.characters[r];if(n===this.decimal_mark||35===n||48===n)e=!0;else if(44!==n)break}if(e){if(t===M.Decimal)throw new Error("invalid grouping in decimal part");this.current_section.grouping=!0}else this.current_section.scaling=1e3*(this.current_section.scaling||1);break;case this.decimal_mark:if(t===M.Decimal)throw new Error("too many decimal marks");t=M.Decimal;break;case 35:t===M.Decimal?this.current_section.decimal_max_digits++:this.current_section.integer_min_digits&&this.current_section.integer_min_digits++;break;case 48:t===M.Decimal?(this.current_section.decimal_max_digits++,this.current_section.decimal_min_digits=this.current_section.decimal_max_digits):this.current_section.integer_min_digits++;break;default:return}},t.AppendCharAsText=function(t){void 0===t&&(t=!0),this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=this.pattern[this.char_index]:this.current_section.prefix[this.current_section.prefix.length-1].text+=this.pattern[this.char_index],t&&this.char_index++},t.AppendString=function(t){this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=t:this.current_section.prefix[this.current_section.prefix.length-1].text+=t},t.AppendTextPart=function(t){this.current_section.has_number_format?(this.current_section.suffix.push(t),this.current_section.suffix.push({text:""})):(this.current_section.prefix.push(t),this.current_section.prefix.push({text:""}))},t.ConsumeChar=function(){var t=this.characters[this.char_index];if(63!==t&&35!==t||this.current_section.has_number_format||this.current_section.string_format||!this.ScanFractionFormat())switch(t){case 59:this.char_index++,this.current_section=new C,3===this.sections.length&&(this.current_section.string_format=!0),this.sections.push(this.current_section);break;case 64:this.char_index++,this.AppendTextPart({text:"@",flag:b.literal}),this.current_section.string_format=!0;break;case 48:case 35:case 46:case 44:this.current_section.has_number_format||this.current_section.string_format?this.AppendCharAsText():(this.ConsumeNumberFormat(),this.current_section.has_number_format=!0);break;case 91:this.AppendTextPart({text:this.ConsumeFormatting(),flag:b.formatting});break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:b.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:b.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:b.padded}),this.current_section.has_asterisk=!0}break;case 101:case 69:this.current_section.percent||this.current_section.exponential||this.current_section.string_format?this.AppendCharAsText():(this.current_section.exponential=!0,this.char_index++);break;case 37:this.current_section.exponential||this.current_section.string_format||(this.current_section.percent=!0),this.AppendCharAsText();break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.ParseDatePattern=function(){var t,e,r,n,i=this;for(this.date_pattern=!0;this.date_pattern&&this.char_index<this.pattern.length;)this.DatePatternConsumeChar();if(this.date_pattern){this.date_pattern=!1;try{for(var a=o(this.sections),s=a.next();!s.done;s=a.next()){var l=s.value;try{for(var u=(r=void 0,o(l.prefix)),c=u.next();!c.done;c=u.next()){var h=c.value;h.flag&&h.flag&(b.date_component|b.date_component_minutes)&&(this.date_pattern=!0)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}return this.date_pattern&&(this.sections[0].date_format=!0,this.sections[0].prefix.forEach((function(t,e){if(t.flag===b.date_component&&("mm"===t.text||"m"===t.text)){if(e)for(var r=e-1;r;r--)if((n=i.sections[0].prefix[r]).flag===b.date_component){/h/i.test(n.text)&&(t.flag=b.date_component_minutes,t.text=t.text.toLowerCase());break}if(e<i.sections[0].prefix.length-1)for(r=e+1;r<i.sections[0].prefix.length;r++){var n;if((n=i.sections[0].prefix[r]).flag===b.date_component){/s/i.test(n.text)&&(t.flag=b.date_component_minutes,t.text=t.text.toLowerCase());break}}}}))),this.date_pattern},t.ConsumeDatePart=function(){for(var t=this.pattern[this.char_index++],e=t.toLowerCase(),r={text:t,flag:b.date_component};this.pattern[this.char_index]&&this.pattern[this.char_index].toLowerCase()===e;)r.text+=this.pattern[this.char_index++];if("s"===e&&"."===this.pattern[this.char_index])for(r.text+=this.pattern[this.char_index++];"0"===this.pattern[this.char_index];)r.text+=this.pattern[this.char_index++];return r},t.ConsumeAMPM=function(){var t=this.pattern.substr(this.char_index,5);return"am/pm"===t||"AM/PM"===t?(this.char_index+=5,this.sections[0].twelve_hour=!0,{text:t,flag:b.date_component}):"a/p"===(t=this.pattern.substr(this.char_index,3))||"A/P"===t?(this.char_index+=3,this.sections[0].twelve_hour=!0,{text:t,flag:b.date_component}):void 0},t.DatePatternConsumeChar=function(){switch(this.characters[this.char_index]){case 59:this.char_index=this.characters.length;break;case 48:case 35:case 101:case 69:case 37:case 64:this.date_pattern=!1;break;case 72:case 104:case 77:case 109:case 83:case 115:case 68:case 100:case 89:case 121:this.AppendTextPart(this.ConsumeDatePart());break;case 65:case 97:var t=this.ConsumeAMPM();t?this.AppendTextPart(t):this.AppendCharAsText();break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:b.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:b.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:b.padded}),this.current_section.has_asterisk=!0}break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.date_pattern=!1,t.pattern="",t.char_index=0,t.characters=[],t.sections=[],t.current_section=new C,t.preserve_formatting_characters=!1,t.decimal_mark=46,t.group_separator=44,t}(),R=function(t){return t>=60&&t--,new Date(864e5*t-22090752e5)},k=function(t,e){if(void 0===e&&(e=!0),e){var r=new Date(t),n=new Date;n.setUTCMilliseconds(r.getUTCMilliseconds()),n.setUTCSeconds(r.getUTCSeconds()),n.setUTCMinutes(r.getUTCMinutes()),n.setUTCHours(r.getHours()),n.setUTCDate(r.getDate()),n.setUTCMonth(r.getMonth()),n.setUTCFullYear(r.getFullYear()),t=n.getTime()}return(t=(t+22090752e5)/864e5)>=60&&t++,t},T=function(){function t(t){var e,r;if(this._pattern="",this.decimal_zero_regexp=[],this.cloned=[],this.magic_decimal=!1,this._pattern=t,this.sections=A.Parse(t),this.sections.length||(this.sections=[]),this.sections[0]||(this.sections[0]=new C),this.sections[1]||(this.sections[1]=n({},this.sections[0]),this.sections[1].prefix=JSON.parse(JSON.stringify(this.sections[1].prefix)),this.sections[1].suffix=JSON.parse(JSON.stringify(this.sections[1].suffix)),this.sections[1].prefix.push({text:"-"}),this.cloned[1]=!0),this.sections[2]||(this.sections[2]=n({},this.sections[0]),this.cloned[2]=!0),!this.sections[3])try{for(var i=o(this.sections[0].prefix),a=i.next();!a.done;a=i.next())if(a.value.flag===b.literal){this.sections[3]=n({},this.sections[0]),this.sections[3].string_format=!0,this.cloned[3]=!0;break}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.decimal_zero_regexp=this.sections.map((function(t){if(t.decimal_max_digits>t.decimal_min_digits)return new RegExp("0{1,"+(t.decimal_max_digits-t.decimal_min_digits)+"}(?:$|e)")}))}return t.FormatPartsAsText=function(t,e){void 0===e&&(e=0);var r=-1,n=t.map((function(t,e){switch(t.flag){case b.padded:return r=e,t.text;case b.hidden:return t.text.replace(/./g," ");case b.formatting:return"";default:return t.text}}));if(r>=0&&e){for(var i=n.reduce((function(t,e,n){return n===r?t:t+e.length}),0),o="",a=0;a<e-i;a++)o+=n[r];n[r]=o}return n.join("")},Object.defineProperty(t.prototype,"pattern",{get:function(){return this._pattern},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"date_format",{get:function(){return this.sections[0]&&this.sections[0].date_format},enumerable:!1,configurable:!0}),t.prototype.IncreaseDecimal=function(){this.sections.forEach((function(t){t.decimal_min_digits++,t.decimal_max_digits=t.decimal_min_digits}))},t.prototype.DecreaseDecimal=function(){this.sections.forEach((function(t){t.decimal_min_digits=Math.max(0,t.decimal_min_digits-1),t.decimal_max_digits=t.decimal_min_digits}))},t.prototype.AddGrouping=function(){this.sections.forEach((function(t){t.grouping=!0}))},t.prototype.RemoveGrouping=function(){this.sections.forEach((function(t){t.grouping=!1}))},t.prototype.ToggleGrouping=function(){var t=!this.sections[0].grouping;this.sections.forEach((function(e){e.grouping=t}))},t.prototype.toString=function(){var t=this;return this.sections[0].date_format?this._pattern:this.sections.filter((function(e,r){return!t.cloned[r]})).map((function(t){var e="",r=0;if(t.fraction_format){t.fraction_integer&&(e+="? ");for(var n="",i=0;i<t.fraction_denominator_digits;i++)n+="#";e+=n,e+="/",t.fraction_denominator?e+=t.fraction_denominator:e+=n}else if(t.has_number_format){for(r=0;r<t.integer_min_digits;r++)e+="0";if(t.grouping&&(e.length<4&&(e=("####"+e).slice(-4)),e=e.replace(/[\d#]{1,3}(?=([\d#]{3})+(?![\d#]))/g,"$&,")),t.decimal_max_digits||t.decimal_min_digits){for(e+=".",r=0;r<t.decimal_min_digits;r++)e+="0";for(;r<t.decimal_max_digits;r++)e+="#"}if(t.scaling){var o=Math.log10(t.scaling)/3;for(r=0;r<o;r++)e+=","}t.exponential&&(e+="e")}return t.prefix.map((function(t){return t.flag===b.hidden?"0"===t.text?"?":"_"+t.text:t.flag===b.padded?"*"+t.text:t.flag===b.formatting?"["+t.text+"]":t.text})).join("")+e+t.suffix.map((function(t){return t.flag===b.hidden?"0"===t.text?"?":"_"+t.text:t.flag===b.padded?"*"+t.text:t.text})).join("")})).join(";")},t.prototype.FormatParts=function(t){var e,r;if("number"!=typeof t&&!this.sections[3])return[{text:t.toString()}];var i=this.BaseFormat(t),l=i.parts,u=i.section,c=[];if(u.date_format||u.string_format)try{for(var h=o(l),f=h.next();!f.done;f=h.next()){var d=f.value;"string"==typeof d?c.push({text:d}):c.push(d)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}else this.magic_decimal&&""===l[1]&&l.splice(1,1),c=s(s(s([],a(u.prefix.map((function(t){return n({},t)})))),[{text:u.has_number_format?l.join(g.decimal_separator):""}]),a(u.suffix.map((function(t){return n({},t)}))));for(var p=1;p<c.length;p++)c[p].flag===c[p-1].flag&&(c[p].text=c[p-1].text+c[p].text,c[p-1].text="");return c.filter((function(t){return t.text}))},t.prototype.Format=function(e,r){return void 0===r&&(r=0),t.FormatPartsAsText(this.FormatParts(e),r)},t.prototype.ZeroPad=function(t,e){for(;t.length<e;)t="0"+t;return t},t.prototype.DateFormat=function(t){var e=this,r=R(t),i=this.sections[0],o=r.getUTCHours();return i.twelve_hour&&(o>12&&(o-=12),0===o&&(o=12)),{parts:i.prefix.map((function(t){if(t.flag===b.date_component_minutes)return"mm"===t.text?{text:e.ZeroPad(r.getUTCMinutes().toString(),2)}:{text:e.ZeroPad(r.getUTCMinutes().toString(),1)};if(t.flag===b.date_component){switch(t.text.toLowerCase()){case"am/pm":case"a/p":var i=t.text.split("/");return{text:r.getUTCHours()>12?i[1]:i[0]};case"mmmmm":return{text:g.date_components.long_months[r.getUTCMonth()][0]};case"mmmm":return"MMMM"===t.text?{text:g.date_components.long_months[r.getUTCMonth()].toUpperCase()}:{text:g.date_components.long_months[r.getUTCMonth()]};case"mmm":return"MMM"===t.text?{text:g.date_components.short_months[r.getUTCMonth()].toUpperCase()}:{text:g.date_components.short_months[r.getUTCMonth()]};case"mm":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),2)};case"m":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),1)};case"ddddd":case"dddd":return"DDDDD"===t.text||"DDDD"===t.text?{text:g.date_components.long_days[r.getUTCDay()].toUpperCase()}:{text:g.date_components.long_days[r.getUTCDay()]};case"ddd":return"DDD"===t.text?{text:g.date_components.short_days[r.getUTCDay()].toUpperCase()}:{text:g.date_components.short_days[r.getUTCDay()]};case"dd":return{text:e.ZeroPad(r.getUTCDate().toString(),2)};case"d":return{text:e.ZeroPad(r.getUTCDate().toString(),1)};case"yyyy":case"yyy":return{text:r.getUTCFullYear().toString()};case"yy":case"y":return{text:e.ZeroPad((r.getUTCFullYear()%100).toString(),2)};case"hh":return{text:e.ZeroPad(o.toString(),2)};case"h":return{text:e.ZeroPad(o.toString(),1)};case"ss":return{text:e.ZeroPad(r.getUTCSeconds().toString(),2)};case"s":return{text:e.ZeroPad(r.getUTCSeconds().toString(),1)}}var a=t.text.match(/^(s+)\.(0+)$/);if(a)return{text:e.ZeroPad(r.getUTCSeconds().toString(),a[1].length)+g.decimal_separator+(r.getUTCMilliseconds()/1e3).toFixed(a[2].length).substr(2)}}return n({},t)})),section:i}},t.prototype.StringFormat=function(t,e){var r,i,a=[];try{for(var s=o(e.prefix),l=s.next();!l.done;l=s.next()){var u=l.value;u.flag===b.literal?a.push({text:t}):a.push(n({},u))}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return{parts:a,section:e}},t.prototype.Round2=function(t,e){var r=Math.pow(10,e);return Math.round(r*t)/r},t.prototype.FormatFraction=function(e,r){r.percent&&(e*=100);var n={denominator:1,numerator:Math.round(e),error:Math.abs(Math.round(e)-e)};if(r.fraction_denominator)n.denominator=r.fraction_denominator,n.numerator=Math.round(e*n.denominator);else if(n.error)for(var i=t.fraction_limits[r.fraction_denominator_digits-1]||t.fraction_limits[0],o=2;o<=i;o++){var a=Math.round(e*o),s=Math.abs(a/o-e);if(s<n.error&&(n={numerator:a,denominator:o,error:s},!s))break}var l=[];if(r.fraction_integer){var u=Math.floor(n.numerator/n.denominator);n.numerator%=n.denominator,!u&&n.numerator||(l.push(u.toString()),n.numerator&&l.push(" "))}else n.numerator||l.push("0");return n.numerator&&(l.push(n.numerator.toString()),l.push("/"),l.push(n.denominator.toString())),l.join("")},t.prototype.BaseFormat=function(e){if(this.sections[0].date_format)return this.DateFormat(Number(e));if("number"!=typeof e)return this.StringFormat(e.toString(),this.sections[3]);var r=this.sections[0],n=this.decimal_zero_regexp[0];e<0&&(r=this.sections[1]);var i=r.percent?r.decimal_max_digits+2:r.decimal_max_digits,o=Math.pow(10,-i)/2,a=Math.abs(e);if(a<o&&(r=this.sections[2],n=this.decimal_zero_regexp[2]),r.scaling&&(a/=r.scaling)<o&&(r=this.sections[2],n=this.decimal_zero_regexp[2]),r.string_format)return this.StringFormat(e.toString(),r);var s="";if(r.fraction_format)return{parts:[this.FormatFraction(a,r)],section:r};r.exponential?s=a.toExponential(r.decimal_max_digits):(r.percent&&(a*=100),s=this.Round2(a,r.decimal_max_digits).toFixed(r.decimal_max_digits)),n&&(s=s.replace(n,""));for(var l=s.split(".");l[0].length<r.integer_min_digits;)l[0]=("0000000000000000"+l[0]).slice(-r.integer_min_digits);return 0===r.integer_min_digits&&"0"===l[0]&&(l[0]=""),r.grouping&&(l[0]=l[0].replace(t.grouping_regexp,"$&"+g.grouping_separator)),{parts:l,section:r}},t.grouping_regexp=/\d{1,3}(?=(\d{3})+(?!\d))/g,t.fraction_limits=[9,99,999,9999],t}(),P=function(){function t(){}return t.Get=function(t){var e=this.symbolc_name_map[t.toLowerCase()],r=this.cache[e||t];return r||(r=new T(t),this.cache[t]=r),r},t.Equals=function(t,e){if(t===e)return!0;var r=this.Get(t),n=this.Get(e);return r.pattern===n.pattern},t.Translate=function(t){var e=this.symbolc_name_map[t.toLowerCase()];return e?this.cache[e].toString():t},t.SymbolicName=function(t){var e,r;try{for(var n=o(Object.keys(this.base_formats)),i=n.next();!i.done;i=n.next()){var a=i.value;if(t===this.base_formats[a])return a}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return null},t.InitCache=function(){var t,e,r,n;try{for(var i=o(Object.keys(this.base_formats)),a=i.next();!a.done;a=i.next()){var s=a.value;this.cache[s]=new T(this.base_formats[s]),this.symbolc_name_map[s.toLowerCase()]=s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.cache.General.magic_decimal=!0;try{for(var l=o(Object.keys(this.aliases)),u=l.next();!u.done;u=l.next())s=u.value,this.cache[s]=this.cache[this.aliases[s]],this.symbolc_name_map[s.toLowerCase()]=s}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}},t.cache={},t.symbolc_name_map={},t.base_formats={Accounting:"_(#,##0.00_);(#,##0.00);-???",Number:"0.00",Integer:"0",Percent:"0.00%",General:"0.######",Fraction:"# ?/?",Dollar:"$* _(#,##0.00_);$* (#,##0.00);$* -???",Exponential:"0.000e","Short Date":"mm/dd/yy","Long Date":"dddd, mmm d yyyy",Timestamp:"mm-dd-yy hh:mm:ss"},t.aliases={Scientific:"Exponential",Percentage:"Percent",Currency:"Dollar"},t}();P.InitCache(),function(t){t[t.None=0]="None",t[t.Nan=1]="Nan",t[t.Exponential=2]="Exponential",t[t.Percent=4]="Percent",t[t.Currency=8]="Currency",t[t.Grouping=16]="Grouping",t[t.Parens=32]="Parens",t[t.Date=64]="Date",t[t.Time=128]="Time"}(S||(S={}));var N=(new Date).getUTCFullYear();new(function(){function t(){}return t.prototype.TestDate=function(t){var e,r,n,i,s,l,u=Date.parse(t);if(isNaN(u))return!1;var c=new Date(u),h=t.replace(/[\d\-\\/,.\s]+/g," ").toLocaleLowerCase().split(/\s+/).map((function(t){return t.trim()})).filter((function(t){return!!t}));if(!h.length)return u;if(!this.compare_month){this.compare_month={};for(var f=0;f<12;f++)this.compare_month[g.date_components.long_months[f].toLocaleLowerCase().replace(/\./,"")]=f,this.compare_month[g.date_components.short_months[f].toLocaleLowerCase().replace(/\./,"")]=f}if(!this.compare_day)for(this.compare_day={},f=0;f<7;f++)this.compare_day[g.date_components.long_days[f].toLocaleLowerCase().replace(/\./,"")]=f,this.compare_day[g.date_components.short_days[f].toLocaleLowerCase().replace(/\./,"")]=f;var d=!1,p=!1;try{for(var m=o(h),v=m.next();!v.done;v=m.next()){var y=v.value,_=!1;try{for(var w=(n=void 0,o(Object.entries(this.compare_month))),b=w.next();!b.done;b=w.next()){var x=a(b.value,2),M=x[0],C=x[1];if(y===M){if(d)return!1;if(c.getUTCMonth()!==C)return!1;_=!0,d=!0}}}catch(t){n={error:t}}finally{try{b&&!b.done&&(i=w.return)&&i.call(w)}finally{if(n)throw n.error}}if(!_)try{for(var S=(s=void 0,o(Object.entries(this.compare_day))),A=S.next();!A.done;A=S.next()){var R=a(A.value,2),k=R[0];if(C=R[1],y===k){if(p)return!1;if(c.getUTCDay()!==C)return!1;_=!0,p=!0}}}catch(t){s={error:t}}finally{try{A&&!A.done&&(l=S.return)&&l.call(S)}finally{if(s)throw s.error}}if(!_)return!1}}catch(t){e={error:t}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return!(p&&!d)&&u},t.prototype.TryParse=function(t){void 0===t&&(t="");var e=S.None;if("'"===t[0])return{value:t,type:l.string};if(""===t)return{value:t,type:l.string};if("NaN"===t)return{value:NaN,type:l.number,hints:S.Nan};var r=t.trim(),n=r.match(/^[$](.*?)$/);n&&(r=n[1],e|=S.Currency);var i=r.match(/^\((.*?)\)$/);i&&(r=i[1],e|=S.Parens);var o=r.match(/^(.*?)%\s*$/);o&&(r=o[1],e|=S.Percent),"."===g.decimal_separator?/,/.test(r)&&(r=r.replace(/,/g,""),e|=S.Grouping):r=(r=(r=r.replace(/(\d)\s+/g,"$1")).replace(/\./g,"")).replace(/,/,".");var a=Number(r);if(null===a||isNaN(a)){var s=t.toLowerCase();if("false"===s)return{value:!1,type:l.boolean};if("true"===s)return{value:!0,type:l.boolean};var u=this.TestDate(t);if(!1!==u&&!isNaN(u)){var c=new Date(u),h=c.getUTCFullYear();if(h>=N-200&&h<=N+200)return e=S.Date,(c.getHours()||c.getMinutes()||c.getSeconds())&&(e|=S.Time),{value:k(u),type:l.number,hints:e}}return{value:t,type:l.string}}if(i&&(a=-a),o){var f=a<0?-1:1,d=(f*a).toString().split(".");d[0]=("00"+d[0]).replace(/(\d\d)$/,".$1"),a=Number(d.join(""))*f}return/e/.test(t)&&(e|=S.Exponential),{value:a,type:l.number,hints:e}},t}());var E,D,O=1e3,F=(function(){function t(t,e){void 0===t&&(t=!1),void 0===e&&(e="undefined"),this.verbose=t,this.log_id=e,this.queue=[],this.dispatched=!1,this.subscribers=[],this.pass_through=[]}t.prototype.Publish=function(t){var e,r=this;this.verbose&&console.info("es publish ("+this.log_id+")",t),this.pass_through.forEach((function(e){return e.Publish(t)})),Array.isArray(t)?(e=this.queue).push.apply(e,s([],a(t))):this.queue.push(t),this.dispatched||(this.dispatched=!0,Promise.resolve().then((function(){var t,e,n,i,a=r.queue.slice(0);r.dispatched=!1,r.queue=[];try{for(var s=o(a),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(n=void 0,o(r.subscribers)),h=c.next();!h.done;h=c.next())h.value.subscriber(u)}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}})))},t.prototype.Subscribe=function(t){var e=O++;return this.subscribers.push({subscriber:t,token:e}),e},t.prototype.Cancel=function(t){this.subscribers=this.subscribers.filter((function(e){return e.token!==t}))},t.prototype.CancelAll=function(){this.subscribers=[],this.pass_through=[]},t.prototype.PassThrough=function(t){this.pass_through.push(t)}}(),function(){function t(e,r,n,i){void 0===i&&(i=e),t.Create({container:e,node:r,resize_callback:n,layout_reference:i})}t.Create=function(e){var r,n,i=document.createElement("div");if(i.classList.add("treb-embed-resize-handle"),(e.layout_reference||e.container).appendChild(i),!t.resize_mask){var o=document.querySelector(".treb-embed-mouse-mask");o||((o=document.createElement("div")).classList.add("treb-embed-mouse-mask"),document.body.appendChild(o)),t.resize_mask=o}if(!t.resize_rect){var a=document.querySelector(".treb-embed-resize-rect");a||((a=document.createElement("div")).classList.add("treb-embed-resize-rect"),t.resize_mask.appendChild(a)),t.resize_rect=a}var s={width:0,height:0},l={x:0,y:0},u={x:0,y:0},c=function(){if(t.resize_mask.removeEventListener("mousemove",n),t.resize_mask.removeEventListener("mouseup",r),t.resize_mask.style.display="none",u.x||u.y){var i=e.container.getBoundingClientRect(),o=i.width+u.x,a=i.height+u.y;e.container.style.width=o+"px",e.container.style.height=a+"px",e.resize_callback&&e.resize_callback()}};n=function(e){e.buttons?(u.x!==e.clientX-l.x&&(u.x=e.clientX-l.x,t.resize_rect.style.width=s.width+u.x+4+"px"),u.y!==e.clientY-l.y&&(u.y=e.clientY-l.y,t.resize_rect.style.height=s.height+u.y+4+"px")):c()},r=function(){c()},i.addEventListener("mousedown",(function(i){i.stopPropagation(),i.preventDefault();var o=e.node.getBoundingClientRect();s={width:o.width,height:o.height},t.resize_rect&&(t.resize_rect.style.top=o.top-2+"px",t.resize_rect.style.left=o.left-2+"px",t.resize_rect.style.width=o.width+4+"px",t.resize_rect.style.height=o.height+4+"px"),l={x:i.clientX,y:i.clientY},u={x:0,y:0},t.resize_mask.style.display="block",t.resize_mask.addEventListener("mousemove",n),t.resize_mask.addEventListener("mouseup",r)}))}}(),function(){function t(){}return t.MeasureColorARGB=function(t){for(var e=this.MeasureColor(t),r="FF",n=0;n<3;n++){var i=e[n].toString(16);0===i.length?r+="00":1===i.length?r+="0"+i:r+=i}return r.toUpperCase()},t.MeasureColor=function(t){var e=this.color_cache[t];if(e)return e;this.color_measurement_canvas||(this.color_measurement_canvas=document.createElement("canvas"),this.color_measurement_canvas.width=1,this.color_measurement_canvas.height=1);var r=this.color_measurement_canvas.getContext("2d");return r?(r.fillStyle="#fff",r.fillRect(0,0,1,1),r.fillStyle=t,r.fillRect(0,0,1,1),e=r.getImageData(0,0,1,1).data,this.color_cache[t]=e,e):new Uint8ClampedArray(3)},t.EnsureMeasurementNode=function(){if(!this.text_measurement_node){var t=document.querySelector(".treb-chart-measurement-node");t?this.text_measurement_node=t:(this.text_measurement_node=document.createElement("div"),this.text_measurement_node.classList.add("treb-chart-measurement-node"),this.text_measurement_node.style.margin="0px",this.text_measurement_node.style.padding="0px",this.text_measurement_node.style.whiteSpace="nowrap",this.text_measurement_node.style.position="fixed",this.text_measurement_node.style.border="0px",this.text_measurement_node.style.border="1px solid red",this.text_measurement_node.style.boxSizing="content-box",this.text_measurement_node.style.top=this.text_measurement_node.style.left="-1000px",document.body.appendChild(this.text_measurement_node))}},t.FontLoaded=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=400);var n=(e?"italic":"")+" "+r+" 20pt "+t,i=this.MeasureText(n+", sans-serif","check font"),o=this.MeasureText(n+", serif","check font"),a=this.MeasureText(n+", monospace","check font");return i.width===o.width&&o.width===a.width},t.MeasureText=function(t,e,r){void 0===r&&(r=0),this.EnsureMeasurementNode(),this.text_measurement_node.style.font=t,/\n/.test(e)?(e=e.replace(/\n/g,"<BR/>"),this.text_measurement_node.innerHTML=e):this.text_measurement_node.textContent=e,this.text_measurement_node.style.lineHeight="1em",this.text_measurement_node.style.transform=r?"rotate("+r+"deg)":"";var n=this.text_measurement_node.getBoundingClientRect();return{width:n.width,height:n.height}},t.color_cache={},t}()),I=function(t,e,r,n){var i,a;if(void 0===r&&(r=6.5),void 0===n&&(n=!1),e===t)e++,t&&t--;else{var s=Math.round(1e5*e)/1e5;Math.abs(s-e)/(e-t)<1e-5&&(e=s)}var l=e-t,u=Math.log(l)/Math.log(10),c=Math.floor(Math.abs(u))*(u<0?-1:1)-1,h=-1,f=0;try{for(var d=o([.1,.25,.5,1,2.5,5,10,25,50,100]),p=d.next();!p.done;p=d.next()){var m=p.value*Math.pow(10,c),v=Math.floor(t/m)*m,y=(Math.ceil(e/m)*m-v)/m,_=Math.abs(y-r);(h<0||_<f)&&(!n||y<=r)&&(f=_,h=m)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}return t=Math.floor(t/h)*h,e=Math.ceil(e/h)*h,{scale:c,step:h,count:r=Math.round((e-t)/h),min:t,max:e}},L=100,U=function(){function t(t){var e,r;void 0===t&&(t={}),this.key_=L++,this.data={},this.type="",this.temp={},this.inflated=!1,this.resizable=!0,this.movable=!0,this.removable=!0,this.selectable=!0,this.move_with_cells=!0,this.resize_with_cells=!0,this.formula="";try{for(var n=o(Object.keys(this)),i=n.next();!i.done;i=n.next()){var a=i.value;"layout"!==a&&t[a]&&(this[a]=t[a])}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}t.layout&&(this.layout=JSON.parse(JSON.stringify(t.layout))),t.rect&&(this.rect=x.Create(t.rect))}return Object.defineProperty(t.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var t={};return this.data&&(t.data=this.data),this.formula&&(t.formula=this.formula),this.type&&(t.type=this.type),this.resizable||(t.resizable=this.resizable),this.movable||(t.movable=this.movable),this.removable||(t.removable=this.removable),this.selectable||(t.selectable=this.selectable),this.move_with_cells||(t.move_with_cells=this.move_with_cells),this.resize_with_cells||(t.resize_with_cells=this.resize_with_cells),this.layout&&(t.layout=this.layout),this.extent&&(t.extent=this.extent),t},t}(),V=function(){function t(e){this.annotations=[],this.freeze={rows:0,columns:0},this.visible=!0,this.default_column_width=100,this.default_row_height=25,this.cells=new _,this.selection={target:{row:0,column:0},area:new u({row:0,column:0}),empty:!0},this.scroll_offset={x:0,y:0},this.name=t.default_sheet_name,this.row_height_=[],this.column_width_=[],this.row_headers=[],this.column_headers=[],this.row_header_width=100,this.column_header_height=25,this.style_map=[],this.style_json_map=[],this.sheet_style={},this.row_styles={},this.column_styles={},this.row_pattern=[],this.cell_style=[],this.default_style_properties=e,this.default_column_width=100,this.row_header_width=60,this.UpdateDefaultRowHeight(),this.id_=t.base_id++}return t.Reset=function(){this.base_id=100},t.Blank=function(e,r,n,i){void 0===n&&(n=30),void 0===i&&(i=20);var o=new t(e);return r&&(o.name=r),n=Math.max(n,1),i=Math.max(i,1),o.cells.EnsureCell({row:n-1,column:i-1}),o},t.FromJSON=function(e,r,i){var a,s,l,u,c,h,f,d,p,m,_,g,w,b,x,M,C,S,A,R,k;k="string"==typeof e?JSON.parse(e):e;var T=function(t,e){Object.keys(e).forEach((function(r){var n=Number(r)||0;t[n]=e[r]}))};i||(i=new t(r)),k.default_column_width&&(i.default_column_width=k.default_column_width),k.default_row_height&&(i.default_row_height=k.default_row_height),k.id&&(i.id=k.id),k.name&&(i.name=k.name);var P=function(t){var e=t;e.text_color&&("none"!==e.text_color&&(e.text={text:e.text_color}),e.text_color=void 0),e.background&&("none"!==e.background&&(e.fill={text:e.background}),e.background=void 0),e.border_top_color&&("none"!==e.border_top_color&&(e.border_top_fill={text:e.border_top_color}),e.border_top_color=void 0),e.border_left_color&&("none"!==e.border_left_color&&(e.border_left_fill={text:e.border_left_color}),e.border_left_color=void 0),e.border_bottom_color&&("none"!==e.border_bottom_color&&(e.border_bottom_fill={text:e.border_bottom_color}),e.border_bottom_color=void 0),e.border_right_color&&("none"!==e.border_right_color&&(e.border_right_fill={text:e.border_right_color}),e.border_right_color=void 0)},N=k.cell_style_refs;try{for(var E=o(N),D=E.next();!D.done;D=E.next())P(X=D.value)}catch(t){a={error:t}}finally{try{D&&!D.done&&(s=E.return)&&s.call(E)}finally{if(a)throw a.error}}if(i.cell_style=[],N&&(k.cell_styles||[]).forEach((function(t){"number"==typeof t.ref&&(t.style=JSON.parse(JSON.stringify(N[t.ref])))})),i.cells.FromJSON(k.data),k.rows&&i.cells.EnsureRow(k.rows-1),k.columns&&i.cells.EnsureColumn(k.columns-1),k.data)if(v(k.data))try{for(var O=o(k.data),F=O.next();!F.done;F=O.next())(X=F.value).style_ref&&(i.cell_style[X.column]||(i.cell_style[X.column]=[]),i.cell_style[X.column][X.row]=JSON.parse(JSON.stringify(N[X.style_ref])))}catch(t){l={error:t}}finally{try{F&&!F.done&&(u=O.return)&&u.call(O)}finally{if(l)throw l.error}}else if(y(k.data))try{for(var I=o(k.data),L=I.next();!L.done;L=I.next()){var V=(q=L.value).row;try{for(var j=(f=void 0,o(q.cells)),G=j.next();!G.done;G=j.next()){var z=(X=G.value).column;X.style_ref&&(i.cell_style[z]||(i.cell_style[z]=[]),i.cell_style[z][V]=JSON.parse(JSON.stringify(N[X.style_ref])))}}catch(t){f={error:t}}finally{try{G&&!G.done&&(d=j.return)&&d.call(j)}finally{if(f)throw f.error}}}}catch(t){c={error:t}}finally{try{L&&!L.done&&(h=I.return)&&h.call(I)}finally{if(c)throw c.error}}else try{for(var B=o(k.data),J=B.next();!J.done;J=B.next()){var q;z=(q=J.value).column;try{for(var H=(_=void 0,o(q.cells)),W=H.next();!W.done;W=H.next())V=(X=W.value).row,X.style_ref&&(i.cell_style[z]||(i.cell_style[z]=[]),i.cell_style[z][V]=JSON.parse(JSON.stringify(N[X.style_ref])))}catch(t){_={error:t}}finally{try{W&&!W.done&&(g=H.return)&&g.call(H)}finally{if(_)throw _.error}}}}catch(t){p={error:t}}finally{try{J&&!J.done&&(m=B.return)&&m.call(B)}finally{if(p)throw p.error}}i.freeze.rows=0,i.freeze.columns=0,k.freeze&&(i.freeze.rows=k.freeze.rows||0,i.freeze.columns=k.freeze.columns||0),i.scroll_offset=k.scroll?n({},k.scroll):{x:0,y:0};try{for(var Z=o(k.cell_styles||[]),$=Z.next();!$.done;$=Z.next()){var Y=$.value;Y.style&&(i.cell_style[Y.column]||(i.cell_style[Y.column]=[]),i.cell_style[Y.column][Y.row]=Y.style)}}catch(t){w={error:t}}finally{try{$&&!$.done&&(b=Z.return)&&b.call(Z)}finally{if(w)throw w.error}}i.sheet_style=k.sheet_style||{},i.row_styles=k.row_style,i.column_styles=k.column_style,i.row_pattern=k.row_pattern||[],P(i.sheet_style||{});try{for(var Q=o(i.row_pattern),K=Q.next();!K.done;K=Q.next()){var X;P(X=K.value)}}catch(t){x={error:t}}finally{try{K&&!K.done&&(M=Q.return)&&M.call(Q)}finally{if(x)throw x.error}}try{for(var tt=o(Object.keys(i.column_styles)),et=tt.next();!et.done;et=tt.next()){var rt=et.value;P(i.column_styles[rt])}}catch(t){C={error:t}}finally{try{et&&!et.done&&(S=tt.return)&&S.call(tt)}finally{if(C)throw C.error}}try{for(var nt=o(Object.keys(i.row_styles)),it=nt.next();!it.done;it=nt.next())rt=it.value,P(i.row_styles[rt])}catch(t){A={error:t}}finally{try{it&&!it.done&&(R=nt.return)&&R.call(nt)}finally{if(A)throw A.error}}return i.row_height_=[],T(i.row_height_,k.row_height||{}),i.row_height_.length&&i.cells.EnsureRow(i.row_height_.length-1),i.column_width_=[],T(i.column_width_,k.column_width||{}),i.column_width_.length&&i.cells.EnsureColumn(i.column_width_.length-1),i.annotations=(k.annotations||[]).map((function(t){return new U(t)})),k.selection&&(i.selection=JSON.parse(JSON.stringify(k.selection))),i.visible=!0,void 0!==k.visible&&(i.visible=!!k.visible),i},Object.defineProperty(t.prototype,"header_offset",{get:function(){return{x:this.row_header_width,y:this.column_header_height}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.cells.rows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.cells.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.id_},set:function(e){this.id_=e,this.id>=t.base_id&&(t.base_id=this.id+1)},enumerable:!1,configurable:!0}),t.prototype.MergeCells=function(t){t=t.Clone(),this.cells.Apply(t,(function(e,r,n){e.merge_area=t,e.render_dirty=!0,r===t.start.column&&n===t.start.row||e.Reset()}),!0)},t.prototype.UnmergeCells=function(t){var e=!0;this.cells.Apply(t,(function(r){e=e&&!!r.merge_area&&t.Equals(r.merge_area)}),!1),e?this.cells.Apply(t,(function(t){t.merge_area=void 0,t.render_dirty=!0}),!1):console.warn("area mismatch")},t.prototype.StyleFontSize=function(t){var e=t.font_size_value||0;return"px"===t.font_size_unit&&(e*=.75),e||10},t.prototype.UpdateDefaultRowHeight=function(){var t=w.Composite([this.default_style_properties,this.sheet_style]);if("undefined"!=typeof window){var e=F.MeasureText(w.Font(t),"M"),r=Math.round(1.4*e.height);this.default_row_height<r&&(this.default_row_height=r)}},t.prototype.SetRowHeaders=function(t){this.row_headers=t.map((function(t){return void 0===t?"":t.toString()})),this.row_headers&&this.cells.EnsureRow(this.row_headers.length-1)},t.prototype.SetColumnHeaders=function(t){this.column_headers=t.map((function(t){return void 0===t?"":t.toString()})),t&&this.cells.EnsureColumn(t.length-1)},t.prototype.RowHeader=function(t){return this.row_headers?this.row_headers.length>t?this.row_headers[t]:"":t+1},t.prototype.ColumnHeader=function(t){var e="";if(this.column_headers)return this.column_headers.length>t?this.column_headers[t]:"";for(;;){var r=t%26;if(e=String.fromCharCode(65+r)+e,!(t=Math.floor(t/26)))break;t--}return e},t.prototype.GetRowHeight=function(t){var e=this.row_height_[t];return void 0===e?this.default_row_height:e},t.prototype.SetRowHeight=function(t,e){return this.row_height_[t]=e,this.cells.EnsureRow(t),e},t.prototype.GetColumnWidth=function(t){var e=this.column_width_[t];return void 0===e?this.default_column_width:e},t.prototype.SetColumnWidth=function(t,e){return this.column_width_[t]=e,this.cells.EnsureColumn(t),e},t.prototype.Delta=function(t,e){var r,n,i={},l=s(s([],a(Object.keys(t))),a(Object.keys(e)));try{for(var u=o(l),c=u.next();!c.done;c=u.next()){var h=c.value,f=t[h],d=e[h];"object"==typeof f&&"object"==typeof d?JSON.stringify(f)!==JSON.stringify(d)&&(i[h]=d):f!==d&&(i[h]=d)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return i},t.prototype.UpdateCellStyle=function(t,e,r){void 0===r&&(r=!0);var n=t.row,i=t.column;this.cell_style[i]||(this.cell_style[i]=[]);var o=this.CompositeStyleForCell(t,!1,!1),a=w.Composite([this.default_style_properties,o,w.Merge(this.cell_style[i][n]||{},e,r)]),s=this.Delta(o,a);this.cell_style[i][n]=s,this.CellData(t).FlushStyle()},t.prototype.Invalidate=function(t){this.cells.Apply(this.RealArea(t),(function(t){return t.render_dirty=!0}))},t.prototype.UpdateAreaStyle=function(t,e,r){var n=this;if(void 0===e&&(e={}),void 0===r&&(r=!0),t)if(t.entire_sheet)this.UpdateSheetStyle(e,r);else if(t.entire_column)for(var i=t.start.column;i<=t.end.column;i++)this.UpdateColumnStyle(i,e,r);else if(t.entire_row)for(var o=t.start.row;o<=t.end.row;o++)this.UpdateRowStyle(o,e,r);else t.Array().forEach((function(t){return n.UpdateCellStyle(t,e,r)}))},t.prototype.HasCellStyle=function(t){return!!(this.cell_style[t.column]&&this.cell_style[t.column][t.row]||this.row_styles[t.row]||this.column_styles[t.column]||this.row_pattern.length)},t.prototype.NextVisibleColumn=function(t){for(++t;0===this.column_width_[t];t++);return t},t.prototype.PreviousVisibleColumn=function(t){for(--t;t>=0&&0===this.column_width_[t];t--);return t},t.prototype.NextVisibleRow=function(t){for(++t;0===this.row_height_[t];t++);return t},t.prototype.PreviousVisibleRow=function(t){for(--t;t>=0&&0===this.row_height_[t];t--);return t},t.prototype.SurroundingStyle=function(t){for(var e=[{},{},{},{},{},{},{},{},{},{}],r=t.column+1,n=t.column-1,i=t.row+1,o=t.row-1;0===this.column_width_[r];r++);for(;0===this.row_height_[i];i++);for(;n>=0&&0===this.column_width_[n];n--);for(;o>=0&&0===this.row_height_[o];o--);return n>=0&&o>=0&&(e[7]=this.CellStyleData({row:o,column:n})||{}),n>=0&&(e[4]=this.CellStyleData({row:t.row,column:n})||{},e[1]=this.CellStyleData({row:i,column:n})||{}),o>=0&&(e[8]=this.CellStyleData({row:o,column:t.column})||{},e[9]=this.CellStyleData({row:o,column:r})||{}),e[6]=this.CellStyleData({row:t.row,column:r})||{},e[2]=this.CellStyleData({row:i,column:t.column})||{},e[3]=this.CellStyleData({row:i,column:r})||{},e},t.prototype.CellStyleData=function(t){var e=this.cells.GetCell(t);if(e){if(!e.style){var r=this.GetStyleIndex(this.CompositeStyleForCell(t));e.style=this.style_map[r]}return e.style}},t.prototype.GetCopyStyle=function(t){return this.CompositeStyleForCell(t,!0,!1)},t.prototype.CellData=function(t){var e,r,n=this.cells.EnsureCell(t);if(n.rendered_type)return n;if(n.calculated_type?(r=n.calculated,e=n.calculated_type):(r=n.value,e=n.type),!n.style){var i=this.GetStyleIndex(this.CompositeStyleForCell(t));n.style=this.style_map[i]}return e&&null!=r?e===l.number?(isNaN(r)?n.formatted=void 0===n.style.nan?"NaN":n.style.nan:n.formatted=this.FormatNumber(r,n.style.number_format),n.rendered_type=l.number):e===l.error?(n.formatted="#"+(r||"ERR?"),n.rendered_type=l.error):e===l.boolean?(n.formatted=r.toString().toUpperCase(),n.rendered_type=l.boolean):e===l.formula&&void 0===n.calculated?(n.formatted="",n.rendered_type=l.string):(n.formatted=this.FormatNumber(r,n.style.number_format),n.rendered_type=l.string):(n.formatted="",n.rendered_type=l.string),n},t.prototype.FormatNumber=function(t,e){void 0===e&&(e="");var r=P.Get(e).FormatParts(t);return r.length?1!==r.length||r[0].flag?r:r[0].text||"":""},t.prototype.SetHeaderSize=function(t,e){void 0===t&&(t=60),void 0===e&&(e=this.default_row_height),this.row_header_width=t,this.column_header_height=e},t.prototype.AutoSizeRow=function(t){for(var e=this.default_row_height,r=0;r<this.cells.columns;r++){var n=this.CellData({row:t,column:r}),i=n.style,o=n.formatted||"";if("string"!=typeof o&&(o=o.map((function(t){return t.text})).join("")),i&&o&&o.length){var a=o.split(/\n/),s=this.StyleFontSize(i);e=Math.max(e,((s||10)+9)*a.length)}}this.SetRowHeight(t,e)},t.prototype.AutoSizeColumn=function(e,r){void 0===r&&(r=!0),t.measurement_canvas||(t.measurement_canvas=document.createElement("canvas"));var n=t.measurement_canvas.getContext("2d");if(n){var i=12;r||(i=this.GetColumnWidth(e));for(var o=0;o<this.cells.rows;o++){var a=this.CellData({row:o,column:e}),s=a.formatted||"";"string"!=typeof s&&(s=s.map((function(t){return t.text})).join("")),s&&s.length&&(n.font=w.Font(a.style||{}),i=Math.max(i,Math.ceil(n.measureText(s).width)+8))}this.SetColumnWidth(e,i)}},t.prototype.GetStyle=function(t){return this.style_map[t]},t.prototype.InsertRows=function(t,e){var r,n,i,a,s=this;if(void 0===t&&(t=0),void 0===e&&(e=1),t)for(var l=0;l<this.cells.columns;l++){var c=this.cells.GetCell({row:t-1,column:l},!1);if(c&&c.area){var h=this.cells.GetCell({row:t,column:l},!1);if(h&&h.area&&h.area.Equals(c.area))return!1}}e<0?this.cells.DeleteRows(t,-e):this.cells.InsertRows(t,e);for(var f={},d={},p=t;p<this.cells.rows;p++)for(l=0;l<this.cells.columns;l++){var m=this.cells.GetCell({row:p,column:l},!1);m&&(m.area&&!d[m.area.spreadsheet_label]&&(d[m.area.spreadsheet_label]=m.area),m.merge_area&&!f[m.merge_area.spreadsheet_label]&&(f[m.merge_area.spreadsheet_label]=m.merge_area))}var v=function(t){var r=d[t],n=new u({row:r.start.row+e,column:r.start.column},{row:r.end.row+e,column:r.end.column});n.Iterate((function(t){s.cells.GetCell(t,!0).area=n}))};try{for(var y=o(Object.keys(d)),_=y.next();!_.done;_=y.next())v(_.value)}catch(t){r={error:t}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}var g=function(r){var n=f[r],i={row:n.start.row,column:n.start.column};n.start.row>=t&&(i.row+=e);var o=new u(i,{row:n.end.row+e,column:n.end.column});o.Iterate((function(t){s.cells.GetCell(t,!0).merge_area=o}))};try{for(var w=o(Object.keys(f)),b=w.next();!b.done;b=w.next())g(b.value)}catch(t){i={error:t}}finally{try{b&&!b.done&&(a=w.return)&&a.call(w)}finally{if(i)throw i.error}}var x=Object.keys(this.row_styles),M={};x.forEach((function(r){var n=Number(r);n<t?M[n]=s.row_styles[n]:e<0&&n<t-e||(M[n+e]=s.row_styles[n])})),this.row_styles=M;var C=[];if(e<0)C=[t,-e];else{C=[t,0];for(var S=0;S<e;S++)C.push(void 0)}return this.cell_style.forEach((function(e){e&&e.length>=t&&e.splice.apply(e,C)})),this.row_height_.splice.apply(this.row_height_,C),this.FlushCellStyles(),!0},t.prototype.InsertColumns=function(t,e){var r,n,i,a,s=this;if(void 0===t&&(t=0),void 0===e&&(e=1),t)for(var l=0;l<this.cells.rows;l++){var c=this.cells.GetCell({row:l,column:t-1},!1);if(c&&c.area){var h=this.cells.GetCell({row:l,column:t},!1);if(h&&h.area&&h.area.Equals(c.area))return!1}}e<0?this.cells.DeleteColumns(t,-e):this.cells.InsertColumns(t,e);for(var f={},d={},p=t;p<this.cells.columns;p++)for(l=0;l<this.cells.rows;l++){var m=this.cells.GetCell({row:l,column:p},!1);m&&(m.area&&!d[m.area.spreadsheet_label]&&(d[m.area.spreadsheet_label]=m.area),m.merge_area&&!f[m.merge_area.spreadsheet_label]&&(f[m.merge_area.spreadsheet_label]=m.merge_area))}var v=function(t){var r=d[t],n=new u({row:r.start.row,column:r.start.column+e},{row:r.end.row,column:r.end.column+e});n.Iterate((function(t){s.cells.GetCell(t,!0).area=n}))};try{for(var y=o(Object.keys(d)),_=y.next();!_.done;_=y.next())v(_.value)}catch(t){r={error:t}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}var g=function(r){var n=f[r],i={row:n.start.row,column:n.start.column};n.start.column>=t&&(i.column+=e);var o=new u(i,{row:n.end.row,column:n.end.column+e});o.Iterate((function(t){s.cells.GetCell(t,!0).merge_area=o}))};try{for(var w=o(Object.keys(f)),b=w.next();!b.done;b=w.next())g(b.value)}catch(t){i={error:t}}finally{try{b&&!b.done&&(a=w.return)&&a.call(w)}finally{if(i)throw i.error}}var x=Object.keys(this.column_styles),M={};x.forEach((function(r){var n=Number(r);n<t?M[n]=s.column_styles[n]:e<0&&n<t-e||(M[n+e]=s.column_styles[n])})),this.column_styles=M;var C=[];if(e<0)C=[t,-e];else{C=[t,0];for(var S=0;S<e;S++)C.push(void 0)}return this.cell_style.splice.apply(this.cell_style,C),this.column_width_.splice.apply(this.column_width_,C),this.FlushCellStyles(),!0},t.prototype.ClearArea=function(t){t=this.RealArea(t),this.cells.Apply(t,(function(t){return t.Reset()}))},t.prototype.SetAreaValues2=function(t,e){t=this.RealArea(t),this.cells.SetArea(t,e)},t.prototype.SetArrayValue=function(t,e){t=this.RealArea(t),this.cells.Apply(t,(function(e){return e.SetArray(t)}),!0),this.cells.GetCell(t.start,!0).SetArrayHead(t,e)},t.prototype.SetCellValue=function(t,e){this.cells.GetCell(t,!0).Set(e)},t.prototype.RealArea=function(t,e){void 0===e&&(e=!1);var r=t.start,n=t.end;return t.entire_row&&(r.column=0,r.absolute_column=!1,n.column=this.cells.columns-1,n.absolute_column=!1),t.entire_column&&(r.row=0,r.absolute_row=!1,n.row=this.cells.rows-1,n.absolute_row=!1),e&&(n.row>=this.rows&&(n.row=this.rows-1,n.absolute_row=!1),n.column>=this.columns&&(n.column=this.columns-1,n.absolute_column=!1)),new u(r,n)},t.prototype.FormattedCellValue=function(t){var e=this.CellData(t);if(e)return"string"==typeof e.formatted?e.formatted:e.formatted?e.formatted.map((function(t){switch(t.flag){case 1:case 2:return" ";default:return t.text}})).join(""):e.value},t.prototype.GetFormattedRange=function(t,e){if(void 0===e&&(e=t),t.row===e.row&&t.column===e.column)return this.FormattedCellValue(t);for(var r=[],n=t.row;n<=e.row;n++){for(var i=[],o=t.column;o<=e.column;o++)i.push(this.FormattedCellValue({row:n,column:o}));r.push(i)}return r},t.prototype.NumberFormatsAndColors=function(t,e){var r,n,i,a,s,l,u=function(r){var n,i,o,a,s,l;r.number_format&&(e[r.number_format]=1),(null===(n=r.text)||void 0===n?void 0:n.text)&&"none"!==r.text.text&&(t[r.text.text]=1),(null===(i=r.fill)||void 0===i?void 0:i.text)&&(t[r.fill.text]=1),(null===(o=r.border_top_fill)||void 0===o?void 0:o.text)&&(t[r.border_top_fill.text]=1),(null===(a=r.border_left_fill)||void 0===a?void 0:a.text)&&(t[r.border_left_fill.text]=1),(null===(s=r.border_right_fill)||void 0===s?void 0:s.text)&&(t[r.border_right_fill.text]=1),(null===(l=r.border_bottom_fill)||void 0===l?void 0:l.text)&&(t[r.border_bottom_fill.text]=1)};for(var c in u(this.sheet_style),this.row_styles)u(this.row_styles[c]);for(var c in this.column_styles)u(this.column_styles[c]);try{for(var h=o(this.row_pattern),f=h.next();!f.done;f=h.next())u(_=f.value)}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}try{for(var d=o(this.cell_style),p=d.next();!p.done;p=d.next()){var m=p.value;if(m)try{for(var v=(s=void 0,o(m)),y=v.next();!y.done;y=v.next()){var _;(_=y.value)&&u(_)}}catch(t){s={error:t}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}}}catch(t){i={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}},t.prototype.toJSON=function(t){var e,r,i,a,s,l,u,c,h,f,d;void 0===t&&(t={});for(var p=function(t,e){for(var r={},n=0;n<t.length;n++)void 0!==t[n]&&t[n]!==e&&(r[n]=t[n]);if(Object.keys(r).length)return r},m=[{}],v={},y=[],_=JSON.stringify({}),g=0;g<this.cell_style.length;g++)if(K=this.cell_style[g]){y[g]=[];for(var b=0;b<K.length;b++)if(K[b]){var x=JSON.stringify(K[b]);if(x!==_){var M=v[x];"number"!=typeof M&&(v[x]=M=m.length,m.push(K[b])),y[g][b]=M}}}m=JSON.parse(JSON.stringify(m));var C=JSON.parse(JSON.stringify(this.sheet_style)),S=JSON.parse(JSON.stringify(this.row_styles)),A=JSON.parse(JSON.stringify(this.column_styles)),R=JSON.parse(JSON.stringify(this.row_pattern)),k=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var r=n(n({},e),t);return r.text?(r.text=F.MeasureColorARGB(r.text),r):"number"==typeof r.theme?r:void 0};if(t.export_colors){var T=[];try{for(var P=o([S,A,m,[C],R]),N=P.next();!N.done;N=P.next()){var E=N.value;if(Array.isArray(E))try{for(var D=(i=void 0,o(E)),O=D.next();!O.done;O=D.next()){var I=O.value;T.push(I)}}catch(t){i={error:t}}finally{try{O&&!O.done&&(a=D.return)&&a.call(D)}finally{if(i)throw i.error}}else try{for(var L=(s=void 0,o(Object.keys(E))),U=L.next();!U.done;U=L.next()){var V=U.value;T.push(E[V])}}catch(t){s={error:t}}finally{try{U&&!U.done&&(l=L.return)&&l.call(L)}finally{if(s)throw s.error}}}}catch(t){e={error:t}}finally{try{N&&!N.done&&(r=P.return)&&r.call(P)}finally{if(e)throw e.error}}try{for(var j=o(T),G=j.next();!G.done;G=j.next()){var z=G.value;z.border_top_fill=k(z.border_top_fill,w.DefaultProperties.border_top_fill),z.border_left_fill=k(z.border_left_fill,w.DefaultProperties.border_top_fill),z.border_right_fill=k(z.border_right_fill,w.DefaultProperties.border_top_fill),z.border_bottom_fill=k(z.border_bottom_fill,w.DefaultProperties.border_top_fill),(null===(d=z.fill)||void 0===d?void 0:d.text)&&(z.fill.text=F.MeasureColorARGB(z.fill.text)),z.text&&z.text.text&&"none"!==z.text.text&&(z.text.text=F.MeasureColorARGB(z.text.text))}}catch(t){u={error:t}}finally{try{G&&!G.done&&(c=j.return)&&c.call(j)}finally{if(u)throw u.error}}}var B={calculated_value:!!t.rendered_values,preserve_type:!!t.preserve_type,expand_arrays:!!t.expand_arrays,decorated_cells:!!t.decorated_cells,nested:!0,cell_style_refs:y},J=this.cells.toJSON(B),q=J.data,H=J.rows,W=J.columns;t.shrink?(H+=2,W+=1):(H=this.rows,W=this.columns);try{for(var Z=o(this.annotations),$=Z.next();!$.done;$=Z.next()){var Y=$.value;Y.extent||this.CalculateAnnotationExtent(Y),Y.extent&&(H=Math.max(H,Y.extent.row+1),W=Math.max(W,Y.extent.column+1))}}catch(t){h={error:t}}finally{try{$&&!$.done&&(f=Z.return)&&f.call(Z)}finally{if(h)throw h.error}}var Q=[];for(g=0;g<y.length;g++){var K;if(K=y[g])for(b=0;b<K.length;b++)K[b]&&Q.push({row:b,column:g,ref:K[b]})}var X={id:this.id,name:this.name,data:q,sheet_style:C,rows:H,columns:W,cell_styles:Q,cell_style_refs:m,row_style:S,column_style:A,row_pattern:R.length?R:void 0,default_row_height:this.default_row_height,default_column_width:this.default_column_width,row_height:p(this.row_height_,this.default_row_height),column_width:p(this.column_width_,this.default_column_width),selection:JSON.parse(JSON.stringify(this.selection)),annotations:JSON.parse(JSON.stringify(this.annotations))};return this.visible||(X.visible=this.visible),(this.scroll_offset.x||this.scroll_offset.y)&&(X.scroll=this.scroll_offset),(this.freeze.rows||this.freeze.columns)&&(X.freeze=this.freeze),X},t.prototype.FlushCellStyles=function(){this.style_map=[],this.style_json_map=[],this.cells.FlushCellStyles()},t.prototype.ImportData=function(t){var e,r,n,i,a=t.styles,s=t.sheet_style;s&&this.UpdateAreaStyle(new u({row:1/0,column:1/0},{row:1/0,column:1/0}),a[s]);var l=t.column_styles;if(l)for(var c=0;c<l.length;c++)l[c]&&this.UpdateAreaStyle(new u({row:1/0,column:c},{row:1/0,column:c}),a[l[c]]);this.cells.FromJSON(t.cells),t.name&&(this.name=t.name||"");var h=this.cell_style;try{for(var f=o(t.cells),d=f.next();!d.done;d=f.next()){var p=d.value;p.style_ref&&(h[p.column]||(h[p.column]=[]),h[p.column][p.row]=a[p.style_ref])}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}for(c=0;c<t.column_widths.length;c++)void 0!==t.column_widths[c]&&this.SetColumnWidth(c,t.column_widths[c]);for(c=0;c<t.row_heights.length;c++)void 0!==t.row_heights[c]&&this.SetRowHeight(c,t.row_heights[c]);try{for(var m=o(t.annotations||[]),v=m.next();!v.done;v=m.next()){var y=v.value;this.annotations.push(new U(y))}}catch(t){n={error:t}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}t.hidden&&(this.visible=!1)},t.prototype.CalculateAnnotationExtent=function(t){var e,r;if(t.layout)t.extent=n({},t.layout.br.address);else{t.extent={row:0,column:0};var i=null===(e=t.rect)||void 0===e?void 0:e.right;if(i&&this.default_column_width)for(var o=0;i>=0&&o<1e3;o++)if((i-=this.GetColumnWidth(o))<0){t.extent.column=o;break}var a=null===(r=t.rect)||void 0===r?void 0:r.bottom;if(a&&this.default_row_height)for(o=0;a>=0&&o<1e3;o++)if((a-=this.GetRowHeight(o))<0){t.extent.row=o;break}}},t.prototype.UpdateSheetStyle=function(t,e){var r,n,i,a,s,l,u,c,h=this;void 0===e&&(e=!0),this.sheet_style=w.Merge(this.sheet_style,t,e);var f=Object.keys(t);try{for(var d=o(this.cell_style),p=d.next();!p.done;p=d.next()){var m=p.value;if(m){var v=function(t){t&&f.forEach((function(e){return delete t[e]}))};try{for(var y=(i=void 0,o(m)),_=y.next();!_.done;_=y.next())v(_.value)}catch(t){i={error:t}}finally{try{_&&!_.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}}}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}var g=function(t){f.forEach((function(e){return delete h.row_styles[t][e]}))};try{for(var b=o(Object.keys(this.row_styles)),x=b.next();!x.done;x=b.next())g(x.value)}catch(t){s={error:t}}finally{try{x&&!x.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}var M=function(t){f.forEach((function(e){return delete h.column_styles[t][e]}))};try{for(var C=o(Object.keys(this.column_styles)),S=C.next();!S.done;S=C.next())M(S.value)}catch(t){u={error:t}}finally{try{S&&!S.done&&(c=C.return)&&c.call(C)}finally{if(u)throw u.error}}this.FlushCellStyles()},t.prototype.UpdateRowStyle=function(t,e,r){var n,i,a,s;void 0===r&&(r=!0),this.row_styles[t]=w.Merge(this.row_styles[t]||{},e,r);var l=Object.keys(e),c=function(e){e&&e[t]&&l.forEach((function(r){return delete e[t][r]}))};try{for(var h=o(this.cell_style),f=h.next();!f.done;f=h.next())c(f.value)}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}for(var d=0;d<this.cells.columns;d++)if(this.column_styles[d]){var p=this.column_styles[d],m=this.cell_style[d]&&this.cell_style[d][t]||{};try{for(var v=(a=void 0,o(l)),y=v.next();!y.done;y=v.next()){var _=y.value;void 0!==p[_]&&(m[_]=e[_])}}catch(t){a={error:t}}finally{try{y&&!y.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}Object.keys(m).length&&(this.cell_style[d]||(this.cell_style[d]=[]),this.cell_style[d][t]=JSON.parse(JSON.stringify(m)))}this.cells.Apply(this.RealArea(u.FromRow(t)),(function(t){return t.FlushStyle()}))},t.prototype.FlattenStyles=function(){this.CompositeStyleForCell},t.prototype.UpdateColumnStyle=function(t,e,r){var n,i;void 0===r&&(r=!0),this.column_styles[t]=w.Merge(this.column_styles[t]||{},e,r);var a=Object.keys(e);if(this.cell_style[t]){var s=function(t){t&&a.forEach((function(e){return delete t[e]}))};try{for(var l=o(this.cell_style[t]),c=l.next();!c.done;c=l.next())s(c.value)}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}this.cells.Apply(this.RealArea(u.FromColumn(t)),(function(t){return t.FlushStyle()}))},t.prototype.CompositeStyleForCell=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!0);var n=t.row,i=t.column,o=[this.default_style_properties,this.sheet_style];return r&&this.row_pattern.length&&o.push(this.row_pattern[n%this.row_pattern.length]),this.row_styles[n]&&o.push(this.row_styles[n]),this.column_styles[i]&&o.push(this.column_styles[i]),e&&this.cell_style[i]&&this.cell_style[i][n]&&o.push(this.cell_style[i][n]),w.Composite(o)},t.prototype.GetStyleIndex=function(t){for(var e=JSON.stringify(t),r=0;r<this.style_json_map.length;r++)if(e===this.style_json_map[r])return r;var n=this.style_map.length;return this.style_map.push(JSON.parse(e)),this.style_json_map.push(e),n},t.base_id=100,t.default_sheet_name="Sheet1",t}(),j=function(){function t(){this.forward={},this.backward=[]}return t.prototype.Count=function(){return this.backward.length},t.prototype.Serialize=function(){return JSON.parse(JSON.stringify(this.Map()))},t.prototype.Deserialize=function(t){var e,r;if(this.Reset(),t){try{for(var n=o(Object.keys(t)),i=n.next();!i.done;i=n.next()){var a=i.value;this.SetName(a,new u(t[a].start,t[a].end),!1)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.RebuildList()}},t.prototype.MatchSelection=function(t,e){var r,n,i;if(!t.start.sheet_id)throw new Error("match selection without sheet id");try{for(var a=o(this.List()),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.range.start.sheet_id===t.start.sheet_id&&(l.range.Equals(t)&&(i=l.name),null==e?void 0:e.Equals(l.range)))return l.name}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i},t.prototype.SetName=function(t,e,r){void 0===r&&(r=!0);var n=this.ValidateNamed(t);return n?e.entire_column||e.entire_row?(console.warn("invalid range"),!1):(this.forward[n]=e,r&&this.RebuildList(),!0):(console.warn("invalid name"),!1)},t.prototype.SetNames=function(t){var e,r;try{for(var n=o(Object.keys(t)),i=n.next();!i.done;i=n.next()){var a=i.value,s=t[a];this.SetName(a,new u(s.start,s.end),!1)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.RebuildList()},t.prototype.ClearName=function(t,e){void 0===e&&(e=!0),delete this.forward[t],e&&this.RebuildList()},t.prototype.Reset=function(){this.forward={},this.backward=[]},t.prototype.Get=function(t){return this.forward[t.toUpperCase()]},t.prototype.Map=function(){return this.forward},t.prototype.List=function(){return this.backward},t.prototype.ValidateNamed=function(t){return!!(t=t.trim()).length&&!/^[A-Za-z]{1,3}\d+$/.test(t)&&!/[^A-Za-z\d_.]/.test(t)&&!/^[^A-Za-z_]/.test(t)&&t.toUpperCase()},t.prototype.PatchNamedRanges=function(t,e,r,n){var i,a,s=this.List().slice(0);try{for(var l=o(s),c=l.next();!c.done;c=l.next()){var h=c.value,f=h.name,d=h.range;if(e&&t<=d.end.column)if(e>0)t<=d.start.column?d.Shift(0,e):t>d.start.column&&t<=d.end.column?d.ConsumeAddress({row:d.end.row,column:d.end.column+e}):console.warn("PNR X case 1",t,e,JSON.stringify(d));else if(e<0)if(t-e<=d.start.column)d.Shift(0,e);else if(t<=d.start.column&&t-e>d.end.column)this.ClearName(f,!1);else if(t<=d.start.column){var p=t-e-1;this.SetName(f,new u({row:d.start.row,column:p+1+e},{row:d.end.row,column:d.end.column+e}),!1)}else t<=d.end.column?(p=t-e-1)>=d.end.column?this.SetName(f,new u({row:d.start.row,column:d.start.column},{row:d.end.row,column:t-1}),!1):this.SetName(f,new u({row:d.start.row,column:d.start.column},{row:d.end.row,column:d.start.column+d.columns+e-1}),!1):console.warn("PNR X case 2",t,e,JSON.stringify(d));if(n&&r<=d.end.row)if(n>0)r<=d.start.row?d.Shift(n,0):r>d.start.row&&r<=d.end.row?d.ConsumeAddress({row:d.end.row+n,column:d.end.column}):console.warn("PNR X case 3",r,n,JSON.stringify(d));else if(n<0)if(r-n<=d.start.row)d.Shift(n,0);else if(r<=d.start.row&&r-n>d.end.row)this.ClearName(f,!1);else if(r<=d.start.row){var m=r-n-1;this.SetName(f,new u({column:d.start.column,row:m+1+n},{column:d.end.column,row:d.end.row+n}),!1)}else r<=d.end.row?(m=r-n-1)>=d.end.row?this.SetName(f,new u({column:d.start.column,row:d.start.row},{column:d.end.column,row:r-1}),!1):this.SetName(f,new u({column:d.start.column,row:d.start.row},{column:d.end.column,row:d.start.row+d.rows+n-1}),!1):console.warn("PNR X case 4",r,n,JSON.stringify(d))}}catch(t){i={error:t}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}this.RebuildList()},t.prototype.RebuildList=function(){var t,e;this.backward=[];try{for(var r=o(Object.keys(this.forward)),n=r.next();!n.done;n=r.next()){var i=n.value;this.backward.push({name:i,range:this.forward[i]})}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t}();!function(t){t.Comma=",",t.Semicolon=";"}(E||(E={})),function(t){t.Period=".",t.Comma=","}(D||(D={}));var G,z,B,J=/[\s-+=<>!()]/,q=48,H={"==":6,"!=":6,"<>":6,"=":6,"<":7,">":7,"<=":7,">=":7,"+":9,"-":9,"&":9,"*":10,"/":10,"^":11,":":13},W=Object.keys(H).sort((function(t,e){return e.length-t.length})),Z={"-":100,"+":100},$=function(){function t(){this.argument_separator=E.Comma,this.decimal_mark=D.Period,this.argument_separator_char=44,this.decimal_mark_char=46,this.id_counter=0,this.expression="",this.data=[],this.index=0,this.length=0,this.valid=!0,this.dependencies={addresses:{},ranges:{}},this.address_refcount={},this.full_reference_list=[]}return t.prototype.Walk=function(t,e){var r=this;switch(t.type){case"address":case"missing":case"literal":case"identifier":case"operator":return void e(t);case"range":return void(e(t)&&(this.Walk(t.start,e),this.Walk(t.end,e)));case"binary":return void(e(t)&&(this.Walk(t.left,e),this.Walk(t.right,e)));case"unary":return void(e(t)&&this.Walk(t.operand,e));case"group":return void(e(t)&&t.elements.forEach((function(t){return r.Walk(t,e)})));case"call":e(t)&&t.args.forEach((function(t){return r.Walk(t,e)}))}},t.prototype.Transpose=function(t){for(var e=t.length,r=[],n=0,i=0;i<e;i++)Array.isArray(t[i])&&(n=Math.max(n,t[i].length));for(i=0;i<n;i++){r[i]=[];for(var o=0;o<e;o++)r[i][o]=t[o][i]}return r},t.prototype.Render=function(t,e,r,n,i){var o=this;void 0===e&&(e={rows:0,columns:0}),void 0===r&&(r="(missing)");var a=this.argument_separator+" ";i===E.Comma?a=", ":i===E.Semicolon&&(a="; ");var s=n===D.Comma?",":".",l=this.decimal_mark===D.Comma?/,/:/\./;switch(t.type){case"address":return this.AddressLabel(t,e);case"range":return this.AddressLabel(t.start,e)+":"+this.AddressLabel(t.end,e);case"missing":return r;case"array":return"{"+this.Transpose(t.values).map((function(t){return t.map((function(t){return"string"==typeof t?'"'+t+'"':t})).join(", ")})).join("; ")+"}";case"binary":return this.Render(t.left,e,r,n,i)+" "+t.operator+" "+this.Render(t.right,e,r,n,i);case"unary":return t.operator+this.Render(t.operand,e,r,n,i);case"literal":if("string"==typeof t.value)return'"'+t.value.replace(/"/g,'""')+'"';if(n&&"number"==typeof t.value){if(t.text){var u=t.text;return n===D.Comma&&this.decimal_mark===D.Period&&(u=u.replace(/,/g,"")),u.replace(l,s)}return t.value.toString().replace(/\./,s)}return t.text?t.text:t.value.toString();case"identifier":return t.name;case"operator":return"["+t.operator+"]";case"group":return t.explicit?"("+t.elements.map((function(t){return o.Render(t,e,r,n,i)})).join(a)+")":t.elements.map((function(t){return o.Render(t,e,r,n,i)})).join(a);case"call":return t.name+"("+t.args.map((function(t){return o.Render(t,e,r,n,i)})).join(a)+")"}return"??"},t.prototype.Parse=function(t){var e,r;switch("="===(t=t.trim())[0]&&(t=t.substr(1).trim()),this.expression=t,this.data=[],this.length=t.length,this.index=0,this.valid=!0,this.error_position=void 0,this.error=void 0,this.dependencies.addresses={},this.dependencies.ranges={},this.address_refcount={},this.full_reference_list=[],this.id_counter=0,this.argument_separator){case E.Semicolon:this.argument_separator_char=59;break;default:this.argument_separator_char=44}switch(this.decimal_mark){case D.Comma:this.decimal_mark_char=44;break;default:this.decimal_mark_char=46}for(var n=0;n<this.length;n++)this.data[n]=t.charCodeAt(n);var i=this.ParseGeneric(),a={};try{for(var s=o(Object.keys(this.dependencies.addresses)),l=s.next();!l.done;l=s.next()){var u=l.value;this.address_refcount[u]&&(a[u]=this.dependencies.addresses[u])}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return this.dependencies.addresses=a,{expression:i||void 0,valid:this.valid,error:this.error,error_position:this.error_position,dependencies:this.dependencies,separator:this.argument_separator,decimal_mark:this.decimal_mark,full_reference_list:this.full_reference_list.slice(0)}},t.prototype.ColumnLabel=function(t){if(t===1/0)return"";for(var e=String.fromCharCode(65+t%26);t>25;)t=Math.floor(t/26)-1,e=String.fromCharCode(65+t%26)+e;return e},t.prototype.AddressLabel=function(t,e){var r=t.column;t.absolute_column||t.column===1/0||(r+=e.columns);var n=t.row;if(t.absolute_row||t.row===1/0||(n+=e.rows),n<0||r<0||n===1/0&&r===1/0)return"#REF";var i="";return t.sheet&&(i=(J.test(t.sheet)?"'"+t.sheet+"'":t.sheet)+"!"),n===1/0?i+(t.absolute_column?"$":"")+this.ColumnLabel(r):r===1/0?i+(t.absolute_row?"$":"")+(n+1):i+(t.absolute_column?"$":"")+this.ColumnLabel(r)+(t.absolute_row?"$":"")+(n+1)},t.prototype.ParseGeneric=function(t){void 0===t&&(t=[0]);for(var e=[],r=function(){var r=n.ParseNext(0===e.length);if("number"==typeof r){if(t.some((function(t){return r===t})))return"break";if(40===r){n.index++;var i=n.ParseGeneric([41]);n.index++,i&&e.push({type:"group",id:n.id_counter++,elements:[i],explicit:!0})}else{var o=n.ConsumeOperator();o?e.push(o):(n.error="unexpected character [1]: "+String.fromCharCode(r)+", "+r,n.valid=!1,n.index++)}}else e.push(r)},n=this;this.index<this.length&&"break"!==r(););return 0===e.length?null:1===e.length?e[0]:this.BinaryToRange(this.ArrangeUnits(e))},t.prototype.UnitToAddress=function(t){if("literal"===t.type){if("number"==typeof t.value&&t.value>0&&!/\./.test(t.text||""))return{type:"address",position:t.position,label:t.value.toString(),row:t.value-1,id:this.id_counter++,column:1/0}}else{var e=void 0,r=t.name,n=r.split("!");if(n.length>1&&(e=n.slice(0,n.length-1).join("!"),r=r.substr(e.length+1),"'"===e[0])){if(!(e.length>1&&"'"===e[e.length-1]))return;e=e.substr(1,e.length-2)}var i="$"===r[0];r=(i?r.substr(1):r).toUpperCase();var o=Number(r);if(isNaN(o)){if(/[A-Z]{1,3}/.test(r)){for(var a=-1,s=0;s<r.length;s++)a=26*(1+a)+(r[s].charCodeAt(0)-65);return{type:"address",position:t.position,absolute_column:i,label:t.name,column:a,id:this.id_counter++,row:1/0,sheet:e}}}else if(o>0&&o!==1/0&&!/\./.test(r))return{type:"address",position:t.position,absolute_row:i,label:t.name,row:o-1,id:this.id_counter++,column:1/0,sheet:e}}},t.prototype.BinaryToRange=function(t){if("binary"===t.type){if(":"===t.operator){var e=void 0,r="";if("address"===t.left.type&&"address"===t.right.type){var n=t.left.position+t.left.label.length,i=t.right.position;r=(e={type:"range",id:this.id_counter++,position:t.left.position,start:t.left,end:t.right,label:t.left.label+this.expression.substring(n,i)+t.right.label}).start.label+":"+e.end.label,this.address_refcount[e.start.label]--,this.address_refcount[e.end.label]--;var o=[t.left.position,t.right.position];this.full_reference_list=this.full_reference_list.filter((function(t){return t.position!==o[0]&&t.position!==o[1]}))}else if(!("literal"!==t.left.type&&"identifier"!==t.left.type||"literal"!==t.right.type&&"identifier"!==t.right.type)){var a=this.UnitToAddress(t.left),s=this.UnitToAddress(t.right);a&&s&&(a.column===1/0&&s.column===1/0||a.row===1/0&&s.row===1/0)&&(r=a.label+":"+s.label,e={type:"range",id:this.id_counter++,position:t.left.position,start:a,end:s,label:r})}if(e)return this.dependencies.ranges[r]=e,this.full_reference_list.push(e),e;this.error="unexpected character: :",this.valid=!1}t.left=this.BinaryToRange(t.left),t.right=this.BinaryToRange(t.right)}return t},t.prototype.ArrangeUnits=function(t){if(0===t.length)return{type:"missing",id:this.id_counter++};if(1===t.length)return t[0];for(var e=[],r=0;r<t.length;r++){var n=t[r];if("operator"===n.type){if(0!==e.length&&"operator"!==e[e.length-1].type){e.push(n);continue}if(!Z[n.operator])return this.error="unexpected character [2]: "+n.operator,this.error_position=n.position,this.valid=!1,{type:"group",id:this.id_counter++,elements:t,explicit:!1};var i=this.BinaryToRange(this.ArrangeUnits(t.slice(r+1)));if(!this.valid)return{type:"group",id:this.id_counter++,elements:t,explicit:!1};"binary"===i.type?(i.left={type:"unary",id:this.id_counter++,operator:n.operator,operand:i.left,position:n.position},n=i):n={type:"unary",id:this.id_counter++,operator:n.operator,operand:i,position:n.position},r=t.length}if(e.length<2)e.push(n);else{if("operator"!==e[e.length-1].type)return this.error="multiple expressions",this.error_position=n.position,this.valid=!1,{type:"group",id:this.id_counter++,elements:t,explicit:!1};var o=e[e.length-2],a=e[e.length-1],s=a.operator,l={type:"binary",id:this.id_counter++,left:o,operator:s,position:a.position,right:n};"binary"===o.type&&H[s]>H[o.operator]&&(l.left=o.left,l.operator=o.operator,l.position=o.position,l.right={type:"binary",id:this.id_counter++,left:o.right,right:n,operator:s,position:a.position}),e.splice(-2,2,l)}}return e[0]},t.prototype.ParseNext=function(t){void 0===t&&(t=!0),this.ConsumeWhiteSpace();var e=this.data[this.index];if(34===e)return{type:"literal",id:this.id_counter++,position:this.index,value:this.ConsumeString()};if(e>=q&&e<=57||e===this.decimal_mark_char){var r=this.index,n=a(this.ConsumeNumber(),2),i=n[0],o=n[1];return{type:"literal",id:this.id_counter++,position:r,value:i,text:o}}if(123===e)return this.ConsumeArray();if(!t||45!==e&&43!==e){if(e>=65&&e<=90||e>=97&&e<=122||95===e||39===e||36===e||e>=192&&e<=312)return this.ConsumeToken(e)}else{var s=this.data[this.index+1];if(s>=q&&s<=57||s===this.decimal_mark_char){r=this.index;var l=a(this.ConsumeNumber(),2);return i=l[0],o=l[1],{type:"literal",id:this.id_counter++,position:r,value:i,text:o}}}return e},t.prototype.ConsumeArray=function(){var t={type:"array",id:this.id_counter++,values:[],position:this.index};this.index++;for(var e=0,r=0;this.index<this.length;){var n=this.ParseNext(),i=this.index;if("number"==typeof n)switch(this.index++,n){case 59:r++,e=0;break;case 44:e++;break;case 125:return t;default:this.valid&&(this.error="invalid character in array literal",this.error_position=i,this.valid=!1)}else switch(n.type){case"literal":t.values[e]||(t.values[e]=[]),t.values[e][r]=n.value;break;default:this.valid&&(this.error="invalid value in array literal",this.error_position=i,this.valid=!1)}}return t},t.prototype.ConsumeOperator=function(){var t,e;try{for(var r=o(W),n=r.next();!n.done;n=r.next()){var i=n.value;if(this.expression.substr(this.index,i.length)===i){var a=this.index;return this.index+=i.length,{type:"operator",id:this.id_counter++,operator:i,position:a}}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return null},t.prototype.ConsumeArguments=function(){this.index++;for(var t=0,e=[];this.index<this.length;){var r=this.ParseGeneric([this.argument_separator_char,41]);null!==r&&e.push(r);var n=this.data[this.index];if(n===this.argument_separator_char){this.index++,t++;for(var i=e.length;i<t;i++)e.push({type:"missing",id:this.id_counter++})}else if(41===n)return this.index++,e}return e},t.prototype.ConsumeToken=function(t){var e=[t],r=this.index,n=39===t;for(++this.index;this.index<this.length;this.index++){var i=this.data[this.index];if(!(i>=65&&i<=90||i>=97&&i<=122||i>=192&&i<=312||95===i||36===i||46===i||33===i||n||i>=q&&i<=57))break;e.push(i),39===i&&(n=!1)}var o=e.map((function(t){return String.fromCharCode(t)})).join("");if(n)return this.error="unbalanced single quote",this.error_position=r,this.valid=!1,{type:"identifier",id:this.id_counter++,name:o,position:r};if("true"===o.toLowerCase())return{type:"literal",id:this.id_counter++,value:!0,position:r};if("false"===o.toLowerCase())return{type:"literal",id:this.id_counter++,value:!1,position:r};if(this.ConsumeWhiteSpace(),40===this.data[this.index]){var a=this.ConsumeArguments();return{type:"call",id:this.id_counter++,name:o,args:a,position:r}}var s=this.ConsumeAddress(o,r);if(s)return s;var l={type:"identifier",id:this.id_counter++,name:o,position:r};return this.full_reference_list.push(l),l},t.prototype.ConsumeAddress=function(t,e){var r,n=e,i=t.length,o=t.split("!");o.length>1&&(e+=(r=o.slice(0,o.length-1).join("!")).length+1);var a=this.ConsumeAddressColumn(e);if(!a)return null;e=a.position;var s=this.ConsumeAddressRow(e);if(!s)return null;e=s.position;var l=r?r+t.substr(r.length,e-n).toUpperCase():t.substr(0,e-n).toUpperCase();r&&"'"===r[0]&&(r=r.substr(1,r.length-2));var u={type:"address",id:this.id_counter++,label:l,row:s.row,column:a.column,absolute_row:s.absolute,absolute_column:a.absolute,position:n,sheet:r};return i!==e-n?null:(this.dependencies.addresses[u.label]=u,this.address_refcount[u.label]=(this.address_refcount[u.label]||0)+1,this.full_reference_list.push(u),u)},t.prototype.ConsumeAddressRow=function(t){var e=36===this.data[t];e&&t++;for(var r=t,n=0;;t++){var i=this.data[t];if(!(i>=q&&i<=57))break;n*=10,n+=i-q}return r!==t&&{absolute:e,row:n-1,position:t}},t.prototype.ConsumeAddressColumn=function(t){var e=-1,r=0,n=36===this.data[t];for(n&&t++;;t++,r++){if(r>=4)return!1;var i=this.data[t];if(i>=65&&i<=90)e=26*(1+e)+(i-65);else{if(!(i>=97&&i<=122))break;e=26*(1+e)+(i-97)}}return!(e<0)&&{absolute:n,column:e,position:t}},t.prototype.ConsumeNumber=function(){for(var t=0,e=!1,r=!1,n=0,i=0,o=0,a="integer",s=0,l=this.index;this.index<this.length;this.index++,s++){var u=this.data[this.index];if(u===this.decimal_mark_char){if("integer"!==a)break;a="fraction"}else{if(37===u){n/=100,o/=100,this.index++;break}if(43===u||45===u){if(0!==s)break;45===u&&(r=!0)}else if(69===u||101===u){if("integer"!==a&&"fraction"!==a)break;a="exponent",this.index<this.length-1&&(43===this.data[this.index+1]?this.index++:45===this.data[this.index+1]&&(this.index++,e=!0))}else{if(!(u>=q&&u<=57))break;switch(a){case"integer":n=10*n+(u-q);break;case"fraction":o=10*o+(u-q),i++;break;case"exponent":t=10*t+(u-q)}}}}var c=n+o*Math.pow(10,-i);return"exponent"===a&&(c*=Math.pow(10,(e?-1:1)*t)),[r?-c:c,this.expression.substring(l,this.index)||""]},t.prototype.ConsumeString=function(){this.index++;for(var t=[];this.index<this.length;this.index++){var e=this.data[this.index];if(34===e&&(this.index++,this.index>=this.length||34!==this.data[this.index]))break;t.push(e)}return t.map((function(t){return String.fromCharCode(t)})).join("")},t.prototype.ConsumeWhiteSpace=function(){for(;this.index<this.length;){var t=this.data[this.index];if(32!==t&&9!==t&&10!==t&&13!==t&&160!==t)return;this.index++}},t}();!function(t){t[t.default=0]="default",t[t.quoted=1]="quoted"}(G||(G={})),(B=z||(z={}))[B.white=0]="white",B[B.gray=1]="gray",B[B.black=2]="black";var Y,Q=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.dirty=!1,e}return e(r,t),r}(function(){function t(){this.type=t.type,this.color=z.white,this.edges_in=[],this.edges_out=[]}return Object.defineProperty(t.prototype,"has_inbound_edges",{get:function(){return this.edges_in.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"has_outbound_edges",{get:function(){return this.edges_out.length>0},enumerable:!1,configurable:!0}),t.prototype.Reset=function(){var t,e,r,n;try{for(var i=o(this.edges_out),a=i.next();!a.done;a=i.next())a.value.RemoveDependency(this)}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}try{for(var s=o(this.edges_in),l=s.next();!l.done;l=s.next())l.value.RemoveDependent(this)}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.edges_out=[],this.edges_in=[]},t.prototype.ClearDependencies=function(){var t,e;try{for(var r=o(this.edges_in),n=r.next();!n.done;n=r.next())n.value.RemoveDependent(this)}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.edges_in=[]},t.prototype.AddDependent=function(t){var e,r;if(t!==this){try{for(var n=o(this.edges_out),i=n.next();!i.done;i=n.next())if(i.value===t)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.edges_out.push(t)}},t.prototype.RemoveDependent=function(t){this.edges_out=this.edges_out.filter((function(e){return e!==t}))},t.prototype.AddDependency=function(t){var e,r;if(t!==this){try{for(var n=o(this.edges_in),i=n.next();!i.done;i=n.next())if(i.value===t)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.edges_in.push(t)}},t.prototype.RemoveDependency=function(t){this.edges_in=this.edges_in.filter((function(e){return e!==t}))},t.prototype.LinkTo=function(t){this.AddDependent(t),t.AddDependency(this)},t.prototype.DependsOn=function(t){this.AddDependency(t),t.AddDependent(this)},t.prototype.LoopCheck=function(){var t,e;this.color=z.gray;try{for(var r=o(this.edges_out),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.color===z.gray||i.color===z.white&&i.LoopCheck())return this.color=z.white,!0}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return this.color=z.black,!1},t.type="vertex",t}());!function(t){t[t.None=0]="None",t[t.CalculationError=1]="CalculationError"}(Y||(Y={}));var K,X=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.error=Y.None,e.result=p(),e.expression={type:"missing",id:-1},e.expression_error=!1,e.short_circuit=!1,e.type=r.type,e}return e(r,t),Object.defineProperty(r.prototype,"array_head",{get:function(){return!!this.address&&!!this.reference&&!!this.reference.area&&this.reference.area.start.column===this.address.column&&this.reference.area.start.row===this.address.row},enumerable:!1,configurable:!0}),r.prototype.TakeReferenceValue=function(){this.reference&&(this.result=m(this.reference.GetValue()))},r.prototype.Calculate=function(t){var e,r,n,i,a,s;if(this.dirty)if(this.color===z.white&&this.LoopCheck()&&(this.dirty=!1,this.edges_in.length)){this.reference&&(this.array_head||this.reference.type===l.formula)&&this.reference.SetCalculationError("LOOP");try{for(var u=o(this.edges_out),c=u.next();!c.done;c=u.next())c.value.Calculate(t)}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}}else{try{for(var h=o(this.edges_in),f=h.next();!f.done;f=h.next())if(f.value.dirty)return}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}if(this.reference){if(this.reference.type===l.formula){this.short_circuit=!1;var d=t.CalculationCallback.call(t,this);if(this.result=d.value,this.short_circuit)return;d.volatile&&t.volatile_list.push(this)}else this.result=this.reference.GetValue4();if(this.array_head)t.SpreadCallback.call(t,this,this.result);else if(this.reference.type===l.formula){var p=Array.isArray(this.result)?this.result[0][0]:this.result;this.reference.SetCalculatedValue(p.value,p.type)}}else console.info("skip dirty constant? [or dangling...]");this.dirty=!1;try{for(var m=o(this.edges_out),v=m.next();!v.done;v=m.next())v.value.Calculate(t)}catch(t){a={error:t}}finally{try{v&&!v.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}},r.type="spreadsheet-vertex",r}(Q),tt=function(t){function r(e){var n=t.call(this)||this;return n.type=r.type,n.area=e.Clone(),r.list.push(n),n}return e(r,t),r.GetVertex=function(t){var e,n;try{for(var i=o(this.list),a=i.next();!a.done;a=i.next()){var s=a.value;if(s.area.start.sheet_id===t.start.sheet_id&&s.area.Equals(t))return[s,!1]}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return[new r(t),!0]},r.Clear=function(){this.list=[]},r.GetContainingArrays=function(t){var e,r,n=[];try{for(var i=o(this.list),a=i.next();!a.done;a=i.next()){var s=a.value;s.area.start.sheet_id===t.sheet_id&&s.area.Contains(t)&&n.push(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},r.CreateImplicitEdges=function(t,e){var r,n;try{for(var i=o(this.list),a=i.next();!a.done;a=i.next()){var s=a.value;s.area.start.sheet_id===e.sheet_id&&s.area.Contains(e)&&s.DependsOn(t)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},r.prototype.RemoveDependent=function(e){var n=this;t.prototype.RemoveDependent.call(this,e),this.edges_out.length||(this.Reset(),r.list=r.list.filter((function(t){return t!==n})))},r.prototype.Calculate=function(t){var e,r,n,i,a,s;if(this.dirty)if(this.color===z.white&&this.LoopCheck()&&(this.dirty=!1,this.edges_in.length))try{for(var l=o(this.edges_out),u=l.next();!u.done;u=l.next())u.value.Calculate(t)}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}else{try{for(var c=o(this.edges_in),h=c.next();!h.done;h=c.next())if(h.value.dirty)return}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}this.dirty=!1;try{for(var f=o(this.edges_out),d=f.next();!d.done;d=f.next())d.value.Calculate(t)}catch(t){a={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}}},r.type="array-vertex",r.list=[],r}(Q);!function(t){t[t.OK=0]="OK",t[t.Loop=1]="Loop",t[t.CalculationError=2]="CalculationError"}(K||(K={}));var et,rt=function(){function t(){this.vertices=[[]],this.volatile_list=[],this.cells_map={},this.leaf_vertices=[],this.dirty_list=[],this.loop_check_required=!1}return t.prototype.IsSpreadsheetVertex=function(t){return t.type===X.type},t.prototype.AttachData=function(t){var e,r;this.model=t,this.cells_map={};try{for(var n=o(t.sheets),i=n.next();!i.done;i=n.next()){var a=i.value;this.cells_map[a.id]=a.cells}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.FlushTree=function(){this.dirty_list=[],this.volatile_list=[],this.vertices=[[]],this.leaf_vertices=[],this.cells_map={},tt.Clear()},t.prototype.ResolveArrayHead=function(t){if(!t.sheet_id)throw new Error("resolve array head with no sheet id");var e=this.cells_map[t.sheet_id];if(!e)throw new Error("no cells? sheet id "+t.sheet_id);var r=e.data[t.row];if(r){var n=r[t.column];if(n&&n.area){var i={row:n.area.start.row,column:n.area.start.column,sheet_id:t.sheet_id};return console.info("array head",t,i),i}}return t},t.prototype.GetVertex=function(t,e){if(!t.sheet_id)throw new Error("getvertex with no sheet id");var r=this.cells_map[t.sheet_id];if(!r)throw new Error("no cells? sheet id "+t.sheet_id);if(!this.vertices[t.sheet_id]){if(!e)return;this.vertices[t.sheet_id]=[]}if(this.vertices[t.sheet_id][t.column]){var n=this.vertices[t.sheet_id][t.column][t.row];if(n)return n;if(!e)return}else{if(!e)return;this.vertices[t.sheet_id][t.column]=[]}var i=new X;return i.address={row:t.row,column:t.column,absolute_row:t.absolute_row,absolute_column:t.absolute_column,sheet_id:t.sheet_id},i.reference=r.EnsureCell(t),this.vertices[t.sheet_id][t.column][t.row]=i,tt.CreateImplicitEdges(i,t),i},t.prototype.RemoveVertex=function(t){if(!t.sheet_id)throw new Error("removevertex with no sheet id");var e=this.GetVertex(t,!1);e&&(e.Reset(),this.vertices[t.sheet_id][t.column][t.row]=void 0)},t.prototype.ResetVertex=function(t){var e=this.GetVertex(t,!1);e&&e.Reset()},t.prototype.ResetInbound=function(t,e,r,n){var i,a;void 0===e&&(e=!1),void 0===r&&(r=!0),void 0===n&&(n=!1);var s=this.GetVertex(t,r);if(s)s.ClearDependencies(),e&&this.SetVertexDirty(s),n&&this.RemoveVertex(t);else if(e){var l=tt.GetContainingArrays(t);try{for(var u=o(l),c=u.next();!c.done;c=u.next()){var h=c.value;this.SetVertexDirty(h)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}}},t.prototype.ResetLoopState=function(){var t,e,r,n,i,a,s,l;try{for(var u=o(this.vertices),c=u.next();!c.done;c=u.next()){var h=c.value;if(h)try{for(var f=(r=void 0,o(h)),d=f.next();!d.done;d=f.next()){var p=d.value;if(p)try{for(var m=(i=void 0,o(p)),v=m.next();!v.done;v=m.next())(g=v.value)&&(g.color=z.white)}catch(t){i={error:t}}finally{try{v&&!v.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var y=o(this.leaf_vertices),_=y.next();!_.done;_=y.next()){var g;(g=_.value).edges_in.length&&(g.color=z.white)}}catch(t){s={error:t}}finally{try{_&&!_.done&&(l=y.return)&&l.call(y)}finally{if(s)throw s.error}}},t.prototype.LoopCheck=function(){var t,e,r,n,i,a,s,l,u=this;if(!this.loop_check_required)return!1;var c=[];try{for(var h=o(this.vertices),f=h.next();!f.done;f=h.next()){var d=f.value;if(d)try{for(var p=(r=void 0,o(d)),m=p.next();!m.done;m=p.next()){var v=m.value;if(v)try{for(var y=(i=void 0,o(v)),_=y.next();!_.done;_=y.next())(x=_.value)&&(x.color=z.white,c.push(x))}catch(t){i={error:t}}finally{try{_&&!_.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{m&&!m.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{f&&!f.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}var g=function(t){var e,r;t.color=z.gray;try{for(var n=o(t.edges_out),i=n.next();!i.done;i=n.next()){var a=i.value;if(a.color===z.gray)return u.loop_hint=u.RenderAddress(t.address),console.info("loop detected @",u.loop_hint),!0;if(a.color===z.white&&g(a))return!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t.color=z.black,!1};try{for(var w=o(c),b=w.next();!b.done;b=w.next()){var x;if((x=b.value).color===z.white&&g(x))return!0}}catch(t){s={error:t}}finally{try{b&&!b.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}return this.loop_check_required=!1,this.loop_hint=void 0,!1},t.prototype.RenderAddress=function(t){var e,r;if(!t)return"undefined";var n="";if(t.sheet_id&&this.model)try{for(var i=o(this.model.sheets),a=i.next();!a.done;a=i.next()){var s=a.value;if(t.sheet_id===s.id){n=s.name+"!";break}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n+new u(t).spreadsheet_label},t.prototype.AddArrayEdge=function(t,e){var r,n;if(!t.start.sheet_id)throw new Error("AddArrayEdge called without sheet ID");var i=this.GetVertex(e,!0),s=a(tt.GetVertex(t),2),l=s[0],u=s[1];if(i.DependsOn(l),this.loop_check_required=!0,u){var c=this.vertices[t.start.sheet_id];if(c)if(t.entire_row){for(var h=0;h<c.length;h++)if(c[h])for(var f=t.start.row;f<=t.end.row;f++)(m=c[h][f])&&l.DependsOn(m);console.groupEnd()}else if(t.entire_column){for(h=t.start.column;h<=t.end.column;h++)if(c[h])try{for(var d=(r=void 0,o(c[h])),p=d.next();!p.done;p=d.next())(null==(m=p.value)?void 0:m.address)&&l.DependsOn(m)}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}console.groupEnd()}else for(f=t.start.row;f<=t.end.row;f++)for(h=t.start.column;h<=t.end.column;h++){var m;(m=c[h][f])&&l.DependsOn(m)}}},t.prototype.AddEdge=function(t,e){var r=this.GetVertex(t,!0);this.GetVertex(e,!0).DependsOn(r),r.reference&&r.reference.area&&!r.array_head&&this.AddEdge(n(n({},t),{row:r.reference.area.start.row,column:r.reference.area.start.column}),t),this.loop_check_required=!0},t.prototype.RemoveEdge=function(t,e){var r=this.GetVertex(t,!1),n=this.GetVertex(e,!1);r&&n&&(r.RemoveDependent(n),n.RemoveDependency(r))},t.prototype.SetAreaDirty=function(t){if(t.start.column===1/0||t.end.column===1/0||t.start.row===1/0||t.end.row===1/0)throw new Error("don't iterate over infinite area");var e=t.start.sheet_id;if(!e)throw new Error("invalid area, missing sheet id");for(var r=t.start.column;r<=t.end.column;r++)for(var n=t.start.row;n<=t.end.row;n++){var i={row:n,column:r,sheet_id:e};this.GetVertex(i,!1)&&this.SetDirty(i)}},t.prototype.SetVertexDirty=function(t){var e,r;if(!t.dirty){this.dirty_list.push(t),t.dirty=!0;try{for(var n=o(t.edges_out),i=n.next();!i.done;i=n.next()){var a=i.value;this.SetVertexDirty(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}},t.prototype.SetDirty=function(t){var e=this.GetVertex(t,!0);this.SetVertexDirty(e)},t.prototype.AddLeafVertex=function(t){var e,r;try{for(var n=o(this.leaf_vertices),i=n.next();!i.done;i=n.next())if(i.value===t)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.leaf_vertices.push(t)},t.prototype.RemoveLeafVertex=function(t){this.leaf_vertices=this.leaf_vertices.filter((function(e){return e!==t}))},t.prototype.AddLeafVertexEdge=function(t,e){var r=this.GetVertex(t,!0);return e.DependsOn(r),K.OK},t.prototype.RemoveLeafVertexEdge=function(t,e){var r=this.GetVertex(t,!1);r&&(r.RemoveDependent(e),e.RemoveDependency(r))},t.prototype.InitializeGraph=function(){var t,e;try{for(var r=o(this.dirty_list),n=r.next();!n.done;n=r.next()){var i=n.value;this.IsSpreadsheetVertex(i)&&(i.TakeReferenceValue(),this.CheckVolatile(i)&&this.volatile_list.push(i)),i.dirty=!1}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.dirty_list=[]},t.prototype.Recalculate=function(){var t,e,r,n;try{for(var i=o(this.volatile_list),a=i.next();!a.done;a=i.next()){var s=a.value;this.SetVertexDirty(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}var l=this.dirty_list.slice(0);this.volatile_list=[],this.dirty_list=[],this.loop_check_required&&(this.ResetLoopState(),this.loop_check_required=!1);try{for(var u=o(l),c=u.next();!c.done;c=u.next())(s=c.value).Calculate(this)}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}},t}();!function(t){t.Argument="ARG",t.Data="DATA",t.Reference="REF",t.Name="NAME",t.Expression="EXPR",t.Value="VALUE",t.Unknown="UNK",t.NotImpl="NOTIMPL",t.Div0="DIV/0",t.NA="N/A"}(et||(et={}));var nt,it={error:et.NotImpl},ot=function(){return{type:l.error,value:et.Expression}},at=function(){return{type:l.error,value:et.Data}},st=function(){return{type:l.error,value:et.Div0}},lt=function(){return{type:l.error,value:et.Argument}},ut=function(){return{type:l.error,value:et.Value}},ct=function(){return{type:l.error,value:et.Reference}},ht=function(){return{type:l.error,value:et.Name}},ft=function(){return{type:l.error,value:et.Unknown}};!function(t){t[t.value=0]="value",t[t.reference=1]="reference"}(nt||(nt={}));var dt,pt=function(t,e){if(t.type===l.error)return[0,0,t];if(e.type===l.error)return[0,0,e];var r=[0,0];switch(t.type){case l.number:r[0]=t.value;break;case l.boolean:r[0]=t.value?1:0;break;case l.undefined:break;default:return[0,0,ut()]}switch(e.type){case l.number:r[1]=e.value;break;case l.boolean:r[1]=e.value?1:0;break;case l.undefined:break;default:return[0,0,ut()]}return r},mt=function(t,e){var r=a(pt(t,e),3),n=r[0],i=r[1];return r[2]||{value:n+i,type:l.number}},vt=function(t,e){var r=a(pt(t,e),3),n=r[0],i=r[1];return r[2]||{value:n-i,type:l.number}},yt=function(t,e){var r=a(pt(t,e),3),n=r[0],i=r[1];return r[2]||{value:Math.pow(n,i),type:l.number}},_t=function(t,e){var r=a(pt(t,e),3),n=r[0],i=r[1];return r[2]||{value:n*i,type:l.number}},gt=function(t,e){var r=a(pt(t,e),3),n=r[0],i=r[1];return r[2]||(0===i?st():{value:n/i,type:l.number})},wt=function(t,e){var r=a(pt(t,e),3),n=r[0],i=r[1];return r[2]||(0===i?st():{value:n%i,type:l.number})},bt=function(t,e){return t.type===l.error?t:e.type===l.error?e:{type:l.string,value:""+(t.type===l.undefined?"":t.value)+(e.type===l.undefined?"":e.value)}},xt=function(t,e){return t.type===l.error?t:e.type===l.error?e:t.type===l.undefined&&(""===e.value||0===e.value)||e.type===l.undefined&&(""===t.value||0===t.value)?{type:l.boolean,value:!0}:{type:l.boolean,value:t.value==e.value}},Mt=function(t,e){return t.type===l.error?t:e.type===l.error?e:t.type===l.undefined&&(""===e.value||0===e.value)||e.type===l.undefined&&(""===t.value||0===t.value)?{type:l.boolean,value:!1}:{type:l.boolean,value:t.value!=e.value}},Ct=function(t,e){return t.type===l.error?t:e.type===l.error?e:{type:l.boolean,value:(t.value||0)>(e.value||0)}},St=function(t,e){return t.type===l.error?t:e.type===l.error?e:{type:l.boolean,value:t.value>=e.value}},At=function(t,e){return t.type===l.error?t:e.type===l.error?e:{type:l.boolean,value:t.value<e.value}},Rt=function(t,e){return t.type===l.error?t:e.type===l.error?e:{type:l.boolean,value:t.value<=e.value}},kt=function(t){return!Array.isArray(t)&&t.type===l.object&&!!t.value.type},Tt=function(t){return!Array.isArray(t)&&t.type===l.object&&"metadata"===t.value.type},Pt=function(){function t(t,e){this.library=t,this.parser=e,this.context={address:{row:-1,column:-1},volatile:!1,call_index:0},this.call_index=0,this.cells_map={},this.sheet_name_map={},this.named_range_map={}}return t.prototype.SetModel=function(t){var e,r;this.cells_map={},this.sheet_name_map={};try{for(var n=o(t.sheets),i=n.next();!i.done;i=n.next()){var a=i.value;this.cells_map[a.id]=a.cells,this.sheet_name_map[a.name.toLowerCase()]=a.id}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.data_model=t,this.named_range_map=t.named_ranges.Map(),this.context.model=t},t.prototype.Calculate=function(t,e,r){return void 0===r&&(r=!1),r||(this.context.address=e,this.context.volatile=!1,this.context.call_index=0,this.call_index=0),{value:this.CalculateExpression(t),volatile:this.context.volatile}},t.prototype.CellFunction2=function(t){if(!t.sheet_id){if(!t.sheet)return function(){return ct()};t.sheet_id=this.sheet_name_map[t.sheet.toLowerCase()]}var e=this.cells_map[t.sheet_id];if(!e)return console.warn("missing cells reference @ "+t.sheet_id),function(){return ct()};var r=e.GetCell(t);return r?function(){return r.GetValue4()}:function(){return{type:l.undefined,value:void 0}}},t.prototype.CellFunction4=function(t,e){if(!t.sheet_id)throw new Error("missing sheet id in CellFunction4");return this.cells_map[t.sheet_id].GetRange4(t,e,!0)},t.prototype.GetMetadata=function(t,e){var r,i,a,s,u,c;switch(t.type){case"address":u=t;break;case"range":c=t;break;case"identifier":var h=this.named_range_map[t.name.toUpperCase()];h&&(1===h.count?u=h.start:c=h);break;case"call":var f=this.CalculateExpression(t,!0);if(!kt(f))return f;if("address"===f.value.type)u=f.value;else{if("range"!==f.value.type)return f;c=f.value}break;default:return this.CalculateExpression(t)}if(u){var d=this.data_model.active_sheet;if(u.sheet_id&&u.sheet_id!==d.id)try{for(var p=o(this.data_model.sheets),m=p.next();!m.done;m=p.next())if((w=m.value).id===u.sheet_id){d=w;break}}catch(t){r={error:t}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}var v=(S=d.CellData(u)).calculated_type?S.calculated:S.value,y=n({type:"metadata",address:n({},u),value:v,format:S.style?S.style.number_format:void 0},e(S,u));return{type:l.object,value:y}}if(c){if(c.start.row===1/0||c.start.column===1/0)return ct();if(d=this.data_model.active_sheet,c.start.sheet_id&&c.start.sheet_id!==d.id)try{for(var _=o(this.data_model.sheets),g=_.next();!g.done;g=_.next()){var w;if((w=g.value).id===c.start.sheet_id){d=w;break}}}catch(t){a={error:t}}finally{try{g&&!g.done&&(s=_.return)&&s.call(_)}finally{if(a)throw a.error}}for(var b=[],x=c.start.column;x<=c.end.column;x++){for(var M=[],C=c.start.row;C<=c.end.row;C++){var S=d.CellData({row:C,column:x});u=n(n({},c.start),{row:C,column:x}),v=S.calculated_type?S.calculated:S.value,y=n({type:"metadata",address:u,value:v,format:S.style?S.style.number_format:void 0},e(S,u)),M.push({type:l.object,value:y})}b.push(M)}return b}return this.CalculateExpression(t)},t.prototype.RewriteMacro=function(t,e){var r,n=this;switch(t.type){case"identifier":if(r=e[t.name.toUpperCase()])return JSON.parse(JSON.stringify(r));break;case"binary":t.left=this.RewriteMacro(t.left,e),t.right=this.RewriteMacro(t.right,e);break;case"unary":t.operand=this.RewriteMacro(t.operand,e);break;case"group":t.elements=t.elements.map((function(t){return n.RewriteMacro(t,e)}));break;case"call":t.args=t.args.map((function(t){return n.RewriteMacro(t,e)}))}return t},t.prototype.CallMacro=function(t,e){var r,n=this;if(!e.expression)return function(){return ot()};var i=JSON.stringify(e.expression),o={},a=(null===(r=e.argument_names)||void 0===r?void 0:r.map((function(t){return t.toUpperCase()})))||[];return function(t){for(var e=JSON.parse(i),r=0;r<a.length;r++)o[a[r]]=t.args[r]||{type:"missing"};return n.CalculateExpression(n.RewriteMacro(e,o))}},t.prototype.CallExpression=function(t,e){var r=this;void 0===e&&(e=!1);var n=this.library.Get(t.name);return n?function(i){var o=r.call_index++;r.context.volatile=r.context.volatile||!!n.volatile;var a,s="if"===t.name.toLowerCase(),u=-1,c=n.arguments||[],h=i.args.map((function(t,e){if(!a){var n=c[Math.min(e,c.length-1)]||{};if(e===u)return n.boxed?p():void 0;if(void 0===t)return s&&0===e&&(u=1),n.boxed?p():void 0;if(n.address)return n.boxed?{type:l.string,value:r.parser.Render(t).replace(/\$/g,"")}:r.parser.Render(t).replace(/\$/g,"");if(n.metadata)return r.GetMetadata(t,(function(){return{}}));var i=r.CalculateExpression(t);if(!Array.isArray(i)&&i.type===l.error)return n.allow_error?i:void(a=i);if(s&&0===e&&!Array.isArray(i)){var o=!1;if(i.type===l.string){var h=i.value.toLowerCase().trim();o="false"!==h&&"f"!==h}else o=!!i.value;u=o?2:1}return n.boxed?i:Array.isArray(i)?i.map((function(t){return t.map((function(t){return t.value}))})):i.value}}));if(a)return a;if(r.context.call_index=o,n.return_type===nt.reference){var f=n.fn.apply(null,h);if(e)return f;if(kt(f)){if("address"===f.value.type)return r.CellFunction2(f.value)();if("range"===f.value.type)return r.CellFunction4(f.value.start,f.value.end)}return f}return n.fn.apply(null,h)}:function(){return ht()}},t.prototype.UnaryExpression=function(t){var e=this;switch(t.operator){case"+":return function(t){return e.CalculateExpression(t.operand)};case"-":var r=vt,n={type:l.number,value:0};return function(t){var i=e.CalculateExpression(t.operand);return Array.isArray(i)?i.map((function(t){return t.map((function(t){return r(n,t)}))})):r(n,i)};default:return function(){return console.warn("unexpected unary operator:",t.operator),ot()}}},t.prototype.RecycleArray=function(t,e,r){var n,i;if(t[0].length<r){var a=t[0].length;try{for(var s=o(t),l=s.next();!l.done;l=s.next())for(var u=l.value,c=a;c<r;c++)u[c]=u[c%a]}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}if(t.length<e)for(var h=a=t.length;h<e;h++)t[h]=t[h%a].slice(0);return t},t.prototype.ElementwiseBinaryExpression=function(t,e,r){var n=Math.max(e.length,r.length),i=Math.max(e[0].length,r[0].length);e=this.RecycleArray(e,n,i),r=this.RecycleArray(r,n,i);for(var o=[],a=0;a<n;a++){for(var s=[],l=0;l<i;l++)s[l]=t(e[a][l],r[a][l]);o.push(s)}return o},t.prototype.BinaryExpression=function(t){var e=this,r=function(t){switch(t){case"&":return bt;case"+":return mt;case"-":return vt;case"*":return _t;case"/":return gt;case"^":case"**":return yt;case"%":return wt;case"=":case"==":return xt;case"!=":case"<>":return Mt;case">":return Ct;case">=":return St;case"<":return At;case"<=":return Rt}}(t.operator);return r?function(t){var n=e.CalculateExpression(t.left),i=e.CalculateExpression(t.right);return Array.isArray(n)?Array.isArray(i)?e.ElementwiseBinaryExpression(r,n,i):e.ElementwiseBinaryExpression(r,n,[[i]]):Array.isArray(i)?e.ElementwiseBinaryExpression(r,[[n]],i):r(n,i)}:function(){return console.info("(unexpected binary operator: "+t.operator+")"),ot()}},t.prototype.Identifier=function(t){var e=this,r=t.name,n=r.toUpperCase();switch(n){case"FALSE":case"F":return function(){return{value:!1,type:l.boolean}};case"TRUE":case"T":return function(){return{value:!0,type:l.boolean}};case"UNDEFINED":return function(){return{value:void 0,type:l.undefined}}}return function(){var t=e.named_range_map[n];return t?1===t.count?e.CellFunction4(t.start,t.start):e.CellFunction4(t.start,t.end):(console.info("** identifier",r),ht())}},t.prototype.GroupExpression=function(t){var e=this;return t.elements&&1===t.elements.length?function(t){return e.CalculateExpression(t.elements[0])}:(console.warn("Can't handle group !== 1"),function(){return ot()})},t.prototype.CalculateExpression=function(t,e){var r=this;if(void 0===e&&(e=!1),t.user_data)return t.user_data(t);switch(t.type){case"call":var n=this.data_model.macro_functions[t.name.toUpperCase()];return n?(t.user_data=this.CallMacro(t,n))(t):(t.user_data=this.CallExpression(t,e))(t);case"address":return(t.user_data=this.CellFunction2(t))();case"range":return(t.user_data=function(t){return r.CellFunction4(t.start,t.end)})(t);case"binary":return(t.user_data=this.BinaryExpression(t))(t);case"unary":return(t.user_data=this.UnaryExpression(t))(t);case"identifier":return(t.user_data=this.Identifier(t))();case"missing":return(t.user_data=function(){return{value:void 0,type:l.undefined}})();case"literal":var i={value:t.value,type:h(t.value)};return(t.user_data=function(){return i})();case"group":return(t.user_data=this.GroupExpression(t))(t);case"array":return(t.user_data=function(){return t.values.map((function(t){return(Array.isArray(t)?t:[t]).map((function(t){return{value:t,type:h(t)}}))}))})();default:return console.warn("Unhandled parse expr:",t),ft()}},t}(),Nt=function(t){for(var e=[],r=t.length,n=t[0].length,i=0;i<n;i++){e[i]=[];for(var o=0;o<r;o++)e[i][o]=t[o][i]}return e},Et=function(t){return Array.isArray(t)?t.reduce((function(t,e){return void 0===e?t:Array.isArray(e)?t.concat(Et(e)):e instanceof Float32Array||e instanceof Float64Array?t.concat(Array.from(e)):t.concat([e])}),[]):[t]},Dt=function(t){return function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return Array.isArray(e)?e.map((function(e){return e.map((function(e){return t.apply(void 0,s([e],a(r)))}))})):t.apply(void 0,s([e],a(r)))}},Ot=function(t){return function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return Array.isArray(e)?Array.isArray(r)?e.map((function(e,i){return e.map((function(e,o){return t.apply(void 0,s([e,r[i][o]],a(n)))}))})):e.map((function(e){return e.map((function(e){return t.apply(void 0,s([e,r],a(n)))}))})):t.apply(void 0,s([e,r],a(n)))}},Ft=function(){function t(){this.functions={}}return t.prototype.Register=function(){for(var t,e,r,n,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];try{for(var s=o(i),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(r=void 0,o(Object.keys(u))),h=c.next();!h.done;h=c.next()){var f=h.value;if(/[^a-zA-Z0-9._]/.test(f))throw new Error("invalid function name (invalid character)");if(f.length>255)throw new Error("invalid function name (too long, > 255)");if(/^[^a-zA-Z]/.test(f))throw new Error("invalid function name (start with an ascii letter)");var d=f.toLowerCase();if(this.functions[d])throw new Error("function name ("+d+") is already in use");var p=u[f];p.canonical_name=f,this.functions[d]=p}}catch(t){r={error:t}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}},t.prototype.Get=function(t){var e=t.toLowerCase();return this.functions[e]},t.prototype.List=function(){var t,e,r={};try{for(var n=o(Object.keys(this.functions)),i=n.next();!i.done;i=n.next()){var a=i.value;r[a]=this.functions[a]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},t.prototype.Alias=function(t,e){var r,i=this.Get(e);if(!i)throw new Error("referenced function "+e+" does not exist");this.Register(((r={})[t]=n({},i),r))},t}();!function(t){t[t.move=0]="move",t[t.line=1]="line"}(dt||(dt={}));var It,Lt,Ut,Vt,jt=function(){function t(){}return t.UnpackValues=function(t){var e=this;if(Array.isArray(t)){var r=t[0];return Array.isArray(r)||r instanceof Float64Array||r instanceof Float32Array?t.reduce((function(t,r){return t.concat(e.UnpackValues(r))}),[]):t.map((function(t){return isNaN(t)?void 0:t}))}if(t instanceof Float32Array||t instanceof Float64Array)return Array.prototype.slice.call(t);if(t&&"object"==typeof t){var n=Object.keys(t).length;if(void 0!==t[0]&&void 0!==t[(n-1).toString()]){for(var i=[],o=0;o<n;o++)i[o]=t[o.toString()];return i}}return[]},t.SparklineCommon=function(t,e){var r,n=[],i=(null===(r=e.text)||void 0===r?void 0:r.text)||this.default_color,o=[i,i];return Array.isArray(t.calculated)&&(n=this.UnpackValues(t.calculated[0]),"string"==typeof t.calculated[1]&&(o[0]=t.calculated[1]),"string"==typeof t.calculated[2]&&(o[1]=t.calculated[2])),{values:n,colors:o}},t.RenderLine=function(t,e,r,n,i){var o=this.SparklineCommon(n,i),a=o.values,s=o.colors,l=1;Array.isArray(n.calculated)&&"number"==typeof n.calculated[2]&&(l=n.calculated[2]);for(var u=0,c=0,h=-1,f=0;f<a.length;f++)"number"==typeof(_=a[f])&&(h>=0?(u=Math.min(u,_),c=Math.max(c,_)):(h=f,u=c=_));if(u!==c){var d=.9*t/(a.length-1),p=c-u,m=.8*e,v=.1*e;r.strokeStyle=s[0],r.lineWidth=l,r.lineCap="round",r.lineJoin="round",r.beginPath();var y=dt.move;for(f=h;f<a.length;f++){var _;if("number"==typeof(_=a[f])){var g=.05*t+d*f,w=e-(_-u)*m/p-v;y===dt.move?(r.moveTo(g,w),y=dt.line):r.lineTo(g,w)}else y=dt.move}r.stroke()}},t.RenderColumn=function(t,e,r,n,i){var a,s,l=this.SparklineCommon(n,i),u=l.values,c=l.colors,h=0,f=0,d=!1;try{for(var p=o(u),m=p.next();!m.done;m=p.next())"number"==typeof(A=m.value)&&(d?(h=Math.min(h,A),f=Math.max(f,A)):(d=!0,h=f=A))}catch(t){a={error:t}}finally{try{m&&!m.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}if(u.length){var v=(t-6-2)/(u.length-1),y=e-5;if(h!==f)if(h<0&&f>0){for(var _=2.5+f/(C=f-h)*y,g=0;g<u.length;g++)if("number"==typeof(A=u[g])){var w=3+g*v,b=Math.abs(A)/C*y;if(A>=0){r.fillStyle=c[0];var x=_-b;r.fillRect(w+2,x,v-2,b)}else{r.fillStyle=c[1];var M=_;r.fillRect(w+2,M,v-2,b)}}}else if(f>0){r.fillStyle=c[0];var C=f-h;for(g=0;g<u.length;g++)if("number"==typeof(A=u[g])){w=3+g*v;var S=e-2.5-(b=Math.max(1,(A-h)/C*y));r.fillRect(w+2,S,v-2,b)}}else for(r.fillStyle=c[1],C=f-h,g=0;g<u.length;g++){var A;"number"==typeof(A=u[g])&&(w=3+g*v,b=Math.max(1,Math.abs(f-A)/C*y),r.fillRect(w+2,2.5,v-2,b))}}},t.default_color="#888",t}(),Gt=function(t){var e=1/(1+.3275911*(t=Math.abs(t)));return 1-((((1.061405429*e-1.453152027)*e+1.421413741)*e-.284496736)*e+.254829592)*e*Math.exp(-1*t*t)},zt=function(t){if(.5===t)return 0;var e=t<1&&t>.5?1-t:t,r=Math.sqrt(Math.log(1/Math.pow(e,2))),n=r-(2.515517+.802853*r+.010328*Math.pow(r,2))/(1+1.432788*r+.189269*Math.pow(r,2)+.001308*Math.pow(r,3));return t>.5?n:-n},Bt={type:l.boolean,value:!0},Jt={type:l.boolean,value:!1},qt={Rand:{volatile:!0,fn:function(){return{type:l.number,value:Math.random()}}},RandBetween:{arguments:[{name:"min"},{name:"max"}],volatile:!0,fn:function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),t>e){var r=t;t=e,e=r}return{type:l.number,value:Math.random()*(e-t)+t}}},Sum:{description:"Adds arguments and ranges",arguments:[{boxed:!0,name:"values or ranges"}],fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=0,a=Et(r);try{for(var s=o(a),u=s.next();!u.done;u=s.next()){var c=u.value;switch(c.type){case l.number:i+=c.value;break;case l.boolean:i+=c.value?1:0;break;case l.error:return c}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return{type:l.number,value:i}}},Now:{description:"Returns current time",volatile:!0,fn:function(){return{type:l.number,value:k((new Date).getTime())}}},Today:{description:"Returns current day",volatile:!0,fn:function(){var t=new Date;return t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setHours(12),{type:l.number,value:k(t.getTime())}}},IfError:{description:"Returns the original value, or the alternate value if the original value contains an error",arguments:[{name:"original value",allow_error:!0,boxed:!0},{name:"alternate value"}],fn:function(t,e){return void 0===e&&(e=0),t&&t.type===l.error?{value:e,type:h(e)}:t}},IsError:{description:"Checks if another cell contains an error",arguments:[{name:"reference",allow_error:!0,boxed:!0}],fn:function(t){var e,r;if(Array.isArray(t)){var n=Et(t);try{for(var i=o(n),a=i.next();!a.done;a=i.next())if(a.value.type===l.error)return{type:l.boolean,value:!0}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}else if(t)return{type:l.boolean,value:t.type===l.error};return{type:l.boolean,value:!1}}},Cell:{description:"Returns data about a cell",arguments:[{name:"type",description:"Type of data to return"},{name:"reference",description:"Cell reference",metadata:!0}],fn:function(t,e){if(!Tt(e))return ct();if(t)switch(t.toString().toLowerCase()){case"format":return e.value.format?{type:l.string,value:e.value.format}:ct();case"address":return{type:l.string,value:e.value.address.label.replace(/\$/g,"")}}return{type:l.error,value:it.error}}},Year:{description:"Returns year from date",arguments:[{name:"date"}],fn:function(t){return m(new Date(R(t)).getUTCFullYear())}},Month:{description:"Returns month from date",arguments:[{name:"date"}],fn:function(t){return m(new Date(R(t)).getUTCMonth()+1)}},Day:{description:"Returns day of month from date",arguments:[{name:"date"}],fn:function(t){return m(new Date(R(t)).getUTCDate())}},Radians:{description:"Converts degrees to radians",arguments:[{name:"Degrees",description:"Angle in degrees"}],fn:Dt((function(t){return m(t*Math.PI/180)}))},Degrees:{description:"Converts radians to degrees",arguments:[{name:"Radians",description:"Angle in radians"}],fn:Dt((function(t){return m(t/Math.PI*180)}))},CountA:{description:"Counts cells that are not empty",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m(Et(t).reduce((function(t,e){return void 0===e?t:t+1}),0))}},Count:{description:"Counts cells that contain numbers",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m(Et(t).reduce((function(t,e){return"number"==typeof e?t+1:t}),0))}},Or:{fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=!1;r=Et(r);try{for(var a=o(r),s=a.next();!s.done;s=a.next()){var l=s.value;i=i||!!l}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return m(i)}},And:{fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=!0;r=Et(r);try{for(var a=o(r),s=a.next();!s.done;s=a.next()){var l=s.value;i=i&&!!l}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return m(i)}},Not:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?lt():1===t.length?m(!t[0]):m(!0)}},If:{arguments:[{name:"test value",boxed:!0},{name:"value if true",boxed:!0,allow_error:!0},{name:"value if false",boxed:!0,allow_error:!0}],fn:function(t,e,r){return void 0===e&&(e=Bt),void 0===r&&(r=Jt),Array.isArray(t)?t.map((function(t,n){return t.map((function(t,i){return(d(t)?"false"!==t.value.toLowerCase()&&"f"!==t.value.toLowerCase():t.value)?Array.isArray(e)?e[n][i]:e:Array.isArray(r)?r[n][i]:r}))})):(d(t)?"false"!==t.value.toLowerCase()&&"f"!==t.value.toLowerCase():t.value)?e:r}},Power:{fn:Ot((function(t,e){return m(Math.pow(t,e))}))},Mod:{fn:Ot((function(t,e){return e?m(t%e):st()}))},Sort:{arguments:[{name:"values"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(t=Et(t)).every((function(t){return"number"==typeof t}))?t.sort((function(t,e){return t-e})):t.sort(),[t.map((function(t){return m(t)}))]}},Transpose:{description:"Returns transpose of input matrix",arguments:[{name:"matrix",boxed:!0}],fn:function(t){return Array.isArray(t)?Nt(t):t}},Max:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.max.apply(0,Et(t).filter((function(t){return"number"==typeof t})))}}},Min:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.min.apply(0,Et(t).filter((function(t){return"number"==typeof t})))}}},SumProduct:{description:"Returns the sum of pairwise products of two or more ranges",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.map((function(t){return Et(t)})),n=Math.max.apply(0,r.map((function(t){return t.length}))),i=0,o=function(t){i+=r.reduce((function(e,r){return e*(r[t]||0)}),1)},a=0;a<n;a++)o(a);return{type:l.number,value:i}}},VLookup:{fn:function(t,e,r,n){if(void 0===n&&(n=!0),r=Math.max(0,r-1),n){for(var i=Math.abs(t-e[0][0]),o=e[r][0],a=1;a<e[0].length;a++){var s=Math.abs(e[0][a]-t);s<i&&(i=s,o=e[r][a])}return m(o)}for(a=1;a<e[0].length;a++)if(e[0][a]==t)return e[r][a];return{type:l.error,value:et.NA}}},Product:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Et(t).reduce((function(t,e){return void 0===e?t:t*Number(e)}),1)}}},Log:{fn:Ot((function(t,e){return void 0===e&&(e=10),{type:l.number,value:Math.log(t)/Math.log(e)}}))},Log10:{fn:Dt((function(t){return{type:l.number,value:Math.log(t)/Math.log(10)}}))},Ln:{fn:Dt((function(t){return{type:l.number,value:Math.log(t)}}))},Round:{fn:Ot((function(t,e){void 0===e&&(e=0);var r=Math.pow(10,e);return{type:l.number,value:Math.round(r*t)/r}}))},RoundDown:{fn:Ot((function(t,e){void 0===e&&(e=0);var r=Math.pow(10,e),n=t>=0;return{type:l.number,value:n?Math.floor(r*t)/r:Math.ceil(r*t)/r}}))},Reverse:{arguments:[{boxed:!0}],fn:function(t){return Array.isArray(t)?1===t.length?[t[0].reverse()]:t.reverse():{type:l.string,value:t.value.toString().split("").reverse().join("")}}},Abs:{fn:Dt((function(t){return{type:l.number,value:Math.abs(t)}}))},Simplify:{fn:Ot((function(t,e){if(void 0===e&&(e=2),e=e||2,0===t)return{type:l.number,value:t};var r=t<0?-1:1;t*=r;var n=Math.pow(10,Math.floor(Math.log10(t))+1-e);return{type:l.number,value:Math.round(t/n)*n*r}}))},Erf:{fn:function(t){return{type:l.number,value:Gt(t)}}},NormsInv:{description:"Inverse of the normal cumulative distribution",arguments:[{name:"probability"}],fn:function(t){return{type:l.number,value:zt(t)}}},"Norm.Inv":{description:"Inverse of the normal cumulative distribution",arguments:[{name:"probability"},{name:"mean",default:0},{name:"standard deviation",default:1}],fn:function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),{type:l.number,value:zt(t)*r+e}}},"Norm.Dist":{description:"Cumulative normal distribution",arguments:[{name:"value"},{name:"mean",default:0},{name:"standard deviation",default:1}],fn:function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1);var n=t<e?-1:1;return{type:l.number,value:.5*(1+n*Gt(Math.abs(t-e)/(r*Math.sqrt(2))))}}},HexToDec:{arguments:[{description:"hexadecimal string"}],fn:function(t){return{type:l.number,value:parseInt(t,16)}}},DecToHex:{arguments:[{description:"number"}],fn:function(t){return{type:l.string,value:t.toString(16)}}},Checkbox:{arguments:[{name:"checked"}],click:function(t){var e=t.x,r=t.y,n=t.width,i=t.height,o=t.cell,a={};if(o&&n&&i&&e&&r){var s={x:3,y:i-3-16};if(o.style){switch(o.style.vertical_align){case w.VerticalAlign.Top:s.y=3;break;case w.VerticalAlign.Middle:s.y=Math.round(i/2-8)}switch(o.style.horizontal_align){case w.HorizontalAlign.Right:s.x=Math.round(n-3-16);break;case w.HorizontalAlign.Center:s.x=Math.round(n/2-8)}}e>=s.x&&e<=s.x+16&&r>=s.y&&r<=s.y+16&&(a.value="=Checkbox("+(o.calculated?"FALSE":"TRUE")+")",a.block_selection=!0)}return a},render:function(t){var e,r,n=t.context,i=t.width,a=t.height,s=t.cell,l=t.scale||1;n.lineJoin="round",n.lineCap="round";var u=3*l,c=u,h=a-u-16*l;if(s.style){switch(s.style.vertical_align){case w.VerticalAlign.Top:h=u;break;case w.VerticalAlign.Middle:h=Math.round(a/2-8*l)}switch(s.style.horizontal_align){case w.HorizontalAlign.Right:c=Math.round(i-u-16*l);break;case w.HorizontalAlign.Center:c=Math.round(i/2-8*l)}}if(s&&s.calculated){n.lineWidth=.5,n.fillStyle=n.strokeStyle,n.beginPath(),n.moveTo(c,h),n.lineTo(c+16*l,h),n.lineTo(c+16*l,h+16*l),n.lineTo(c,h+16*l),n.closePath(),n.moveTo(c+15*l,h+4*l);try{for(var f=o([[13.59,2.58],[6,10.17],[2.41,6.59],[1,8],[6,13]]),d=f.next();!d.done;d=f.next()){var p=d.value;n.lineTo(c+p[0]*l,h+p[1]*l)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}n.closePath(),n.fill()}else n.lineWidth=Math.max(2,2*l),n.strokeRect(c,h,16*l,16*l);return{handled:!0}},fn:function(t){return{value:!!t,type:l.boolean}}},"Sparkline.Column":{arguments:[{name:"data"},{name:"color"},{name:"negative color"}],render:function(t){return jt.RenderColumn(t.width,t.height,t.context,t.cell,t.style),{handled:!0}},fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.object,value:t}}},"Sparkline.Line":{arguments:[{name:"data"},{name:"color"},{name:"line width"}],render:function(t){return jt.RenderLine(t.width,t.height,t.context,t.cell,t.style),{handled:!0}},fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.object,value:t}}}},Ht={};try{for(var Wt=o(Object.keys(qt)),Zt=Wt.next();!Zt.done;Zt=Wt.next()){var $t=Zt.value;Ht[$t.toLowerCase()]=$t}}catch(t){It={error:t}}finally{try{Zt&&!Zt.done&&(Lt=Wt.return)&&Lt.call(Wt)}finally{if(It)throw It.error}}var Yt=function(t){if(Ht[t.toLowerCase()])return"continue";var e=Object.getOwnPropertyDescriptor(Math,t);if(!e)return"continue";var r=e.value,n=typeof r;switch(n){case"number":qt[t]={fn:function(){return{type:l.number,value:r}},category:["Math Functions"]};break;case"function":qt[t]={fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m(r.apply(void 0,s([],a(t))))},category:["Math Functions"]};break;default:console.info("unexpected type:",n,t)}};try{for(var Qt=o(Object.getOwnPropertyNames(Math)),Kt=Qt.next();!Kt.done;Kt=Qt.next())Yt(Kt.value)}catch(t){Ut={error:t}}finally{try{Kt&&!Kt.done&&(Vt=Qt.return)&&Vt.call(Qt)}finally{if(Ut)throw Ut.error}}Math.log10||(Math.log10=function(t){return Math.log(t)/Math.log(10)});var Xt,te=function(t,e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),i?-r*(t/(1-Math.pow(1+t,-e)))/(1+t)-n*(1/((1+t)*((Math.pow(1+t,e)-1)/t))):-(r*t*Math.pow(1+t,e)+n*t)/(Math.pow(1+t,e)-1)},ee=function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),i?(1+t)*-r/t*(Math.pow(1+t,e)-1)-n*Math.pow(1+t,e):-r/t*(Math.pow(1+t,e)-1)-n*Math.pow(1+t,e)},re=function(t,e,r,n,i,o){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),e<1)return NaN;if(1===e&&o)return 0;var a=te(t,r,n,i,o),s=ee(t,e-1,a,n,o)*t;return o?s/(1+t):s},ne=function(t,e,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),te(t,r,n,i,o)-re(t,e,r,n,i,o)},ie={NPV:{description:"Returns the present value of a series of future cashflows",arguments:[{name:"Rate"},{name:"Cashflow"}],fn:function(t){void 0===t&&(t=0);for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0,i=Et(e),o=0;o<i.length;o++){var a=i[o];"number"==typeof a&&(n+=Math.pow(1+t,-(o+1))*a)}return{type:l.number,value:n}}},IRR:{description:"Calculates the internal rate of return of a series of cashflows",arguments:[{name:"Cashflows"},{name:"Guess",default:.1}],fn:function(t,e){void 0===e&&(e=.1);for(var r=Et(t).map((function(t){return"number"==typeof t?t:0})),n=[{found:!1,value:0},{found:!1,value:0}],i=0;i<50;i++){for(var o=0,a=0;a<r.length;a++)o+=Math.pow(1+e,-(a+1))*r[a];if(Math.abs(o)<=.00125)return{type:l.number,value:e};if(o>0){if(n[0].value=n[0].found?Math.max(n[0].value,e):e,n[0].found=!0,!n[1].found){e+=.1;continue}}else if(n[1].value=n[1].found?Math.min(n[1].value,e):e,n[1].found=!0,!n[0].found){e-=.1;continue}e=n[0].value+(n[1].value-n[0].value)/2}return{type:l.error,value:"NUM"}}},CUMPRINC:{description:"Returns cumulative principal paid on a loan between two periods",arguments:[{name:"Rate"},{name:"Periods"},{name:"Present Value"},{name:"Start Period"},{name:"End Period"},{name:"Type",default:0}],fn:function(t,e,r,n,i,o){void 0===o&&(o=0);for(var a=0,s=n;s<=i;s++)a+=ne(t,s,e,r,0,o);return{type:l.number,value:a}}},CUMIPMT:{description:"Returns cumulative interest paid on a loan between two periods",arguments:[{name:"Rate"},{name:"Periods"},{name:"Present Value"},{name:"Start Period"},{name:"End Period"},{name:"Type",default:0}],fn:function(t,e,r,n,i,o){void 0===o&&(o=0);for(var a=0,s=n;s<=i;s++)a+=re(t,s,e,r,0,o);return{type:l.number,value:a}}},IPMT:{description:"Returns the interest portion of a payment",arguments:[{name:"Rate"},{name:"Period"},{name:"Periods"},{name:"Present Value",default:0},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),{type:l.number,value:re(t,e,r,n,i,o)}}},PPMT:{description:"Returns the principal portion of a payment",arguments:[{name:"Rate"},{name:"Period"},{name:"Periods"},{name:"Present Value",default:0},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),{type:l.number,value:ne(t,e,r,n,i,o)}}},Rate:{description:"Returns the interest rate of a loan",arguments:[{name:"Periods"},{name:"Payment"},{name:"Present Value",default:0},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0);for(var o=.25,a=[-1,1],s=0;s<32;s++){var u=te(o,t,r,n,i);if(Math.abs(u-e)<=1e-6)return{type:l.number,value:o};var c=te(a[1],t,r,n,i);e>=u&&e<=c||e>=c&&e<=u?a[0]=o:a[1]=o,o=a[0]+(a[1]-a[0])/2}return{type:l.number,value:o}}},FV:{description:"Returns the future value of an investment",arguments:[{name:"Rate"},{name:"Periods"},{name:"Payment"},{name:"Present Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),{type:l.number,value:ee(t,e,r,n,i)}}},PV:{description:"Returns the present value of an investment",arguments:[{name:"Rate"},{name:"Periods"},{name:"Payment"},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),i?(r+=n*(1/((1+t)*((Math.pow(1+t,e)-1)/t))),{type:l.number,value:-(r+r/t*(1-Math.pow(1+t,-(e-1))))}):{type:l.number,value:-(n+r/t*(Math.pow(1+t,e)-1))/Math.pow(1+t,e)}}},NPER:{description:"Returns the number of periods of an investment",arguments:[{name:"Rate"},{name:"Payment"},{name:"Present Value"},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),i?{type:l.number,value:1+(-Math.log(1+t*(1-r/-e))+Math.log(1+n*t/(-e*(1+t))))/Math.log(1+t)}:{type:l.number,value:(Math.log(Math.pow(1-r*t/-e,-1))+Math.log(1+n*t/-e))/Math.log(1+t)}}},PMT:{description:"Returns the periodic payment of a loan",arguments:[{name:"Rate"},{name:"Periods"},{name:"Present Value"},{name:"Future Value",default:0},{name:"Type",default:0}],fn:function(t,e,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),{type:l.number,value:te(t,e,r,n,i)}}}},oe={Char:{arguments:[{name:"number"}],fn:function(t){return{type:l.string,value:String.fromCodePoint(t||32)}},category:["text"]},Code:{arguments:[{name:"string"}],fn:function(t){return{type:l.number,value:t.codePointAt(0)}},category:["text"]},Text:{arguments:[{name:"value"},{name:"number format"}],fn:function(t,e){return void 0===e&&(e="0.00####"),{type:l.string,value:P.Get(e).Format(t||0)}},category:["text"]},Left:{arguments:[{name:"string"},{name:"count"}],fn:function(t,e){return void 0===e&&(e=1),{type:l.string,value:t.substr(0,e)}},category:["text"]},Right:{arguments:[{name:"string"},{name:"count"}],fn:function(t,e){return void 0===e&&(e=1),{type:l.string,value:t.slice(-e)}},category:["text"]},Mid:{arguments:[{name:"string"},{name:"left"},{name:"count"}],fn:function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),{type:l.string,value:t.substr(Math.max(0,e-1),r)}},category:["text"]},Search:{description:"Find a string (needle) in another string (haystack). Case-insensitive.",arguments:[{name:"Needle"},{name:"Haystack"},{name:"Start",default:1}],fn:function(t,e,r){if(void 0===r&&(r=1),r>=1){if(!t)return{type:l.number,value:r};var n=function(t){for(var e=[],r=t.length,n="[\\^$.|?*+()",i=0;i<r;i++){var o=t[i];switch(o){case"*":e.push(".","*");break;case"?":e.push(".");break;case"~":o=t[++i]||"";default:for(var a=0;a<n.length;a++)if(o===n[a]){e.push("\\");break}e.push(o)}}return e.join("")}(t),i=new RegExp(n,"i").exec(e.substr(r-1));if(i)return{type:l.number,value:i.index+r}}return ut()}},Find:{description:"Find a string (needle) in another string (haystack). Case-sensitive.",arguments:[{name:"Needle"},{name:"Haystack"},{name:"Start",default:1}],fn:function(t,e,r){if(void 0===r&&(r=1),r>=1){if(!t)return{type:l.number,value:r};var n=new RegExp(t).exec(e.substr(r-1));if(n)return{type:l.number,value:n.index+r}}return ut()}},Concat:{description:"Pastes strings together",fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Et(t),n=r.map((function(t){var e,r=(null===(e=t)||void 0===e?void 0:e.toString())||"";return"number"==typeof t&&","===g.decimal_separator?r.replace(/\./,","):r})).join("");return{type:l.string,value:n}}}},ae={Concatenate:"Concat"},se={IsBlank:{description:"Returns true if the reference is blank",arguments:[{name:"Reference",metadata:!0}],fn:Dt((function(t){return{type:l.boolean,value:!(null==t?void 0:t.value)||void 0===t.value.value}}))},IsNumber:{description:"Returns true if the reference is a number",arguments:[{name:"Reference",metadata:!0}],fn:Dt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&"number"==typeof t.value.value}}))},IsLogical:{description:"Returns true if the reference is a logical TRUE or FALSE",arguments:[{name:"Reference",metadata:!0}],fn:Dt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&"boolean"==typeof t.value.value}}))},IsText:{description:"Returns true if the reference is text",arguments:[{name:"Reference",metadata:!0}],fn:Dt((function(t){return{type:l.boolean,value:(null==t?void 0:t.value)&&"string"==typeof t.value.value}}))}},le=function(t,e){void 0===e&&(e=!1);for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=t[o];for(n/=r,o=0;o<r;o++){var a=t[o]-n;i+=a*a}return e?i/(r-1):i/r},ue={StDev:{description:"Returns the standard deviation of a set of values, corresponding to a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.sqrt(le(Et(t),!1))}}},"StDev.S":{description:"Returns the standard deviation of a set of values, corresponding to a sample of a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:Math.sqrt(le(Et(t),!0))}}},Var:{description:"Returns the variance of a set of values, corresponding to a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:le(Et(t),!1)}}},"Var.S":{description:"Returns the variance of a set of values, corresponding to a sample of a population",arguments:[{name:"data"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:l.number,value:le(Et(t),!0)}}},Correl:{description:"Returns the correlation between two ranges of values",arguments:[{name:"A"},{name:"B"}],fn:function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return ut();if(!Array.isArray(t[0])||!Array.isArray(e[0]))return ut();for(var r=0,n=0,i=0,o=0,a=0,s=0,u=0,c=0;c<t.length;c++)if(t[c]&&e[c])for(var h=t[c].length,f=0;f<h;f++){var d=Number(t[c][f]),p=Number(e[c][f]);isNaN(d)||isNaN(p)||(n+=d*p,i+=d,o+=p,a+=d*d,s+=p*p,u++)}return(r=u*n-i*o)&&(r/=Math.sqrt((u*a-i*i)*(u*s-o*o))),{type:l.number,value:r}}},GeoMean:{fn:function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];r=Et(r);var i=0,a=1;try{for(var s=o(r),u=s.next();!u.done;u=s.next()){var c=u.value;if(void 0!==c){var h=Number(c);if(h<0)return ut();i++,a*=h}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return{type:l.number,value:Math.pow(a,1/i)}}},Average:{fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(t=Et(t)).reduce((function(t,e){return void 0===e?t:t+Number(e)}),0)/t.length;return{type:l.number,value:r}}},Percentile:{description:"Returns the kth percentile value from the range of data",arguments:[{name:"range"},{name:"percentile"}],fn:function(t,e){var r=Et(t).filter((function(t){return"number"==typeof t}));r.sort((function(t,e){return t-e}));var n=r.length,i=Math.pow(10,8),o=Math.round((1+(n-1)*e)*i)/i,a=Math.floor(o),s=Math.ceil(o);return{type:l.number,value:(r[a-1]+r[s-1])/2}}},Median:{description:"Returns the median value of the range of data",arguments:[{name:"range"}],fn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Et(t).filter((function(t){return"number"==typeof t}));r.sort((function(t,e){return t-e}));var n=r.length,i=1+.5*(n-1),o=Math.floor(i),a=Math.ceil(i);return{type:l.number,value:(r[o-1]+r[a-1])/2}}}},ce={Mean:"Average","StDev.P":"StDev","Var.P":"Var"},he=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.state_id=0,e.type=r.type,e.state_representation="",e}return e(r,t),r.prototype.UpdateState=function(){var t=JSON.stringify(this.edges_in.map((function(t){return t.result})));t!==this.state_representation&&(this.state_representation=t,this.state_id++)},r.prototype.Calculate=function(t){var e,r;if(this.dirty){try{for(var n=o(this.edges_in),i=n.next();!i.done;i=n.next())if(i.value.dirty)return}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.UpdateState(),this.dirty=!1}},r.prototype.AddDependent=function(t){throw new Error("leaf vertex cannot have dependents")},r.type="leaf-vertex",r}(X),fe=function(t){function r(){var e,r,i,a,s=t.call(this)||this;s.library=new Ft,s.parser=new $,s.expression_calculator=new Pt(s.library,s.parser),s.full_rebuild_required=!1,s.UpdateLocale(),s.library.Register(qt,oe,ue,ie,se);try{for(var u=o(Object.keys(ce)),c=u.next();!c.done;c=u.next()){var h=c.value;s.library.Alias(h,ce[h])}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}try{for(var f=o(Object.keys(ae)),d=f.next();!d.done;d=f.next())h=d.value,s.library.Alias(h,ae[h])}catch(t){i={error:t}}finally{try{d&&!d.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}return s.library.Register({CountIf:{arguments:[{name:"range"},{name:"criteria"}],fn:function(t,e){var r,n,i,a,u=Et(t);"string"!=typeof e?e="="+(e||0).toString():(e=e.trim(),/^[=<>]/.test(e)||(e="="+e));var c=s.parser.Parse("{}"+e),h=c.expression;if(c.error||!h)return ot();if("binary"!==h.type)return ot();if("array"!==h.left.type)return ot();h.left.values=[u];var f=s.CalculateExpression(h);if(Array.isArray(f)){var d=0;try{for(var p=o(f),m=p.next();!m.done;m=p.next()){var v=m.value;try{for(var y=(i=void 0,o(v)),_=y.next();!_.done;_=y.next())_.value.value&&d++}catch(t){i={error:t}}finally{try{_&&!_.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{m&&!m.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return{type:l.number,value:d}}return f}},Offset:{arguments:[{name:"reference",description:"Base reference",metadata:!0},{name:"rows",description:"number of rows to offset"},{name:"columns",description:"number of columns to offset"}],return_type:nt.reference,volatile:!0,fn:function(t,e,r,i,o){if(void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=1),!t)return lt();if(!Tt(t))return ct();var a=s.DynamicDependencies(t.value.address,s.expression_calculator.context.address,!0,e,r,i,o);if(!a)return ct();if(a.dirty)return s.GetVertex(s.expression_calculator.context.address,!0).short_circuit=!0,{type:l.undefined,value:void 0};if(a.area){var u=n(n({type:"address"},a.area.start),{label:"",position:0,id:0}),c=n(n({type:"address"},a.area.end),{label:"",position:0,id:0}),h=1===a.area.count?u:{type:"range",start:u,end:c,label:"",position:0,id:0};return{type:l.object,value:h}}return ut()}.bind(s)},Indirect:{arguments:[{name:"reference",description:"Cell reference (string)"}],return_type:nt.reference,volatile:!0,fn:function(t){if(!t||"string"!=typeof t)return lt();var e=s.parser.Parse(t);if(e.error||!e.expression||"address"!==e.expression.type&&"range"!==e.expression.type)return ct();var r=s.DynamicDependencies(e.expression,s.expression_calculator.context.address);return r?r.dirty?(s.GetVertex(s.expression_calculator.context.address,!0).short_circuit=!0,{type:l.undefined,value:void 0}):{type:l.object,value:e.expression}:ct()}.bind(s)},Rows:{arguments:[{name:"reference",description:"Array or reference"}],volatile:!1,fn:function(t){if(!t)return lt();if(Array.isArray(t)){var e=t[0];return Array.isArray(e)?{type:l.number,value:e.length}:ut()}return{type:l.number,value:1}}},Columns:{arguments:[{name:"reference",description:"Array or reference"}],volatile:!1,fn:function(t){return t?Array.isArray(t)?{type:l.number,value:t.length}:{type:l.number,value:1}:lt()}},IsFormula:{description:"Returns true if the reference is a formula",arguments:[{name:"Reference",metadata:!0}],fn:Dt((function(t){var e,r,n,i;if(null===(n=null==t?void 0:t.value)||void 0===n?void 0:n.address)try{for(var a=o((null===(i=s.model)||void 0===i?void 0:i.sheets)||[]),u=a.next();!u.done;u=a.next()){var c=u.value;if(c.id===t.value.address.sheet_id){var h=c.cells.GetCell(t.value.address,!1);return{type:l.boolean,value:(null==h?void 0:h.type)===l.formula}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return{type:l.boolean,value:!1}}))}}),s}return e(r,t),r.prototype.SpreadCallback=function(t,e){if(!t.address||!t.address.sheet_id)throw new Error("spread callback called without sheet id");var r=this.cells_map[t.address.sheet_id];if(!r)throw new Error("spread callback called without cells");if(t&&t.reference){var n=t.reference.area;if(n){var i=n.rows,o=n.columns;if(Array.isArray(e)){e=Nt(e);for(var a=0;a<i;a++)if(e[a]){for(var s=0;s<o&&s<e[a].length;s++)r.data[a+n.start.row][s+n.start.column].SetCalculatedValue(e[a][s].value,e[a][s].type);for(;s<o;s++)r.data[a+n.start.row][s+n.start.column].SetCalculatedValue(void 0,l.undefined)}else for(s=0;s<o;s++)r.data[a+n.start.row][s+n.start.column].SetCalculatedValue(void 0,l.undefined)}else for(a=0;a<i;a++)for(s=0;s<o;s++)r.data[a+n.start.row][s+n.start.column].SetCalculatedValue(e.value,e.type)}}},r.prototype.CalculationCallback=function(t){if(!t.address)throw new Error("vertex missing address");return t.expression_error?{value:ft()}:this.expression_calculator.Calculate(t.expression,t.address)},r.prototype.DynamicDependencies=function(t,e,r,n,i,o,a){if(void 0===r&&(r=!1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=1),void 0===a&&(a=1),this.model){var s=this.ResolveExpressionAddress(t,e);if(s){var l=!1,c=(s=this.model.active_sheet.RealArea(s)).start.sheet_id;r&&(s=new u({column:s.start.column+i,row:s.start.row+n,sheet_id:s.start.sheet_id},{column:s.start.column+i+o-1,row:s.start.row+n+a-1,sheet_id:s.end.sheet_id}));for(var h=s.start.row;h<=s.end.row;h++)for(var f=s.start.column;f<=s.end.column;f++){var d=this.GetVertex({row:h,column:f,sheet_id:c},!1);d&&d.dirty&&(this.AddEdge({row:h,column:f,sheet_id:c},this.expression_calculator.context.address),l=!0)}return{dirty:l,area:s}}}},r.prototype.UpdateLocale=function(){","===g.decimal_separator?(this.parser.decimal_mark=D.Comma,this.parser.argument_separator=E.Semicolon):(this.parser.decimal_mark=D.Period,this.parser.argument_separator=E.Comma)},r.prototype.GetFunction=function(t){return this.library.Get(t)},r.prototype.SupportedFunctions=function(){var t,e,r=this.library.List(),n=Object.keys(r).map((function(t){var e=r[t].canonical_name;return e||(e=t.replace(/_/g,".")),{name:e,description:r[t].description,arguments:(r[t].arguments||[]).map((function(t){return{name:t.name||""}}))}}));if(this.model)try{for(var i=o(Object.keys(this.model.macro_functions)),a=i.next();!a.done;a=i.next()){var s=a.value,l=this.model.macro_functions[s];n.push({name:l.name,description:l.description,arguments:(l.argument_names||[]).map((function(t){return{name:t}}))})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},r.prototype.RegisterFunction=function(t){var e,r,i=this,a=function(e){var r,o=t[e],a=o.fn;o.fn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a.apply({address:n({},i.expression_calculator.context.address)},t)},s.library.Register(((r={})[e]=o,r))},s=this;try{for(var l=o(Object.keys(t)),u=l.next();!u.done;u=l.next())a(u.value)}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},r.prototype.AttachModel=function(t){this.AttachData(t),this.expression_calculator.SetModel(t)},r.prototype.Calculate=function(t,e){if(this.AttachModel(t),e&&!e.start.sheet_id)throw new Error("CalculateInternal called with subset w/out sheet ID");this.full_rebuild_required&&(e=void 0,this.UpdateAnnotations(),this.full_rebuild_required=!1),this.RebuildGraph(e);try{this.Recalculate()}catch(t){console.error(t),console.info("calculation error trapped")}},r.prototype.Reset=function(){this.FlushTree(),this.model&&this.AttachModel(this.model),this.full_rebuild_required=!0},r.prototype.CalculateExpression=function(t,e,r){return void 0===e&&(e={row:-1,column:-1}),void 0===r&&(r=!1),this.expression_calculator.Calculate(t,e,r).value},r.prototype.RebuildClean=function(t,e){void 0===e&&(e=!1),this.full_rebuild_required=!1,this.AttachModel(t),this.RebuildGraph(),this.UpdateAnnotations(),this.InitializeGraph(),e&&this.volatile_list.length&&this.Recalculate()},r.prototype.FlattenCellList=function(t){var e,r,n={},i=[];try{for(var a=o(t),s=a.next();!s.done;s=a.next()){var l=s.value,c={column:l.column,row:l.row,sheet_id:l.sheet_id},h=u.CellAddressToLabel(c,!0);n[h]||(n[h]=h,i.push(c))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return i},r.prototype.MetadataReferences=function(t){var e=[];if(!this.model)return e;var r=this.parser.Parse(t);if(r.expression&&"call"===r.expression.type){var n=this.GetFunction(r.expression.name);if(!n||!n.arguments)return e;for(var i=0;i<n.arguments.length;i++){var o=n.arguments[i];if(o&&o.metadata){var a=r.expression.args[i];if(a){var s=this.ResolveExpressionAddress(a);s&&e.push(s.start)}}}}return e},r.prototype.RemoveAnnotation=function(t){var e=t.temp.vertex;e&&(e.Reset(),this.RemoveLeafVertex(e))},r.prototype.UpdateAnnotations=function(t){var e,r;if(!t&&this.model&&(t=this.model.active_sheet.annotations),t){void 0===t||Array.isArray(t)||(t=[t]);try{for(var n=o(t),i=n.next();!i.done;i=n.next()){var a=i.value;if(a.formula){a.temp.vertex||(a.temp.vertex=new he);var s=a.temp.vertex;this.AddLeafVertex(s),this.UpdateLeafVertex(s,a.formula)}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}},r.prototype.ResolveSheetID=function(t,e){var r,n;if(!this.model)throw new Error("ResolveSheetID called without model");var i="address"===t.type?t:t.start;if(i.sheet_id)return!0;if(!i.sheet)return i.sheet_id=(null==e?void 0:e.sheet_id)||this.model.active_sheet.id,!0;var a=i.sheet.toLowerCase();try{for(var s=o(this.model.sheets),l=s.next();!l.done;l=s.next()){var u=l.value;if(u.name.toLowerCase()===a)return i.sheet_id=u.id,!0}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},r.prototype.ResolveExpressionAddress=function(t,e){switch(t.type){case"address":if(this.ResolveSheetID(t,e))return new u(t);break;case"range":if(this.ResolveSheetID(t,e))return new u(t.start,t.end);break;case"identifier":if(this.model){var r=this.model.named_ranges.Get(t.name.toUpperCase());if(r)return new u(r.start,r.end)}}},r.prototype.NamedRangeToAddressUnit=function(t){if(this.model){var e=t.name.toUpperCase(),r=this.model.named_ranges.Get(e);return r?1===r.count?this.ConstructAddressUnit(r.start,e,t.id,t.position):{type:"range",start:this.ConstructAddressUnit(r.start,e,t.id,t.position),end:this.ConstructAddressUnit(r.end,e,t.id,t.position),label:e,id:t.id,position:t.position}:void 0}},r.prototype.ConstructAddressUnit=function(t,e,r,n){return{type:"address",row:t.row,column:t.column,sheet_id:t.sheet_id,label:e,id:r,position:n}},r.prototype.RebuildDependencies=function(t,e,r,n,i){var a,s,l,u,c=this;if(void 0===n&&(n={addresses:{},ranges:{}}),!i&&(i={},this.model)){try{for(var h=o(this.model.sheets),f=h.next();!f.done;f=h.next()){var d=f.value;i[d.name.toLowerCase()]=d.id}}catch(t){a={error:t}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}if(!r)try{for(var p=o(this.model.sheets),m=p.next();!m.done;m=p.next())if((d=m.value).id===e){r=d.name;break}}catch(t){l={error:t}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(l)throw l.error}}}switch(t.type){case"literal":case"missing":case"operator":break;case"identifier":var v=this.NamedRangeToAddressUnit(t);v&&("address"===v.type?n.addresses[v.label]=v:n.ranges[v.label]=v);break;case"address":t.sheet_id||(t.sheet_id=t.sheet?i[t.sheet.toLowerCase()]||0:e,t.sheet||(t.sheet=r)),n.addresses[t.sheet_id+"!"+t.label]=t;break;case"range":t.start.sheet_id||(t.start.sheet_id=t.start.sheet?i[t.start.sheet.toLowerCase()]||0:e,t.start.sheet||(t.start.sheet=r)),n.ranges[t.start.sheet_id+"!"+t.start.label+":"+t.end.label]=t;break;case"unary":this.RebuildDependencies(t.operand,e,r,n,i);break;case"binary":this.RebuildDependencies(t.left,e,r,n,i),this.RebuildDependencies(t.right,e,r,n,i);break;case"group":t.elements.forEach((function(t){return c.RebuildDependencies(t,e,r,n,i)}));break;case"call":var y=t.args.slice(0),_=this.library.Get(t.name);_&&_.arguments&&_.arguments.forEach((function(t,n){t&&t.address&&(c.RebuildDependencies(y[n],e,r,void 0,i),y[n]={type:"missing",id:-1})})),y.forEach((function(t){return c.RebuildDependencies(t,e,r,n,i)}))}return n},r.prototype.UpdateLeafVertex=function(t,e){var r,n,i,a,s=this;if(!this.model)throw new Error("UpdateLeafVertex called without model");t.Reset();var l=this.parser.Parse(e);if(l.expression){var c=this.RebuildDependencies(l.expression,this.model.active_sheet.id,this.model.active_sheet.name);try{for(var h=o(Object.keys(c.ranges)),f=h.next();!f.done;f=h.next()){var d=f.value,p=c.ranges[d];new u(p.start,p.end).Iterate((function(e){s.AddLeafVertexEdge(e,t)}))}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}try{for(var m=o(Object.keys(c.addresses)),v=m.next();!v.done;v=m.next()){d=v.value;var y=c.addresses[d];this.AddLeafVertexEdge(y,t)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}}t.expression=l.expression||{type:"missing",id:-1},t.expression_error=!l.valid},r.prototype.ApplyMacroFunctionInternal=function(t,e,r){var n=this;switch(t.type){case"identifier":if(r[0]){var i=r[0][(t.name||"").toUpperCase()];if(i)return JSON.parse(JSON.stringify(i))}break;case"binary":t.left=this.ApplyMacroFunctionInternal(t.left,e,r),t.right=this.ApplyMacroFunctionInternal(t.right,e,r);break;case"unary":t.operand=this.ApplyMacroFunctionInternal(t.operand,e,r);break;case"group":t.elements=t.elements.map((function(t){return n.ApplyMacroFunctionInternal(t,e,r)}));break;case"call":if(t.args=t.args.map((function(t){return n.ApplyMacroFunctionInternal(t,e,r)})),!this.library.Get(t.name)){var o=e.macro_functions[t.name.toUpperCase()];if(o&&o.expression){var a=JSON.parse(JSON.stringify(o.expression)),s={};if(o.argument_names)for(var l=0;l<o.argument_names.length;l++)s[o.argument_names[l].toUpperCase()]=t.args[l]?t.args[l]:{type:"missing"};r.unshift(s);var u=this.ApplyMacroFunctionInternal(a,e,r);return r.shift(),u}}}return t},r.prototype.ApplyMacroFunctions=function(t){if(this.model&&Object.keys(this.model.macro_functions).length)return this.ApplyMacroFunctionInternal(t,this.model,[])},r.prototype.RebuildGraphCell=function(t,e){var r,i,a,s,c=this;if(t.area&&t.area.start.column===e.column&&t.area.start.row===e.row){var h=t.area,f=h.start,d=h.end,p=f.sheet_id||e.sheet_id;f.sheet_id||(f.sheet_id=p);for(var m=f.column;m<=d.column;m++)for(var v=f.row;v<=d.row;v++)this.ResetInbound({column:m,row:v,sheet_id:p},!0,!1);for(this.SetDirty(e),m=f.column;m<=d.column;m++)for(v=f.row;v<=d.row;v++)v===f.row&&m===f.column||this.AddEdge(f,n(n({},f),{row:v,column:m}))}if(t.type===l.formula){this.ResetInbound(e,!0);var y=this.parser.Parse(t.value);if(y.expression){if("call"===y.expression.type){var _=this.library.Get(y.expression.name);_&&(_.render||_.click)&&(t.render_function=_.render,t.click_function=_.click)}var g=this.RebuildDependencies(y.expression,e.sheet_id,"");try{for(var w=o(Object.keys(g.ranges)),b=w.next();!b.done;b=w.next()){var x=b.value,M=g.ranges[x],C=new u(M.start,M.end);C.entire_row||C.entire_column?this.AddArrayEdge(C,e):C.Iterate((function(t){return c.AddEdge(t,e)}))}}catch(t){r={error:t}}finally{try{b&&!b.done&&(i=w.return)&&i.call(w)}finally{if(r)throw r.error}}try{for(var S=o(Object.keys(g.addresses)),A=S.next();!A.done;A=S.next()){x=A.value;var R=g.addresses[x];this.AddEdge(R,e)}}catch(t){a={error:t}}finally{try{A&&!A.done&&(s=S.return)&&s.call(S)}finally{if(a)throw a.error}}}var k=this.GetVertex(e,!0);k&&(k.expression=y.expression||{type:"missing",id:-1},k.expression_error=!y.valid)}else t.value!==t.calculated?this.ResetInbound(e,!0,!1):t.type===l.undefined?this.ResetInbound(e,!0,!1,!0):console.warn("UNHANDLED CASE",t)},r.prototype.RebuildGraph=function(t){var e,r,n;if(t){if(!t.start.sheet_id)throw new Error("subset missing sheet id");for(var i=this.cells_map[t.start.sheet_id],a=t.start.row;a<=t.end.row;a++)if(f=i.data[a])for(var s=t.start.column;s<=t.end.column;s++)(p=f[s])&&this.RebuildGraphCell(p,{row:a,column:s,sheet_id:t.start.sheet_id})}else try{for(var l=o((null===(n=this.model)||void 0===n?void 0:n.sheets)||[]),u=l.next();!u.done;u=l.next()){var c=u.value,h=c.cells.data.length;for(a=0;a<h;a++){var f;if(f=c.cells.data[a]){var d=f.length;for(s=0;s<d;s++){var p;(p=f[s])&&this.RebuildGraphCell(p,{row:a,column:s,sheet_id:c.id})}}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},r.prototype.IsNativeOrTypedArray=function(t){return Array.isArray(t)||t instanceof Float64Array||t instanceof Float32Array},r.prototype.CheckVolatile=function(t){var e=this;if(!t.expression||t.expression_error)return!1;var r=!1;return this.parser.Walk(t.expression,(function(t){if("call"===t.type){var n=e.library.Get(t.name);n&&n.volatile&&(r=!0)}return!r})),r},r}(rt),de=function(t){return t.length===3+t[2]?{column:t[0],row:t[1],sheet_id:0,data:t.subarray(3)}:{column:t[0],row:t[1],sheet_id:t[2],data:t.subarray(4)}},pe=r(4691);!function(t){t[t.Null=0]="Null",t[t.Prep=1]="Prep",t[t.Simulation=2]="Simulation",t[t.Post=3]="Post"}(Xt||(Xt={}));var me=function(){function t(){this.address={row:0,column:0},this.volatile=!1,this.iteration=0,this.iterations=0,this.call_index=0,this.lhs=!1,this.state=Xt.Null,this.results=[],this.elapsed=0,this.trials=0,this.distributions=[],this.correlated_distributions={},this.functions={"Multivariate.Normal":{description:"Returns a sample from the multivariate normal distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"mean",description:"Distribution Mean",default:0},{name:"stdev",description:"Standard Deviation",default:1}],fn:this.multivariate_normal.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.LogNormal":{description:"Returns a sample from the multivariate log-normal distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"mean",description:"Mean of underlying Normal distribution",default:0},{name:"stdev",description:"Standard Deviation of underlying Normal distribution",default:1}],fn:this.multivariate_lognormal.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.Uniform":{description:"Returns a sample from the multivariate uniform distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"min",description:"Minimum Value",default:0},{name:"max",description:"Maximum Value",default:1}],fn:this.multivariate_uniform.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.Beta":{description:"Returns a sample from the multivariate beta distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"w",description:"Shape Parameter"},{name:"v",description:"Shape Parameter"}],fn:this.multivariate_beta.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.PERT":{description:"Returns a sample from the multivariate PERT distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"min",description:"Minimum Value"},{name:"mode",description:"Most-Likely Value"},{name:"max",description:"Maximum Value"},{name:"lambda",default:4}],fn:this.multivariate_pert.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"Multivariate.Triangular":{description:"Returns a sample from the multivariate triangular distribution",simulation_volatile:!0,arguments:[{name:"range of values",description:"Set of Correlated Distributions (N)",address:!0},{name:"correlation",description:"Correlation Matrix (NxN)"},{name:"min",description:"Minimum Value"},{name:"mode",description:"Most-Likely Value"},{name:"max",description:"Maximum Value"}],fn:this.multivariate_triangular.bind(this),category:["RiskAMP Random Distributions"],extension:!0},UniformRangeSample:{description:"Returns one of a set of values, with equal probability and with replacement",simulation_volatile:!0,arguments:[{name:"range",description:"Range of Values"}],fn:this.uniformrangesample.bind(this),category:["RiskAMP Random Distributions"],extension:!0},SampleValue:{description:"Returns one of a set of values, with equal probability and with replacement",simulation_volatile:!0,arguments:[{name:"range",description:"Range of Values"}],fn:this.samplevalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"SampleValue.Weighted":{description:"Returns one of a set of values, weighted by a second set of values",simulation_volatile:!0,arguments:[{name:"range",description:"Range of Values"},{name:"weights",description:"Range of Weights"}],fn:this.samplevalue_weighted.bind(this),category:["RiskAMP Random Distributions"],extension:!0},BernoulliValue:{description:"Returns true or false (boolean) based on the given probability",simulation_volatile:!0,arguments:[{name:"p",description:"Probability to return True",default:.5}],fn:this.bernoullivalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},ProbabilityValue:{description:"Returns true or false (boolean) based on the given probability",simulation_volatile:!0,arguments:[{name:"p",description:"Probability to return True",default:.5}],fn:this.probabilityvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},UniformValue:{description:"Returns a sample from the uniform distribution",simulation_volatile:!0,arguments:[{name:"min",description:"Minimum",default:0},{name:"max",description:"Maximum",default:1}],fn:this.uniformvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},BetaValue:{description:"Returns a sample from the beta distribution",simulation_volatile:!0,arguments:[{name:"w",description:"Shape Parameter"},{name:"v",description:"Shape Parameter"}],fn:this.betavalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},TruncatedNormalValue:{description:"Returns a sample from the normal distribution",simulation_volatile:!0,arguments:[{name:"mean",description:"Mean",default:0},{name:"stdev",description:"Standard Deviation",default:1},{name:"min",description:"Minimum Value"},{name:"max",description:"Maximum Value"}],fn:this.truncatednormalvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},NormalValue:{description:"Returns a sample from the normal distribution",simulation_volatile:!0,arguments:[{name:"mean",description:"Mean",default:0},{name:"stdev",description:"Standard Deviation",default:1}],fn:this.normalvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},PERTValue:{description:"Returns a sample from the beta-PERT distribution",simulation_volatile:!0,arguments:[{name:"min",description:"Minimum Value",default:0},{name:"mode",description:"Most-Likely Value",default:.5},{name:"max",description:"Maximum Value",default:1},{name:"lambda",default:4}],fn:this.pertvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},LognormalValue:{description:"Returns a sample from the log-normal distribution",simulation_volatile:!0,arguments:[{name:"mean",description:"Mean of underlying Normal distribution",default:0},{name:"stdev",description:"Standard Deviation of underlying Normal distribution",default:1}],fn:this.lognormalvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},SequentialValue:{description:"Returns one from a set of values, in order",simulation_volatile:!0,arguments:[{name:"values",description:"Data Array"},{name:"count",description:"Count",default:0}],fn:this.sequentialvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},IndexValue:{description:"Returns a monotonically increasing value",simulation_volatile:!0,arguments:[{name:"max",description:"Maximum",default:0}],fn:this.indexvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},"PERTValue.P":{description:"Returns a sample from the beta-PERT distribution",simulation_volatile:!0,arguments:[{name:"p10",description:"10th-Percentile Value",default:0},{name:"mode",description:"Most-Likely Value",default:.5},{name:"p90",description:"90th-Percentile Value",default:1},{name:"lambda",default:4}],fn:this.pertvalue_p.bind(this),category:["RiskAMP Random Distributions"],extension:!0},TriangularValue:{description:"Returns a sample from the triangular distribution",simulation_volatile:!0,arguments:[{name:"min",description:"Minimum Value",default:0},{name:"mode",description:"Most Likely Value",default:.5},{name:"max",description:"Maximum Value",default:1}],fn:this.triangularvalue.bind(this),category:["RiskAMP Random Distributions"],extension:!0},SimulationCorrelation:{description:"Returns the correlation between the data from two cells in the simulation",arguments:[{name:"reference cell",description:"Cell 1",collector:!0},{name:"reference cell",description:"Cell 2",collector:!0}],fn:this.simulationcorrelation.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationRSquared:{description:"Returns the r-squared value (coefficient of correlation) of the data from two cells in the simulation",arguments:[{name:"dependent",description:"Dependent Value",collector:!0},{name:"independent",description:"Indepdendent Value",collector:!0}],fn:this.simulationrsquared.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationSkewness:{description:"Returns the skewness of data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationskewness.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationKurtosis:{description:"Returns the kurtosis (peakedness) of data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationkurtosis.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationPercentile:{description:"Returns the value of a cell at a given percentile in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"percentile",description:"Percentile (as %)"}],fn:this.simulationpercentile.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationInterval:{description:"Returns the portion of results in the simulation that fall within some bounds (as a percentage)",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"min",description:"Minimum Value (optional, inclusive)"},{name:"max",description:"Maximum Value (optional, inclusive)"}],fn:this.simulationinterval.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationMean:{description:"Returns the mean (average) value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmean.bind(this),extension:!0,category:["RiskAMP Simulation Functions"]},SimulationMedian:{description:"Returns the median value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmedian.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationValue:{description:"Returns the value of this cell in the simulation at the given trial number",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"iteration",description:"Trial Number"}],fn:this.simulationvalue.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationValuesArray:{description:"Returns all values of this cell in the simulation, as an array",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationvaluesarray.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SortedSimulationIndex:{description:"Returns the iteration number of a sorted value for this cell",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"index"}],fn:this.sortedsimulationindex.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},"SimulationValuesArray.Ordered":{description:"Returns all values of this cell in the simulation, as an array, ordered by a second cell",arguments:[{name:"reference cell",description:"Source Cell",collector:!0},{name:"order by",description:"Reference Cell for Ordering",collector:!0}],fn:this.simulationvaluesarray_ordered.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationMin:{description:"Returns the minimum value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmin.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationMax:{description:"Returns the maximum value of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationmax.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationStandardError:{description:"Returns the standard error of the mean from this cell in the simulation",arguments:[{name:"reference cell",collector:!0}],fn:this.simulationstandarderror.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationStandardDeviation:{description:"Returns the standard deviation of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationstandarddeviation.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationVariance:{description:"Returns the variance of the data from this cell in the simulation",arguments:[{name:"reference cell",description:"Source Cell",collector:!0}],fn:this.simulationvariance.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationTrials:{description:"Returns the number of trials from the last simulation",fn:this.simulationtrials.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},SimulationTime:{description:"Returns the elapsed time of the last simulation",fn:this.simulationtime.bind(this),category:["RiskAMP Simulation Functions"],extension:!0},IsPosDef:{description:"Checks that a matrix is positive-definite",arguments:[{name:"matrix"}],fn:function(t){if(t.some((function(t){return t.some((function(t){return"number"!=typeof t}))})))return ut();var e=pe.Matrix.FromArray(t);return{type:l.boolean,value:e.IsPosDef()}},extension:!0},MakePosDef:{description:"Returns a matrix that is positive-definite",arguments:[{name:"matrix"}],fn:function(t){return t.some((function(t){return t.some((function(t){return"number"!=typeof t}))}))?ut():pe.Matrix.FromArray(t).MakePosDef().ToArray().map((function(t){return t.map((function(t){return{type:l.number,value:t}}))}))},extension:!0},Cholesky:{arguments:[{name:"matrix"},{name:"transpose",default:!1}],fn:function(t,e){return void 0===e&&(e=!1),pe.Matrix.FromArray(t).Cholesky(e).ToArray().map((function(t){return t.map((function(t){return{type:l.number,value:t}}))}))},extension:!0},EigenValues:{description:"Returns the eigenvalues of the matrix (as column vector)",arguments:[{name:"matrix"}],fn:function(t){return t.some((function(t){return t.some((function(t){return"number"!=typeof t}))}))?ut():[pe.Matrix.FromArray(t).EigenSystem().realvalues.map((function(t){return{type:l.number,value:t}}))]},extension:!0},EigenVectors:{description:"Returns the eigenvectors of the matrix (as matrix)",arguments:[{name:"matrix"}],fn:function(t){return t.some((function(t){return t.some((function(t){return"number"!=typeof t}))}))?ut():pe.Matrix.FromArray(t).EigenSystem().vectors.map((function(t){return Array.from(t).map((function(t){return{type:l.number,value:t}}))}))},extension:!0},MMult:{description:"Multiplies two matrices",arguments:[{name:"Matrix 1"},{name:"Matrix 2"}],fn:function(t,e){var r,n;if(!t||!e)return lt();var i=t.length||0,o=(null===(r=t[0])||void 0===r?void 0:r.length)||0,a=e.length||0,s=(null===(n=e[0])||void 0===n?void 0:n.length)||0;if(!(o&&s&&i&&a&&o===a&&i===s))return ut();var u=pe.Matrix.FromArray(t);return pe.Matrix.FromArray(e).Multiply(u).ToArray().map((function(t){return t.map((function(t){return{type:l.number,value:t}}))}))}},MInverse:{description:"Returns the inverse matrix",arguments:[{name:"Matrix"}],fn:function(t){try{return pe.Matrix.FromArray(t).Transpose().Inverse().ToArray(!0).map((function(t){return t.map((function(t){return{type:l.number,value:t}}))}))}catch(t){return console.warn(t),ut()}}},"RiskAMP.Scale":{description:"Creates a uniform scale within a given range",arguments:[{name:"min"},{name:"max"}],fn:this.Scale.bind(this),extension:!0},"RiskAMP.HistogramTable":{description:"Creates a histogram table from a source cell",arguments:[{name:"reference cell",collector:!0}],fn:this.HistogramTable.bind(this),extension:!0}}}return Object.defineProperty(t.prototype,"seed",{set:function(t){pe.Random.Seed(t)},enumerable:!1,configurable:!0}),t.prototype.CorrelateDistributions=function(){var t,e,r=this,n=function(t){var e=i.correlated_distributions[t],n=e.addresses.map((function(t){return r.distributions[t.sheet_id||0][t.column][t.row][t.call_index]}));try{var o=pe.MC.CorrelateCDM(e.correlation,n,!0);e.addresses.forEach((function(t,e){r.distributions[t.sheet_id||0][t.column][t.row][t.call_index]=o[e]}))}catch(t){console.warn(t)}},i=this;try{for(var a=o(Object.keys(this.correlated_distributions)),s=a.next();!s.done;s=a.next())n(s.value)}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},t.prototype.InitDistribution=function(){if(!this.address)throw new Error("invalid address");if(!this.address.sheet_id)throw new Error("address missing sheet ID");this.distributions[this.address.sheet_id]||(this.distributions[this.address.sheet_id]=[]);var t=this.distributions[this.address.sheet_id];t[this.address.column]||(t[this.address.column]=[]);var e=t[this.address.column];e[this.address.row]||(e[this.address.row]=[])},t.prototype.StoreCellResults=function(t){if(t||(t=this.address),t){if(!t.sheet_id)throw new Error("SCR called without sheet id");this.results[t.sheet_id]||(this.results[t.sheet_id]=[]),this.results[t.sheet_id][t.column]||(this.results[t.sheet_id][t.column]=[]);var e=this.results[t.sheet_id][t.column];return e[t.row]||(e[t.row]=[]),e[t.row]}},t.prototype.PrepMultivariate=function(t,e){if(!this.correlated_distributions[t]){var r=pe.CDMatrix.FromArray(e);if(!r.IsSymmetric()){for(var n=1;n<e.length;n++)for(var i=0;i<n;i++)if(e[n][i]){console.warn("invalid lower-triangular matrix");break}r=r.Symmetrize(!0)}this.correlated_distributions[t]={correlation:r,addresses:[]}}this.correlated_distributions[t].addresses.push({column:this.address.column,row:this.address.row,sheet_id:this.address.sheet_id,call_index:this.call_index}),this.InitDistribution()},t.prototype.ValidateCorrelationMatrix=function(t){var e=pe.Matrix.FromArray(t);return e.IsSymmetric()||(e=e.Symmetrize(!0)),!(t.some((function(t){return t.some((function(t){return"number"!=typeof t&&void 0!==t}))}))||!e.IsPosDef())},t.prototype.multivariate_normal=function(t,e,r,n){if(void 0===r&&(r=0),void 0===n&&(n=1),this.state===Xt.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Normal(this.iterations,{mean:r,sd:n,lhs:this.lhs,ordered:!0});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:pe.MC.Normal(1,{mean:r,sd:n})[0]}:at()},t.prototype.multivariate_lognormal=function(t,e,r,n){if(void 0===r&&(r=0),void 0===n&&(n=1),this.state===Xt.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.LogNormal(this.iterations,{mean:r,sd:n,lhs:this.lhs,ordered:!0});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:pe.MC.LogNormal(1,{mean:r,sd:n})[0]}:at()},t.prototype.multivariate_beta=function(t,e,r,n){if(void 0===r&&(r=1),void 0===n&&(n=2),this.state===Xt.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Beta(this.iterations,{a:r,b:n,lhs:this.lhs,ordered:!0});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:pe.MC.Beta(1,{a:r,b:n})[0]}:at()},t.prototype.multivariate_uniform=function(t,e,r,n){if(void 0===r&&(r=0),void 0===n&&(n=1),this.state===Xt.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Uniform(this.iterations,{min:r,max:n,lhs:this.lhs,ordered:!0});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:pe.MC.Uniform(1,{min:r,max:n})[0]}:at()},t.prototype.multivariate_pert=function(t,e,r,n,i,o){if(void 0===r&&(r=0),void 0===n&&(n=.5),void 0===i&&(i=1),void 0===o&&(o=4),this.state===Xt.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.PERT(this.iterations,{a:r,b:i,c:n,lambda:o,lhs:this.lhs,ordered:!0});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:pe.MC.PERT(1,{a:r,b:i,c:n,lambda:o})[0]}:at()},t.prototype.multivariate_triangular=function(t,e,r,n,i){if(void 0===r&&(r=0),void 0===n&&(n=.5),void 0===i&&(i=1),this.state===Xt.Prep)this.PrepMultivariate(t,e),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Triangular(this.iterations,{a:r,b:i,c:n,lhs:this.lhs,ordered:!0});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return this.ValidateCorrelationMatrix(e)?{type:l.number,value:pe.MC.Triangular(1,{a:r,b:i,c:n})[0]}:at()},t.prototype.uniformvalue=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Uniform(this.iterations,{min:t,max:e,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.Uniform(1,{min:t,max:e})[0]}},t.prototype.bernoullivalue=function(t){if(void 0===t&&(t=.5),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Bernoulli(this.iterations,{p:t,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.boolean,value:pe.MC.Bernoulli(1,{p:t})[0]}},t.prototype.probabilityvalue=function(t){return void 0===t&&(t=.5),this.bernoullivalue(t)},t.prototype.sequentialvalue=function(t,e){if(void 0===e&&(e=0),this.state===Xt.Prep)this.InitDistribution();else if(this.state===Xt.Simulation){var r=this.iteration;e>0&&(r=this.iteration%e);var n=t[0].length,i=Math.floor(r/n)%t.length,o=r%n;return{type:l.number,value:t[i][o]}}return{type:l.number,value:t[0][0]}},t.prototype.indexvalue=function(t){if(void 0===t&&(t=0),this.state===Xt.Prep)this.InitDistribution();else if(this.state===Xt.Simulation)return t>0?{type:l.number,value:this.iteration%t+1}:{type:l.number,value:this.iteration+1};return{type:l.number,value:1}},t.prototype.lognormalvalue=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.LogNormal(this.iterations,{mean:t,sd:e,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.LogNormal(1,{mean:t,sd:e})[0]}},t.prototype.truncatednormalvalue=function(t,e,r,n){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.TruncatedNormal(this.iterations,{mean:t,sd:e,lhs:this.lhs,min:r,max:n});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.TruncatedNormal(1,{mean:t,sd:e,min:r,max:n})[0]}},t.prototype.normalvalue=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Normal(this.iterations,{mean:t,sd:e,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.Normal(1,{mean:t,sd:e})[0]}},t.prototype.pertvalue=function(t,e,r,n){if(void 0===t&&(t=0),void 0===e&&(e=.5),void 0===r&&(r=1),void 0===n&&(n=4),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.PERT(this.iterations,{a:t,b:r,c:e,lambda:n,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.PERT(1,{a:t,b:r,c:e,lambda:n})[0]}},t.prototype.pertvalue_p=function(t,e,r,i){if(void 0===t&&(t=0),void 0===e&&(e=.5),void 0===r&&(r=1),void 0===i&&(i=4),this.state===Xt.Prep){var o=pe.MC.P80Pert(t,r,e,i);this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.PERT(this.iterations,n(n({},o),{lambda:i,lhs:this.lhs}))}else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};var a=pe.MC.P80Pert(t,r,e,i);return{type:l.number,value:pe.MC.PERT(1,n(n({},a),{lambda:i}))[0]}},t.prototype.CommonDistributionFunction=function(t,e,r){if(this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=t.apply(e,[this.iterations].concat(r));else if(this.state===Xt.Simulation)return this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration];return t.apply(e,[1].concat(r))[0]},t.prototype.triangularvalue=function(t,e,r){if(void 0===t&&(t=0),void 0===e&&(e=.5),void 0===r&&(r=1),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Triangular(this.iterations,{a:t,b:r,c:e,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.Triangular(1,{a:t,b:r,c:e})[0]}},t.prototype.betavalue=function(t,e){if(void 0===t&&(t=1),void 0===e&&(e=1),this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Beta(this.iterations,{a:t,b:e,lhs:this.lhs});else if(this.state===Xt.Simulation)return{type:l.number,value:this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]};return{type:l.number,value:pe.MC.Beta(1,{a:t,b:e})[0]}},t.prototype.samplevalue=function(t){return this.uniformrangesample(t)},t.prototype.samplevalue_weighted=function(t,e){if(this.state===Xt.Prep)this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Uniform(this.iterations,{min:0,max:1,lhs:this.lhs});else{var r=this.state===Xt.Simulation?this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]:pe.MC.Uniform(1,{min:0,max:1})[0];if(!t||!t.length)return{type:l.undefined,value:void 0};for(var n=r*Et(e).reduce((function(t,e){return void 0===e?t:t+Number(e)}),0),i=0,o=0;o<t.length;o++)for(var a=0;a<t[o].length;a++)if((i+=e[o][a])>=n)return{type:l.number,value:t[o][a]}}return{type:l.number,value:t[0][0]}},t.prototype.uniformrangesample=function(t){this.state===Xt.Prep&&(this.InitDistribution(),this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index]=pe.MC.Uniform(this.iterations,{min:0,max:1,lhs:this.lhs}));var e=this.state===Xt.Simulation?this.distributions[this.address.sheet_id||0][this.address.column][this.address.row][this.call_index][this.iteration]:pe.MC.Uniform(1,{min:0,max:1})[0];if(!t||!t.length)return{type:l.undefined,value:void 0};var r=Math.floor(t[0].length*t.length*e),n=t[r%t.length][Math.floor(r/t.length)]||"";return{value:n,type:h(n)}},t.prototype.simulationtrials=function(){return{type:l.number,value:this.trials}},t.prototype.simulationtime=function(){return{type:l.number,value:this.elapsed/1e3}},t.prototype.simulationvaluesarray=function(t){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();for(var e=[],r=0;r<t.length;r++)e[r]={type:l.number,value:t[r]};return[e]},t.prototype.simulationvaluesarray_ordered=function(t,e){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length||e&&!e.length)return at();if(!e)return[Array.prototype.slice.call(t,0).sort((function(t,e){return t-e})).map((function(t){return{type:l.number,value:t}}))];var r=Array.from(t).map((function(t,r){return[t,e[r]]}));return r.sort((function(t,e){return t[1]-e[1]})),[r.map((function(t){return{type:l.number,value:t[0]}}))]},t.prototype.simulationrsquared=function(t,e){return this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length&&e&&e.length?{type:l.number,value:pe.Stats.R2(t,e)}:at()},t.prototype.simulationcorrelation=function(t,e){return this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length&&e&&e.length?{type:l.number,value:pe.Stats.Correlation(t,e)}:at()},t.prototype.sortedsimulationindex=function(t,e){if(void 0===e&&(e=1),this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();if(e<1||e>t.length)return lt();var r=Array.from(t).map((function(t,e){return[t,e+1]}));return r.sort((function(t,e){return t[0]-e[0]})),{type:l.number,value:r[e-1][1]}},t.prototype.simulationvalue=function(t,e){return void 0===e&&(e=1),this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length?e<1||e>t.length?lt():{type:l.number,value:t[e-1]}:at()},t.prototype.simulationpercentile=function(t,e){return void 0===e&&(e=.5),this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:pe.Stats.Percentile(t,e)}:at()},t.prototype.simulationstandarddeviation=function(t){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var e=pe.Stats.Statistics(t);return{type:l.number,value:e.stdev}},t.prototype.simulationvariance=function(t){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var e=pe.Stats.Statistics(t);return{type:l.number,value:e.variance}},t.prototype.simulationskewness=function(t){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var e=pe.Stats.Statistics(t);return{type:l.number,value:e.skewness}},t.prototype.simulationkurtosis=function(t){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var e=pe.Stats.Statistics(t);return{type:l.number,value:e.kurtosis}},t.prototype.simulationinterval=function(t,e,r){return this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:pe.Stats.Interval({data:t,min:e,max:r})}:at()},t.prototype.simulationstandarderror=function(t){var e,r,n,i;if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var a=0,s=0;try{for(var u=o(t),c=u.next();!c.done;c=u.next())a+=c.value||0}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}var h=a/t.length;try{for(var f=o(t),d=f.next();!d.done;d=f.next()){var p=d.value-h;s+=p*p}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return{type:l.number,value:Math.sqrt(s/t.length)/Math.sqrt(t.length)}},t.prototype.simulationmin=function(t){return this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:Math.min.apply(0,t)}:at()},t.prototype.simulationmax=function(t){return this.state!==Xt.Null?{type:l.number,value:0}:t&&t.length?{type:l.number,value:Math.max.apply(0,t)}:at()},t.prototype.simulationmean=function(t){var e,r;if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var n=0;try{for(var i=o(t),a=i.next();!a.done;a=i.next())n+=a.value}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return{type:l.number,value:n/t.length}},t.prototype.simulationmedian=function(t){if(this.state!==Xt.Null)return{type:l.number,value:0};if(!t||!t.length)return at();var e=t.filter((function(t){return"number"==typeof t?t:0}));return e.sort((function(t,e){return t-e})),{type:l.number,value:e[Math.round(e.length/2)]}},t.prototype.Scale=function(t,e){var r,n,i,a,s=1,c=1;if(this.address.sheet_id)try{for(var h=o((null===(i=this.model)||void 0===i?void 0:i.sheets)||[]),f=h.next();!f.done;f=h.next()){var d=f.value;if(d.id===this.address.sheet_id){d.cells.data[this.address.row]&&(a=d.cells.data[this.address.row][this.address.column]);break}}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}if(!a)return lt();if(a.area){var p=new u(a.area.start,a.area.end);s=p.rows,c=p.columns}var m=Math.max(s,c),v=t>e?I(e,t,m-1,!0):I(t,e,m-1,!0),y=v.min,_=[[]];if(v.count<m-1&&(y=v.min-Math.floor((m-1-v.count)/2)*v.step),t>e)for(var g=0;g<m;g++){var w=y+g*v.step;_[0][m-1-g]={type:l.number,value:w}}else for(g=0;g<m;g++)w=y+g*v.step,_[0][g]={type:l.number,value:w};return s<c?Nt(_):_},t.prototype.HistogramTable=function(t){var e,r,n,i,a=1,s=1;if(this.address.sheet_id)try{for(var c=o((null===(n=this.model)||void 0===n?void 0:n.sheets)||[]),h=c.next();!h.done;h=c.next()){var f=h.value;if(f.id===this.address.sheet_id){f.cells.data[this.address.row]&&(i=f.cells.data[this.address.row][this.address.column]);break}}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(!i)return lt();if(i.area){var d=new u(i.area.start,i.area.end);a=d.rows,s=d.columns}var p=Math.max(a,s),m=Math.min(a,s);if(Array.isArray(t)||t instanceof Float64Array||t instanceof Float32Array){if(t.length<=1)return{type:l.number,value:0};Array.isArray(t)||(t=Array.prototype.slice.call(t)),t.sort((function(t,e){return t-e}));var v=t[0]||0,y=t[t.length-1]||0;if(y===v)return{type:l.number,value:0};var _=[[],[]],g=I(v,y,p,!0),w=g.min,b=0;g.count<p&&(w=g.min-Math.ceil(p-g.count)/2*g.step);for(var x=0;x<p;x++){for(var M=w+(x+1)*g.step,C=0;b<t.length&&t[b]<M;b++,C++);_[1][x]={type:l.number,value:C},_[0][x]={type:l.number,value:M}}return 1===m&&(_=[_[1]]),s>a?Nt(_):_}return{type:l.number,value:0}},t}(),ve=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.simulation_model=new me,n.context=n.simulation_model,n}return e(r,t),r.prototype.CallExpression=function(t,e){var r=this;void 0===e&&(e=!1);var n=this.library.Get(t.name);if(!n)return function(t){return ht()};var i=n.arguments||[];return this.simulation_model.state===Xt.Prep&&t.args.forEach((function(t,e){var n=i[e]||{};if(t&&n.collector)if("address"===t.type)r.simulation_model.StoreCellResults(t);else if("identifier"===t.type){var o=r.named_range_map[t.name.toUpperCase()];o&&r.simulation_model.StoreCellResults(o.start)}else if("call"===t.type){var a=r.CalculateExpression(t,!0);a&&kt(a)&&("address"===a.value.type?r.simulation_model.StoreCellResults(a.value):"range"===a.value.type&&r.simulation_model.StoreCellResults(a.value.start))}})),function(o){var a=r.call_index++;r.simulation_model.volatile=r.simulation_model.volatile||!!n.volatile||!!n.simulation_volatile&&r.simulation_model.state!==Xt.Null;var s,u="IF"===t.name.toUpperCase(),c=-1,h=o.args.map((function(t,e){if(!s){var n=i[Math.min(e,i.length-1)]||{};if(e===c)return n.boxed?p():void 0;if(void 0===t)return u&&0===e&&(c=1),n.boxed?p():void 0;if(n.address)return n.boxed?{type:l.string,value:r.parser.Render(t).replace(/\$/g,"")}:r.parser.Render(t).replace(/\$/g,"");if(n.metadata)return r.GetMetadata(t,(function(t,e){return{simulation_data:r.simulation_model.state===Xt.Null?r.simulation_model.StoreCellResults(e):[]}}));if(n.collector&&r.simulation_model.state===Xt.Null){if("address"===t.type)return r.simulation_model.StoreCellResults(t);if("range"===t.type)return r.simulation_model.StoreCellResults(t.start);if("identifier"===t.type){var o=r.named_range_map[t.name.toUpperCase()];if(o)return r.simulation_model.StoreCellResults(o.start)}else if("call"===t.type&&(a=r.CalculateExpression(t,!0))&&kt(a)){if("address"===a.value.type)return r.simulation_model.StoreCellResults(a.value);if("range"===a.value.type)return r.simulation_model.StoreCellResults(a.value.start)}return s=ct()}var a=r.CalculateExpression(t);if(!Array.isArray(a)&&a.type===l.error)return n.allow_error?a:void(s=a);if(u&&0===e&&!Array.isArray(a)){var h=!1;if(a.type===l.string){var f=a.value.toLowerCase().trim();h="false"!==f&&"f"!==f}else h=!!a.value;c=h?2:1}return n.boxed?a:Array.isArray(a)?a.map((function(t){return t.map((function(t){return t.value}))})):a.value}}));if(s)return s;if(r.context.call_index=a,n.return_type===nt.reference){var f=n.fn.apply(null,h);if(e)return f;if(kt(f)){if("address"===f.value.type)return r.CellFunction2(f.value)();if("range"===f.value.type)return r.CellFunction4(f.value.start,f.value.end)}return f}return n.fn.apply(null,h)}},r}(Pt),ye=function(t){function r(){var e=t.call(this)||this;return e.expression_calculator=e.simulation_expression_calculator=new ve(e.library,e.parser),e.library.Register(e.simulation_expression_calculator.simulation_model.functions),e}return e(r,t),r.prototype.InitSimulation=function(t,e,r,n,i){var a,s,l,u,c,h=this.simulation_expression_calculator.simulation_model;if(h.iterations=t,h.results=[],h.lhs=e,h.correlated_distributions={},"number"==typeof i&&(h.seed=i),this.Reset(),this.AttachModel(r),n&&n.length)try{for(var f=o(n),d=f.next();!d.done;d=f.next()){var p=d.value;if(!p.sheet_id)throw new Error("additional cell passed without sheet id");try{for(var m=(l=void 0,o((null===(c=this.model)||void 0===c?void 0:c.sheets)||[])),v=m.next();!v.done;v=m.next()){var y=v.value;if(y.id===p.sheet_id){y.cells.GetCell(p,!1)&&h.StoreCellResults(p);break}}}catch(t){l={error:t}}finally{try{v&&!v.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}}}catch(t){a={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}if(this.RebuildGraph(),this.LoopCheck())throw new Error("Loop (circular dependency) found in graph");return h.state=Xt.Prep,h.iteration=0,this.Recalculate(),h.CorrelateDistributions(),h.state=Xt.Simulation,K.OK},r.prototype.GetResults=function(){return this.simulation_expression_calculator.simulation_model.results},r.prototype.SimulationTrial=function(t){var e=this.simulation_expression_calculator.simulation_model;e.iteration=t;try{for(var r in this.Recalculate(),e.results){var n=this.cells_map[r];for(var i in e.results[r]){var o=e.results[r][i];for(var a in o){var s=n.GetCell({row:Number(a),column:Number(i)});if(s){var l=s.GetValue();switch(typeof l){case"number":o[a][t]=l;break;case"boolean":o[a][t]=l?1:0;break;default:o[a][t]=0}}}}}return{status:K.OK,reference:null}}catch(t){return console.info("calculation error trapped",t),{status:K.CalculationError,reference:null}}},r.prototype.FlattenedResults=function(){var t,e,r,n=this.simulation_expression_calculator.simulation_model,i=[];for(var o in n.results)for(var a in n.results[o]){var s=n.results[o][a];for(var l in s)i.push((t={row:Number(l),column:Number(a),sheet_id:Number(o),data:s[l]},void 0,r=void 0,e=4+t.data.length,r=new Float64Array(e),r[0]=t.column,r[1]=t.row,r[2]=t.sheet_id,r[3]=t.data.length,r.set(t.data,4),r).buffer)}return i},r.prototype.FlushSimulationResults=function(){var t=this.simulation_expression_calculator.simulation_model;t.results=[],t.elapsed=0,t.trials=0},r.prototype.ShiftSimulationResults=function(t,e,r,n){},r.prototype.UpdateResults=function(t,e,r){var n,i;if(void 0===e&&(e=this.model),void 0===r&&(r=!0),!e)throw new Error("UpdateResults called without model");var a=this.simulation_expression_calculator.simulation_model;if(t){a.results=[],a.elapsed=t.elapsed,a.trials=t.trials;try{for(var s=o(t.results),l=s.next();!l.done;l=s.next()){var u=l.value,c=u instanceof ArrayBuffer?de(new Float64Array(u)):u;c.sheet_id||(c.sheet_id=e.active_sheet.id),a.results[c.sheet_id]||(a.results[c.sheet_id]=[]),a.results[c.sheet_id][c.column]||(a.results[c.sheet_id][c.column]=[]),a.results[c.sheet_id][c.column][c.row]=c.data,r&&this.SetDirty(c)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}else a.results=[],a.elapsed=0,a.trials=0},r}(fe),_e=function(){function t(t){this.base_worker=t,this.trials=0,this.lhs=!1,this.data_model={active_sheet:V.Blank({}),sheets:[V.Blank({})],named_ranges:new j,macro_functions:{}},this.screen_updates=!1,this.calculator=new ye,this.start_time=0,this.additional_cells=[],this.iteration=0}return t.prototype.Timestamp=function(){return self.performance?performance.now():Date.now()},t.prototype.OnMessage=function(t){var e,r,n=t.data;if(n)switch(n.type){case"configure":if(n.locale&&n.locale!==g.locale&&(g.UpdateLocale(n.locale),this.calculator.UpdateLocale()),this.data_model.sheets=n.sheets.map((function(t){return V.FromJSON(t,{})})),this.data_model.active_sheet=this.data_model.sheets[0],n.additional_cells&&(this.additional_cells=n.additional_cells),this.data_model.named_ranges.Deserialize(n.named_ranges),this.data_model.macro_functions={},n.macro_functions)try{for(var i=o(n.macro_functions),a=i.next();!a.done;a=i.next()){var s=a.value;this.data_model.macro_functions[s.name.toUpperCase()]=s}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.seed=n.seed;break;case"step":this.SimulationStep();break;case"start":this.trials=n.trials||1e3,this.lhs=!!n.lhs,this.screen_updates=!!n.screen_updates,this.Start()}},t.prototype.Post=function(t,e){this.base_worker.postMessage(t,e)},t.prototype.SimulationStep=function(){if(!(this.iteration>=this.trials)){this.calculator.SimulationTrial(this.iteration);var t=Math.floor(this.iteration/this.trials*100);if(++this.iteration!==this.trials){var e=this.calculator.FlattenedResults(),r=this.Timestamp()-this.start_time;this.Post({type:"update",percent_complete:t,cells:this.data_model.active_sheet.cells.toJSON(),trial_data:{results:e,trials:this.iteration,elapsed:r}},e)}else this.Finish()}},t.prototype.Start=function(){if(!this.trials)throw new Error("invalid trial count");this.start_time=this.Timestamp();var t=this.calculator.InitSimulation(this.trials,this.lhs,this.data_model,this.additional_cells,this.seed);if(this.seed=void 0,t!==K.OK)throw new Error("graph failed");var e=0;if(this.screen_updates)this.iteration=0,this.SimulationStep();else{for(var r=0;r<this.trials;r++){this.calculator.SimulationTrial(r);var n=Math.floor(r/this.trials*100);n!==e&&(e=n,this.Post({type:"progress",percent_complete:e}))}this.Finish()}},t.prototype.Finish=function(){this.Post({type:"progress",percent_complete:100});var t=this.calculator.FlattenedResults(),e=this.Timestamp()-this.start_time;this.Post({type:"complete",trial_data:{results:t,trials:this.trials,elapsed:e}},t)},t}(),ge=self,we=new _e(ge);ge.addEventListener("message",(function(t){return we.OnMessage(t)})),r(4370),r(1045)}()}();